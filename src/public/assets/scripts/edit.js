angular.module("dias.transects.edit",["dias.api","dias.ui.messages"]),angular.module("dias.transects.edit").config(["$compileProvider",function(e){"use strict";e.debugInfoEnabled(!1)}]),angular.module("dias.transects.edit").controller("AnnotationSessionController",["$scope","AnnotationSession","TRANSECT_ID",function(e,n,t){"use strict";var a=!0,s={},o=function(e){console.log("success",e)},i=function(e){s=e.data},r=function(){s={}};e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy"],e.open={starts_at:!1,ends_at:!1},e.newSession={name:null,description:null,starts_at:null,ends_at:null,hide_other_users_annotations:!1,hide_own_annotations:!1},e.isEditing=function(){return a},e.toggleEditing=function(){a=!a},e.openStartsAt=function(){e.open.starts_at=!0,e.open.ends_at=!1},e.openEndsAt=function(){e.open.ends_at=!0,e.open.starts_at=!1},e.hasError=function(e){return s.hasOwnProperty(e)},e.getError=function(n){if(e.hasError(n))return s[n][0]},e.addSession=function(){r(),n.create({transect_id:t},e.newSession,o,i)}}]),angular.module("dias.transects.edit").controller("ImagesController",["$scope","$element","Image","TransectImage","TRANSECT_ID","msg",function(e,n,t,a,s,o){"use strict";var i={confirm:n.attr("data-confirmation"),success:n.attr("data-success")};e.data={addingNewImages:!1,filenames:"",newImages:[]};var r=function(n){var t=document.getElementById("transect-image-"+n);if(t)t.remove();else for(var a=e.data.newImages.length-1;a>=0;a--)if(e.data.newImages[a].id===n){e.data.newImages.splice(a,1);break}};e.deleteImage=function(e,n){var a=i.confirm.replace(":img","#"+e+" ("+n+")");confirm(a)&&t.delete({id:e},function(){r(e),o.success(i.success)},o.responseError)},window.$diasTransectsEditDeleteImage=function(n,t){e.$apply(function(){e.deleteImage(n,t)})},e.toggleAddingNewImage=function(){e.data.addingNewImages=!e.data.addingNewImages},e.addNewImages=function(){var n=a.save({transect_id:s},{images:e.data.filenames},function(){Array.prototype.push.apply(e.data.newImages,n),e.data.filenames=""},o.responseError)}}]);