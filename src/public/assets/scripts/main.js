angular.module("biigle.projects",["biigle.api","biigle.ui"]),angular.module("biigle.projects").controller("ProjectController",["$scope","PROJECT","Project","msg","$timeout","ProjectUser","USER_ID","REDIRECT_URL",function(e,n,t,i,o,r,c,a){"use strict";var s=!1,u=!1;e.projectInfo={name:n.name,description:n.description};var d=function(e){i.responseError(e),u=!1},l=function(e){n.name=e.name,n.description=e.description,s=!1,u=!1},f=function(){i.success("The project was deleted. Redirecting..."),o(function(){window.location.href=a},2e3)},p=function(){i.success("You left the project. Redirecting..."),o(function(){window.location.href=a},2e3)},g=function(e){400===e.status?confirm("Deleting this project will delete one or more volumes with all annotations! Do you want to continue?")&&t.delete({id:n.id,force:!0},f,i.responseError):mgs.responseError(e)};e.isEditing=function(){return s},e.toggleEditing=function(){s=!s},e.isSaving=function(){return u},e.getName=function(){return n.name},e.getDescription=function(){return n.description},e.saveChanges=function(){u=!0,t.save({id:n.id,name:e.projectInfo.name,description:e.projectInfo.description},l,d)},e.discardChanges=function(){e.projectInfo.name=n.name,e.projectInfo.description=n.description,s=!1},e.deleteProject=function(){confirm("Do you really want to delete the project "+n.name+"?")&&t.delete({id:n.id},f,g)},e.leaveProject=function(){confirm("Do you really want to leave the project "+n.name+"?")&&r.detach({project_id:n.id},{id:c},p,i.responseError)}}]),angular.module("biigle.projects").controller("ProjectLabelTreesController",["$scope","PROJECT","LABEL_TREES","ProjectLabelTree","msg",function(e,n,t,i,o){"use strict";var r,c=!1,a=!1;e.selected={tree:null};var s=function(e){for(var n=t.length-1;n>=0;n--)if(t[n].id===e.id)return!1;return!0},u=function(n){t.push(n),e.selected.tree=null,a=!1},d=function(e){for(var n=t.length-1;n>=0;n--)if(t[n].id===e.id){t.splice(n,1);break}a=!1};e.isEditing=function(){return c},e.isLoading=function(){return a},e.toggleEditing=function(){c=!c,r||(r=i.available({project_id:n.id}))},e.getTrees=function(){return t},e.attachLabelTree=function(e){e&&void 0!==e.id&&s(e)&&(i.attach({project_id:n.id},{id:e.id},function(){u(e)},o.responseError),a=!0)},e.getAvailableTrees=function(){return r.filter(s)},e.detachLabelTree=function(e){i.detach({project_id:n.id},{id:e.id},d,o.responseError),a=!0}}]);