angular.module("dias.admin",["dias.api","dias.ui.messages"]),angular.module("dias.admin").config(["$compileProvider",function(e){"use strict";e.debugInfoEnabled(!1)}]),angular.module("dias.admin").directive("adminLabelCategoryItem",["$compile","$timeout","$templateCache",function(e,n,t){"use strict";return{restrict:"C",templateUrl:"label-item.html",scope:!0,link:function(i,a,l){var o=angular.element(t.get("label-subtree.html"));n(function(){a.append(e(o)(i))})},controller:["$scope",function(e){e.isOpen=!1,e.isExpandable=!!e.categoriesTree[e.item.id],e.isSelected=!1,e.removing=!1,e.startRemove=function(){e.removing=!0},e.cancelRemove=function(){e.removing=!1},e.$on("categories.selected",function(n,t){e.item.id===t?(e.isOpen=!0,e.isSelected=!0,e.$emit("categories.openParents")):(e.isOpen=!1,e.isSelected=!1)}),e.$on("categories.openParents",function(n){e.isOpen=!0,null===e.item.parent_id&&n.stopPropagation()}),e.$on("categories.refresh",function(n){e.isExpandable=!!e.categoriesTree[e.item.id]})}]}}]),angular.module("dias.admin").controller("AdminLabelsController",["$scope","Label","msg",function(e,n,t){"use strict";var i="#0099ff",a=function(n){var t=n.parent_id;e.categoriesTree[t]?e.categoriesTree[t].push(n):e.categoriesTree[t]=[n]},l=function(){e.labels=n.query(function(){e.categoriesTree={},e.labels.forEach(a)})};l(),e.newLabel={parent_id:null,name:null,project_id:null,color:i},e.selected={label:null},e.resetColor=function(){e.newLabel.color=i},e.selectItem=function(n){e.selected.label=n,e.newLabel.parent_id=n?n.id:null,e.$broadcast("categories.selected",e.newLabel.parent_id)},e.remove=function(t){n["delete"]({id:t,force:!0},function(){e.selected.label.id===t&&e.selectItem(null),l()})},e.addLabel=function(){n.add(e.newLabel,function(n){e.labels.push(n),a(n),e.$broadcast("categories.refresh"),e.newLabel.name=""},t.responseError)}}]);