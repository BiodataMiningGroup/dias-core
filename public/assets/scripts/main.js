/*! For license information please see main.js.LICENSE.txt */
(()=>{var t,e={1070:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1540),r=6378137;function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(s(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(s(t[i]))}return e}function s(t){var e,i,n,o,s,l,u=0,h=t.length;if(h>2){for(l=0;l<h;l++)l===h-2?(n=h-2,o=h-1,s=0):l===h-1?(n=h-1,o=0,s=1):(n=l,o=l+1,s=l+2),e=t[n],i=t[o],u+=(a(t[s][0])-a(e[0]))*Math.sin(a(i[1]));u=u*r*r/2}return u}function a(t){return t*Math.PI/180}e.default=function(t){return n.geomReduce(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=o(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}},9705:(t,e,i)=>{"use strict";var n=i(1540);function r(t){var e=[1/0,1/0,-1/0,-1/0];return n.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}r.default=r,e.Z=r},9977:(t,e,i)=>{"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var r=n(i(9209)),o=n(i(1070)),s=i(4102),a=i(611),l=i(1540);function u(t){switch(t.type){case"Polygon":return o(t)>1?t:null;case"MultiPolygon":var e=[];if(l.flattenEach(t,(function(t){o(t)>1&&e.push(t.geometry.coordinates)})),e.length)return{type:"MultiPolygon",coordinates:e}}}t.exports=function(t,e){var i=a.getGeom(t),n=a.getGeom(e),o=t.properties||{};if(i=u(i),n=u(n),!i)return null;if(!n)return s.feature(i,o);var l=r.diff(i.coordinates,n.coordinates);return 0===l.length?null:1===l.length?s.polygon(l[0],o):s.multiPolygon(l,o)}},4102:(t,e)=>{"use strict";function i(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function n(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(t[0])||!f(t[1]))throw new Error("coordinates must contain numbers");return i({type:"Point",coordinates:t},e,n)}function r(t,e,n){void 0===n&&(n={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return i({type:"Polygon",coordinates:t},e,n)}function o(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return i({type:"LineString",coordinates:t},e,n)}function s(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function a(t,e,n){return void 0===n&&(n={}),i({type:"MultiLineString",coordinates:t},e,n)}function l(t,e,n){return void 0===n&&(n={}),i({type:"MultiPoint",coordinates:t},e,n)}function u(t,e,n){return void 0===n&&(n={}),i({type:"MultiPolygon",coordinates:t},e,n)}function h(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t*n}function c(t,i){void 0===i&&(i="kilometers");var n=e.factors[i];if(!n)throw new Error(i+" units is invalid");return t/n}function d(t){return 180*(t%(2*Math.PI))/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=i,e.geometry=function(t,e,i){switch(void 0===i&&(i={}),t){case"Point":return n(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=n,e.points=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return n(t,e)})),i)},e.polygon=r,e.polygons=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return r(t,e)})),i)},e.lineString=o,e.lineStrings=function(t,e,i){return void 0===i&&(i={}),s(t.map((function(t){return o(t,e)})),i)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,n){return void 0===n&&(n={}),i({type:"GeometryCollection",geometries:t},e,n)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var i=Math.pow(10,e||0);return Math.round(t*i)/i},e.radiansToLength=h,e.lengthToRadians=c,e.lengthToDegrees=function(t,e){return d(c(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=d,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,i){if(void 0===e&&(e="kilometers"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("length must be a positive number");return h(c(t,e),i)},e.convertArea=function(t,i,n){if(void 0===i&&(i="meters"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[i];if(!r)throw new Error("invalid original units");var o=e.areaFactors[n];if(!o)throw new Error("invalid final units");return t/r*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},611:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4102);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,i){if(!e||!i)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,i){if(!t)throw new Error("No feature passed");if(!i)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,i){if(!t)throw new Error("No featureCollection passed");if(!i)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+i+", FeatureCollection required");for(var n=0,r=t.features;n<r.length;n++){var o=r[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+i+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+i+": must be a "+e+", given "+o.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},1540:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4102);function r(t,e,i){if(null!==t)for(var n,o,s,a,l,u,h,c,d=0,f=0,p=t.type,g="FeatureCollection"===p,m="Feature"===p,v=g?t.features.length:1,y=0;y<v;y++){l=(c=!!(h=g?t.features[y].geometry:m?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var _=0;_<l;_++){var b=0,w=0;if(null!==(a=c?h.geometries[_]:h)){u=a.coordinates;var x=a.type;switch(d=!i||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(u,f,y,b,w))return!1;f++,b++;break;case"LineString":case"MultiPoint":for(n=0;n<u.length;n++){if(!1===e(u[n],f,y,b,w))return!1;f++,"MultiPoint"===x&&b++}"LineString"===x&&b++;break;case"Polygon":case"MultiLineString":for(n=0;n<u.length;n++){for(o=0;o<u[n].length-d;o++){if(!1===e(u[n][o],f,y,b,w))return!1;f++}"MultiLineString"===x&&b++,"Polygon"===x&&w++}"Polygon"===x&&b++;break;case"MultiPolygon":for(n=0;n<u.length;n++){for(w=0,o=0;o<u[n].length;o++){for(s=0;s<u[n][o].length-d;s++){if(!1===e(u[n][o][s],f,y,b,w))return!1;f++}w++}b++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===r(a.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var i;switch(t.type){case"FeatureCollection":for(i=0;i<t.features.length&&!1!==e(t.features[i].properties,i);i++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function a(t,e){var i,n,r,o,s,a,l,u,h,c,d=0,f="FeatureCollection"===t.type,p="Feature"===t.type,g=f?t.features.length:1;for(i=0;i<g;i++){for(a=f?t.features[i].geometry:p?t.geometry:t,u=f?t.features[i].properties:p?t.properties:{},h=f?t.features[i].bbox:p?t.bbox:void 0,c=f?t.features[i].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,h,c))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],d,u,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,h,c))return!1;d++}}function l(t,e){a(t,(function(t,i,r,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(n.feature(t,r,{bbox:o,id:s}),i,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var h={type:a,coordinates:t.coordinates[u]};if(!1===e(n.feature(h,r),i,u))return!1}}))}function u(t,e){l(t,(function(t,i,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,h=0,c=0;return!1!==r(t,(function(r,a,d,f,p){if(void 0===l||i>u||f>h||p>c)return l=r,u=i,h=f,c=p,void(s=0);var g=n.lineString([l,r],t.properties);if(!1===e(g,i,o,p,s))return!1;s++,l=r}))&&void 0}}}))}function h(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,i,r){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,i,r,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(n.lineString(s[a],t.properties),i,r,a))return!1}}}))}e.coordEach=r,e.coordReduce=function(t,e,i,n){var o=i;return r(t,(function(t,n,r,s,a){o=0===n&&void 0===i?t:e(o,t,n,r,s,a)}),n),o},e.propEach=o,e.propReduce=function(t,e,i){var n=i;return o(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},e.featureEach=s,e.featureReduce=function(t,e,i){var n=i;return s(t,(function(t,r){n=0===r&&void 0===i?t:e(n,t,r)})),n},e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.geomEach=a,e.geomReduce=function(t,e,i){var n=i;return a(t,(function(t,r,o,s,a){n=0===r&&void 0===i?t:e(n,t,r,o,s,a)})),n},e.flattenEach=l,e.flattenReduce=function(t,e,i){var n=i;return l(t,(function(t,r,o){n=0===r&&0===o&&void 0===i?t:e(n,t,r,o)})),n},e.segmentEach=u,e.segmentReduce=function(t,e,i){var n=i,r=!1;return u(t,(function(t,o,s,a,l){n=!1===r&&void 0===i?t:e(n,t,o,s,a,l),r=!0})),n},e.lineEach=h,e.lineReduce=function(t,e,i){var n=i;return h(t,(function(t,r,o,s){n=0===r&&void 0===i?t:e(n,t,r,o,s)})),n},e.findSegment=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var i,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,i=t.features[r].geometry;break;case"Feature":l=l||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var u=i.coordinates;switch(i.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),n.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),n.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),n.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),n.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.findPoint=function(t,e){if(e=e||{},!n.isObject(e))throw new Error("options is invalid");var i,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,i=t.features[r].geometry;break;case"Feature":l=l||t.properties,i=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":i=t;break;default:throw new Error("geojson is invalid")}if(null===i)return null;var u=i.coordinates;switch(i.type){case"Point":return n.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),n.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),n.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),n.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),n.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),n.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")}},2789:t=>{var e=function(){var t={};function e(t,e){return new k(null,t+"    uniform sampler2D texture;    uniform vec2 texSize;    varying vec2 texCoord;    void main() {        vec2 coord = texCoord * texSize;        "+e+"        gl_FragColor = texture2D(texture, coord / texSize);        vec2 clampedCoord = clamp(coord, vec2(0.0), texSize);        if (coord != clampedCoord) {            /* fade to transparent if we are outside the image */            gl_FragColor.a *= max(0.0, 1.0 - length(coord - clampedCoord));        }    }")}var i="    float random(vec3 scale, float seed) {        /* use the fragment position for a different seed per-pixel */        return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);    }";function n(t,e){return A.brightnessContrast=A.brightnessContrast||new k(null,"        uniform sampler2D texture;        uniform float brightness;        uniform float contrast;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.rgb += brightness;            if (contrast > 0.0) {                color.rgb = (color.rgb - 0.5) / (1.0 - contrast) + 0.5;            } else {                color.rgb = (color.rgb - 0.5) * (1.0 + contrast) + 0.5;            }            gl_FragColor = color;        }    "),D.call(this,A.brightnessContrast,{brightness:P(-1,t,1),contrast:P(-1,e,1)}),this}function r(t){return A.gamma=A.gamma||new k(null,"        uniform sampler2D texture;        uniform float gamma;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.rgb = pow(color.rgb, vec3(gamma));            gl_FragColor = color;        }    "),D.call(this,A.gamma,{gamma:P(0,t,5)}),this}function o(t){return A.vibrance=A.vibrance||new k(null,"        uniform sampler2D texture;        uniform float amount;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            float average = (color.r + color.g + color.b) / 3.0;            float mx = max(color.r, max(color.g, color.b));            float amt = (mx - average) * (-amount * 3.0);            color.rgb = mix(color.rgb, vec3(mx), amt);            gl_FragColor = color;        }    "),D.call(this,A.vibrance,{amount:P(-1,t,1)}),this}function s(t){for(var e=new V(t),i=[],n=0;n<256;n++)i.push(P(0,Math.floor(256*e.interpolate(n/255)),255));return i}function a(t,e,i){t=s(t),1==arguments.length?e=i=t:(e=s(e),i=s(i));for(var n=[],r=0;r<256;r++)n.splice(n.length,0,t[r],e[r],i[r],255);return this._.extraTexture.initFromBytes(256,1,n),this._.extraTexture.use(1),A.curves=A.curves||new k(null,"        uniform sampler2D texture;        uniform sampler2D map;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.r = texture2D(map, vec2(color.r)).r;            color.g = texture2D(map, vec2(color.g)).g;            color.b = texture2D(map, vec2(color.b)).b;            gl_FragColor = color;        }    "),A.curves.textures({map:1}),D.call(this,A.curves,{}),this}function l(t,e,i){return A.brightnessRGB=A.brightnessRGB||new k(null,"        uniform sampler2D texture;        uniform float r;        uniform float g;        uniform float b;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color.r += r;            color.g += g;            color.b += b;            gl_FragColor = color;        }    "),D.call(this,A.brightnessRGB,{r:P(-1,t,1),g:P(-1,e,1),b:P(-1,i,1)}),this}function u(t,e){return A.vignette=A.vignette||new k(null,"        uniform sampler2D texture;        uniform float size;        uniform float amount;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);                        float dist = distance(texCoord, vec2(0.5, 0.5));            color.rgb *= smoothstep(0.8, size * 0.799, dist * (amount + size));                        gl_FragColor = color;        }    "),D.call(this,A.vignette,{size:P(0,t,1),amount:P(0,e,1)}),this}function h(t){return A.noise=A.noise||new k(null,"        uniform sampler2D texture;        uniform float amount;        varying vec2 texCoord;        float rand(vec2 co) {            return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);        }        void main() {            vec4 color = texture2D(texture, texCoord);                        float diff = (rand(texCoord) - 0.5) * amount;            color.r += diff;            color.g += diff;            color.b += diff;                        gl_FragColor = color;        }    "),D.call(this,A.noise,{amount:P(0,t,1)}),this}function c(t){A.denoise=A.denoise||new k(null,"        uniform sampler2D texture;        uniform float exponent;        uniform float strength;        uniform vec2 texSize;        varying vec2 texCoord;        void main() {            vec4 center = texture2D(texture, texCoord);            vec4 color = vec4(0.0);            float total = 0.0;            for (float x = -4.0; x <= 4.0; x += 1.0) {                for (float y = -4.0; y <= 4.0; y += 1.0) {                    vec4 sample = texture2D(texture, texCoord + vec2(x, y) / texSize);                    float weight = 1.0 - abs(dot(sample.rgb - center.rgb, vec3(0.25)));                    weight = pow(weight, exponent);                    color += sample * weight;                    total += weight;                }            }            gl_FragColor = color / total;        }    ");for(var e=0;e<2;e++)D.call(this,A.denoise,{exponent:Math.max(0,t),texSize:[this.width,this.height]});return this}function d(t){return A.sepia=A.sepia||new k(null,"        uniform sampler2D texture;        uniform float amount;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            float r = color.r;            float g = color.g;            float b = color.b;                        color.r = min(1.0, (r * (1.0 - (0.607 * amount))) + (g * (0.769 * amount)) + (b * (0.189 * amount)));            color.g = min(1.0, (r * 0.349 * amount) + (g * (1.0 - (0.314 * amount))) + (b * 0.168 * amount));            color.b = min(1.0, (r * 0.272 * amount) + (g * 0.534 * amount) + (b * (1.0 - (0.869 * amount))));                        gl_FragColor = color;        }    "),D.call(this,A.sepia,{amount:P(0,t,1)}),this}function f(t,e){return A.unsharpMask=A.unsharpMask||new k(null,"        uniform sampler2D blurredTexture;        uniform sampler2D originalTexture;        uniform float strength;        uniform float threshold;        varying vec2 texCoord;        void main() {            vec4 blurred = texture2D(blurredTexture, texCoord);            vec4 original = texture2D(originalTexture, texCoord);            gl_FragColor = mix(blurred, original, 1.0 + strength);        }    "),this._.extraTexture.ensureFormat(this._.texture),this._.texture.use(),this._.extraTexture.drawTo((function(){k.getDefaultShader().drawRect()})),this._.extraTexture.use(1),this.triangleBlur(t),A.unsharpMask.textures({originalTexture:1}),D.call(this,A.unsharpMask,{strength:e}),this._.extraTexture.unuse(1),this}function p(t,e){return A.hueSaturation=A.hueSaturation||new k(null,"        uniform sampler2D texture;        uniform float hue;        uniform float saturation;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);                        /* hue adjustment, wolfram alpha: RotationTransform[angle, {1, 1, 1}][{x, y, z}] */            float angle = hue * 3.14159265;            float s = sin(angle), c = cos(angle);            vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;            float len = length(color.rgb);            color.rgb = vec3(                dot(color.rgb, weights.xyz),                dot(color.rgb, weights.zxy),                dot(color.rgb, weights.yzx)            );                        /* saturation adjustment */            float average = (color.r + color.g + color.b) / 3.0;            if (saturation > 0.0) {                color.rgb += (average - color.rgb) * (1.0 - 1.0 / (1.001 - saturation));            } else {                color.rgb += (average - color.rgb) * (-saturation);            }                        gl_FragColor = color;        }    "),D.call(this,A.hueSaturation,{hue:P(-1,t,1),saturation:P(-1,e,1)}),this}function g(t,i,n,r){return A.swirl=A.swirl||e("        uniform float radius;        uniform float angle;        uniform vec2 center;    ","        coord -= center;        float distance = length(coord);        if (distance < radius) {            float percent = (radius - distance) / radius;            float theta = percent * percent * angle;            float s = sin(theta);            float c = cos(theta);            coord = vec2(                coord.x * c - coord.y * s,                coord.x * s + coord.y * c            );        }        coord += center;    "),D.call(this,A.swirl,{radius:n,center:[t,i],angle:r,texSize:[this.width,this.height]}),this}function m(t,e){var i=U.apply(null,e),n=U.apply(null,t),r=function(t,e){return[t[0]*e[0]+t[1]*e[3]+t[2]*e[6],t[0]*e[1]+t[1]*e[4]+t[2]*e[7],t[0]*e[2]+t[1]*e[5]+t[2]*e[8],t[3]*e[0]+t[4]*e[3]+t[5]*e[6],t[3]*e[1]+t[4]*e[4]+t[5]*e[7],t[3]*e[2]+t[4]*e[5]+t[5]*e[8],t[6]*e[0]+t[7]*e[3]+t[8]*e[6],t[6]*e[1]+t[7]*e[4]+t[8]*e[7],t[6]*e[2]+t[7]*e[5]+t[8]*e[8]]}(G(i),n);return this.matrixWarp(r)}function v(t,i,n,r){return A.bulgePinch=A.bulgePinch||e("        uniform float radius;        uniform float strength;        uniform vec2 center;    ","        coord -= center;        float distance = length(coord);        if (distance < radius) {            float percent = distance / radius;            if (strength > 0.0) {                coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);            } else {                coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);            }        }        coord += center;    "),D.call(this,A.bulgePinch,{radius:n,strength:P(-1,r,1),center:[t,i],texSize:[this.width,this.height]}),this}function y(t,i,n){if(A.matrixWarp=A.matrixWarp||e("        uniform mat3 matrix;        uniform bool useTextureSpace;    ","        if (useTextureSpace) coord = coord / texSize * 2.0 - 1.0;        vec3 warp = matrix * vec3(coord, 1.0);        coord = warp.xy / warp.z;        if (useTextureSpace) coord = (coord * 0.5 + 0.5) * texSize;    "),4==(t=Array.prototype.concat.apply([],t)).length)t=[t[0],t[1],0,t[2],t[3],0,0,0,1];else if(9!=t.length)throw"can only warp with 2x2 or 3x3 matrix";return D.call(this,A.matrixWarp,{matrix:i?G(t):t,texSize:[this.width,this.height],useTextureSpace:0|n}),this}function _(t,e,n){return A.zoomBlur=A.zoomBlur||new k(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float strength;        uniform vec2 texSize;        varying vec2 texCoord;        "+i+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;            vec2 toCenter = center - texCoord * texSize;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = 0.0; t <= 40.0; t++) {                float percent = (t + offset) / 40.0;                float weight = 4.0 * (percent - percent * percent);                vec4 sample = texture2D(texture, texCoord + toCenter * percent * strength / texSize);                                /* switch to pre-multiplied alpha to correctly blur transparent images */                sample.rgb *= sample.a;                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;                        /* switch back from pre-multiplied alpha */            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;        }    "),D.call(this,A.zoomBlur,{center:[t,e],strength:n,texSize:[this.width,this.height]}),this}function b(t,e,n,r,o,s){A.tiltShift=A.tiltShift||new k(null,"        uniform sampler2D texture;        uniform float blurRadius;        uniform float gradientRadius;        uniform vec2 start;        uniform vec2 end;        uniform vec2 delta;        uniform vec2 texSize;        varying vec2 texCoord;        "+i+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));            float radius = smoothstep(0.0, 1.0, abs(dot(texCoord * texSize - start, normal)) / gradientRadius) * blurRadius;            for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta / texSize * percent * radius);                                /* switch to pre-multiplied alpha to correctly blur transparent images */                sample.rgb *= sample.a;                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;                        /* switch back from pre-multiplied alpha */            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;        }    ");var a=n-t,l=r-e,u=Math.sqrt(a*a+l*l);return D.call(this,A.tiltShift,{blurRadius:o,gradientRadius:s,start:[t,e],end:[n,r],delta:[a/u,l/u],texSize:[this.width,this.height]}),D.call(this,A.tiltShift,{blurRadius:o,gradientRadius:s,start:[t,e],end:[n,r],delta:[-l/u,a/u],texSize:[this.width,this.height]}),this}function w(t){return A.triangleBlur=A.triangleBlur||new k(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+i+"        void main() {            vec4 color = vec4(0.0);            float total = 0.0;                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec4 sample = texture2D(texture, texCoord + delta * percent);                                /* switch to pre-multiplied alpha to correctly blur transparent images */                sample.rgb *= sample.a;                                color += sample * weight;                total += weight;            }                        gl_FragColor = color / total;                        /* switch back from pre-multiplied alpha */            gl_FragColor.rgb /= gl_FragColor.a + 0.00001;        }    "),D.call(this,A.triangleBlur,{delta:[t/this.width,0]}),D.call(this,A.triangleBlur,{delta:[0,t/this.height]}),this}function x(t,e,n){A.lensBlurPrePass=A.lensBlurPrePass||new k(null,"        uniform sampler2D texture;        uniform float power;        varying vec2 texCoord;        void main() {            vec4 color = texture2D(texture, texCoord);            color = pow(color, vec4(power));            gl_FragColor = vec4(color);        }    ");var r="        uniform sampler2D texture0;        uniform sampler2D texture1;        uniform vec2 delta0;        uniform vec2 delta1;        uniform float power;        varying vec2 texCoord;        "+i+"        vec4 sample(vec2 delta) {            /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(delta, 151.7182), 0.0);                        vec4 color = vec4(0.0);            float total = 0.0;            for (float t = 0.0; t <= 30.0; t++) {                float percent = (t + offset) / 30.0;                color += texture2D(texture0, texCoord + delta * percent);                total += 1.0;            }            return color / total;        }    ";A.lensBlur0=A.lensBlur0||new k(null,r+"        void main() {            gl_FragColor = sample(delta0);        }    "),A.lensBlur1=A.lensBlur1||new k(null,r+"        void main() {            gl_FragColor = (sample(delta0) + sample(delta1)) * 0.5;        }    "),A.lensBlur2=A.lensBlur2||new k(null,r+"        void main() {            vec4 color = (sample(delta0) + 2.0 * texture2D(texture1, texCoord)) / 3.0;            gl_FragColor = pow(color, vec4(power));        }    ").textures({texture1:1});for(var o=[],s=0;s<3;s++){var a=n+s*Math.PI*2/3;o.push([t*Math.sin(a)/this.width,t*Math.cos(a)/this.height])}var l=Math.pow(10,P(-1,e,1));return D.call(this,A.lensBlurPrePass,{power:l}),this._.extraTexture.ensureFormat(this._.texture),D.call(this,A.lensBlur0,{delta0:o[0]},this._.texture,this._.extraTexture),D.call(this,A.lensBlur1,{delta0:o[1],delta1:o[2]},this._.extraTexture,this._.extraTexture),D.call(this,A.lensBlur0,{delta0:o[1]}),this._.extraTexture.use(1),D.call(this,A.lensBlur2,{power:1/l,delta0:o[2]}),this}function S(t){return A.edgeWork1=A.edgeWork1||new k(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+i+"        void main() {            vec2 color = vec2(0.0);            vec2 total = vec2(0.0);                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec3 sample = texture2D(texture, texCoord + delta * percent).rgb;                float average = (sample.r + sample.g + sample.b) / 3.0;                color.x += average * weight;                total.x += weight;                if (abs(t) < 15.0) {                    weight = weight * 2.0 - 1.0;                    color.y += average * weight;                    total.y += weight;                }            }            gl_FragColor = vec4(color / total, 0.0, 1.0);        }    "),A.edgeWork2=A.edgeWork2||new k(null,"        uniform sampler2D texture;        uniform vec2 delta;        varying vec2 texCoord;        "+i+"        void main() {            vec2 color = vec2(0.0);            vec2 total = vec2(0.0);                        /* randomize the lookup values to hide the fixed number of samples */            float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);                        for (float t = -30.0; t <= 30.0; t++) {                float percent = (t + offset - 0.5) / 30.0;                float weight = 1.0 - abs(percent);                vec2 sample = texture2D(texture, texCoord + delta * percent).xy;                color.x += sample.x * weight;                total.x += weight;                if (abs(t) < 15.0) {                    weight = weight * 2.0 - 1.0;                    color.y += sample.y * weight;                    total.y += weight;                }            }            float c = clamp(10000.0 * (color.y / total.y - color.x / total.x) + 0.5, 0.0, 1.0);            gl_FragColor = vec4(c, c, c, 1.0);        }    "),D.call(this,A.edgeWork1,{delta:[t/this.width,0]}),D.call(this,A.edgeWork2,{delta:[0,t/this.height]}),this}function C(t,e,i,n){return A.colorHalftone=A.colorHalftone||new k(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float angle;        uniform float scale;        uniform vec2 texSize;        varying vec2 texCoord;                float pattern(float angle) {            float s = sin(angle), c = cos(angle);            vec2 tex = texCoord * texSize - center;            vec2 point = vec2(                c * tex.x - s * tex.y,                s * tex.x + c * tex.y            ) * scale;            return (sin(point.x) * sin(point.y)) * 4.0;        }                void main() {            vec4 color = texture2D(texture, texCoord);            vec3 cmy = 1.0 - color.rgb;            float k = min(cmy.x, min(cmy.y, cmy.z));            cmy = (cmy - k) / (1.0 - k);            cmy = clamp(cmy * 10.0 - 3.0 + vec3(pattern(angle + 0.26179), pattern(angle + 1.30899), pattern(angle)), 0.0, 1.0);            k = clamp(k * 10.0 - 5.0 + pattern(angle + 0.78539), 0.0, 1.0);            gl_FragColor = vec4(1.0 - cmy - k, color.a);        }    "),D.call(this,A.colorHalftone,{center:[t,e],angle:i,scale:Math.PI/n,texSize:[this.width,this.height]}),this}function E(t,e,i){return A.hexagonalPixelate=A.hexagonalPixelate||new k(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float scale;        uniform vec2 texSize;        varying vec2 texCoord;        void main() {            vec2 tex = (texCoord * texSize - center) / scale;            tex.y /= 0.866025404;            tex.x -= tex.y * 0.5;                        vec2 a;            if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) a = vec2(floor(tex.x), floor(tex.y));            else a = vec2(ceil(tex.x), ceil(tex.y));            vec2 b = vec2(ceil(tex.x), floor(tex.y));            vec2 c = vec2(floor(tex.x), ceil(tex.y));                        vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);            vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);            vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);            vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);                        float alen = length(TEX - A);            float blen = length(TEX - B);            float clen = length(TEX - C);                        vec2 choice;            if (alen < blen) {                if (alen < clen) choice = a;                else choice = c;            } else {                if (blen < clen) choice = b;                else choice = c;            }                        choice.x += choice.y * 0.5;            choice.y *= 0.866025404;            choice *= scale / texSize;            gl_FragColor = texture2D(texture, choice + center / texSize);        }    "),D.call(this,A.hexagonalPixelate,{center:[t,e],scale:i,texSize:[this.width,this.height]}),this}function T(t){return A.ink=A.ink||new k(null,"        uniform sampler2D texture;        uniform float strength;        uniform vec2 texSize;        varying vec2 texCoord;        void main() {            vec2 dx = vec2(1.0 / texSize.x, 0.0);            vec2 dy = vec2(0.0, 1.0 / texSize.y);            vec4 color = texture2D(texture, texCoord);            float bigTotal = 0.0;            float smallTotal = 0.0;            vec3 bigAverage = vec3(0.0);            vec3 smallAverage = vec3(0.0);            for (float x = -2.0; x <= 2.0; x += 1.0) {                for (float y = -2.0; y <= 2.0; y += 1.0) {                    vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;                    bigAverage += sample;                    bigTotal += 1.0;                    if (abs(x) + abs(y) < 2.0) {                        smallAverage += sample;                        smallTotal += 1.0;                    }                }            }            vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);            gl_FragColor = vec4(color.rgb - dot(edge, edge) * strength * 100000.0, color.a);        }    "),D.call(this,A.ink,{strength:t*t*t*t*t,texSize:[this.width,this.height]}),this}function I(t,e,i,n){return A.dotScreen=A.dotScreen||new k(null,"        uniform sampler2D texture;        uniform vec2 center;        uniform float angle;        uniform float scale;        uniform vec2 texSize;        varying vec2 texCoord;                float pattern() {            float s = sin(angle), c = cos(angle);            vec2 tex = texCoord * texSize - center;            vec2 point = vec2(                c * tex.x - s * tex.y,                s * tex.x + c * tex.y            ) * scale;            return (sin(point.x) * sin(point.y)) * 4.0;        }                void main() {            vec4 color = texture2D(texture, texCoord);            float average = (color.r + color.g + color.b) / 3.0;            gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);        }    "),D.call(this,A.dotScreen,{center:[t,e],angle:i,scale:Math.PI/n,texSize:[this.width,this.height]}),this}var A,k=function(){function t(t){return"[object Number]"==Object.prototype.toString.call(t)}function e(t,e){var i=A.createShader(t);if(A.shaderSource(i,e),A.compileShader(i),!A.getShaderParameter(i,A.COMPILE_STATUS))throw"compile error: "+A.getShaderInfoLog(i);return i}function i(t,i){if(this.vertexAttribute=null,this.texCoordAttribute=null,this.program=A.createProgram(),t=t||"    attribute vec2 vertex;    attribute vec2 _texCoord;    varying vec2 texCoord;    void main() {        texCoord = _texCoord;        gl_Position = vec4(vertex * 2.0 - 1.0, 0.0, 1.0);    }",i="precision highp float;"+(i=i||"    uniform sampler2D texture;    varying vec2 texCoord;    void main() {        gl_FragColor = texture2D(texture, texCoord);    }"),A.attachShader(this.program,e(A.VERTEX_SHADER,t)),A.attachShader(this.program,e(A.FRAGMENT_SHADER,i)),A.linkProgram(this.program),!A.getProgramParameter(this.program,A.LINK_STATUS))throw"link error: "+A.getProgramInfoLog(this.program)}return i.prototype.destroy=function(){A.deleteProgram(this.program),this.program=null},i.prototype.uniforms=function(e){for(var i in A.useProgram(this.program),e)if(e.hasOwnProperty(i)){var n=A.getUniformLocation(this.program,i);if(null!==n){var r=e[i];if(o=r,"[object Array]"==Object.prototype.toString.call(o))switch(r.length){case 1:A.uniform1fv(n,new Float32Array(r));break;case 2:A.uniform2fv(n,new Float32Array(r));break;case 3:A.uniform3fv(n,new Float32Array(r));break;case 4:A.uniform4fv(n,new Float32Array(r));break;case 9:A.uniformMatrix3fv(n,!1,new Float32Array(r));break;case 16:A.uniformMatrix4fv(n,!1,new Float32Array(r));break;default:throw"dont't know how to load uniform \""+i+'" of length '+r.length}else{if(!t(r))throw'attempted to set uniform "'+i+'" to invalid value '+(r||"undefined").toString();A.uniform1f(n,r)}}}var o;return this},i.prototype.textures=function(t){for(var e in A.useProgram(this.program),t)t.hasOwnProperty(e)&&A.uniform1i(A.getUniformLocation(this.program,e),t[e]);return this},i.prototype.drawRect=function(t,e,i,n){var r,o=A.getParameter(A.VIEWPORT);e=e!==r?(e-o[1])/o[3]:0,t=t!==r?(t-o[0])/o[2]:0,i=i!==r?(i-o[0])/o[2]:1,n=n!==r?(n-o[1])/o[3]:1,null==A.vertexBuffer&&(A.vertexBuffer=A.createBuffer()),A.bindBuffer(A.ARRAY_BUFFER,A.vertexBuffer),A.bufferData(A.ARRAY_BUFFER,new Float32Array([t,e,t,n,i,e,i,n]),A.STATIC_DRAW),null==A.texCoordBuffer&&(A.texCoordBuffer=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,A.texCoordBuffer),A.bufferData(A.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),A.STATIC_DRAW)),null==this.vertexAttribute&&(this.vertexAttribute=A.getAttribLocation(this.program,"vertex"),A.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=A.getAttribLocation(this.program,"_texCoord"),A.enableVertexAttribArray(this.texCoordAttribute)),A.useProgram(this.program),A.bindBuffer(A.ARRAY_BUFFER,A.vertexBuffer),A.vertexAttribPointer(this.vertexAttribute,2,A.FLOAT,!1,0,0),A.bindBuffer(A.ARRAY_BUFFER,A.texCoordBuffer),A.vertexAttribPointer(this.texCoordAttribute,2,A.FLOAT,!1,0,0),A.drawArrays(A.TRIANGLE_STRIP,0,4)},i.getDefaultShader=function(){return A.defaultShader=A.defaultShader||new i,A.defaultShader},i}();function P(t,e,i){return Math.max(t,Math.min(e,i))}function L(t){return{_:t,loadContentsOf:function(t){A=this._.gl,this._.loadContentsOf(t)},destroy:function(){A=this._.gl,this._.destroy()}}}function R(t){return L(z.fromElement(t))}function F(t,e){var i=A.UNSIGNED_BYTE;if(A.getExtension("OES_texture_float")&&A.getExtension("OES_texture_float_linear")){A.getExtension("WEBGL_color_buffer_float");var n=new z(100,100,A.RGBA,A.FLOAT);try{n.drawTo((function(){i=A.FLOAT}))}catch(t){}n.destroy()}this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=t,this.height=e,this._.texture=new z(t,e,A.RGBA,i),this._.spareTexture=new z(t,e,A.RGBA,i),this._.extraTexture=this._.extraTexture||new z(0,0,A.RGBA,i),this._.flippedShader=this._.flippedShader||new k(null,"        uniform sampler2D texture;        varying vec2 texCoord;        void main() {            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));        }    "),this._.isInitialized=!0}function M(t,e,i){return this._.isInitialized&&t._.width==this.width&&t._.height==this.height||F.call(this,e||t._.width,i||t._.height),t._.use(),this._.texture.drawTo((function(){k.getDefaultShader().drawRect()})),this}function O(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function D(t,e,i,n){(i||this._.texture).use(),this._.spareTexture.drawTo((function(){t.uniforms(e).drawRect()})),this._.spareTexture.swapWith(n||this._.texture)}function $(t){return t.parentNode.insertBefore(this,t),t.parentNode.removeChild(t),this}function j(){var t=new z(this._.texture.width,this._.texture.height,A.RGBA,A.UNSIGNED_BYTE);return this._.texture.use(),t.drawTo((function(){k.getDefaultShader().drawRect()})),L(t)}function N(){var t=this._.texture.width,e=this._.texture.height,i=new Uint8Array(t*e*4);return this._.texture.drawTo((function(){A.readPixels(0,0,t,e,A.RGBA,A.UNSIGNED_BYTE,i)})),i}function B(t){return function(){return A=this._.gl,t.apply(this,arguments)}}function U(t,e,i,n,r,o,s,a){var l=i-r,u=n-o,h=s-r,c=a-o,d=t-i+r-s,f=e-n+o-a,p=l*c-h*u,g=(d*c-h*f)/p,m=(l*f-d*u)/p;return[i-t+g*i,n-e+g*n,g,s-t+m*s,a-e+m*a,m,t,e,1]}function G(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],h=e*o*u-e*s*l-i*r*u+i*s*a+n*r*l-n*o*a;return[(o*u-s*l)/h,(n*l-i*u)/h,(i*s-n*o)/h,(s*a-r*u)/h,(e*u-n*a)/h,(n*r-e*s)/h,(r*l-o*a)/h,(i*a-e*l)/h,(e*o-i*r)/h]}function V(t){var e=t.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],t.sort((function(t,e){return t[0]-e[0]}));for(var i=0;i<e;i++)this.xa.push(t[i][0]),this.ya.push(t[i][1]);this.u[0]=0,this.y2[0]=0;for(i=1;i<e-1;++i){var n=this.xa[i+1]-this.xa[i-1],r=(this.xa[i]-this.xa[i-1])/n,o=r*this.y2[i-1]+2;this.y2[i]=(r-1)/o;var s=(this.ya[i+1]-this.ya[i])/(this.xa[i+1]-this.xa[i])-(this.ya[i]-this.ya[i-1])/(this.xa[i]-this.xa[i-1]);this.u[i]=(6*s/n-r*this.u[i-1])/o}this.y2[e-1]=0;for(i=e-2;i>=0;--i)this.y2[i]=this.y2[i]*this.y2[i+1]+this.u[i]}t.canvas=function(){var t=document.createElement("canvas");try{A=t.getContext("experimental-webgl",{premultipliedAlpha:!1})}catch(t){A=null}if(!A)throw"This browser does not support WebGL";return t._={gl:A,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},t.texture=B(R),t.draw=B(M),t.update=B(O),t.replace=B($),t.contents=B(j),t.getPixelArray=B(N),t.brightnessContrast=B(n),t.brightnessRGB=B(l),t.hexagonalPixelate=B(E),t.hueSaturation=B(p),t.colorHalftone=B(C),t.triangleBlur=B(w),t.unsharpMask=B(f),t.perspective=B(m),t.matrixWarp=B(y),t.bulgePinch=B(v),t.tiltShift=B(b),t.dotScreen=B(I),t.edgeWork=B(S),t.lensBlur=B(x),t.zoomBlur=B(_),t.noise=B(h),t.denoise=B(c),t.curves=B(a),t.swirl=B(g),t.ink=B(T),t.vignette=B(u),t.vibrance=B(o),t.sepia=B(d),t.gamma=B(r),t},t.splineInterpolate=s,V.prototype.interpolate=function(t){for(var e=0,i=this.ya.length-1;i-e>1;){var n=i+e>>1;this.xa[n]>t?i=n:e=n}var r=this.xa[i]-this.xa[e],o=(this.xa[i]-t)/r,s=(t-this.xa[e])/r;return o*this.ya[e]+s*this.ya[i]+((o*o*o-o)*this.y2[e]+(s*s*s-s)*this.y2[i])*(r*r)/6};var z=function(){function t(t,e,i,n){this.gl=A,this.id=A.createTexture(),this.width=t,this.height=e,this.format=i,this.type=n,A.bindTexture(A.TEXTURE_2D,this.id),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),t&&e&&A.texImage2D(A.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null)}t.fromElement=function(e){var i=new t(0,0,A.RGBA,A.UNSIGNED_BYTE);return i.loadContentsOf(e),i},t.prototype.loadContentsOf=function(t){this.width=t.width||t.videoWidth,this.height=t.height||t.videoHeight,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,t)},t.prototype.initFromBytes=function(t,e,i){this.width=t,this.height=e,this.format=A.RGBA,this.type=A.UNSIGNED_BYTE,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,t,e,0,A.RGBA,this.type,new Uint8Array(i))},t.prototype.destroy=function(){A.deleteTexture(this.id),this.id=null},t.prototype.use=function(t){A.activeTexture(A.TEXTURE0+(t||0)),A.bindTexture(A.TEXTURE_2D,this.id)},t.prototype.unuse=function(t){A.activeTexture(A.TEXTURE0+(t||0)),A.bindTexture(A.TEXTURE_2D,null)},t.prototype.ensureFormat=function(t,e,i,n){if(1==arguments.length){var r=arguments[0];t=r.width,e=r.height,i=r.format,n=r.type}t==this.width&&e==this.height&&i==this.format&&n==this.type||(this.width=t,this.height=e,this.format=i,this.type=n,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null))},t.prototype.drawTo=function(t){if(A.framebuffer=A.framebuffer||A.createFramebuffer(),A.bindFramebuffer(A.FRAMEBUFFER,A.framebuffer),A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,this.id,0),A.checkFramebufferStatus(A.FRAMEBUFFER)!==A.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");A.viewport(0,0,this.width,this.height),t(),A.bindFramebuffer(A.FRAMEBUFFER,null)};var e=null;function i(t){null==e&&(e=document.createElement("canvas")),e.width=t.width,e.height=t.height;var i=e.getContext("2d");return i.clearRect(0,0,e.width,e.height),i}return t.prototype.fillUsingCanvas=function(t){return t(i(this)),this.format=A.RGBA,this.type=A.UNSIGNED_BYTE,A.bindTexture(A.TEXTURE_2D,this.id),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,e),this},t.prototype.toImage=function(t){this.use(),k.getDefaultShader().drawRect();var n=this.width*this.height*4,r=new Uint8Array(n),o=i(this),s=o.createImageData(this.width,this.height);A.readPixels(0,0,this.width,this.height,A.RGBA,A.UNSIGNED_BYTE,r);for(var a=0;a<n;a++)s.data[a]=r[a];o.putImageData(s,0,0),t.src=e.toDataURL()},t.prototype.swapWith=function(t){var e;e=t.id,t.id=this.id,this.id=e,e=t.width,t.width=this.width,this.width=e,e=t.height,t.height=this.height,this.height=e,e=t.format,t.format=this.format,this.format=e},t}();return t}();t.exports=e},1755:()=>{window.addEventListener("load",(function(){var t=(new Date).getTime(),e=window.setInterval((function(){(new Date).getTime()-t>72e5?window.clearInterval(e):Vue.http.post("heartbeat").then((function(){t=(new Date).getTime()}),(function(){window.clearInterval(e)}))}),36e5)}))},5471:(t,e,i)=>{"use strict";var n=Object.freeze({});function r(t){return null==t}function o(t){return null!=t}function s(t){return!0===t}function a(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function l(t){return null!==t&&"object"==typeof t}var u=Object.prototype.toString;function h(t){return"[object Object]"===u.call(t)}function c(t){return"[object RegExp]"===u.call(t)}function d(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function f(t){return o(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function p(t){return null==t?"":Array.isArray(t)||h(t)&&t.toString===u?JSON.stringify(t,null,2):String(t)}function g(t){var e=parseFloat(t);return isNaN(e)?t:e}function m(t,e){for(var i=Object.create(null),n=t.split(","),r=0;r<n.length;r++)i[n[r]]=!0;return e?function(t){return i[t.toLowerCase()]}:function(t){return i[t]}}var v=m("slot,component",!0),y=m("key,ref,slot,slot-scope,is");function _(t,e){if(t.length){var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}var b=Object.prototype.hasOwnProperty;function w(t,e){return b.call(t,e)}function x(t){var e=Object.create(null);return function(i){return e[i]||(e[i]=t(i))}}var S=/-(\w)/g,C=x((function(t){return t.replace(S,(function(t,e){return e?e.toUpperCase():""}))})),E=x((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),T=/\B([A-Z])/g,I=x((function(t){return t.replace(T,"-$1").toLowerCase()}));var A=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function i(i){var n=arguments.length;return n?n>1?t.apply(e,arguments):t.call(e,i):t.call(e)}return i._length=t.length,i};function k(t,e){e=e||0;for(var i=t.length-e,n=new Array(i);i--;)n[i]=t[i+e];return n}function P(t,e){for(var i in e)t[i]=e[i];return t}function L(t){for(var e={},i=0;i<t.length;i++)t[i]&&P(e,t[i]);return e}function R(t,e,i){}var F=function(t,e,i){return!1},M=function(t){return t};function O(t,e){if(t===e)return!0;var i=l(t),n=l(e);if(!i||!n)return!i&&!n&&String(t)===String(e);try{var r=Array.isArray(t),o=Array.isArray(e);if(r&&o)return t.length===e.length&&t.every((function(t,i){return O(t,e[i])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(r||o)return!1;var s=Object.keys(t),a=Object.keys(e);return s.length===a.length&&s.every((function(i){return O(t[i],e[i])}))}catch(t){return!1}}function D(t,e){for(var i=0;i<t.length;i++)if(O(t[i],e))return i;return-1}function $(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var j="data-server-rendered",N=["component","directive","filter"],B=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],U={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:F,isReservedAttr:F,isUnknownElement:F,getTagNamespace:R,parsePlatformTagName:M,mustUseProp:F,async:!0,_lifecycleHooks:B},G=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function V(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function z(t,e,i,n){Object.defineProperty(t,e,{value:i,enumerable:!!n,writable:!0,configurable:!0})}var q=new RegExp("[^"+G.source+".$_\\d]");var W,K="__proto__"in{},X="undefined"!=typeof window,Y="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,H=Y&&WXEnvironment.platform.toLowerCase(),Z=X&&window.navigator.userAgent.toLowerCase(),J=Z&&/msie|trident/.test(Z),Q=Z&&Z.indexOf("msie 9.0")>0,tt=Z&&Z.indexOf("edge/")>0,et=(Z&&Z.indexOf("android"),Z&&/iphone|ipad|ipod|ios/.test(Z)||"ios"===H),it=(Z&&/chrome\/\d+/.test(Z),Z&&/phantomjs/.test(Z),Z&&Z.match(/firefox\/(\d+)/)),nt={}.watch,rt=!1;if(X)try{var ot={};Object.defineProperty(ot,"passive",{get:function(){rt=!0}}),window.addEventListener("test-passive",null,ot)}catch(t){}var st=function(){return void 0===W&&(W=!X&&!Y&&void 0!==i.g&&(i.g.process&&"server"===i.g.process.env.VUE_ENV)),W},at=X&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function lt(t){return"function"==typeof t&&/native code/.test(t.toString())}var ut,ht="undefined"!=typeof Symbol&&lt(Symbol)&&"undefined"!=typeof Reflect&&lt(Reflect.ownKeys);ut="undefined"!=typeof Set&&lt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var ct=R,dt=0,ft=function(){this.id=dt++,this.subs=[]};ft.prototype.addSub=function(t){this.subs.push(t)},ft.prototype.removeSub=function(t){_(this.subs,t)},ft.prototype.depend=function(){ft.target&&ft.target.addDep(this)},ft.prototype.notify=function(){var t=this.subs.slice();for(var e=0,i=t.length;e<i;e++)t[e].update()},ft.target=null;var pt=[];function gt(t){pt.push(t),ft.target=t}function mt(){pt.pop(),ft.target=pt[pt.length-1]}var vt=function(t,e,i,n,r,o,s,a){this.tag=t,this.data=e,this.children=i,this.text=n,this.elm=r,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=s,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=a,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},yt={child:{configurable:!0}};yt.child.get=function(){return this.componentInstance},Object.defineProperties(vt.prototype,yt);var _t=function(t){void 0===t&&(t="");var e=new vt;return e.text=t,e.isComment=!0,e};function bt(t){return new vt(void 0,void 0,void 0,String(t))}function wt(t){var e=new vt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var xt=Array.prototype,St=Object.create(xt);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var e=xt[t];z(St,t,(function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];var r,o=e.apply(this,i),s=this.__ob__;switch(t){case"push":case"unshift":r=i;break;case"splice":r=i.slice(2)}return r&&s.observeArray(r),s.dep.notify(),o}))}));var Ct=Object.getOwnPropertyNames(St),Et=!0;function Tt(t){Et=t}var It=function(t){this.value=t,this.dep=new ft,this.vmCount=0,z(t,"__ob__",this),Array.isArray(t)?(K?function(t,e){t.__proto__=e}(t,St):function(t,e,i){for(var n=0,r=i.length;n<r;n++){var o=i[n];z(t,o,e[o])}}(t,St,Ct),this.observeArray(t)):this.walk(t)};function At(t,e){var i;if(l(t)&&!(t instanceof vt))return w(t,"__ob__")&&t.__ob__ instanceof It?i=t.__ob__:Et&&!st()&&(Array.isArray(t)||h(t))&&Object.isExtensible(t)&&!t._isVue&&(i=new It(t)),e&&i&&i.vmCount++,i}function kt(t,e,i,n,r){var o=new ft,s=Object.getOwnPropertyDescriptor(t,e);if(!s||!1!==s.configurable){var a=s&&s.get,l=s&&s.set;a&&!l||2!==arguments.length||(i=t[e]);var u=!r&&At(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=a?a.call(t):i;return ft.target&&(o.depend(),u&&(u.dep.depend(),Array.isArray(e)&&Rt(e))),e},set:function(e){var n=a?a.call(t):i;e===n||e!=e&&n!=n||a&&!l||(l?l.call(t,e):i=e,u=!r&&At(e),o.notify())}})}}function Pt(t,e,i){if(Array.isArray(t)&&d(e))return t.length=Math.max(t.length,e),t.splice(e,1,i),i;if(e in t&&!(e in Object.prototype))return t[e]=i,i;var n=t.__ob__;return t._isVue||n&&n.vmCount?i:n?(kt(n.value,e,i),n.dep.notify(),i):(t[e]=i,i)}function Lt(t,e){if(Array.isArray(t)&&d(e))t.splice(e,1);else{var i=t.__ob__;t._isVue||i&&i.vmCount||w(t,e)&&(delete t[e],i&&i.dep.notify())}}function Rt(t){for(var e=void 0,i=0,n=t.length;i<n;i++)(e=t[i])&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Rt(e)}It.prototype.walk=function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)kt(t,e[i])},It.prototype.observeArray=function(t){for(var e=0,i=t.length;e<i;e++)At(t[e])};var Ft=U.optionMergeStrategies;function Mt(t,e){if(!e)return t;for(var i,n,r,o=ht?Reflect.ownKeys(e):Object.keys(e),s=0;s<o.length;s++)"__ob__"!==(i=o[s])&&(n=t[i],r=e[i],w(t,i)?n!==r&&h(n)&&h(r)&&Mt(n,r):Pt(t,i,r));return t}function Ot(t,e,i){return i?function(){var n="function"==typeof e?e.call(i,i):e,r="function"==typeof t?t.call(i,i):t;return n?Mt(n,r):r}:e?t?function(){return Mt("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function Dt(t,e){var i=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return i?function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}(i):i}function $t(t,e,i,n){var r=Object.create(t||null);return e?P(r,e):r}Ft.data=function(t,e,i){return i?Ot(t,e,i):e&&"function"!=typeof e?t:Ot(t,e)},B.forEach((function(t){Ft[t]=Dt})),N.forEach((function(t){Ft[t+"s"]=$t})),Ft.watch=function(t,e,i,n){if(t===nt&&(t=void 0),e===nt&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var r={};for(var o in P(r,t),e){var s=r[o],a=e[o];s&&!Array.isArray(s)&&(s=[s]),r[o]=s?s.concat(a):Array.isArray(a)?a:[a]}return r},Ft.props=Ft.methods=Ft.inject=Ft.computed=function(t,e,i,n){if(!t)return e;var r=Object.create(null);return P(r,t),e&&P(r,e),r},Ft.provide=Ot;var jt=function(t,e){return void 0===e?t:e};function Nt(t,e,i){if("function"==typeof e&&(e=e.options),function(t,e){var i=t.props;if(i){var n,r,o={};if(Array.isArray(i))for(n=i.length;n--;)"string"==typeof(r=i[n])&&(o[C(r)]={type:null});else if(h(i))for(var s in i)r=i[s],o[C(s)]=h(r)?r:{type:r};t.props=o}}(e),function(t,e){var i=t.inject;if(i){var n=t.inject={};if(Array.isArray(i))for(var r=0;r<i.length;r++)n[i[r]]={from:i[r]};else if(h(i))for(var o in i){var s=i[o];n[o]=h(s)?P({from:o},s):{from:s}}}}(e),function(t){var e=t.directives;if(e)for(var i in e){var n=e[i];"function"==typeof n&&(e[i]={bind:n,update:n})}}(e),!e._base&&(e.extends&&(t=Nt(t,e.extends,i)),e.mixins))for(var n=0,r=e.mixins.length;n<r;n++)t=Nt(t,e.mixins[n],i);var o,s={};for(o in t)a(o);for(o in e)w(t,o)||a(o);function a(n){var r=Ft[n]||jt;s[n]=r(t[n],e[n],i,n)}return s}function Bt(t,e,i,n){if("string"==typeof i){var r=t[e];if(w(r,i))return r[i];var o=C(i);if(w(r,o))return r[o];var s=E(o);return w(r,s)?r[s]:r[i]||r[o]||r[s]}}function Ut(t,e,i,n){var r=e[t],o=!w(i,t),s=i[t],a=zt(Boolean,r.type);if(a>-1)if(o&&!w(r,"default"))s=!1;else if(""===s||s===I(t)){var l=zt(String,r.type);(l<0||a<l)&&(s=!0)}if(void 0===s){s=function(t,e,i){if(!w(e,"default"))return;var n=e.default;0;if(t&&t.$options.propsData&&void 0===t.$options.propsData[i]&&void 0!==t._props[i])return t._props[i];return"function"==typeof n&&"Function"!==Gt(e.type)?n.call(t):n}(n,r,t);var u=Et;Tt(!0),At(s),Tt(u)}return s}function Gt(t){var e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:""}function Vt(t,e){return Gt(t)===Gt(e)}function zt(t,e){if(!Array.isArray(e))return Vt(e,t)?0:-1;for(var i=0,n=e.length;i<n;i++)if(Vt(e[i],t))return i;return-1}function qt(t,e,i){gt();try{if(e)for(var n=e;n=n.$parent;){var r=n.$options.errorCaptured;if(r)for(var o=0;o<r.length;o++)try{if(!1===r[o].call(n,t,e,i))return}catch(t){Kt(t,n,"errorCaptured hook")}}Kt(t,e,i)}finally{mt()}}function Wt(t,e,i,n,r){var o;try{(o=i?t.apply(e,i):t.call(e))&&!o._isVue&&f(o)&&!o._handled&&(o.catch((function(t){return qt(t,n,r+" (Promise/async)")})),o._handled=!0)}catch(t){qt(t,n,r)}return o}function Kt(t,e,i){if(U.errorHandler)try{return U.errorHandler.call(null,t,e,i)}catch(e){e!==t&&Xt(e,null,"config.errorHandler")}Xt(t,e,i)}function Xt(t,e,i){if(!X&&!Y||"undefined"==typeof console)throw t;console.error(t)}var Yt,Ht=!1,Zt=[],Jt=!1;function Qt(){Jt=!1;var t=Zt.slice(0);Zt.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&lt(Promise)){var te=Promise.resolve();Yt=function(){te.then(Qt),et&&setTimeout(R)},Ht=!0}else if(J||"undefined"==typeof MutationObserver||!lt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Yt="undefined"!=typeof setImmediate&&lt(setImmediate)?function(){setImmediate(Qt)}:function(){setTimeout(Qt,0)};else{var ee=1,ie=new MutationObserver(Qt),ne=document.createTextNode(String(ee));ie.observe(ne,{characterData:!0}),Yt=function(){ee=(ee+1)%2,ne.data=String(ee)},Ht=!0}function re(t,e){var i;if(Zt.push((function(){if(t)try{t.call(e)}catch(t){qt(t,e,"nextTick")}else i&&i(e)})),Jt||(Jt=!0,Yt()),!t&&"undefined"!=typeof Promise)return new Promise((function(t){i=t}))}var oe=new ut;function se(t){ae(t,oe),oe.clear()}function ae(t,e){var i,n,r=Array.isArray(t);if(!(!r&&!l(t)||Object.isFrozen(t)||t instanceof vt)){if(t.__ob__){var o=t.__ob__.dep.id;if(e.has(o))return;e.add(o)}if(r)for(i=t.length;i--;)ae(t[i],e);else for(i=(n=Object.keys(t)).length;i--;)ae(t[n[i]],e)}}var le=x((function(t){var e="&"===t.charAt(0),i="~"===(t=e?t.slice(1):t).charAt(0),n="!"===(t=i?t.slice(1):t).charAt(0);return{name:t=n?t.slice(1):t,once:i,capture:n,passive:e}}));function ue(t,e){function i(){var t=arguments,n=i.fns;if(!Array.isArray(n))return Wt(n,null,arguments,e,"v-on handler");for(var r=n.slice(),o=0;o<r.length;o++)Wt(r[o],null,t,e,"v-on handler")}return i.fns=t,i}function he(t,e,i,n,o,a){var l,u,h,c;for(l in t)u=t[l],h=e[l],c=le(l),r(u)||(r(h)?(r(u.fns)&&(u=t[l]=ue(u,a)),s(c.once)&&(u=t[l]=o(c.name,u,c.capture)),i(c.name,u,c.capture,c.passive,c.params)):u!==h&&(h.fns=u,t[l]=h));for(l in e)r(t[l])&&n((c=le(l)).name,e[l],c.capture)}function ce(t,e,i){var n;t instanceof vt&&(t=t.data.hook||(t.data.hook={}));var a=t[e];function l(){i.apply(this,arguments),_(n.fns,l)}r(a)?n=ue([l]):o(a.fns)&&s(a.merged)?(n=a).fns.push(l):n=ue([a,l]),n.merged=!0,t[e]=n}function de(t,e,i,n,r){if(o(e)){if(w(e,i))return t[i]=e[i],r||delete e[i],!0;if(w(e,n))return t[i]=e[n],r||delete e[n],!0}return!1}function fe(t){return a(t)?[bt(t)]:Array.isArray(t)?ge(t):void 0}function pe(t){return o(t)&&o(t.text)&&!1===t.isComment}function ge(t,e){var i,n,l,u,h=[];for(i=0;i<t.length;i++)r(n=t[i])||"boolean"==typeof n||(u=h[l=h.length-1],Array.isArray(n)?n.length>0&&(pe((n=ge(n,(e||"")+"_"+i))[0])&&pe(u)&&(h[l]=bt(u.text+n[0].text),n.shift()),h.push.apply(h,n)):a(n)?pe(u)?h[l]=bt(u.text+n):""!==n&&h.push(bt(n)):pe(n)&&pe(u)?h[l]=bt(u.text+n.text):(s(t._isVList)&&o(n.tag)&&r(n.key)&&o(e)&&(n.key="__vlist"+e+"_"+i+"__"),h.push(n)));return h}function me(t,e){if(t){for(var i=Object.create(null),n=ht?Reflect.ownKeys(t):Object.keys(t),r=0;r<n.length;r++){var o=n[r];if("__ob__"!==o){for(var s=t[o].from,a=e;a;){if(a._provided&&w(a._provided,s)){i[o]=a._provided[s];break}a=a.$parent}if(!a)if("default"in t[o]){var l=t[o].default;i[o]="function"==typeof l?l.call(e):l}else 0}}return i}}function ve(t,e){if(!t||!t.length)return{};for(var i={},n=0,r=t.length;n<r;n++){var o=t[n],s=o.data;if(s&&s.attrs&&s.attrs.slot&&delete s.attrs.slot,o.context!==e&&o.fnContext!==e||!s||null==s.slot)(i.default||(i.default=[])).push(o);else{var a=s.slot,l=i[a]||(i[a]=[]);"template"===o.tag?l.push.apply(l,o.children||[]):l.push(o)}}for(var u in i)i[u].every(ye)&&delete i[u];return i}function ye(t){return t.isComment&&!t.asyncFactory||" "===t.text}function _e(t,e,i){var r,o=Object.keys(e).length>0,s=t?!!t.$stable:!o,a=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(s&&i&&i!==n&&a===i.$key&&!o&&!i.$hasNormal)return i;for(var l in r={},t)t[l]&&"$"!==l[0]&&(r[l]=be(e,l,t[l]))}else r={};for(var u in e)u in r||(r[u]=we(e,u));return t&&Object.isExtensible(t)&&(t._normalized=r),z(r,"$stable",s),z(r,"$key",a),z(r,"$hasNormal",o),r}function be(t,e,i){var n=function(){var t=arguments.length?i.apply(null,arguments):i({});return(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:fe(t))&&(0===t.length||1===t.length&&t[0].isComment)?void 0:t};return i.proxy&&Object.defineProperty(t,e,{get:n,enumerable:!0,configurable:!0}),n}function we(t,e){return function(){return t[e]}}function xe(t,e){var i,n,r,s,a;if(Array.isArray(t)||"string"==typeof t)for(i=new Array(t.length),n=0,r=t.length;n<r;n++)i[n]=e(t[n],n);else if("number"==typeof t)for(i=new Array(t),n=0;n<t;n++)i[n]=e(n+1,n);else if(l(t))if(ht&&t[Symbol.iterator]){i=[];for(var u=t[Symbol.iterator](),h=u.next();!h.done;)i.push(e(h.value,i.length)),h=u.next()}else for(s=Object.keys(t),i=new Array(s.length),n=0,r=s.length;n<r;n++)a=s[n],i[n]=e(t[a],a,n);return o(i)||(i=[]),i._isVList=!0,i}function Se(t,e,i,n){var r,o=this.$scopedSlots[t];o?(i=i||{},n&&(i=P(P({},n),i)),r=o(i)||e):r=this.$slots[t]||e;var s=i&&i.slot;return s?this.$createElement("template",{slot:s},r):r}function Ce(t){return Bt(this.$options,"filters",t)||M}function Ee(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function Te(t,e,i,n,r){var o=U.keyCodes[e]||i;return r&&n&&!U.keyCodes[e]?Ee(r,n):o?Ee(o,t):n?I(n)!==e:void 0}function Ie(t,e,i,n,r){if(i)if(l(i)){var o;Array.isArray(i)&&(i=L(i));var s=function(s){if("class"===s||"style"===s||y(s))o=t;else{var a=t.attrs&&t.attrs.type;o=n||U.mustUseProp(e,a,s)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var l=C(s),u=I(s);l in o||u in o||(o[s]=i[s],r&&((t.on||(t.on={}))["update:"+s]=function(t){i[s]=t}))};for(var a in i)s(a)}else;return t}function Ae(t,e){var i=this._staticTrees||(this._staticTrees=[]),n=i[t];return n&&!e||Pe(n=i[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),n}function ke(t,e,i){return Pe(t,"__once__"+e+(i?"_"+i:""),!0),t}function Pe(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&"string"!=typeof t[n]&&Le(t[n],e+"_"+n,i);else Le(t,e,i)}function Le(t,e,i){t.isStatic=!0,t.key=e,t.isOnce=i}function Re(t,e){if(e)if(h(e)){var i=t.on=t.on?P({},t.on):{};for(var n in e){var r=i[n],o=e[n];i[n]=r?[].concat(r,o):o}}else;return t}function Fe(t,e,i,n){e=e||{$stable:!i};for(var r=0;r<t.length;r++){var o=t[r];Array.isArray(o)?Fe(o,e,i):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return n&&(e.$key=n),e}function Me(t,e){for(var i=0;i<e.length;i+=2){var n=e[i];"string"==typeof n&&n&&(t[e[i]]=e[i+1])}return t}function Oe(t,e){return"string"==typeof t?e+t:t}function De(t){t._o=ke,t._n=g,t._s=p,t._l=xe,t._t=Se,t._q=O,t._i=D,t._m=Ae,t._f=Ce,t._k=Te,t._b=Ie,t._v=bt,t._e=_t,t._u=Fe,t._g=Re,t._d=Me,t._p=Oe}function $e(t,e,i,r,o){var a,l=this,u=o.options;w(r,"_uid")?(a=Object.create(r))._original=r:(a=r,r=r._original);var h=s(u._compiled),c=!h;this.data=t,this.props=e,this.children=i,this.parent=r,this.listeners=t.on||n,this.injections=me(u.inject,r),this.slots=function(){return l.$slots||_e(t.scopedSlots,l.$slots=ve(i,r)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return _e(t.scopedSlots,this.slots())}}),h&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=_e(t.scopedSlots,this.$slots)),u._scopeId?this._c=function(t,e,i,n){var o=ze(a,t,e,i,n,c);return o&&!Array.isArray(o)&&(o.fnScopeId=u._scopeId,o.fnContext=r),o}:this._c=function(t,e,i,n){return ze(a,t,e,i,n,c)}}function je(t,e,i,n,r){var o=wt(t);return o.fnContext=i,o.fnOptions=n,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function Ne(t,e){for(var i in e)t[C(i)]=e[i]}De($e.prototype);var Be={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var i=t;Be.prepatch(i,i)}else{(t.componentInstance=function(t,e){var i={_isComponent:!0,_parentVnode:t,parent:e},n=t.data.inlineTemplate;o(n)&&(i.render=n.render,i.staticRenderFns=n.staticRenderFns);return new t.componentOptions.Ctor(i)}(t,ei)).$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var i=e.componentOptions;!function(t,e,i,r,o){0;var s=r.data.scopedSlots,a=t.$scopedSlots,l=!!(s&&!s.$stable||a!==n&&!a.$stable||s&&t.$scopedSlots.$key!==s.$key),u=!!(o||t.$options._renderChildren||l);t.$options._parentVnode=r,t.$vnode=r,t._vnode&&(t._vnode.parent=r);if(t.$options._renderChildren=o,t.$attrs=r.data.attrs||n,t.$listeners=i||n,e&&t.$options.props){Tt(!1);for(var h=t._props,c=t.$options._propKeys||[],d=0;d<c.length;d++){var f=c[d],p=t.$options.props;h[f]=Ut(f,p,e,t)}Tt(!0),t.$options.propsData=e}i=i||n;var g=t.$options._parentListeners;t.$options._parentListeners=i,ti(t,i,g),u&&(t.$slots=ve(o,r.context),t.$forceUpdate());0}(e.componentInstance=t.componentInstance,i.propsData,i.listeners,e,i.children)},insert:function(t){var e,i=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,si(n,"mounted")),t.data.keepAlive&&(i._isMounted?((e=n)._inactive=!1,li.push(e)):ri(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?oi(e,!0):e.$destroy())}},Ue=Object.keys(Be);function Ge(t,e,i,a,u){if(!r(t)){var h=i.$options._base;if(l(t)&&(t=h.extend(t)),"function"==typeof t){var c;if(r(t.cid)&&void 0===(t=function(t,e){if(s(t.error)&&o(t.errorComp))return t.errorComp;if(o(t.resolved))return t.resolved;var i=Ke;i&&o(t.owners)&&-1===t.owners.indexOf(i)&&t.owners.push(i);if(s(t.loading)&&o(t.loadingComp))return t.loadingComp;if(i&&!o(t.owners)){var n=t.owners=[i],a=!0,u=null,h=null;i.$on("hook:destroyed",(function(){return _(n,i)}));var c=function(t){for(var e=0,i=n.length;e<i;e++)n[e].$forceUpdate();t&&(n.length=0,null!==u&&(clearTimeout(u),u=null),null!==h&&(clearTimeout(h),h=null))},d=$((function(i){t.resolved=Xe(i,e),a?n.length=0:c(!0)})),p=$((function(e){o(t.errorComp)&&(t.error=!0,c(!0))})),g=t(d,p);return l(g)&&(f(g)?r(t.resolved)&&g.then(d,p):f(g.component)&&(g.component.then(d,p),o(g.error)&&(t.errorComp=Xe(g.error,e)),o(g.loading)&&(t.loadingComp=Xe(g.loading,e),0===g.delay?t.loading=!0:u=setTimeout((function(){u=null,r(t.resolved)&&r(t.error)&&(t.loading=!0,c(!1))}),g.delay||200)),o(g.timeout)&&(h=setTimeout((function(){h=null,r(t.resolved)&&p(null)}),g.timeout)))),a=!1,t.loading?t.loadingComp:t.resolved}}(c=t,h)))return function(t,e,i,n,r){var o=_t();return o.asyncFactory=t,o.asyncMeta={data:e,context:i,children:n,tag:r},o}(c,e,i,a,u);e=e||{},Ai(t),o(e.model)&&function(t,e){var i=t.model&&t.model.prop||"value",n=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[i]=e.model.value;var r=e.on||(e.on={}),s=r[n],a=e.model.callback;o(s)?(Array.isArray(s)?-1===s.indexOf(a):s!==a)&&(r[n]=[a].concat(s)):r[n]=a}(t.options,e);var d=function(t,e,i){var n=e.options.props;if(!r(n)){var s={},a=t.attrs,l=t.props;if(o(a)||o(l))for(var u in n){var h=I(u);de(s,l,u,h,!0)||de(s,a,u,h,!1)}return s}}(e,t);if(s(t.options.functional))return function(t,e,i,r,s){var a=t.options,l={},u=a.props;if(o(u))for(var h in u)l[h]=Ut(h,u,e||n);else o(i.attrs)&&Ne(l,i.attrs),o(i.props)&&Ne(l,i.props);var c=new $e(i,l,s,r,t),d=a.render.call(null,c._c,c);if(d instanceof vt)return je(d,i,c.parent,a);if(Array.isArray(d)){for(var f=fe(d)||[],p=new Array(f.length),g=0;g<f.length;g++)p[g]=je(f[g],i,c.parent,a);return p}}(t,d,e,i,a);var p=e.on;if(e.on=e.nativeOn,s(t.options.abstract)){var g=e.slot;e={},g&&(e.slot=g)}!function(t){for(var e=t.hook||(t.hook={}),i=0;i<Ue.length;i++){var n=Ue[i],r=e[n],o=Be[n];r===o||r&&r._merged||(e[n]=r?Ve(o,r):o)}}(e);var m=t.options.name||u;return new vt("vue-component-"+t.cid+(m?"-"+m:""),e,void 0,void 0,void 0,i,{Ctor:t,propsData:d,listeners:p,tag:u,children:a},c)}}}function Ve(t,e){var i=function(i,n){t(i,n),e(i,n)};return i._merged=!0,i}function ze(t,e,i,n,r,u){return(Array.isArray(i)||a(i))&&(r=n,n=i,i=void 0),s(u)&&(r=2),function(t,e,i,n,r){if(o(i)&&o(i.__ob__))return _t();o(i)&&o(i.is)&&(e=i.is);if(!e)return _t();0;Array.isArray(n)&&"function"==typeof n[0]&&((i=i||{}).scopedSlots={default:n[0]},n.length=0);2===r?n=fe(n):1===r&&(n=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(n));var s,a;if("string"==typeof e){var u;a=t.$vnode&&t.$vnode.ns||U.getTagNamespace(e),s=U.isReservedTag(e)?new vt(U.parsePlatformTagName(e),i,n,void 0,void 0,t):i&&i.pre||!o(u=Bt(t.$options,"components",e))?new vt(e,i,n,void 0,void 0,t):Ge(u,i,t,n,e)}else s=Ge(e,i,t,n);return Array.isArray(s)?s:o(s)?(o(a)&&qe(s,a),o(i)&&function(t){l(t.style)&&se(t.style);l(t.class)&&se(t.class)}(i),s):_t()}(t,e,i,n,r)}function qe(t,e,i){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,i=!0),o(t.children))for(var n=0,a=t.children.length;n<a;n++){var l=t.children[n];o(l.tag)&&(r(l.ns)||s(i)&&"svg"!==l.tag)&&qe(l,e,i)}}var We,Ke=null;function Xe(t,e){return(t.__esModule||ht&&"Module"===t[Symbol.toStringTag])&&(t=t.default),l(t)?e.extend(t):t}function Ye(t){return t.isComment&&t.asyncFactory}function He(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var i=t[e];if(o(i)&&(o(i.componentOptions)||Ye(i)))return i}}function Ze(t,e){We.$on(t,e)}function Je(t,e){We.$off(t,e)}function Qe(t,e){var i=We;return function n(){var r=e.apply(null,arguments);null!==r&&i.$off(t,n)}}function ti(t,e,i){We=t,he(e,i||{},Ze,Je,Qe,t),We=void 0}var ei=null;function ii(t){var e=ei;return ei=t,function(){ei=e}}function ni(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function ri(t,e){if(e){if(t._directInactive=!1,ni(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var i=0;i<t.$children.length;i++)ri(t.$children[i]);si(t,"activated")}}function oi(t,e){if(!(e&&(t._directInactive=!0,ni(t))||t._inactive)){t._inactive=!0;for(var i=0;i<t.$children.length;i++)oi(t.$children[i]);si(t,"deactivated")}}function si(t,e){gt();var i=t.$options[e],n=e+" hook";if(i)for(var r=0,o=i.length;r<o;r++)Wt(i[r],t,null,t,n);t._hasHookEvent&&t.$emit("hook:"+e),mt()}var ai=[],li=[],ui={},hi=!1,ci=!1,di=0;var fi=0,pi=Date.now;if(X&&!J){var gi=window.performance;gi&&"function"==typeof gi.now&&pi()>document.createEvent("Event").timeStamp&&(pi=function(){return gi.now()})}function mi(){var t,e;for(fi=pi(),ci=!0,ai.sort((function(t,e){return t.id-e.id})),di=0;di<ai.length;di++)(t=ai[di]).before&&t.before(),e=t.id,ui[e]=null,t.run();var i=li.slice(),n=ai.slice();di=ai.length=li.length=0,ui={},hi=ci=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,ri(t[e],!0)}(i),function(t){var e=t.length;for(;e--;){var i=t[e],n=i.vm;n._watcher===i&&n._isMounted&&!n._isDestroyed&&si(n,"updated")}}(n),at&&U.devtools&&at.emit("flush")}var vi=0,yi=function(t,e,i,n,r){this.vm=t,r&&(t._watcher=this),t._watchers.push(this),n?(this.deep=!!n.deep,this.user=!!n.user,this.lazy=!!n.lazy,this.sync=!!n.sync,this.before=n.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++vi,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ut,this.newDepIds=new ut,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!q.test(t)){var e=t.split(".");return function(t){for(var i=0;i<e.length;i++){if(!t)return;t=t[e[i]]}return t}}}(e),this.getter||(this.getter=R)),this.value=this.lazy?void 0:this.get()};yi.prototype.get=function(){var t;gt(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;qt(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&se(t),mt(),this.cleanupDeps()}return t},yi.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},yi.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},yi.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==ui[e]){if(ui[e]=!0,ci){for(var i=ai.length-1;i>di&&ai[i].id>t.id;)i--;ai.splice(i+1,0,t)}else ai.push(t);hi||(hi=!0,re(mi))}}(this)},yi.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||l(t)||this.deep){var e=this.value;if(this.value=t,this.user)try{this.cb.call(this.vm,t,e)}catch(t){qt(t,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,t,e)}}},yi.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},yi.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},yi.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||_(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var _i={enumerable:!0,configurable:!0,get:R,set:R};function bi(t,e,i){_i.get=function(){return this[e][i]},_i.set=function(t){this[e][i]=t},Object.defineProperty(t,i,_i)}function wi(t){t._watchers=[];var e=t.$options;e.props&&function(t,e){var i=t.$options.propsData||{},n=t._props={},r=t.$options._propKeys=[];t.$parent&&Tt(!1);var o=function(o){r.push(o);var s=Ut(o,e,i,t);kt(n,o,s),o in t||bi(t,"_props",o)};for(var s in e)o(s);Tt(!0)}(t,e.props),e.methods&&function(t,e){t.$options.props;for(var i in e)t[i]="function"!=typeof e[i]?R:A(e[i],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;h(e=t._data="function"==typeof e?function(t,e){gt();try{return t.call(e,e)}catch(t){return qt(t,e,"data()"),{}}finally{mt()}}(e,t):e||{})||(e={});var i=Object.keys(e),n=t.$options.props,r=(t.$options.methods,i.length);for(;r--;){var o=i[r];0,n&&w(n,o)||V(o)||bi(t,"_data",o)}At(e,!0)}(t):At(t._data={},!0),e.computed&&function(t,e){var i=t._computedWatchers=Object.create(null),n=st();for(var r in e){var o=e[r],s="function"==typeof o?o:o.get;0,n||(i[r]=new yi(t,s||R,R,xi)),r in t||Si(t,r,o)}}(t,e.computed),e.watch&&e.watch!==nt&&function(t,e){for(var i in e){var n=e[i];if(Array.isArray(n))for(var r=0;r<n.length;r++)Ti(t,i,n[r]);else Ti(t,i,n)}}(t,e.watch)}var xi={lazy:!0};function Si(t,e,i){var n=!st();"function"==typeof i?(_i.get=n?Ci(e):Ei(i),_i.set=R):(_i.get=i.get?n&&!1!==i.cache?Ci(e):Ei(i.get):R,_i.set=i.set||R),Object.defineProperty(t,e,_i)}function Ci(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),ft.target&&e.depend(),e.value}}function Ei(t){return function(){return t.call(this,this)}}function Ti(t,e,i,n){return h(i)&&(n=i,i=i.handler),"string"==typeof i&&(i=t[i]),t.$watch(e,i,n)}var Ii=0;function Ai(t){var e=t.options;if(t.super){var i=Ai(t.super);if(i!==t.superOptions){t.superOptions=i;var n=function(t){var e,i=t.options,n=t.sealedOptions;for(var r in i)i[r]!==n[r]&&(e||(e={}),e[r]=i[r]);return e}(t);n&&P(t.extendOptions,n),(e=t.options=Nt(i,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function ki(t){this._init(t)}function Pi(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var i=this,n=i.cid,r=t._Ctor||(t._Ctor={});if(r[n])return r[n];var o=t.name||i.options.name;var s=function(t){this._init(t)};return(s.prototype=Object.create(i.prototype)).constructor=s,s.cid=e++,s.options=Nt(i.options,t),s.super=i,s.options.props&&function(t){var e=t.options.props;for(var i in e)bi(t.prototype,"_props",i)}(s),s.options.computed&&function(t){var e=t.options.computed;for(var i in e)Si(t.prototype,i,e[i])}(s),s.extend=i.extend,s.mixin=i.mixin,s.use=i.use,N.forEach((function(t){s[t]=i[t]})),o&&(s.options.components[o]=s),s.superOptions=i.options,s.extendOptions=t,s.sealedOptions=P({},s.options),r[n]=s,s}}function Li(t){return t&&(t.Ctor.options.name||t.tag)}function Ri(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:!!c(t)&&t.test(e)}function Fi(t,e){var i=t.cache,n=t.keys,r=t._vnode;for(var o in i){var s=i[o];if(s){var a=Li(s.componentOptions);a&&!e(a)&&Mi(i,o,n,r)}}}function Mi(t,e,i,n){var r=t[e];!r||n&&r.tag===n.tag||r.componentInstance.$destroy(),t[e]=null,_(i,e)}!function(t){t.prototype._init=function(t){var e=this;e._uid=Ii++,e._isVue=!0,t&&t._isComponent?function(t,e){var i=t.$options=Object.create(t.constructor.options),n=e._parentVnode;i.parent=e.parent,i._parentVnode=n;var r=n.componentOptions;i.propsData=r.propsData,i._parentListeners=r.listeners,i._renderChildren=r.children,i._componentTag=r.tag,e.render&&(i.render=e.render,i.staticRenderFns=e.staticRenderFns)}(e,t):e.$options=Nt(Ai(e.constructor),t||{},e),e._renderProxy=e,e._self=e,function(t){var e=t.$options,i=e.parent;if(i&&!e.abstract){for(;i.$options.abstract&&i.$parent;)i=i.$parent;i.$children.push(t)}t.$parent=i,t.$root=i?i.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}(e),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&ti(t,e)}(e),function(t){t._vnode=null,t._staticTrees=null;var e=t.$options,i=t.$vnode=e._parentVnode,r=i&&i.context;t.$slots=ve(e._renderChildren,r),t.$scopedSlots=n,t._c=function(e,i,n,r){return ze(t,e,i,n,r,!1)},t.$createElement=function(e,i,n,r){return ze(t,e,i,n,r,!0)};var o=i&&i.data;kt(t,"$attrs",o&&o.attrs||n,null,!0),kt(t,"$listeners",e._parentListeners||n,null,!0)}(e),si(e,"beforeCreate"),function(t){var e=me(t.$options.inject,t);e&&(Tt(!1),Object.keys(e).forEach((function(i){kt(t,i,e[i])})),Tt(!0))}(e),wi(e),function(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}(e),si(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}(ki),function(t){var e={get:function(){return this._data}},i={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",i),t.prototype.$set=Pt,t.prototype.$delete=Lt,t.prototype.$watch=function(t,e,i){var n=this;if(h(e))return Ti(n,t,e,i);(i=i||{}).user=!0;var r=new yi(n,t,e,i);if(i.immediate)try{e.call(n,r.value)}catch(t){qt(t,n,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}(ki),function(t){var e=/^hook:/;t.prototype.$on=function(t,i){var n=this;if(Array.isArray(t))for(var r=0,o=t.length;r<o;r++)n.$on(t[r],i);else(n._events[t]||(n._events[t]=[])).push(i),e.test(t)&&(n._hasHookEvent=!0);return n},t.prototype.$once=function(t,e){var i=this;function n(){i.$off(t,n),e.apply(i,arguments)}return n.fn=e,i.$on(t,n),i},t.prototype.$off=function(t,e){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)i.$off(t[n],e);return i}var o,s=i._events[t];if(!s)return i;if(!e)return i._events[t]=null,i;for(var a=s.length;a--;)if((o=s[a])===e||o.fn===e){s.splice(a,1);break}return i},t.prototype.$emit=function(t){var e=this,i=e._events[t];if(i){i=i.length>1?k(i):i;for(var n=k(arguments,1),r='event handler for "'+t+'"',o=0,s=i.length;o<s;o++)Wt(i[o],e,n,e,r)}return e}}(ki),function(t){t.prototype._update=function(t,e){var i=this,n=i.$el,r=i._vnode,o=ii(i);i._vnode=t,i.$el=r?i.__patch__(r,t):i.__patch__(i.$el,t,e,!1),o(),n&&(n.__vue__=null),i.$el&&(i.$el.__vue__=i),i.$vnode&&i.$parent&&i.$vnode===i.$parent._vnode&&(i.$parent.$el=i.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){si(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||_(e.$children,t),t._watcher&&t._watcher.teardown();for(var i=t._watchers.length;i--;)t._watchers[i].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),si(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}(ki),function(t){De(t.prototype),t.prototype.$nextTick=function(t){return re(t,this)},t.prototype._render=function(){var t,e=this,i=e.$options,n=i.render,r=i._parentVnode;r&&(e.$scopedSlots=_e(r.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=r;try{Ke=e,t=n.call(e._renderProxy,e.$createElement)}catch(i){qt(i,e,"render"),t=e._vnode}finally{Ke=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof vt||(t=_t()),t.parent=r,t}}(ki);var Oi=[String,RegExp,Array],Di={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Oi,exclude:Oi,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Mi(this.cache,t,this.keys)},mounted:function(){var t=this;this.$watch("include",(function(e){Fi(t,(function(t){return Ri(e,t)}))})),this.$watch("exclude",(function(e){Fi(t,(function(t){return!Ri(e,t)}))}))},render:function(){var t=this.$slots.default,e=He(t),i=e&&e.componentOptions;if(i){var n=Li(i),r=this.include,o=this.exclude;if(r&&(!n||!Ri(r,n))||o&&n&&Ri(o,n))return e;var s=this.cache,a=this.keys,l=null==e.key?i.Ctor.cid+(i.tag?"::"+i.tag:""):e.key;s[l]?(e.componentInstance=s[l].componentInstance,_(a,l),a.push(l)):(s[l]=e,a.push(l),this.max&&a.length>parseInt(this.max)&&Mi(s,a[0],a,this._vnode)),e.data.keepAlive=!0}return e||t&&t[0]}}};!function(t){var e={get:function(){return U}};Object.defineProperty(t,"config",e),t.util={warn:ct,extend:P,mergeOptions:Nt,defineReactive:kt},t.set=Pt,t.delete=Lt,t.nextTick=re,t.observable=function(t){return At(t),t},t.options=Object.create(null),N.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,P(t.options.components,Di),function(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var i=k(arguments,1);return i.unshift(this),"function"==typeof t.install?t.install.apply(t,i):"function"==typeof t&&t.apply(null,i),e.push(t),this}}(t),function(t){t.mixin=function(t){return this.options=Nt(this.options,t),this}}(t),Pi(t),function(t){N.forEach((function(e){t[e]=function(t,i){return i?("component"===e&&h(i)&&(i.name=i.name||t,i=this.options._base.extend(i)),"directive"===e&&"function"==typeof i&&(i={bind:i,update:i}),this.options[e+"s"][t]=i,i):this.options[e+"s"][t]}}))}(t)}(ki),Object.defineProperty(ki.prototype,"$isServer",{get:st}),Object.defineProperty(ki.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(ki,"FunctionalRenderContext",{value:$e}),ki.version="2.6.12";var $i=m("style,class"),ji=m("input,textarea,option,select,progress"),Ni=function(t,e,i){return"value"===i&&ji(t)&&"button"!==e||"selected"===i&&"option"===t||"checked"===i&&"input"===t||"muted"===i&&"video"===t},Bi=m("contenteditable,draggable,spellcheck"),Ui=m("events,caret,typing,plaintext-only"),Gi=m("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,translate,truespeed,typemustmatch,visible"),Vi="http://www.w3.org/1999/xlink",zi=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},qi=function(t){return zi(t)?t.slice(6,t.length):""},Wi=function(t){return null==t||!1===t};function Ki(t){for(var e=t.data,i=t,n=t;o(n.componentInstance);)(n=n.componentInstance._vnode)&&n.data&&(e=Xi(n.data,e));for(;o(i=i.parent);)i&&i.data&&(e=Xi(e,i.data));return function(t,e){if(o(t)||o(e))return Yi(t,Hi(e));return""}(e.staticClass,e.class)}function Xi(t,e){return{staticClass:Yi(t.staticClass,e.staticClass),class:o(t.class)?[t.class,e.class]:e.class}}function Yi(t,e){return t?e?t+" "+e:t:e||""}function Hi(t){return Array.isArray(t)?function(t){for(var e,i="",n=0,r=t.length;n<r;n++)o(e=Hi(t[n]))&&""!==e&&(i&&(i+=" "),i+=e);return i}(t):l(t)?function(t){var e="";for(var i in t)t[i]&&(e&&(e+=" "),e+=i);return e}(t):"string"==typeof t?t:""}var Zi={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Ji=m("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Qi=m("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignObject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),tn=function(t){return Ji(t)||Qi(t)};function en(t){return Qi(t)?"svg":"math"===t?"math":void 0}var nn=Object.create(null);var rn=m("text,number,password,search,email,tel,url");function on(t){if("string"==typeof t){var e=document.querySelector(t);return e||document.createElement("div")}return t}var sn=Object.freeze({createElement:function(t,e){var i=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i},createElementNS:function(t,e){return document.createElementNS(Zi[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,i){t.insertBefore(e,i)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),an={create:function(t,e){ln(e)},update:function(t,e){t.data.ref!==e.data.ref&&(ln(t,!0),ln(e))},destroy:function(t){ln(t,!0)}};function ln(t,e){var i=t.data.ref;if(o(i)){var n=t.context,r=t.componentInstance||t.elm,s=n.$refs;e?Array.isArray(s[i])?_(s[i],r):s[i]===r&&(s[i]=void 0):t.data.refInFor?Array.isArray(s[i])?s[i].indexOf(r)<0&&s[i].push(r):s[i]=[r]:s[i]=r}}var un=new vt("",{},[]),hn=["create","activate","update","remove","destroy"];function cn(t,e){return t.key===e.key&&(t.tag===e.tag&&t.isComment===e.isComment&&o(t.data)===o(e.data)&&function(t,e){if("input"!==t.tag)return!0;var i,n=o(i=t.data)&&o(i=i.attrs)&&i.type,r=o(i=e.data)&&o(i=i.attrs)&&i.type;return n===r||rn(n)&&rn(r)}(t,e)||s(t.isAsyncPlaceholder)&&t.asyncFactory===e.asyncFactory&&r(e.asyncFactory.error))}function dn(t,e,i){var n,r,s={};for(n=e;n<=i;++n)o(r=t[n].key)&&(s[r]=n);return s}var fn={create:pn,update:pn,destroy:function(t){pn(t,un)}};function pn(t,e){(t.data.directives||e.data.directives)&&function(t,e){var i,n,r,o=t===un,s=e===un,a=mn(t.data.directives,t.context),l=mn(e.data.directives,e.context),u=[],h=[];for(i in l)n=a[i],r=l[i],n?(r.oldValue=n.value,r.oldArg=n.arg,yn(r,"update",e,t),r.def&&r.def.componentUpdated&&h.push(r)):(yn(r,"bind",e,t),r.def&&r.def.inserted&&u.push(r));if(u.length){var c=function(){for(var i=0;i<u.length;i++)yn(u[i],"inserted",e,t)};o?ce(e,"insert",c):c()}h.length&&ce(e,"postpatch",(function(){for(var i=0;i<h.length;i++)yn(h[i],"componentUpdated",e,t)}));if(!o)for(i in a)l[i]||yn(a[i],"unbind",t,t,s)}(t,e)}var gn=Object.create(null);function mn(t,e){var i,n,r=Object.create(null);if(!t)return r;for(i=0;i<t.length;i++)(n=t[i]).modifiers||(n.modifiers=gn),r[vn(n)]=n,n.def=Bt(e.$options,"directives",n.name);return r}function vn(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function yn(t,e,i,n,r){var o=t.def&&t.def[e];if(o)try{o(i.elm,t,i,n,r)}catch(n){qt(n,i.context,"directive "+t.name+" "+e+" hook")}}var _n=[an,fn];function bn(t,e){var i=e.componentOptions;if(!(o(i)&&!1===i.Ctor.options.inheritAttrs||r(t.data.attrs)&&r(e.data.attrs))){var n,s,a=e.elm,l=t.data.attrs||{},u=e.data.attrs||{};for(n in o(u.__ob__)&&(u=e.data.attrs=P({},u)),u)s=u[n],l[n]!==s&&wn(a,n,s);for(n in(J||tt)&&u.value!==l.value&&wn(a,"value",u.value),l)r(u[n])&&(zi(n)?a.removeAttributeNS(Vi,qi(n)):Bi(n)||a.removeAttribute(n))}}function wn(t,e,i){t.tagName.indexOf("-")>-1?xn(t,e,i):Gi(e)?Wi(i)?t.removeAttribute(e):(i="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,i)):Bi(e)?t.setAttribute(e,function(t,e){return Wi(e)||"false"===e?"false":"contenteditable"===t&&Ui(e)?e:"true"}(e,i)):zi(e)?Wi(i)?t.removeAttributeNS(Vi,qi(e)):t.setAttributeNS(Vi,e,i):xn(t,e,i)}function xn(t,e,i){if(Wi(i))t.removeAttribute(e);else{if(J&&!Q&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==i&&!t.__ieph){var n=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",n)};t.addEventListener("input",n),t.__ieph=!0}t.setAttribute(e,i)}}var Sn={create:bn,update:bn};function Cn(t,e){var i=e.elm,n=e.data,s=t.data;if(!(r(n.staticClass)&&r(n.class)&&(r(s)||r(s.staticClass)&&r(s.class)))){var a=Ki(e),l=i._transitionClasses;o(l)&&(a=Yi(a,Hi(l))),a!==i._prevClass&&(i.setAttribute("class",a),i._prevClass=a)}}var En,Tn,In,An,kn,Pn,Ln={create:Cn,update:Cn},Rn=/[\w).+\-_$\]]/;function Fn(t){var e,i,n,r,o,s=!1,a=!1,l=!1,u=!1,h=0,c=0,d=0,f=0;for(n=0;n<t.length;n++)if(i=e,e=t.charCodeAt(n),s)39===e&&92!==i&&(s=!1);else if(a)34===e&&92!==i&&(a=!1);else if(l)96===e&&92!==i&&(l=!1);else if(u)47===e&&92!==i&&(u=!1);else if(124!==e||124===t.charCodeAt(n+1)||124===t.charCodeAt(n-1)||h||c||d){switch(e){case 34:a=!0;break;case 39:s=!0;break;case 96:l=!0;break;case 40:d++;break;case 41:d--;break;case 91:c++;break;case 93:c--;break;case 123:h++;break;case 125:h--}if(47===e){for(var p=n-1,g=void 0;p>=0&&" "===(g=t.charAt(p));p--);g&&Rn.test(g)||(u=!0)}}else void 0===r?(f=n+1,r=t.slice(0,n).trim()):m();function m(){(o||(o=[])).push(t.slice(f,n).trim()),f=n+1}if(void 0===r?r=t.slice(0,n).trim():0!==f&&m(),o)for(n=0;n<o.length;n++)r=Mn(r,o[n]);return r}function Mn(t,e){var i=e.indexOf("(");if(i<0)return'_f("'+e+'")('+t+")";var n=e.slice(0,i),r=e.slice(i+1);return'_f("'+n+'")('+t+(")"!==r?","+r:r)}function On(t,e){console.error("[Vue compiler]: "+t)}function Dn(t,e){return t?t.map((function(t){return t[e]})).filter((function(t){return t})):[]}function $n(t,e,i,n,r){(t.props||(t.props=[])).push(Wn({name:e,value:i,dynamic:r},n)),t.plain=!1}function jn(t,e,i,n,r){(r?t.dynamicAttrs||(t.dynamicAttrs=[]):t.attrs||(t.attrs=[])).push(Wn({name:e,value:i,dynamic:r},n)),t.plain=!1}function Nn(t,e,i,n){t.attrsMap[e]=i,t.attrsList.push(Wn({name:e,value:i},n))}function Bn(t,e,i,n,r,o,s,a){(t.directives||(t.directives=[])).push(Wn({name:e,rawName:i,value:n,arg:r,isDynamicArg:o,modifiers:s},a)),t.plain=!1}function Un(t,e,i){return i?"_p("+e+',"'+t+'")':t+e}function Gn(t,e,i,r,o,s,a,l){var u;(r=r||n).right?l?e="("+e+")==='click'?'contextmenu':("+e+")":"click"===e&&(e="contextmenu",delete r.right):r.middle&&(l?e="("+e+")==='click'?'mouseup':("+e+")":"click"===e&&(e="mouseup")),r.capture&&(delete r.capture,e=Un("!",e,l)),r.once&&(delete r.once,e=Un("~",e,l)),r.passive&&(delete r.passive,e=Un("&",e,l)),r.native?(delete r.native,u=t.nativeEvents||(t.nativeEvents={})):u=t.events||(t.events={});var h=Wn({value:i.trim(),dynamic:l},a);r!==n&&(h.modifiers=r);var c=u[e];Array.isArray(c)?o?c.unshift(h):c.push(h):u[e]=c?o?[h,c]:[c,h]:h,t.plain=!1}function Vn(t,e,i){var n=zn(t,":"+e)||zn(t,"v-bind:"+e);if(null!=n)return Fn(n);if(!1!==i){var r=zn(t,e);if(null!=r)return JSON.stringify(r)}}function zn(t,e,i){var n;if(null!=(n=t.attrsMap[e]))for(var r=t.attrsList,o=0,s=r.length;o<s;o++)if(r[o].name===e){r.splice(o,1);break}return i&&delete t.attrsMap[e],n}function qn(t,e){for(var i=t.attrsList,n=0,r=i.length;n<r;n++){var o=i[n];if(e.test(o.name))return i.splice(n,1),o}}function Wn(t,e){return e&&(null!=e.start&&(t.start=e.start),null!=e.end&&(t.end=e.end)),t}function Kn(t,e,i){var n=i||{},r=n.number,o="$$v",s=o;n.trim&&(s="(typeof $$v === 'string'? $$v.trim(): $$v)"),r&&(s="_n("+s+")");var a=Xn(e,s);t.model={value:"("+e+")",expression:JSON.stringify(e),callback:"function ($$v) {"+a+"}"}}function Xn(t,e){var i=function(t){if(t=t.trim(),En=t.length,t.indexOf("[")<0||t.lastIndexOf("]")<En-1)return(An=t.lastIndexOf("."))>-1?{exp:t.slice(0,An),key:'"'+t.slice(An+1)+'"'}:{exp:t,key:null};Tn=t,An=kn=Pn=0;for(;!Hn();)Zn(In=Yn())?Qn(In):91===In&&Jn(In);return{exp:t.slice(0,kn),key:t.slice(kn+1,Pn)}}(t);return null===i.key?t+"="+e:"$set("+i.exp+", "+i.key+", "+e+")"}function Yn(){return Tn.charCodeAt(++An)}function Hn(){return An>=En}function Zn(t){return 34===t||39===t}function Jn(t){var e=1;for(kn=An;!Hn();)if(Zn(t=Yn()))Qn(t);else if(91===t&&e++,93===t&&e--,0===e){Pn=An;break}}function Qn(t){for(var e=t;!Hn()&&(t=Yn())!==e;);}var tr,er="__r";function ir(t,e,i){var n=tr;return function r(){var o=e.apply(null,arguments);null!==o&&or(t,r,i,n)}}var nr=Ht&&!(it&&Number(it[1])<=53);function rr(t,e,i,n){if(nr){var r=fi,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=r||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}tr.addEventListener(t,e,rt?{capture:i,passive:n}:i)}function or(t,e,i,n){(n||tr).removeEventListener(t,e._wrapper||e,i)}function sr(t,e){if(!r(t.data.on)||!r(e.data.on)){var i=e.data.on||{},n=t.data.on||{};tr=e.elm,function(t){if(o(t.__r)){var e=J?"change":"input";t[e]=[].concat(t.__r,t[e]||[]),delete t.__r}o(t.__c)&&(t.change=[].concat(t.__c,t.change||[]),delete t.__c)}(i),he(i,n,rr,or,ir,e.context),tr=void 0}}var ar,lr={create:sr,update:sr};function ur(t,e){if(!r(t.data.domProps)||!r(e.data.domProps)){var i,n,s=e.elm,a=t.data.domProps||{},l=e.data.domProps||{};for(i in o(l.__ob__)&&(l=e.data.domProps=P({},l)),a)i in l||(s[i]="");for(i in l){if(n=l[i],"textContent"===i||"innerHTML"===i){if(e.children&&(e.children.length=0),n===a[i])continue;1===s.childNodes.length&&s.removeChild(s.childNodes[0])}if("value"===i&&"PROGRESS"!==s.tagName){s._value=n;var u=r(n)?"":String(n);hr(s,u)&&(s.value=u)}else if("innerHTML"===i&&Qi(s.tagName)&&r(s.innerHTML)){(ar=ar||document.createElement("div")).innerHTML="<svg>"+n+"</svg>";for(var h=ar.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;h.firstChild;)s.appendChild(h.firstChild)}else if(n!==a[i])try{s[i]=n}catch(t){}}}}function hr(t,e){return!t.composing&&("OPTION"===t.tagName||function(t,e){var i=!0;try{i=document.activeElement!==t}catch(t){}return i&&t.value!==e}(t,e)||function(t,e){var i=t.value,n=t._vModifiers;if(o(n)){if(n.number)return g(i)!==g(e);if(n.trim)return i.trim()!==e.trim()}return i!==e}(t,e))}var cr={create:ur,update:ur},dr=x((function(t){var e={},i=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach((function(t){if(t){var n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}));function fr(t){var e=pr(t.style);return t.staticStyle?P(t.staticStyle,e):e}function pr(t){return Array.isArray(t)?L(t):"string"==typeof t?dr(t):t}var gr,mr=/^--/,vr=/\s*!important$/,yr=function(t,e,i){if(mr.test(e))t.style.setProperty(e,i);else if(vr.test(i))t.style.setProperty(I(e),i.replace(vr,""),"important");else{var n=br(e);if(Array.isArray(i))for(var r=0,o=i.length;r<o;r++)t.style[n]=i[r];else t.style[n]=i}},_r=["Webkit","Moz","ms"],br=x((function(t){if(gr=gr||document.createElement("div").style,"filter"!==(t=C(t))&&t in gr)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<_r.length;i++){var n=_r[i]+e;if(n in gr)return n}}));function wr(t,e){var i=e.data,n=t.data;if(!(r(i.staticStyle)&&r(i.style)&&r(n.staticStyle)&&r(n.style))){var s,a,l=e.elm,u=n.staticStyle,h=n.normalizedStyle||n.style||{},c=u||h,d=pr(e.data.style)||{};e.data.normalizedStyle=o(d.__ob__)?P({},d):d;var f=function(t,e){var i,n={};if(e)for(var r=t;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(i=fr(r.data))&&P(n,i);(i=fr(t.data))&&P(n,i);for(var o=t;o=o.parent;)o.data&&(i=fr(o.data))&&P(n,i);return n}(e,!0);for(a in c)r(f[a])&&yr(l,a,"");for(a in f)(s=f[a])!==c[a]&&yr(l,a,null==s?"":s)}}var xr={create:wr,update:wr},Sr=/\s+/;function Cr(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Sr).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var i=" "+(t.getAttribute("class")||"")+" ";i.indexOf(" "+e+" ")<0&&t.setAttribute("class",(i+e).trim())}}function Er(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Sr).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var i=" "+(t.getAttribute("class")||"")+" ",n=" "+e+" ";i.indexOf(n)>=0;)i=i.replace(n," ");(i=i.trim())?t.setAttribute("class",i):t.removeAttribute("class")}}function Tr(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&P(e,Ir(t.name||"v")),P(e,t),e}return"string"==typeof t?Ir(t):void 0}}var Ir=x((function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}})),Ar=X&&!Q,kr="transition",Pr="animation",Lr="transition",Rr="transitionend",Fr="animation",Mr="animationend";Ar&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Lr="WebkitTransition",Rr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Fr="WebkitAnimation",Mr="webkitAnimationEnd"));var Or=X?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Dr(t){Or((function(){Or(t)}))}function $r(t,e){var i=t._transitionClasses||(t._transitionClasses=[]);i.indexOf(e)<0&&(i.push(e),Cr(t,e))}function jr(t,e){t._transitionClasses&&_(t._transitionClasses,e),Er(t,e)}function Nr(t,e,i){var n=Ur(t,e),r=n.type,o=n.timeout,s=n.propCount;if(!r)return i();var a=r===kr?Rr:Mr,l=0,u=function(){t.removeEventListener(a,h),i()},h=function(e){e.target===t&&++l>=s&&u()};setTimeout((function(){l<s&&u()}),o+1),t.addEventListener(a,h)}var Br=/\b(transform|all)(,|$)/;function Ur(t,e){var i,n=window.getComputedStyle(t),r=(n[Lr+"Delay"]||"").split(", "),o=(n[Lr+"Duration"]||"").split(", "),s=Gr(r,o),a=(n[Fr+"Delay"]||"").split(", "),l=(n[Fr+"Duration"]||"").split(", "),u=Gr(a,l),h=0,c=0;return e===kr?s>0&&(i=kr,h=s,c=o.length):e===Pr?u>0&&(i=Pr,h=u,c=l.length):c=(i=(h=Math.max(s,u))>0?s>u?kr:Pr:null)?i===kr?o.length:l.length:0,{type:i,timeout:h,propCount:c,hasTransform:i===kr&&Br.test(n[Lr+"Property"])}}function Gr(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map((function(e,i){return Vr(e)+Vr(t[i])})))}function Vr(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function zr(t,e){var i=t.elm;o(i._leaveCb)&&(i._leaveCb.cancelled=!0,i._leaveCb());var n=Tr(t.data.transition);if(!r(n)&&!o(i._enterCb)&&1===i.nodeType){for(var s=n.css,a=n.type,u=n.enterClass,h=n.enterToClass,c=n.enterActiveClass,d=n.appearClass,f=n.appearToClass,p=n.appearActiveClass,m=n.beforeEnter,v=n.enter,y=n.afterEnter,_=n.enterCancelled,b=n.beforeAppear,w=n.appear,x=n.afterAppear,S=n.appearCancelled,C=n.duration,E=ei,T=ei.$vnode;T&&T.parent;)E=T.context,T=T.parent;var I=!E._isMounted||!t.isRootInsert;if(!I||w||""===w){var A=I&&d?d:u,k=I&&p?p:c,P=I&&f?f:h,L=I&&b||m,R=I&&"function"==typeof w?w:v,F=I&&x||y,M=I&&S||_,O=g(l(C)?C.enter:C);0;var D=!1!==s&&!Q,j=Kr(R),N=i._enterCb=$((function(){D&&(jr(i,P),jr(i,k)),N.cancelled?(D&&jr(i,A),M&&M(i)):F&&F(i),i._enterCb=null}));t.data.show||ce(t,"insert",(function(){var e=i.parentNode,n=e&&e._pending&&e._pending[t.key];n&&n.tag===t.tag&&n.elm._leaveCb&&n.elm._leaveCb(),R&&R(i,N)})),L&&L(i),D&&($r(i,A),$r(i,k),Dr((function(){jr(i,A),N.cancelled||($r(i,P),j||(Wr(O)?setTimeout(N,O):Nr(i,a,N)))}))),t.data.show&&(e&&e(),R&&R(i,N)),D||j||N()}}}function qr(t,e){var i=t.elm;o(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var n=Tr(t.data.transition);if(r(n)||1!==i.nodeType)return e();if(!o(i._leaveCb)){var s=n.css,a=n.type,u=n.leaveClass,h=n.leaveToClass,c=n.leaveActiveClass,d=n.beforeLeave,f=n.leave,p=n.afterLeave,m=n.leaveCancelled,v=n.delayLeave,y=n.duration,_=!1!==s&&!Q,b=Kr(f),w=g(l(y)?y.leave:y);0;var x=i._leaveCb=$((function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[t.key]=null),_&&(jr(i,h),jr(i,c)),x.cancelled?(_&&jr(i,u),m&&m(i)):(e(),p&&p(i)),i._leaveCb=null}));v?v(S):S()}function S(){x.cancelled||(!t.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[t.key]=t),d&&d(i),_&&($r(i,u),$r(i,c),Dr((function(){jr(i,u),x.cancelled||($r(i,h),b||(Wr(w)?setTimeout(x,w):Nr(i,a,x)))}))),f&&f(i,x),_||b||x())}}function Wr(t){return"number"==typeof t&&!isNaN(t)}function Kr(t){if(r(t))return!1;var e=t.fns;return o(e)?Kr(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function Xr(t,e){!0!==e.data.show&&zr(e)}var Yr=function(t){var e,i,n={},l=t.modules,u=t.nodeOps;for(e=0;e<hn.length;++e)for(n[hn[e]]=[],i=0;i<l.length;++i)o(l[i][hn[e]])&&n[hn[e]].push(l[i][hn[e]]);function h(t){var e=u.parentNode(t);o(e)&&u.removeChild(e,t)}function c(t,e,i,r,a,l,h){if(o(t.elm)&&o(l)&&(t=l[h]=wt(t)),t.isRootInsert=!a,!function(t,e,i,r){var a=t.data;if(o(a)){var l=o(t.componentInstance)&&a.keepAlive;if(o(a=a.hook)&&o(a=a.init)&&a(t,!1),o(t.componentInstance))return d(t,e),f(i,t.elm,r),s(l)&&function(t,e,i,r){var s,a=t;for(;a.componentInstance;)if(o(s=(a=a.componentInstance._vnode).data)&&o(s=s.transition)){for(s=0;s<n.activate.length;++s)n.activate[s](un,a);e.push(a);break}f(i,t.elm,r)}(t,e,i,r),!0}}(t,e,i,r)){var c=t.data,g=t.children,m=t.tag;o(m)?(t.elm=t.ns?u.createElementNS(t.ns,m):u.createElement(m,t),y(t),p(t,g,e),o(c)&&v(t,e),f(i,t.elm,r)):s(t.isComment)?(t.elm=u.createComment(t.text),f(i,t.elm,r)):(t.elm=u.createTextNode(t.text),f(i,t.elm,r))}}function d(t,e){o(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,g(t)?(v(t,e),y(t)):(ln(t),e.push(t))}function f(t,e,i){o(t)&&(o(i)?u.parentNode(i)===t&&u.insertBefore(t,e,i):u.appendChild(t,e))}function p(t,e,i){if(Array.isArray(e)){0;for(var n=0;n<e.length;++n)c(e[n],i,t.elm,null,!0,e,n)}else a(t.text)&&u.appendChild(t.elm,u.createTextNode(String(t.text)))}function g(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return o(t.tag)}function v(t,i){for(var r=0;r<n.create.length;++r)n.create[r](un,t);o(e=t.data.hook)&&(o(e.create)&&e.create(un,t),o(e.insert)&&i.push(t))}function y(t){var e;if(o(e=t.fnScopeId))u.setStyleScope(t.elm,e);else for(var i=t;i;)o(e=i.context)&&o(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e),i=i.parent;o(e=ei)&&e!==t.context&&e!==t.fnContext&&o(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e)}function _(t,e,i,n,r,o){for(;n<=r;++n)c(i[n],o,t,e,!1,i,n)}function b(t){var e,i,r=t.data;if(o(r))for(o(e=r.hook)&&o(e=e.destroy)&&e(t),e=0;e<n.destroy.length;++e)n.destroy[e](t);if(o(e=t.children))for(i=0;i<t.children.length;++i)b(t.children[i])}function w(t,e,i){for(;e<=i;++e){var n=t[e];o(n)&&(o(n.tag)?(x(n),b(n)):h(n.elm))}}function x(t,e){if(o(e)||o(t.data)){var i,r=n.remove.length+1;for(o(e)?e.listeners+=r:e=function(t,e){function i(){0==--i.listeners&&h(t)}return i.listeners=e,i}(t.elm,r),o(i=t.componentInstance)&&o(i=i._vnode)&&o(i.data)&&x(i,e),i=0;i<n.remove.length;++i)n.remove[i](t,e);o(i=t.data.hook)&&o(i=i.remove)?i(t,e):e()}else h(t.elm)}function S(t,e,i,n){for(var r=i;r<n;r++){var s=e[r];if(o(s)&&cn(t,s))return r}}function C(t,e,i,a,l,h){if(t!==e){o(e.elm)&&o(a)&&(e=a[l]=wt(e));var d=e.elm=t.elm;if(s(t.isAsyncPlaceholder))o(e.asyncFactory.resolved)?I(t.elm,e,i):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(t.isStatic)&&e.key===t.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=t.componentInstance;else{var f,p=e.data;o(p)&&o(f=p.hook)&&o(f=f.prepatch)&&f(t,e);var m=t.children,v=e.children;if(o(p)&&g(e)){for(f=0;f<n.update.length;++f)n.update[f](t,e);o(f=p.hook)&&o(f=f.update)&&f(t,e)}r(e.text)?o(m)&&o(v)?m!==v&&function(t,e,i,n,s){var a,l,h,d=0,f=0,p=e.length-1,g=e[0],m=e[p],v=i.length-1,y=i[0],b=i[v],x=!s;for(;d<=p&&f<=v;)r(g)?g=e[++d]:r(m)?m=e[--p]:cn(g,y)?(C(g,y,n,i,f),g=e[++d],y=i[++f]):cn(m,b)?(C(m,b,n,i,v),m=e[--p],b=i[--v]):cn(g,b)?(C(g,b,n,i,v),x&&u.insertBefore(t,g.elm,u.nextSibling(m.elm)),g=e[++d],b=i[--v]):cn(m,y)?(C(m,y,n,i,f),x&&u.insertBefore(t,m.elm,g.elm),m=e[--p],y=i[++f]):(r(a)&&(a=dn(e,d,p)),r(l=o(y.key)?a[y.key]:S(y,e,d,p))?c(y,n,t,g.elm,!1,i,f):cn(h=e[l],y)?(C(h,y,n,i,f),e[l]=void 0,x&&u.insertBefore(t,h.elm,g.elm)):c(y,n,t,g.elm,!1,i,f),y=i[++f]);d>p?_(t,r(i[v+1])?null:i[v+1].elm,i,f,v,n):f>v&&w(e,d,p)}(d,m,v,i,h):o(v)?(o(t.text)&&u.setTextContent(d,""),_(d,null,v,0,v.length-1,i)):o(m)?w(m,0,m.length-1):o(t.text)&&u.setTextContent(d,""):t.text!==e.text&&u.setTextContent(d,e.text),o(p)&&o(f=p.hook)&&o(f=f.postpatch)&&f(t,e)}}}function E(t,e,i){if(s(i)&&o(t.parent))t.parent.data.pendingInsert=e;else for(var n=0;n<e.length;++n)e[n].data.hook.insert(e[n])}var T=m("attrs,class,staticClass,staticStyle,key");function I(t,e,i,n){var r,a=e.tag,l=e.data,u=e.children;if(n=n||l&&l.pre,e.elm=t,s(e.isComment)&&o(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(o(l)&&(o(r=l.hook)&&o(r=r.init)&&r(e,!0),o(r=e.componentInstance)))return d(e,i),!0;if(o(a)){if(o(u))if(t.hasChildNodes())if(o(r=l)&&o(r=r.domProps)&&o(r=r.innerHTML)){if(r!==t.innerHTML)return!1}else{for(var h=!0,c=t.firstChild,f=0;f<u.length;f++){if(!c||!I(c,u[f],i,n)){h=!1;break}c=c.nextSibling}if(!h||c)return!1}else p(e,u,i);if(o(l)){var g=!1;for(var m in l)if(!T(m)){g=!0,v(e,i);break}!g&&l.class&&se(l.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,i,a){if(!r(e)){var l,h=!1,d=[];if(r(t))h=!0,c(e,d);else{var f=o(t.nodeType);if(!f&&cn(t,e))C(t,e,d,null,null,a);else{if(f){if(1===t.nodeType&&t.hasAttribute(j)&&(t.removeAttribute(j),i=!0),s(i)&&I(t,e,d))return E(e,d,!0),t;l=t,t=new vt(u.tagName(l).toLowerCase(),{},[],void 0,l)}var p=t.elm,m=u.parentNode(p);if(c(e,d,p._leaveCb?null:m,u.nextSibling(p)),o(e.parent))for(var v=e.parent,y=g(e);v;){for(var _=0;_<n.destroy.length;++_)n.destroy[_](v);if(v.elm=e.elm,y){for(var x=0;x<n.create.length;++x)n.create[x](un,v);var S=v.data.hook.insert;if(S.merged)for(var T=1;T<S.fns.length;T++)S.fns[T]()}else ln(v);v=v.parent}o(m)?w([t],0,0):o(t.tag)&&b(t)}}return E(e,d,h),e.elm}o(t)&&b(t)}}({nodeOps:sn,modules:[Sn,Ln,lr,cr,xr,X?{create:Xr,activate:Xr,remove:function(t,e){!0!==t.data.show?qr(t,e):e()}}:{}].concat(_n)});Q&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&no(t,"input")}));var Hr={inserted:function(t,e,i,n){"select"===i.tag?(n.elm&&!n.elm._vOptions?ce(i,"postpatch",(function(){Hr.componentUpdated(t,e,i)})):Zr(t,e,i.context),t._vOptions=[].map.call(t.options,to)):("textarea"===i.tag||rn(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",eo),t.addEventListener("compositionend",io),t.addEventListener("change",io),Q&&(t.vmodel=!0)))},componentUpdated:function(t,e,i){if("select"===i.tag){Zr(t,e,i.context);var n=t._vOptions,r=t._vOptions=[].map.call(t.options,to);if(r.some((function(t,e){return!O(t,n[e])})))(t.multiple?e.value.some((function(t){return Qr(t,r)})):e.value!==e.oldValue&&Qr(e.value,r))&&no(t,"change")}}};function Zr(t,e,i){Jr(t,e,i),(J||tt)&&setTimeout((function(){Jr(t,e,i)}),0)}function Jr(t,e,i){var n=e.value,r=t.multiple;if(!r||Array.isArray(n)){for(var o,s,a=0,l=t.options.length;a<l;a++)if(s=t.options[a],r)o=D(n,to(s))>-1,s.selected!==o&&(s.selected=o);else if(O(to(s),n))return void(t.selectedIndex!==a&&(t.selectedIndex=a));r||(t.selectedIndex=-1)}}function Qr(t,e){return e.every((function(e){return!O(e,t)}))}function to(t){return"_value"in t?t._value:t.value}function eo(t){t.target.composing=!0}function io(t){t.target.composing&&(t.target.composing=!1,no(t.target,"input"))}function no(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),t.dispatchEvent(i)}function ro(t){return!t.componentInstance||t.data&&t.data.transition?t:ro(t.componentInstance._vnode)}var oo={model:Hr,show:{bind:function(t,e,i){var n=e.value,r=(i=ro(i)).data&&i.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;n&&r?(i.data.show=!0,zr(i,(function(){t.style.display=o}))):t.style.display=n?o:"none"},update:function(t,e,i){var n=e.value;!n!=!e.oldValue&&((i=ro(i)).data&&i.data.transition?(i.data.show=!0,n?zr(i,(function(){t.style.display=t.__vOriginalDisplay})):qr(i,(function(){t.style.display="none"}))):t.style.display=n?t.__vOriginalDisplay:"none")},unbind:function(t,e,i,n,r){r||(t.style.display=t.__vOriginalDisplay)}}},so={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function ao(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?ao(He(e.children)):t}function lo(t){var e={},i=t.$options;for(var n in i.propsData)e[n]=t[n];var r=i._parentListeners;for(var o in r)e[C(o)]=r[o];return e}function uo(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}var ho=function(t){return t.tag||Ye(t)},co=function(t){return"show"===t.name},fo={name:"transition",props:so,abstract:!0,render:function(t){var e=this,i=this.$slots.default;if(i&&(i=i.filter(ho)).length){0;var n=this.mode;0;var r=i[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return!0}(this.$vnode))return r;var o=ao(r);if(!o)return r;if(this._leaving)return uo(t,r);var s="__transition-"+this._uid+"-";o.key=null==o.key?o.isComment?s+"comment":s+o.tag:a(o.key)?0===String(o.key).indexOf(s)?o.key:s+o.key:o.key;var l=(o.data||(o.data={})).transition=lo(this),u=this._vnode,h=ao(u);if(o.data.directives&&o.data.directives.some(co)&&(o.data.show=!0),h&&h.data&&!function(t,e){return e.key===t.key&&e.tag===t.tag}(o,h)&&!Ye(h)&&(!h.componentInstance||!h.componentInstance._vnode.isComment)){var c=h.data.transition=P({},l);if("out-in"===n)return this._leaving=!0,ce(c,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),uo(t,r);if("in-out"===n){if(Ye(o))return u;var d,f=function(){d()};ce(l,"afterEnter",f),ce(l,"enterCancelled",f),ce(c,"delayLeave",(function(t){d=t}))}}return r}}},po=P({tag:String,moveClass:String},so);function go(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function mo(t){t.data.newPos=t.elm.getBoundingClientRect()}function vo(t){var e=t.data.pos,i=t.data.newPos,n=e.left-i.left,r=e.top-i.top;if(n||r){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+n+"px,"+r+"px)",o.transitionDuration="0s"}}delete po.mode;var yo={Transition:fo,TransitionGroup:{props:po,beforeMount:function(){var t=this,e=this._update;this._update=function(i,n){var r=ii(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,r(),e.call(t,i,n)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),n=this.prevChildren=this.children,r=this.$slots.default||[],o=this.children=[],s=lo(this),a=0;a<r.length;a++){var l=r[a];if(l.tag)if(null!=l.key&&0!==String(l.key).indexOf("__vlist"))o.push(l),i[l.key]=l,(l.data||(l.data={})).transition=s;else;}if(n){for(var u=[],h=[],c=0;c<n.length;c++){var d=n[c];d.data.transition=s,d.data.pos=d.elm.getBoundingClientRect(),i[d.key]?u.push(d):h.push(d)}this.kept=t(e,null,u),this.removed=h}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(go),t.forEach(mo),t.forEach(vo),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var i=t.elm,n=i.style;$r(i,e),n.transform=n.WebkitTransform=n.transitionDuration="",i.addEventListener(Rr,i._moveCb=function t(n){n&&n.target!==i||n&&!/transform$/.test(n.propertyName)||(i.removeEventListener(Rr,t),i._moveCb=null,jr(i,e))})}})))},methods:{hasMove:function(t,e){if(!Ar)return!1;if(this._hasMove)return this._hasMove;var i=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){Er(i,t)})),Cr(i,e),i.style.display="none",this.$el.appendChild(i);var n=Ur(i);return this.$el.removeChild(i),this._hasMove=n.hasTransform}}}};ki.config.mustUseProp=Ni,ki.config.isReservedTag=tn,ki.config.isReservedAttr=$i,ki.config.getTagNamespace=en,ki.config.isUnknownElement=function(t){if(!X)return!0;if(tn(t))return!1;if(t=t.toLowerCase(),null!=nn[t])return nn[t];var e=document.createElement(t);return t.indexOf("-")>-1?nn[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:nn[t]=/HTMLUnknownElement/.test(e.toString())},P(ki.options.directives,oo),P(ki.options.components,yo),ki.prototype.__patch__=X?Yr:R,ki.prototype.$mount=function(t,e){return function(t,e,i){var n;return t.$el=e,t.$options.render||(t.$options.render=_t),si(t,"beforeMount"),n=function(){t._update(t._render(),i)},new yi(t,n,R,{before:function(){t._isMounted&&!t._isDestroyed&&si(t,"beforeUpdate")}},!0),i=!1,null==t.$vnode&&(t._isMounted=!0,si(t,"mounted")),t}(this,t=t&&X?on(t):void 0,e)},X&&setTimeout((function(){U.devtools&&at&&at.emit("init",ki)}),0);var _o=/\{\{((?:.|\r?\n)+?)\}\}/g,bo=/[-.*+?^${}()|[\]\/\\]/g,wo=x((function(t){var e=t[0].replace(bo,"\\$&"),i=t[1].replace(bo,"\\$&");return new RegExp(e+"((?:.|\\n)+?)"+i,"g")}));var xo={staticKeys:["staticClass"],transformNode:function(t,e){e.warn;var i=zn(t,"class");i&&(t.staticClass=JSON.stringify(i));var n=Vn(t,"class",!1);n&&(t.classBinding=n)},genData:function(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}};var So,Co={staticKeys:["staticStyle"],transformNode:function(t,e){e.warn;var i=zn(t,"style");i&&(t.staticStyle=JSON.stringify(dr(i)));var n=Vn(t,"style",!1);n&&(t.styleBinding=n)},genData:function(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}},Eo=function(t){return(So=So||document.createElement("div")).innerHTML=t,So.textContent},To=m("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),Io=m("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),Ao=m("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),ko=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Po=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Lo="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+G.source+"]*",Ro="((?:"+Lo+"\\:)?"+Lo+")",Fo=new RegExp("^<"+Ro),Mo=/^\s*(\/?)>/,Oo=new RegExp("^<\\/"+Ro+"[^>]*>"),Do=/^<!DOCTYPE [^>]+>/i,$o=/^<!\--/,jo=/^<!\[/,No=m("script,style,textarea",!0),Bo={},Uo={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},Go=/&(?:lt|gt|quot|amp|#39);/g,Vo=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,zo=m("pre,textarea",!0),qo=function(t,e){return t&&zo(t)&&"\n"===e[0]};function Wo(t,e){var i=e?Vo:Go;return t.replace(i,(function(t){return Uo[t]}))}var Ko,Xo,Yo,Ho,Zo,Jo,Qo,ts,es=/^@|^v-on:/,is=/^v-|^@|^:|^#/,ns=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,rs=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,os=/^\(|\)$/g,ss=/^\[.*\]$/,as=/:(.*)$/,ls=/^:|^\.|^v-bind:/,us=/\.[^.\]]+(?=[^\]]*$)/g,hs=/^v-slot(:|$)|^#/,cs=/[\r\n]/,ds=/\s+/g,fs=x(Eo),ps="_empty_";function gs(t,e,i){return{type:1,tag:t,attrsList:e,attrsMap:xs(e),rawAttrsMap:{},parent:i,children:[]}}function ms(t,e){Ko=e.warn||On,Jo=e.isPreTag||F,Qo=e.mustUseProp||F,ts=e.getTagNamespace||F;var i=e.isReservedTag||F;(function(t){return!!t.component||!i(t.tag)}),Yo=Dn(e.modules,"transformNode"),Ho=Dn(e.modules,"preTransformNode"),Zo=Dn(e.modules,"postTransformNode"),Xo=e.delimiters;var n,r,o=[],s=!1!==e.preserveWhitespace,a=e.whitespace,l=!1,u=!1;function h(t){if(c(t),l||t.processed||(t=vs(t,e)),o.length||t===n||n.if&&(t.elseif||t.else)&&_s(n,{exp:t.elseif,block:t}),r&&!t.forbidden)if(t.elseif||t.else)s=t,(a=function(t){for(var e=t.length;e--;){if(1===t[e].type)return t[e];t.pop()}}(r.children))&&a.if&&_s(a,{exp:s.elseif,block:s});else{if(t.slotScope){var i=t.slotTarget||'"default"';(r.scopedSlots||(r.scopedSlots={}))[i]=t}r.children.push(t),t.parent=r}var s,a;t.children=t.children.filter((function(t){return!t.slotScope})),c(t),t.pre&&(l=!1),Jo(t.tag)&&(u=!1);for(var h=0;h<Zo.length;h++)Zo[h](t,e)}function c(t){if(!u)for(var e;(e=t.children[t.children.length-1])&&3===e.type&&" "===e.text;)t.children.pop()}return function(t,e){for(var i,n,r=[],o=e.expectHTML,s=e.isUnaryTag||F,a=e.canBeLeftOpenTag||F,l=0;t;){if(i=t,n&&No(n)){var u=0,h=n.toLowerCase(),c=Bo[h]||(Bo[h]=new RegExp("([\\s\\S]*?)(</"+h+"[^>]*>)","i")),d=t.replace(c,(function(t,i,n){return u=n.length,No(h)||"noscript"===h||(i=i.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),qo(h,i)&&(i=i.slice(1)),e.chars&&e.chars(i),""}));l+=t.length-d.length,t=d,T(h,l-u,l)}else{var f=t.indexOf("<");if(0===f){if($o.test(t)){var p=t.indexOf("--\x3e");if(p>=0){e.shouldKeepComment&&e.comment(t.substring(4,p),l,l+p+3),S(p+3);continue}}if(jo.test(t)){var g=t.indexOf("]>");if(g>=0){S(g+2);continue}}var m=t.match(Do);if(m){S(m[0].length);continue}var v=t.match(Oo);if(v){var y=l;S(v[0].length),T(v[1],y,l);continue}var _=C();if(_){E(_),qo(_.tagName,t)&&S(1);continue}}var b=void 0,w=void 0,x=void 0;if(f>=0){for(w=t.slice(f);!(Oo.test(w)||Fo.test(w)||$o.test(w)||jo.test(w)||(x=w.indexOf("<",1))<0);)f+=x,w=t.slice(f);b=t.substring(0,f)}f<0&&(b=t),b&&S(b.length),e.chars&&b&&e.chars(b,l-b.length,l)}if(t===i){e.chars&&e.chars(t);break}}function S(e){l+=e,t=t.substring(e)}function C(){var e=t.match(Fo);if(e){var i,n,r={tagName:e[1],attrs:[],start:l};for(S(e[0].length);!(i=t.match(Mo))&&(n=t.match(Po)||t.match(ko));)n.start=l,S(n[0].length),n.end=l,r.attrs.push(n);if(i)return r.unarySlash=i[1],S(i[0].length),r.end=l,r}}function E(t){var i=t.tagName,l=t.unarySlash;o&&("p"===n&&Ao(i)&&T(n),a(i)&&n===i&&T(i));for(var u=s(i)||!!l,h=t.attrs.length,c=new Array(h),d=0;d<h;d++){var f=t.attrs[d],p=f[3]||f[4]||f[5]||"",g="a"===i&&"href"===f[1]?e.shouldDecodeNewlinesForHref:e.shouldDecodeNewlines;c[d]={name:f[1],value:Wo(p,g)}}u||(r.push({tag:i,lowerCasedTag:i.toLowerCase(),attrs:c,start:t.start,end:t.end}),n=i),e.start&&e.start(i,c,u,t.start,t.end)}function T(t,i,o){var s,a;if(null==i&&(i=l),null==o&&(o=l),t)for(a=t.toLowerCase(),s=r.length-1;s>=0&&r[s].lowerCasedTag!==a;s--);else s=0;if(s>=0){for(var u=r.length-1;u>=s;u--)e.end&&e.end(r[u].tag,i,o);r.length=s,n=s&&r[s-1].tag}else"br"===a?e.start&&e.start(t,[],!0,i,o):"p"===a&&(e.start&&e.start(t,[],!1,i,o),e.end&&e.end(t,i,o))}T()}(t,{warn:Ko,expectHTML:e.expectHTML,isUnaryTag:e.isUnaryTag,canBeLeftOpenTag:e.canBeLeftOpenTag,shouldDecodeNewlines:e.shouldDecodeNewlines,shouldDecodeNewlinesForHref:e.shouldDecodeNewlinesForHref,shouldKeepComment:e.comments,outputSourceRange:e.outputSourceRange,start:function(t,i,s,a,c){var d=r&&r.ns||ts(t);J&&"svg"===d&&(i=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];Ss.test(n.name)||(n.name=n.name.replace(Cs,""),e.push(n))}return e}(i));var f,p=gs(t,i,r);d&&(p.ns=d),"style"!==(f=p).tag&&("script"!==f.tag||f.attrsMap.type&&"text/javascript"!==f.attrsMap.type)||st()||(p.forbidden=!0);for(var g=0;g<Ho.length;g++)p=Ho[g](p,e)||p;l||(!function(t){null!=zn(t,"v-pre")&&(t.pre=!0)}(p),p.pre&&(l=!0)),Jo(p.tag)&&(u=!0),l?function(t){var e=t.attrsList,i=e.length;if(i)for(var n=t.attrs=new Array(i),r=0;r<i;r++)n[r]={name:e[r].name,value:JSON.stringify(e[r].value)},null!=e[r].start&&(n[r].start=e[r].start,n[r].end=e[r].end);else t.pre||(t.plain=!0)}(p):p.processed||(ys(p),function(t){var e=zn(t,"v-if");if(e)t.if=e,_s(t,{exp:e,block:t});else{null!=zn(t,"v-else")&&(t.else=!0);var i=zn(t,"v-else-if");i&&(t.elseif=i)}}(p),function(t){null!=zn(t,"v-once")&&(t.once=!0)}(p)),n||(n=p),s?h(p):(r=p,o.push(p))},end:function(t,e,i){var n=o[o.length-1];o.length-=1,r=o[o.length-1],h(n)},chars:function(t,e,i){if(r&&(!J||"textarea"!==r.tag||r.attrsMap.placeholder!==t)){var n,o,h,c=r.children;if(t=u||t.trim()?"script"===(n=r).tag||"style"===n.tag?t:fs(t):c.length?a?"condense"===a&&cs.test(t)?"":" ":s?" ":"":"")u||"condense"!==a||(t=t.replace(ds," ")),!l&&" "!==t&&(o=function(t,e){var i=e?wo(e):_o;if(i.test(t)){for(var n,r,o,s=[],a=[],l=i.lastIndex=0;n=i.exec(t);){(r=n.index)>l&&(a.push(o=t.slice(l,r)),s.push(JSON.stringify(o)));var u=Fn(n[1].trim());s.push("_s("+u+")"),a.push({"@binding":u}),l=r+n[0].length}return l<t.length&&(a.push(o=t.slice(l)),s.push(JSON.stringify(o))),{expression:s.join("+"),tokens:a}}}(t,Xo))?h={type:2,expression:o.expression,tokens:o.tokens,text:t}:" "===t&&c.length&&" "===c[c.length-1].text||(h={type:3,text:t}),h&&c.push(h)}},comment:function(t,e,i){if(r){var n={type:3,text:t,isComment:!0};0,r.children.push(n)}}}),n}function vs(t,e){var i;!function(t){var e=Vn(t,"key");if(e){t.key=e}}(t),t.plain=!t.key&&!t.scopedSlots&&!t.attrsList.length,function(t){var e=Vn(t,"ref");e&&(t.ref=e,t.refInFor=function(t){var e=t;for(;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}(t))}(t),function(t){var e;"template"===t.tag?(e=zn(t,"scope"),t.slotScope=e||zn(t,"slot-scope")):(e=zn(t,"slot-scope"))&&(t.slotScope=e);var i=Vn(t,"slot");i&&(t.slotTarget='""'===i?'"default"':i,t.slotTargetDynamic=!(!t.attrsMap[":slot"]&&!t.attrsMap["v-bind:slot"]),"template"===t.tag||t.slotScope||jn(t,"slot",i,function(t,e){return t.rawAttrsMap[":"+e]||t.rawAttrsMap["v-bind:"+e]||t.rawAttrsMap[e]}(t,"slot")));if("template"===t.tag){var n=qn(t,hs);if(n){0;var r=bs(n),o=r.name,s=r.dynamic;t.slotTarget=o,t.slotTargetDynamic=s,t.slotScope=n.value||ps}}else{var a=qn(t,hs);if(a){0;var l=t.scopedSlots||(t.scopedSlots={}),u=bs(a),h=u.name,c=u.dynamic,d=l[h]=gs("template",[],t);d.slotTarget=h,d.slotTargetDynamic=c,d.children=t.children.filter((function(t){if(!t.slotScope)return t.parent=d,!0})),d.slotScope=a.value||ps,t.children=[],t.plain=!1}}}(t),"slot"===(i=t).tag&&(i.slotName=Vn(i,"name")),function(t){var e;(e=Vn(t,"is"))&&(t.component=e);null!=zn(t,"inline-template")&&(t.inlineTemplate=!0)}(t);for(var n=0;n<Yo.length;n++)t=Yo[n](t,e)||t;return function(t){var e,i,n,r,o,s,a,l,u=t.attrsList;for(e=0,i=u.length;e<i;e++){if(n=r=u[e].name,o=u[e].value,is.test(n))if(t.hasBindings=!0,(s=ws(n.replace(is,"")))&&(n=n.replace(us,"")),ls.test(n))n=n.replace(ls,""),o=Fn(o),(l=ss.test(n))&&(n=n.slice(1,-1)),s&&(s.prop&&!l&&"innerHtml"===(n=C(n))&&(n="innerHTML"),s.camel&&!l&&(n=C(n)),s.sync&&(a=Xn(o,"$event"),l?Gn(t,'"update:"+('+n+")",a,null,!1,0,u[e],!0):(Gn(t,"update:"+C(n),a,null,!1,0,u[e]),I(n)!==C(n)&&Gn(t,"update:"+I(n),a,null,!1,0,u[e])))),s&&s.prop||!t.component&&Qo(t.tag,t.attrsMap.type,n)?$n(t,n,o,u[e],l):jn(t,n,o,u[e],l);else if(es.test(n))n=n.replace(es,""),(l=ss.test(n))&&(n=n.slice(1,-1)),Gn(t,n,o,s,!1,0,u[e],l);else{var h=(n=n.replace(is,"")).match(as),c=h&&h[1];l=!1,c&&(n=n.slice(0,-(c.length+1)),ss.test(c)&&(c=c.slice(1,-1),l=!0)),Bn(t,n,r,o,c,l,s,u[e])}else jn(t,n,JSON.stringify(o),u[e]),!t.component&&"muted"===n&&Qo(t.tag,t.attrsMap.type,n)&&$n(t,n,"true",u[e])}}(t),t}function ys(t){var e;if(e=zn(t,"v-for")){var i=function(t){var e=t.match(ns);if(!e)return;var i={};i.for=e[2].trim();var n=e[1].trim().replace(os,""),r=n.match(rs);r?(i.alias=n.replace(rs,"").trim(),i.iterator1=r[1].trim(),r[2]&&(i.iterator2=r[2].trim())):i.alias=n;return i}(e);i&&P(t,i)}}function _s(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function bs(t){var e=t.name.replace(hs,"");return e||"#"!==t.name[0]&&(e="default"),ss.test(e)?{name:e.slice(1,-1),dynamic:!0}:{name:'"'+e+'"',dynamic:!1}}function ws(t){var e=t.match(us);if(e){var i={};return e.forEach((function(t){i[t.slice(1)]=!0})),i}}function xs(t){for(var e={},i=0,n=t.length;i<n;i++)e[t[i].name]=t[i].value;return e}var Ss=/^xmlns:NS\d+/,Cs=/^NS\d+:/;function Es(t){return gs(t.tag,t.attrsList.slice(),t.parent)}var Ts=[xo,Co,{preTransformNode:function(t,e){if("input"===t.tag){var i,n=t.attrsMap;if(!n["v-model"])return;if((n[":type"]||n["v-bind:type"])&&(i=Vn(t,"type")),n.type||i||!n["v-bind"]||(i="("+n["v-bind"]+").type"),i){var r=zn(t,"v-if",!0),o=r?"&&("+r+")":"",s=null!=zn(t,"v-else",!0),a=zn(t,"v-else-if",!0),l=Es(t);ys(l),Nn(l,"type","checkbox"),vs(l,e),l.processed=!0,l.if="("+i+")==='checkbox'"+o,_s(l,{exp:l.if,block:l});var u=Es(t);zn(u,"v-for",!0),Nn(u,"type","radio"),vs(u,e),_s(l,{exp:"("+i+")==='radio'"+o,block:u});var h=Es(t);return zn(h,"v-for",!0),Nn(h,":type",i),vs(h,e),_s(l,{exp:r,block:h}),s?l.else=!0:a&&(l.elseif=a),l}}}}];var Is,As,ks={expectHTML:!0,modules:Ts,directives:{model:function(t,e,i){i;var n=e.value,r=e.modifiers,o=t.tag,s=t.attrsMap.type;if(t.component)return Kn(t,n,r),!1;if("select"===o)!function(t,e,i){var n='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(i&&i.number?"_n(val)":"val")+"});";n=n+" "+Xn(e,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),Gn(t,"change",n,null,!0)}(t,n,r);else if("input"===o&&"checkbox"===s)!function(t,e,i){var n=i&&i.number,r=Vn(t,"value")||"null",o=Vn(t,"true-value")||"true",s=Vn(t,"false-value")||"false";$n(t,"checked","Array.isArray("+e+")?_i("+e+","+r+")>-1"+("true"===o?":("+e+")":":_q("+e+","+o+")")),Gn(t,"change","var $$a="+e+",$$el=$event.target,$$c=$$el.checked?("+o+"):("+s+");if(Array.isArray($$a)){var $$v="+(n?"_n("+r+")":r)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+Xn(e,"$$a.concat([$$v])")+")}else{$$i>-1&&("+Xn(e,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+Xn(e,"$$c")+"}",null,!0)}(t,n,r);else if("input"===o&&"radio"===s)!function(t,e,i){var n=i&&i.number,r=Vn(t,"value")||"null";$n(t,"checked","_q("+e+","+(r=n?"_n("+r+")":r)+")"),Gn(t,"change",Xn(e,r),null,!0)}(t,n,r);else if("input"===o||"textarea"===o)!function(t,e,i){var n=t.attrsMap.type;0;var r=i||{},o=r.lazy,s=r.number,a=r.trim,l=!o&&"range"!==n,u=o?"change":"range"===n?er:"input",h="$event.target.value";a&&(h="$event.target.value.trim()");s&&(h="_n("+h+")");var c=Xn(e,h);l&&(c="if($event.target.composing)return;"+c);$n(t,"value","("+e+")"),Gn(t,u,c,null,!0),(a||s)&&Gn(t,"blur","$forceUpdate()")}(t,n,r);else{if(!U.isReservedTag(o))return Kn(t,n,r),!1}return!0},text:function(t,e){e.value&&$n(t,"textContent","_s("+e.value+")",e)},html:function(t,e){e.value&&$n(t,"innerHTML","_s("+e.value+")",e)}},isPreTag:function(t){return"pre"===t},isUnaryTag:To,mustUseProp:Ni,canBeLeftOpenTag:Io,isReservedTag:tn,getTagNamespace:en,staticKeys:function(t){return t.reduce((function(t,e){return t.concat(e.staticKeys||[])}),[]).join(",")}(Ts)},Ps=x((function(t){return m("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(t?","+t:""))}));function Ls(t,e){t&&(Is=Ps(e.staticKeys||""),As=e.isReservedTag||F,Rs(t),Fs(t,!1))}function Rs(t){if(t.static=function(t){if(2===t.type)return!1;if(3===t.type)return!0;return!(!t.pre&&(t.hasBindings||t.if||t.for||v(t.tag)||!As(t.tag)||function(t){for(;t.parent;){if("template"!==(t=t.parent).tag)return!1;if(t.for)return!0}return!1}(t)||!Object.keys(t).every(Is)))}(t),1===t.type){if(!As(t.tag)&&"slot"!==t.tag&&null==t.attrsMap["inline-template"])return;for(var e=0,i=t.children.length;e<i;e++){var n=t.children[e];Rs(n),n.static||(t.static=!1)}if(t.ifConditions)for(var r=1,o=t.ifConditions.length;r<o;r++){var s=t.ifConditions[r].block;Rs(s),s.static||(t.static=!1)}}}function Fs(t,e){if(1===t.type){if((t.static||t.once)&&(t.staticInFor=e),t.static&&t.children.length&&(1!==t.children.length||3!==t.children[0].type))return void(t.staticRoot=!0);if(t.staticRoot=!1,t.children)for(var i=0,n=t.children.length;i<n;i++)Fs(t.children[i],e||!!t.for);if(t.ifConditions)for(var r=1,o=t.ifConditions.length;r<o;r++)Fs(t.ifConditions[r].block,e)}}var Ms=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,Os=/\([^)]*?\);*$/,Ds=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,$s={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},js={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},Ns=function(t){return"if("+t+")return null;"},Bs={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:Ns("$event.target !== $event.currentTarget"),ctrl:Ns("!$event.ctrlKey"),shift:Ns("!$event.shiftKey"),alt:Ns("!$event.altKey"),meta:Ns("!$event.metaKey"),left:Ns("'button' in $event && $event.button !== 0"),middle:Ns("'button' in $event && $event.button !== 1"),right:Ns("'button' in $event && $event.button !== 2")};function Us(t,e){var i=e?"nativeOn:":"on:",n="",r="";for(var o in t){var s=Gs(t[o]);t[o]&&t[o].dynamic?r+=o+","+s+",":n+='"'+o+'":'+s+","}return n="{"+n.slice(0,-1)+"}",r?i+"_d("+n+",["+r.slice(0,-1)+"])":i+n}function Gs(t){if(!t)return"function(){}";if(Array.isArray(t))return"["+t.map((function(t){return Gs(t)})).join(",")+"]";var e=Ds.test(t.value),i=Ms.test(t.value),n=Ds.test(t.value.replace(Os,""));if(t.modifiers){var r="",o="",s=[];for(var a in t.modifiers)if(Bs[a])o+=Bs[a],$s[a]&&s.push(a);else if("exact"===a){var l=t.modifiers;o+=Ns(["ctrl","shift","alt","meta"].filter((function(t){return!l[t]})).map((function(t){return"$event."+t+"Key"})).join("||"))}else s.push(a);return s.length&&(r+=function(t){return"if(!$event.type.indexOf('key')&&"+t.map(Vs).join("&&")+")return null;"}(s)),o&&(r+=o),"function($event){"+r+(e?"return "+t.value+"($event)":i?"return ("+t.value+")($event)":n?"return "+t.value:t.value)+"}"}return e||i?t.value:"function($event){"+(n?"return "+t.value:t.value)+"}"}function Vs(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var i=$s[t],n=js[t];return"_k($event.keyCode,"+JSON.stringify(t)+","+JSON.stringify(i)+",$event.key,"+JSON.stringify(n)+")"}var zs={on:function(t,e){t.wrapListeners=function(t){return"_g("+t+","+e.value+")"}},bind:function(t,e){t.wrapData=function(i){return"_b("+i+",'"+t.tag+"',"+e.value+","+(e.modifiers&&e.modifiers.prop?"true":"false")+(e.modifiers&&e.modifiers.sync?",true":"")+")"}},cloak:R},qs=function(t){this.options=t,this.warn=t.warn||On,this.transforms=Dn(t.modules,"transformCode"),this.dataGenFns=Dn(t.modules,"genData"),this.directives=P(P({},zs),t.directives);var e=t.isReservedTag||F;this.maybeComponent=function(t){return!!t.component||!e(t.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function Ws(t,e){var i=new qs(e);return{render:"with(this){return "+(t?Ks(t,i):'_c("div")')+"}",staticRenderFns:i.staticRenderFns}}function Ks(t,e){if(t.parent&&(t.pre=t.pre||t.parent.pre),t.staticRoot&&!t.staticProcessed)return Xs(t,e);if(t.once&&!t.onceProcessed)return Ys(t,e);if(t.for&&!t.forProcessed)return Js(t,e);if(t.if&&!t.ifProcessed)return Hs(t,e);if("template"!==t.tag||t.slotTarget||e.pre){if("slot"===t.tag)return function(t,e){var i=t.slotName||'"default"',n=ia(t,e),r="_t("+i+(n?","+n:""),o=t.attrs||t.dynamicAttrs?oa((t.attrs||[]).concat(t.dynamicAttrs||[]).map((function(t){return{name:C(t.name),value:t.value,dynamic:t.dynamic}}))):null,s=t.attrsMap["v-bind"];!o&&!s||n||(r+=",null");o&&(r+=","+o);s&&(r+=(o?"":",null")+","+s);return r+")"}(t,e);var i;if(t.component)i=function(t,e,i){var n=e.inlineTemplate?null:ia(e,i,!0);return"_c("+t+","+Qs(e,i)+(n?","+n:"")+")"}(t.component,t,e);else{var n;(!t.plain||t.pre&&e.maybeComponent(t))&&(n=Qs(t,e));var r=t.inlineTemplate?null:ia(t,e,!0);i="_c('"+t.tag+"'"+(n?","+n:"")+(r?","+r:"")+")"}for(var o=0;o<e.transforms.length;o++)i=e.transforms[o](t,i);return i}return ia(t,e)||"void 0"}function Xs(t,e){t.staticProcessed=!0;var i=e.pre;return t.pre&&(e.pre=t.pre),e.staticRenderFns.push("with(this){return "+Ks(t,e)+"}"),e.pre=i,"_m("+(e.staticRenderFns.length-1)+(t.staticInFor?",true":"")+")"}function Ys(t,e){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return Hs(t,e);if(t.staticInFor){for(var i="",n=t.parent;n;){if(n.for){i=n.key;break}n=n.parent}return i?"_o("+Ks(t,e)+","+e.onceId+++","+i+")":Ks(t,e)}return Xs(t,e)}function Hs(t,e,i,n){return t.ifProcessed=!0,Zs(t.ifConditions.slice(),e,i,n)}function Zs(t,e,i,n){if(!t.length)return n||"_e()";var r=t.shift();return r.exp?"("+r.exp+")?"+o(r.block)+":"+Zs(t,e,i,n):""+o(r.block);function o(t){return i?i(t,e):t.once?Ys(t,e):Ks(t,e)}}function Js(t,e,i,n){var r=t.for,o=t.alias,s=t.iterator1?","+t.iterator1:"",a=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,(n||"_l")+"(("+r+"),function("+o+s+a+"){return "+(i||Ks)(t,e)+"})"}function Qs(t,e){var i="{",n=function(t,e){var i=t.directives;if(!i)return;var n,r,o,s,a="directives:[",l=!1;for(n=0,r=i.length;n<r;n++){o=i[n],s=!0;var u=e.directives[o.name];u&&(s=!!u(t,o,e.warn)),s&&(l=!0,a+='{name:"'+o.name+'",rawName:"'+o.rawName+'"'+(o.value?",value:("+o.value+"),expression:"+JSON.stringify(o.value):"")+(o.arg?",arg:"+(o.isDynamicArg?o.arg:'"'+o.arg+'"'):"")+(o.modifiers?",modifiers:"+JSON.stringify(o.modifiers):"")+"},")}if(l)return a.slice(0,-1)+"]"}(t,e);n&&(i+=n+","),t.key&&(i+="key:"+t.key+","),t.ref&&(i+="ref:"+t.ref+","),t.refInFor&&(i+="refInFor:true,"),t.pre&&(i+="pre:true,"),t.component&&(i+='tag:"'+t.tag+'",');for(var r=0;r<e.dataGenFns.length;r++)i+=e.dataGenFns[r](t);if(t.attrs&&(i+="attrs:"+oa(t.attrs)+","),t.props&&(i+="domProps:"+oa(t.props)+","),t.events&&(i+=Us(t.events,!1)+","),t.nativeEvents&&(i+=Us(t.nativeEvents,!0)+","),t.slotTarget&&!t.slotScope&&(i+="slot:"+t.slotTarget+","),t.scopedSlots&&(i+=function(t,e,i){var n=t.for||Object.keys(e).some((function(t){var i=e[t];return i.slotTargetDynamic||i.if||i.for||ta(i)})),r=!!t.if;if(!n)for(var o=t.parent;o;){if(o.slotScope&&o.slotScope!==ps||o.for){n=!0;break}o.if&&(r=!0),o=o.parent}var s=Object.keys(e).map((function(t){return ea(e[t],i)})).join(",");return"scopedSlots:_u(["+s+"]"+(n?",null,true":"")+(!n&&r?",null,false,"+function(t){var e=5381,i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return e>>>0}(s):"")+")"}(t,t.scopedSlots,e)+","),t.model&&(i+="model:{value:"+t.model.value+",callback:"+t.model.callback+",expression:"+t.model.expression+"},"),t.inlineTemplate){var o=function(t,e){var i=t.children[0];0;if(i&&1===i.type){var n=Ws(i,e.options);return"inlineTemplate:{render:function(){"+n.render+"},staticRenderFns:["+n.staticRenderFns.map((function(t){return"function(){"+t+"}"})).join(",")+"]}"}}(t,e);o&&(i+=o+",")}return i=i.replace(/,$/,"")+"}",t.dynamicAttrs&&(i="_b("+i+',"'+t.tag+'",'+oa(t.dynamicAttrs)+")"),t.wrapData&&(i=t.wrapData(i)),t.wrapListeners&&(i=t.wrapListeners(i)),i}function ta(t){return 1===t.type&&("slot"===t.tag||t.children.some(ta))}function ea(t,e){var i=t.attrsMap["slot-scope"];if(t.if&&!t.ifProcessed&&!i)return Hs(t,e,ea,"null");if(t.for&&!t.forProcessed)return Js(t,e,ea);var n=t.slotScope===ps?"":String(t.slotScope),r="function("+n+"){return "+("template"===t.tag?t.if&&i?"("+t.if+")?"+(ia(t,e)||"undefined")+":undefined":ia(t,e)||"undefined":Ks(t,e))+"}",o=n?"":",proxy:true";return"{key:"+(t.slotTarget||'"default"')+",fn:"+r+o+"}"}function ia(t,e,i,n,r){var o=t.children;if(o.length){var s=o[0];if(1===o.length&&s.for&&"template"!==s.tag&&"slot"!==s.tag){var a=i?e.maybeComponent(s)?",1":",0":"";return""+(n||Ks)(s,e)+a}var l=i?function(t,e){for(var i=0,n=0;n<t.length;n++){var r=t[n];if(1===r.type){if(na(r)||r.ifConditions&&r.ifConditions.some((function(t){return na(t.block)}))){i=2;break}(e(r)||r.ifConditions&&r.ifConditions.some((function(t){return e(t.block)})))&&(i=1)}}return i}(o,e.maybeComponent):0,u=r||ra;return"["+o.map((function(t){return u(t,e)})).join(",")+"]"+(l?","+l:"")}}function na(t){return void 0!==t.for||"template"===t.tag||"slot"===t.tag}function ra(t,e){return 1===t.type?Ks(t,e):3===t.type&&t.isComment?function(t){return"_e("+JSON.stringify(t.text)+")"}(t):"_v("+(2===(i=t).type?i.expression:sa(JSON.stringify(i.text)))+")";var i}function oa(t){for(var e="",i="",n=0;n<t.length;n++){var r=t[n],o=sa(r.value);r.dynamic?i+=r.name+","+o+",":e+='"'+r.name+'":'+o+","}return e="{"+e.slice(0,-1)+"}",i?"_d("+e+",["+i.slice(0,-1)+"])":e}function sa(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b"),new RegExp("\\b"+"delete,typeof,void".split(",").join("\\s*\\([^\\)]*\\)|\\b")+"\\s*\\([^\\)]*\\)");function aa(t,e){try{return new Function(t)}catch(i){return e.push({err:i,code:t}),R}}function la(t){var e=Object.create(null);return function(i,n,r){(n=P({},n)).warn;delete n.warn;var o=n.delimiters?String(n.delimiters)+i:i;if(e[o])return e[o];var s=t(i,n);var a={},l=[];return a.render=aa(s.render,l),a.staticRenderFns=s.staticRenderFns.map((function(t){return aa(t,l)})),e[o]=a}}var ua,ha,ca=(ua=function(t,e){var i=ms(t.trim(),e);!1!==e.optimize&&Ls(i,e);var n=Ws(i,e);return{ast:i,render:n.render,staticRenderFns:n.staticRenderFns}},function(t){function e(e,i){var n=Object.create(t),r=[],o=[];if(i)for(var s in i.modules&&(n.modules=(t.modules||[]).concat(i.modules)),i.directives&&(n.directives=P(Object.create(t.directives||null),i.directives)),i)"modules"!==s&&"directives"!==s&&(n[s]=i[s]);n.warn=function(t,e,i){(i?o:r).push(t)};var a=ua(e.trim(),n);return a.errors=r,a.tips=o,a}return{compile:e,compileToFunctions:la(e)}})(ks),da=(ca.compile,ca.compileToFunctions);function fa(t){return(ha=ha||document.createElement("div")).innerHTML=t?'<a href="\n"/>':'<div a="\n"/>',ha.innerHTML.indexOf("&#10;")>0}var pa=!!X&&fa(!1),ga=!!X&&fa(!0),ma=x((function(t){var e=on(t);return e&&e.innerHTML})),va=ki.prototype.$mount;ki.prototype.$mount=function(t,e){if((t=t&&on(t))===document.body||t===document.documentElement)return this;var i=this.$options;if(!i.render){var n=i.template;if(n)if("string"==typeof n)"#"===n.charAt(0)&&(n=ma(n));else{if(!n.nodeType)return this;n=n.innerHTML}else t&&(n=function(t){if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}(t));if(n){0;var r=da(n,{outputSourceRange:!1,shouldDecodeNewlines:pa,shouldDecodeNewlinesForHref:ga,delimiters:i.delimiters,comments:i.comments},this),o=r.render,s=r.staticRenderFns;i.render=o,i.staticRenderFns=s}}return va.call(this,t,e)},ki.compile=da;const ya=ki;function _a(t){this.state=2,this.value=void 0,this.deferred=[];var e=this;try{t((function(t){e.resolve(t)}),(function(t){e.reject(t)}))}catch(t){e.reject(t)}}_a.reject=function(t){return new _a((function(e,i){i(t)}))},_a.resolve=function(t){return new _a((function(e,i){e(t)}))},_a.all=function(t){return new _a((function(e,i){var n=0,r=[];function o(i){return function(o){r[i]=o,(n+=1)===t.length&&e(r)}}0===t.length&&e(r);for(var s=0;s<t.length;s+=1)_a.resolve(t[s]).then(o(s),i)}))},_a.race=function(t){return new _a((function(e,i){for(var n=0;n<t.length;n+=1)_a.resolve(t[n]).then(e,i)}))};var ba=_a.prototype;function wa(t,e){this.promise=t instanceof Promise?t:new Promise(t.bind(e)),this.context=e}ba.resolve=function(t){var e=this;if(2===e.state){if(t===e)throw new TypeError("Promise settled with itself.");var i=!1;try{var n=t&&t.then;if(null!==t&&"object"==typeof t&&"function"==typeof n)return void n.call(t,(function(t){i||e.resolve(t),i=!0}),(function(t){i||e.reject(t),i=!0}))}catch(t){return void(i||e.reject(t))}e.state=0,e.value=t,e.notify()}},ba.reject=function(t){var e=this;if(2===e.state){if(t===e)throw new TypeError("Promise settled with itself.");e.state=1,e.value=t,e.notify()}},ba.notify=function(){var t,e=this;Sa((function(){if(2!==e.state)for(;e.deferred.length;){var t=e.deferred.shift(),i=t[0],n=t[1],r=t[2],o=t[3];try{0===e.state?r("function"==typeof i?i.call(void 0,e.value):e.value):1===e.state&&("function"==typeof n?r(n.call(void 0,e.value)):o(e.value))}catch(t){o(t)}}}),t)},ba.then=function(t,e){var i=this;return new _a((function(n,r){i.deferred.push([t,e,n,r]),i.notify()}))},ba.catch=function(t){return this.then(void 0,t)},"undefined"==typeof Promise&&(window.Promise=_a),wa.all=function(t,e){return new wa(Promise.all(t),e)},wa.resolve=function(t,e){return new wa(Promise.resolve(t),e)},wa.reject=function(t,e){return new wa(Promise.reject(t),e)},wa.race=function(t,e){return new wa(Promise.race(t),e)};var xa=wa.prototype;xa.bind=function(t){return this.context=t,this},xa.then=function(t,e){return t&&t.bind&&this.context&&(t=t.bind(this.context)),e&&e.bind&&this.context&&(e=e.bind(this.context)),new wa(this.promise.then(t,e),this.context)},xa.catch=function(t){return t&&t.bind&&this.context&&(t=t.bind(this.context)),new wa(this.promise.catch(t),this.context)},xa.finally=function(t){return this.then((function(e){return t.call(this),e}),(function(e){return t.call(this),Promise.reject(e)}))};var Sa,Ca={}.hasOwnProperty,Ea=[].slice,Ta=!1,Ia="undefined"!=typeof window;function Aa(t){return t?t.replace(/^\s*|\s*$/g,""):""}function ka(t){return t?t.toLowerCase():""}function Pa(t){return t?t.toUpperCase():""}var La=Array.isArray;function Ra(t){return"string"==typeof t}function Fa(t){return"function"==typeof t}function Ma(t){return null!==t&&"object"==typeof t}function Oa(t){return Ma(t)&&Object.getPrototypeOf(t)==Object.prototype}function Da(t,e,i){var n=wa.resolve(t);return arguments.length<2?n:n.then(e,i)}function $a(t,e,i){return Fa(i=i||{})&&(i=i.call(e)),Ba(t.bind({$vm:e,$options:i}),t,{$options:i})}function ja(t,e){var i,n;if(La(t))for(i=0;i<t.length;i++)e.call(t[i],t[i],i);else if(Ma(t))for(n in t)Ca.call(t,n)&&e.call(t[n],t[n],n);return t}var Na=Object.assign||function(t){var e=Ea.call(arguments,1);return e.forEach((function(e){Ua(t,e)})),t};function Ba(t){var e=Ea.call(arguments,1);return e.forEach((function(e){Ua(t,e,!0)})),t}function Ua(t,e,i){for(var n in e)i&&(Oa(e[n])||La(e[n]))?(Oa(e[n])&&!Oa(t[n])&&(t[n]={}),La(e[n])&&!La(t[n])&&(t[n]=[]),Ua(t[n],e[n],i)):void 0!==e[n]&&(t[n]=e[n])}function Ga(t,e,i){var n=function(t){var e=["+","#",".","/",";","?","&"],i=[];return{vars:i,expand:function(n){return t.replace(/\{([^{}]+)\}|([^{}]+)/g,(function(t,r,o){if(r){var s=null,a=[];if(-1!==e.indexOf(r.charAt(0))&&(s=r.charAt(0),r=r.substr(1)),r.split(/,/g).forEach((function(t){var e=/([^:*]*)(?::(\d+)|(\*))?/.exec(t);a.push.apply(a,function(t,e,i,n){var r=t[i],o=[];if(Va(r)&&""!==r)if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)r=r.toString(),n&&"*"!==n&&(r=r.substring(0,parseInt(n,10))),o.push(qa(e,r,za(e)?i:null));else if("*"===n)Array.isArray(r)?r.filter(Va).forEach((function(t){o.push(qa(e,t,za(e)?i:null))})):Object.keys(r).forEach((function(t){Va(r[t])&&o.push(qa(e,r[t],t))}));else{var s=[];Array.isArray(r)?r.filter(Va).forEach((function(t){s.push(qa(e,t))})):Object.keys(r).forEach((function(t){Va(r[t])&&(s.push(encodeURIComponent(t)),s.push(qa(e,r[t].toString())))})),za(e)?o.push(encodeURIComponent(i)+"="+s.join(",")):0!==s.length&&o.push(s.join(","))}else";"===e?o.push(encodeURIComponent(i)):""!==r||"&"!==e&&"?"!==e?""===r&&o.push(""):o.push(encodeURIComponent(i)+"=");return o}(n,s,e[1],e[2]||e[3])),i.push(e[1])})),s&&"+"!==s){var l=",";return"?"===s?l="&":"#"!==s&&(l=s),(0!==a.length?s:"")+a.join(l)}return a.join(",")}return Wa(o)}))}}}(t),r=n.expand(e);return i&&i.push.apply(i,n.vars),r}function Va(t){return null!=t}function za(t){return";"===t||"&"===t||"?"===t}function qa(t,e,i){return e="+"===t||"#"===t?Wa(e):encodeURIComponent(e),i?encodeURIComponent(i)+"="+e:e}function Wa(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map((function(t){return/%[0-9A-Fa-f]/.test(t)||(t=encodeURI(t)),t})).join("")}function Ka(t,e){var i,n=this||{},r=t;return Ra(t)&&(r={url:t,params:e}),r=Ba({},Ka.options,n.$options,r),Ka.transforms.forEach((function(t){Ra(t)&&(t=Ka.transform[t]),Fa(t)&&(i=function(t,e,i){return function(n){return t.call(i,n,e)}}(t,i,n.$vm))})),i(r)}function Xa(t,e,i){var n,r=La(e),o=Oa(e);ja(e,(function(e,s){n=Ma(e)||La(e),i&&(s=i+"["+(o||n?s:"")+"]"),!i&&r?t.add(e.name,e.value):n?Xa(t,e,s):t.add(s,e)}))}function Ya(t){return new wa((function(e){var i=new XDomainRequest,n=function(n){var r=n.type,o=0;"load"===r?o=200:"error"===r&&(o=500),e(t.respondWith(i.responseText,{status:o}))};t.abort=function(){return i.abort()},i.open(t.method,t.getUrl()),t.timeout&&(i.timeout=t.timeout),i.onload=n,i.onabort=n,i.onerror=n,i.ontimeout=n,i.onprogress=function(){},i.send(t.getBody())}))}Ka.options={url:"",root:null,params:{}},Ka.transform={template:function(t){var e=[],i=Ga(t.url,t.params,e);return e.forEach((function(e){delete t.params[e]})),i},query:function(t,e){var i=Object.keys(Ka.options.params),n={},r=e(t);return ja(t.params,(function(t,e){-1===i.indexOf(e)&&(n[e]=t)})),(n=Ka.params(n))&&(r+=(-1==r.indexOf("?")?"?":"&")+n),r},root:function(t,e){var i=e(t);return Ra(t.root)&&!/^(https?:)?\//.test(i)&&(i=function(t,e){return t&&void 0===e?t.replace(/\s+$/,""):t&&e?t.replace(new RegExp("["+e+"]+$"),""):t}(t.root,"/")+"/"+i),i}},Ka.transforms=["template","query","root"],Ka.params=function(t){var e=[],i=encodeURIComponent;return e.add=function(t,e){Fa(e)&&(e=e()),null===e&&(e=""),this.push(i(t)+"="+i(e))},Xa(e,t),e.join("&").replace(/%20/g,"+")},Ka.parse=function(t){var e=document.createElement("a");return document.documentMode&&(e.href=t,t=e.href),e.href=t,{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",port:e.port,host:e.host,hostname:e.hostname,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):""}};var Ha=Ia&&"withCredentials"in new XMLHttpRequest;function Za(t){return new wa((function(e){var i,n,r=t.jsonp||"callback",o=t.jsonpCallback||"_jsonp"+Math.random().toString(36).substr(2),s=null;i=function(i){var r=i.type,a=0;"load"===r&&null!==s?a=200:"error"===r&&(a=500),a&&window[o]&&(delete window[o],document.body.removeChild(n)),e(t.respondWith(s,{status:a}))},window[o]=function(t){s=JSON.stringify(t)},t.abort=function(){i({type:"abort"})},t.params[r]=o,t.timeout&&setTimeout(t.abort,t.timeout),(n=document.createElement("script")).src=t.getUrl(),n.type="text/javascript",n.async=!0,n.onload=i,n.onerror=i,document.body.appendChild(n)}))}function Ja(t){return new wa((function(e){var i=new XMLHttpRequest,n=function(n){var r=t.respondWith("response"in i?i.response:i.responseText,{status:1223===i.status?204:i.status,statusText:1223===i.status?"No Content":Aa(i.statusText)});ja(Aa(i.getAllResponseHeaders()).split("\n"),(function(t){r.headers.append(t.slice(0,t.indexOf(":")),t.slice(t.indexOf(":")+1))})),e(r)};t.abort=function(){return i.abort()},i.open(t.method,t.getUrl(),!0),t.timeout&&(i.timeout=t.timeout),t.responseType&&"responseType"in i&&(i.responseType=t.responseType),(t.withCredentials||t.credentials)&&(i.withCredentials=!0),t.crossOrigin||t.headers.set("X-Requested-With","XMLHttpRequest"),Fa(t.progress)&&"GET"===t.method&&i.addEventListener("progress",t.progress),Fa(t.downloadProgress)&&i.addEventListener("progress",t.downloadProgress),Fa(t.progress)&&/^(POST|PUT)$/i.test(t.method)&&i.upload.addEventListener("progress",t.progress),Fa(t.uploadProgress)&&i.upload&&i.upload.addEventListener("progress",t.uploadProgress),t.headers.forEach((function(t,e){i.setRequestHeader(e,t)})),i.onload=n,i.onabort=n,i.onerror=n,i.ontimeout=n,i.send(t.getBody())}))}function Qa(t){var e=i(6608);return new wa((function(i){var n,r=t.getUrl(),o=t.getBody(),s=t.method,a={};t.headers.forEach((function(t,e){a[e]=t})),e(r,{body:o,method:s,headers:a}).then(n=function(e){var n=t.respondWith(e.body,{status:e.statusCode,statusText:Aa(e.statusMessage)});ja(e.headers,(function(t,e){n.headers.set(e,t)})),i(n)},(function(t){return n(t.response)}))}))}function tl(t){return(t.client||(Ia?Ja:Qa))(t)}var el=function(){function t(t){var e=this;this.map={},ja(t,(function(t,i){return e.append(i,t)}))}var e=t.prototype;return e.has=function(t){return null!==il(this.map,t)},e.get=function(t){var e=this.map[il(this.map,t)];return e?e.join():null},e.getAll=function(t){return this.map[il(this.map,t)]||[]},e.set=function(t,e){this.map[function(t){if(/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return Aa(t)}(il(this.map,t)||t)]=[Aa(e)]},e.append=function(t,e){var i=this.map[il(this.map,t)];i?i.push(Aa(e)):this.set(t,e)},e.delete=function(t){delete this.map[il(this.map,t)]},e.deleteAll=function(){this.map={}},e.forEach=function(t,e){var i=this;ja(this.map,(function(n,r){ja(n,(function(n){return t.call(e,n,r,i)}))}))},t}();function il(t,e){return Object.keys(t).reduce((function(t,i){return ka(e)===ka(i)?i:t}),null)}var nl=function(){function t(t,e){var i,n=e.url,r=e.headers,o=e.status,s=e.statusText;this.url=n,this.ok=o>=200&&o<300,this.status=o||0,this.statusText=s||"",this.headers=new el(r),this.body=t,Ra(t)?this.bodyText=t:(i=t,"undefined"!=typeof Blob&&i instanceof Blob&&(this.bodyBlob=t,function(t){return 0===t.type.indexOf("text")||-1!==t.type.indexOf("json")}(t)&&(this.bodyText=function(t){return new wa((function(e){var i=new FileReader;i.readAsText(t),i.onload=function(){e(i.result)}}))}(t))))}var e=t.prototype;return e.blob=function(){return Da(this.bodyBlob)},e.text=function(){return Da(this.bodyText)},e.json=function(){return Da(this.text(),(function(t){return JSON.parse(t)}))},t}();Object.defineProperty(nl.prototype,"data",{get:function(){return this.body},set:function(t){this.body=t}});var rl=function(){function t(t){this.body=null,this.params={},Na(this,t,{method:Pa(t.method||"GET")}),this.headers instanceof el||(this.headers=new el(this.headers))}var e=t.prototype;return e.getUrl=function(){return Ka(this)},e.getBody=function(){return this.body},e.respondWith=function(t,e){return new nl(t,Na(e||{},{url:this.getUrl()}))},t}(),ol={"Content-Type":"application/json;charset=utf-8"};function sl(t){var e=this||{},i=function(t){var e=[tl],i=[];function n(n){for(;e.length;){var r=e.pop();if(Fa(r)){var o=function(){var e=void 0,o=void 0;if(Ma(e=r.call(t,n,(function(t){return o=t}))||o))return{v:new wa((function(n,r){i.forEach((function(i){e=Da(e,(function(e){return i.call(t,e)||e}),r)})),Da(e,n,r)}),t)};Fa(e)&&i.unshift(e)}();if("object"==typeof o)return o.v}else s="Invalid interceptor of type "+typeof r+", must be a function","undefined"!=typeof console&&Ta&&console.warn("[VueResource warn]: "+s)}var s}return Ma(t)||(t=null),n.use=function(t){e.push(t)},n}(e.$vm);return function(t){Ea.call(arguments,1).forEach((function(e){for(var i in e)void 0===t[i]&&(t[i]=e[i])}))}(t||{},e.$options,sl.options),sl.interceptors.forEach((function(t){Ra(t)&&(t=sl.interceptor[t]),Fa(t)&&i.use(t)})),i(new rl(t)).then((function(t){return t.ok?t:wa.reject(t)}),(function(t){var e;return t instanceof Error&&(e=t,"undefined"!=typeof console&&console.error(e)),wa.reject(t)}))}function al(t,e,i,n){var r=this||{},o={};return ja(i=Na({},al.actions,i),(function(i,s){i=Ba({url:t,params:Na({},e)},n,i),o[s]=function(){return(r.$http||sl)(ll(i,arguments))}})),o}function ll(t,e){var i,n=Na({},t),r={};switch(e.length){case 2:r=e[0],i=e[1];break;case 1:/^(POST|PUT|PATCH)$/i.test(n.method)?i=e[0]:r=e[0];break;case 0:break;default:throw"Expected up to 2 arguments [params, body], got "+e.length+" arguments"}return n.body=i,n.params=Na({},n.params,r),n}function ul(t){ul.installed||(!function(t){var e=t.config,i=t.nextTick;Sa=i,Ta=e.debug||!e.silent}(t),t.url=Ka,t.http=sl,t.resource=al,t.Promise=wa,Object.defineProperties(t.prototype,{$url:{get:function(){return $a(t.url,this,this.$options.url)}},$http:{get:function(){return $a(t.http,this,this.$options.http)}},$resource:{get:function(){return t.resource.bind(this)}},$promise:{get:function(){var e=this;return function(i){return new t.Promise(i,e)}}}}))}sl.options={},sl.headers={put:ol,post:ol,patch:ol,delete:ol,common:{Accept:"application/json, text/plain, */*"},custom:{}},sl.interceptor={before:function(t){Fa(t.before)&&t.before.call(this,t)},method:function(t){t.emulateHTTP&&/^(PUT|PATCH|DELETE)$/i.test(t.method)&&(t.headers.set("X-HTTP-Method-Override",t.method),t.method="POST")},jsonp:function(t){"JSONP"==t.method&&(t.client=Za)},json:function(t){var e=t.headers.get("Content-Type")||"";return Ma(t.body)&&0===e.indexOf("application/json")&&(t.body=JSON.stringify(t.body)),function(t){return t.bodyText?Da(t.text(),(function(e){if(0===(t.headers.get("Content-Type")||"").indexOf("application/json")||function(t){var e=t.match(/^\s*(\[|\{)/),i={"[":/]\s*$/,"{":/}\s*$/};return e&&i[e[1]].test(t)}(e))try{t.body=JSON.parse(e)}catch(e){t.body=null}else t.body=e;return t})):t}},form:function(t){var e;e=t.body,"undefined"!=typeof FormData&&e instanceof FormData?t.headers.delete("Content-Type"):Ma(t.body)&&t.emulateJSON&&(t.body=Ka.params(t.body),t.headers.set("Content-Type","application/x-www-form-urlencoded"))},header:function(t){ja(Na({},sl.headers.common,t.crossOrigin?{}:sl.headers.custom,sl.headers[ka(t.method)]),(function(e,i){t.headers.has(i)||t.headers.set(i,e)}))},cors:function(t){if(Ia){var e=Ka.parse(location.href),i=Ka.parse(t.getUrl());i.protocol===e.protocol&&i.host===e.host||(t.crossOrigin=!0,t.emulateHTTP=!1,Ha||(t.client=Ya))}}},sl.interceptors=["before","method","jsonp","json","form","header","cors"],["get","delete","head","jsonp"].forEach((function(t){sl[t]=function(e,i){return this(Na(i||{},{url:e,method:t}))}})),["post","put","patch"].forEach((function(t){sl[t]=function(e,i,n){return this(Na(n||{},{url:e,method:t,body:i}))}})),al.actions={get:{method:"GET"},save:{method:"POST"},query:{method:"GET"},update:{method:"PUT"},remove:{method:"DELETE"},delete:{method:"DELETE"}},"undefined"!=typeof window&&window.Vue&&!window.Vue.resource&&window.Vue.use(ul);const hl=ul;i(8227);var cl,dl=Array.prototype,fl=new Error("Passed arguments must be of Node"),pl=[],gl=[];const ml=function(){if("undefined"!=typeof window){function t(t){return t instanceof window.Node}function e(t){return t instanceof window.NodeList||t instanceof u||t instanceof window.HTMLCollection||t instanceof Array}class u{constructor(e){var i=e;if(e[0]===window?i=[window]:"string"==typeof e[0]?(i=(e[1]||document).querySelectorAll(e[0]),e[1]&&(this.owner=e[1])):0 in e&&!t(e[0])&&e[0]&&"length"in e[0]&&(i=e[0],e[1]&&(this.owner=e[1])),i){for(var n in i)this[n]=i[n];this.length=i.length}else this.length=0;window.prueba=this}concat(...i){var n=dl.slice.call(this);function r(i){dl.forEach.call(i,(i=>{t(i)?~n.indexOf(i)||n.push(i):e(i)&&r(i)}))}return dl.forEach.call(i,(i=>{if(t(i))~n.indexOf(i)||n.push(i);else{if(!e(i))throw Error("Concat arguments must be of a Node, NodeList, HTMLCollection, or Array of (Node, NodeList, HTMLCollection, Array)");r(i)}})),l(n,this)}delete(){var t=n(this).filter((t=>(t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t),document.body.contains(t))));return t.length&&console.warn("NodeList: Some nodes could not be deleted."),t}each(...t){return dl.forEach.apply(this,t),this}filter(...t){return l(dl.filter.apply(this,t),this)}find(i){var r=[];if("string"==typeof i&&n(this).forEach((t=>{r.push(t.querySelectorAll(i))})),t(i)&&n(this).forEach((t=>{t!==i&&t.contains(i)&&r.push(i)})),e(i)){var o=n(i);n(this).forEach((t=>{o.forEach((e=>{t!==e&&t.contains(e)&&r.push(e)}))}))}return n(r,this.owner)}forEach(...t){return dl.forEach.apply(this,t),this}includes(t,e){return~this.indexOf(t,e)}map(...i){var r=dl.map.apply(this,i);return r.some((i=>t(i)||e(i)))?n(r,this):r}parent(){return n(this.map((t=>t.parentNode)),this)}pop(t){"number"!=typeof t&&(t=1);for(var e=[],i=dl.pop.bind(this);t--;)e.push(i());return l(e,this)}push(...e){return dl.forEach.call(e,(e=>{if(!t(e))throw fl;~this.indexOf(e)||dl.push.call(this,e)})),this}shift(t){"number"!=typeof t&&(t=1);for(var e=[];t--;)e.push(dl.shift.call(this));return 1==e.length?e[0]:l(e,this)}slice(...t){return l(dl.slice.apply(this,t),this)}splice(...e){for(var i=2,n=e.length;i<n;i++)if(!t(e[i]))throw fl;return dl.splice.apply(this,e),this}unshift(...e){var i=dl.unshift.bind(this);return dl.forEach.call(e,(e=>{if(!t(e))throw fl;~this.indexOf(e)||i(e)})),this}addClass(t){return this.toggleClass(t,!0)}removeClass(t){return this.toggleClass(t,!1)}toggleClass(t,e=null){var i=null==e?"toggle":e?"add":"remove";return"string"==typeof t&&(t=t.trim().replace(/\s+/," ").split(" ")),this.each((e=>t.forEach((t=>e.classList[i](t)))))}get(t){var e=[];return this.each((i=>{null!==i&&(i=i[t]),e.push(i)})),n(e,this)}set(t,e){return t.constructor===Object?this.each((e=>{if(e)for(var i in t)i in e&&(e[i]=t[i])})):this.each((i=>{t in i&&(i[t]=e)})),this}call(...t){const e=dl.shift.call(t);let i=[],r=!0;return this.each((n=>{n&&n[e]instanceof Function?(n=n[e].apply(n,t),i.push(n),r&&void 0!==n&&(r=!1)):i.push(void 0)})),r?this:n(i,this)}item(t){return l([this[t]],this)}get asArray(){return dl.slice.call(this)}on(e,i,n){if("string"==typeof e&&(e=e.trim().replace(/\s+/," ").split(" ")),!this||!this.length)return this;if(void 0===n&&(n=i,i=null),!n)return this;var r=n;return n=i?function(t){var e=l(i,this);e.length&&e.some((e=>{var i=e.contains(t.target);return i&&r.call(e,t,e),i}))}:function(t){r.apply(this,[t,this])},this.each((i=>{e.forEach((e=>{(i===window||t(i))&&(i.addEventListener(e,n,!1),gl.push({el:i,event:e,callback:n}))}))})),this}off(t,e){return t instanceof Function&&(e=t,t=null),t=t instanceof Array?t:"string"==typeof t?t.trim().replace(/\s+/," ").split(" "):null,this.each((i=>{gl=gl.filter((n=>!!(!n||n.el!==i||e&&e!==n.callback||t&&!~t.indexOf(n.event))||(n.el.removeEventListener(n.event,n.callback),!1)))})),this}onBlur(t){return this&&this.length&&t?(this.each((e=>{pl.push({el:e,callback:t})})),cl||(cl=t=>{pl.forEach((e=>{e.el.contains(t.target)||e.el===t.target||e.callback.call(e.el,t,e.el)}))},document.addEventListener("click",cl,!1),document.addEventListener("touchstart",cl,!1)),this):this}offBlur(t){return this.each((e=>{pl=pl.filter((i=>!(i&&i.el===e&&(!t||i.callback===t))&&e))})),this}}var i=u.prototype;function n(n,r){var o=[];return dl.forEach.call(n,(s=>{if(t(s))~o.indexOf(s)||o.push(s);else if(e(s))for(var a in s)~o.indexOf(s[a])||o.push(s[a]);else if(null!==s)return n.get=i.get,n.set=i.set,n.call=i.call,n.owner=r,n})),l(o,r)}var r=["join","copyWithin","fill","find","forEach"];Object.getOwnPropertyNames(dl).forEach((t=>{~r.indexOf(t)||void 0!==i[t]||(i[t]=dl[t])})),"undefined"!=typeof window&&window.Symbol&&Symbol.iterator&&(i[Symbol.iterator]=i.values=dl[Symbol.iterator]);var o=document.createElement("div");function s(t){i[t]||(o[t]instanceof Function?i[t]=(...e)=>{var r=[],o=!0;for(var s in i){var a=i[s];a&&a[t]instanceof Function?(a=a[t].apply(a,e),r.push(a),o&&void 0!==a&&(o=!1)):r.push(void 0)}return o?this:n(r,this)}:Object.defineProperty(i,t,{get(){var e=[];return this.each((i=>{null!==i&&(i=i[t]),e.push(i)})),n(e,this)},set(e){this.each((i=>{i&&t in i&&(i[t]=e)}))}}))}for(var a in o)s(a);function l(...t){return new u(t)}return window.NL=l,l}}(),vl={boolean:t=>"string"==typeof t?""===t||"true"===t||"false"!==t&&"null"!==t&&"undefined"!==t&&t:t,number:(t,e=null)=>"number"==typeof t?t:null==t||isNaN(Number(t))?e:Number(t),string:t=>null==t?"":t+"",pattern:t=>t instanceof Function||t instanceof RegExp?t:"string"==typeof t?new RegExp(t):null};function yl(t,e,i=100){function n(t){return/^[0-9]+$/.test(t)?Number(t)||1:null}var r;return function(...o){r&&clearTimeout(r),r=setTimeout((()=>{t.apply(this,o)}),n(e)||n(this[e])||i)}}var _l=[];function bl(t){_l.forEach((e=>{e.node.contains(t.target)||e.callback(t)}))}function wl(t,e){_l.length||document.addEventListener("click",bl,!1),_l.push({node:t,callback:e})}function xl(t,e){(_l=_l.filter((i=>i.node!==t||!!e&&i.callback!==e))).length||document.removeEventListener("click",bl,!1)}const Sl={bind(t,e){xl(t,e.value),"function"!=typeof e.value||wl(t,e.value)},update(t,e){e.value!==e.oldValue&&(xl(t,e.oldValue),wl(t,e.value))},unbind(t,e){xl(t,e.value)}},Cl="_vue_scroll_handler",El=["resize","scroll"];function Tl(t,e){Il(t);var i=e.value;"function"!=typeof i||(t[Cl]=function(t){i(t)},El.forEach((function(e){window.addEventListener(e,t[Cl],!1)})),document.addEventListener("load",t[Cl],!1),setTimeout((function(){t[Cl]()}),0))}function Il(t){El.forEach((function(e){window.removeEventListener(e,t[Cl],!1)})),document.removeEventListener("load",t[Cl],!1),delete t[Cl]}const Al={bind:Tl,unbind:Il,update(t,e){e.value!==e.oldValue&&Tl(t,e)}};const kl={props:{dismissable:{type:Boolean,default:!1},duration:{default:0},placement:{type:String},type:{type:String},value:{type:Boolean,default:!0},width:{type:String}},data(){return{val:this.value}},computed:{durationNum(){return vl.number(this.duration,0)}},watch:{val(t){t&&this.durationNum>0&&this._delayClose(),this.$emit("input",t)},value(t){this.val!==t&&(this.val=t)}},created(){this._delayClose=yl((function(){this.val=!1}),"durationNum")}};var Pl=i(3379),Ll=i.n(Pl),Rl=i(6187),Fl={insert:"head",singleton:!1};Ll()(Rl.Z,Fl);Rl.Z.locals;function Ml(t,e,i,n,r,o,s,a){var l,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=i,u._compiled=!0),n&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=l):r&&(l=a?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var h=u.render;u.render=function(t,e){return l.call(e),h(t,e)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,l):[l]}return{exports:t,options:u}}const Ol=Ml(kl,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.val,expression:"val"}],class:["alert","alert-"+t.type,t.placement],style:{width:t.width},attrs:{role:"alert"}},[i("button",{directives:[{name:"show",rawName:"v-show",value:t.dismissable,expression:"dismissable"}],staticClass:"close",attrs:{type:"button"},on:{click:function(e){t.val=!1}}},[i("span",[t._v("×")])]),t._v(" "),t._t("default")],2)])}),[],!1,null,null,null).exports;const Dl={props:{value:{type:String},format:{default:"MM/dd/yyyy"},disabledDaysOfWeek:{type:Array,default:()=>[]},width:{type:String},clearButton:{type:Boolean,default:!1},lang:{type:String,default:"undefined"!=typeof navigator?navigator.language:"zh-CN"},placeholder:{type:String},iconsFont:{type:String,default:"glyphicon"}},data(){return{currDate:new Date,dateRange:[],decadeRange:[],displayDayView:!1,displayMonthView:!1,displayYearView:!1,val:this.value}},watch:{currDate(){this.getDateRange()},format(){this.val=this.stringify(this.currDate)},val(t,e){this.$emit("input",t)},value(t){this.val!==t&&(this.val=t)}},computed:{text(){return function(t="en"){return"undefined"!=typeof window&&window.VueStrapLang?window.VueStrapLang(t):{daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],limit:"Limit reached ({{limit}} items max).",loading:"Loading...",minLength:"Min. Length",months:["January","February","March","April","May","June","July","August","September","October","November","December"],notSelected:"Nothing Selected",required:"Required",search:"Search"}}(this.lang)},preBtnClasses(){return`datepicker-preBtn ${this.iconsFont} ${this.iconsFont}-chevron-left`},nextBtnClasses(){return`datepicker-nextBtn ${this.iconsFont} ${this.iconsFont}-chevron-right`},disabledDaysArray(){return this.disabledDaysOfWeek.map((t=>parseInt(t,10)))}},methods:{close(){this.displayDayView=this.displayMonthView=this.displayYearView=!1},inputClick(){this.currDate=this.parse(this.val)||this.parse(new Date),this.displayMonthView||this.displayYearView?this.displayDayView=!1:this.displayDayView=!this.displayDayView},preNextDecadeClick(t){const e=this.currDate.getFullYear(),i=this.currDate.getMonth(),n=this.currDate.getDate();this.currDate=0===t?new Date(e-10,i,n):new Date(e+10,i,n)},preNextMonthClick(t){const e=this.currDate.getFullYear(),i=this.currDate.getMonth(),n=this.currDate.getDate();if(0===t){const t=this.getYearMonth(e,i-1);this.currDate=new Date(t.year,t.month,n)}else{const t=this.getYearMonth(e,i+1);this.currDate=new Date(t.year,t.month,n)}},preNextYearClick(t){const e=this.currDate.getFullYear(),i=this.currDate.getMonth(),n=this.currDate.getDate();this.currDate=0===t?new Date(e-1,i,n):new Date(e+1,i,n)},yearSelect(t){this.displayYearView=!1,this.displayMonthView=!0,this.currDate=new Date(t,this.currDate.getMonth(),this.currDate.getDate())},daySelect(t){if("datepicker-item-disable"===t.sclass)return!1;this.currDate=t.date,this.val=this.stringify(this.currDate),this.displayDayView=!1},switchMonthView(){this.displayDayView=!1,this.displayMonthView=!0},switchDecadeView(){this.displayMonthView=!1,this.displayYearView=!0},monthSelect(t){this.displayMonthView=!1,this.displayDayView=!0,this.currDate=new Date(this.currDate.getFullYear(),t,this.currDate.getDate())},getYearMonth:(t,e)=>(e>11?(t++,e=0):e<0&&(t--,e=11),{year:t,month:e}),stringifyDecadeHeader(t){const e=t.getFullYear().toString(),i=e.substring(0,e.length-1)+0;return i+"-"+(parseInt(i,10)+10)},stringifyDayHeader(t){return this.text.months[t.getMonth()]+" "+t.getFullYear()},parseMonth(t){return this.text.months[t.getMonth()]},stringifyYearHeader:t=>t.getFullYear(),stringify(t,e=this.format){if(t||(t=this.parse()),!t)return"";const i=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),o=this.parseMonth(t);return e.replace(/yyyy/g,i).replace(/yy/g,i).replace(/MMMM/g,o).replace(/MMM/g,o.substring(0,3)).replace(/MM/g,("0"+n).slice(-2)).replace(/M(?!a)/g,n).replace(/dd/g,("0"+r).slice(-2)).replace(/d/g,r)},parse(t){if(null==t&&(t=this.val),!t)return new Date;let e=10!==t.length||"dd-MM-yyyy"!==this.format&&"dd/MM/yyyy"!==this.format?new Date(t):new Date(t.substring(6,10),t.substring(3,5)-1,t.substring(0,2));return isNaN(e.getFullYear())?new Date:e},getDayCount:(t,e)=>1===e&&(t%400==0||t%4==0&&t%100!=0)?29:[31,28,31,30,31,30,31,31,30,31,30,31][e],getDateRange(){this.dateRange=[],this.decadeRange=[];const t={year:this.currDate.getFullYear(),month:this.currDate.getMonth(),day:this.currDate.getDate()},e=t.year.toString(),i=e.substring(0,e.length-1)+0-1;for(let t=0;t<12;t++)this.decadeRange.push({text:i+t});let n=new Date(t.year,t.month,1).getDay()+1;0===n&&(n=7);const r=this.getDayCount(t.year,t.month);if(n>1){const e=this.getYearMonth(t.year,t.month-1),i=this.getDayCount(e.year,e.month);for(let t=1;t<n;t++){const r=i-n+t+1,o=new Date(e.year,e.month,r);let s="datepicker-item-gray";this.disabledDaysArray.indexOf(o.getDay())>-1&&(s="datepicker-item-disable"),this.dateRange.push({text:r,date:o,sclass:s})}}for(let e=1;e<=r;e++){const i=new Date(t.year,t.month,e);let n="";this.disabledDaysArray.indexOf(i.getDay())>-1&&(n="datepicker-item-disable"),e==t.day&&i.getFullYear()==t.year&&i.getMonth()==t.month&&(n="datepicker-dateRange-item-active"),this.dateRange.push({text:e,date:i,sclass:n})}if(this.dateRange.length<42){const e=42-this.dateRange.length,i=this.getYearMonth(t.year,t.month+1);for(let t=1;t<=e;t++){const e=new Date(i.year,i.month,t);let n="datepicker-item-gray";this.disabledDaysArray.indexOf(e.getDay())>-1&&(n="datepicker-item-disable"),this.dateRange.push({text:t,date:e,sclass:n})}}}},mounted(){this.$emit("child-created",this),this.currDate=this.parse(this.val)||this.parse(new Date),this._blur=t=>{this.$el.contains(t.target)||this.close()},window.addEventListener("click",this._blur)},beforeDestroy(){window.removeEventListener("click",this._blur)}};var $l=i(5608),jl={insert:"head",singleton:!1};Ll()($l.Z,jl);$l.Z.locals;const Nl=Ml(Dl,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"datepicker"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"form-control datepicker-input",class:{"with-reset-button":t.clearButton},style:{width:t.width},attrs:{type:"text",placeholder:t.placeholder},domProps:{value:t.val},on:{click:t.inputClick,input:function(e){e.target.composing||(t.val=e.target.value)}}}),t._v(" "),t.clearButton&&t.val?i("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){t.val=""}}},[i("span",[t._v("×")])]):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.displayDayView,expression:"displayDayView"}],staticClass:"datepicker-popup"},[i("div",{staticClass:"datepicker-inner"},[i("div",{staticClass:"datepicker-body"},[i("div",{staticClass:"datepicker-ctrl"},[i("span",{class:t.preBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextMonthClick(0)}}}),t._v(" "),i("span",{class:t.nextBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextMonthClick(1)}}}),t._v(" "),i("p",{on:{click:t.switchMonthView}},[t._v(t._s(t.stringifyDayHeader(t.currDate)))])]),t._v(" "),i("div",{staticClass:"datepicker-weekRange"},t._l(t.text.daysOfWeek,(function(e){return i("span",[t._v(t._s(e))])})),0),t._v(" "),i("div",{staticClass:"datepicker-dateRange"},t._l(t.dateRange,(function(e){return i("span",{class:e.sclass,on:{click:function(i){return t.daySelect(e)}}},[t._v(t._s(e.text))])})),0)])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.displayMonthView,expression:"displayMonthView"}],staticClass:"datepicker-popup"},[i("div",{staticClass:"datepicker-inner"},[i("div",{staticClass:"datepicker-body"},[i("div",{staticClass:"datepicker-ctrl"},[i("span",{class:t.preBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextYearClick(0)}}}),t._v(" "),i("span",{class:t.nextBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextYearClick(1)}}}),t._v(" "),i("p",{on:{click:t.switchDecadeView}},[t._v(t._s(t.stringifyYearHeader(t.currDate)))])]),t._v(" "),i("div",{staticClass:"datepicker-monthRange"},[t._l(t.text.months,(function(e,n){return[i("span",{class:{"datepicker-dateRange-item-active":t.text.months[t.parse(t.val).getMonth()]===e&&t.currDate.getFullYear()===t.parse(t.val).getFullYear()},domProps:{textContent:t._s(e.substr(0,3))},on:{click:function(e){return t.monthSelect(n)}}})]}))],2)])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.displayYearView,expression:"displayYearView"}],staticClass:"datepicker-popup"},[i("div",{staticClass:"datepicker-inner"},[i("div",{staticClass:"datepicker-body"},[i("div",{staticClass:"datepicker-ctrl"},[i("span",{class:t.preBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextDecadeClick(0)}}}),t._v(" "),i("span",{class:t.nextBtnClasses,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.preNextDecadeClick(1)}}}),t._v(" "),i("p",[t._v(t._s(t.stringifyDecadeHeader(t.currDate)))])]),t._v(" "),i("div",{staticClass:"datepicker-monthRange decadeRange"},[t._l(t.decadeRange,(function(e){return[i("span",{class:{"datepicker-dateRange-item-active":t.parse(t.val).getFullYear()===e.text},domProps:{textContent:t._s(e.text)},on:{click:function(i){return i.stopPropagation(),t.yearSelect(e.text)}}})]}))],2)])])])])}),[],!1,null,null,null).exports;const Bl=Ml({directives:{ClickOutside:Sl},props:{disabled:{type:Boolean,default:!1},size:{type:String,default:null},text:{type:String,default:null},type:{type:String,default:"default"},value:{type:Boolean,default:!1}},data(){return{show:this.value}},watch:{show(t){this.$emit("input",t)},value(t){this.show=t}},computed:{buttonSize(){return~["lg","sm","xs"].indexOf(this.size)?"btn-"+this.size:""},inInput(){return this.$parent._input},isLi(){return this.$parent._isTabs||this.$parent._navbar||this.$parent.menu},menu(){return!this.$parent||this.$parent.navbar},slots(){return this._slotContents},submenu(){return this.$parent&&(this.$parent.menu||this.$parent.submenu)}},methods:{blur(){this.show=!1},toggle(){this.disabled||(this.show=!this.show)}},mounted(){ml("ul",this.$el).on("click","li>a",(t=>{this.show=!1}))},beforeDestroy(){ml("ul",this.$el).off()}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(t.isLi?"li":"div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.blur,expression:"blur"}],tag:"div",class:[{open:t.show,disabled:t.disabled,dropdown:t.isLi,"input-group-btn":t.inInput,"btn-group":!t.isLi&&!t.inInput}]},[t._t("before"),t._v(" "),t.isLi?i("a",{class:["dropdown-toggle",t.buttonSize,{disabled:t.disabled}],attrs:{role:"button"},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.show=!1},click:function(e){return e.preventDefault(),t.toggle(e)}}},[t._t("button",[t._v(t._s(t.text))]),t._v(" "),i("span",{staticClass:"caret"})],2):i("button",{class:["btn btn-"+t.type,t.buttonSize,"dropdown-toggle"],attrs:{type:"button",disabled:t.disabled},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"]))return null;t.show=!1},click:function(e){return e.preventDefault(),t.toggle(e)}}},[t._t("button",[t._v(t._s(t.text))]),t._v(" "),i("span",{staticClass:"caret"})],2),t._v(" "),t._t("dropdown-menu",[i("ul",{staticClass:"dropdown-menu"},[t._t("default")],2)])],2)}),[],!1,null,null,null).exports;const Ul={mixins:[{props:{content:{type:String},effect:{type:String,default:"fade"},header:{type:Boolean,default:!0},placement:{type:String,default:"top"},title:{type:String},trigger:{type:String}},data:()=>({top:0,left:0,show:!1}),computed:{events(){return{contextmenu:["contextmenu"],hover:["mouseleave","mouseenter"],focus:["blur","focus"]}[this.trigger]||["click"]}},methods:{beforeEnter(){this.position(),setTimeout((()=>this.position()),30)},position(){this.$nextTick((()=>{var t=this.$refs.popover,e=this.$refs.trigger.children[0];switch(this.placement){case"top":this.left=e.offsetLeft-t.offsetWidth/2+e.offsetWidth/2,this.top=e.offsetTop-t.offsetHeight;break;case"left":this.left=e.offsetLeft-t.offsetWidth,this.top=e.offsetTop+e.offsetHeight/2-t.offsetHeight/2;break;case"right":this.left=e.offsetLeft+e.offsetWidth,this.top=e.offsetTop+e.offsetHeight/2-t.offsetHeight/2;break;case"bottom":this.left=e.offsetLeft-t.offsetWidth/2+e.offsetWidth/2,this.top=e.offsetTop+e.offsetHeight;break;default:console.warn("Wrong placement prop")}t.style.top=this.top+"px",t.style.left=this.left+"px"}))},toggle(t){t&&"contextmenu"===this.trigger&&t.preventDefault(),this.show=!this.show,this.show&&this.beforeEnter()}},mounted(){let t=this.$refs.trigger.children[0];if(!t)return console.error("Could not find trigger v-el in your component that uses popoverMixin.");("focus"!==this.trigger||~t.tabIndex||(t=ml("a,input,select,textarea,button",t),t.length))&&this.events.forEach((e=>{ml(t).on(e,this.toggle)}))},beforeDestroy(){this._trigger&&ml(this._trigger).off()}}],props:{trigger:{type:String,default:"click"}}};var Gl=i(8518),Vl={insert:"head",singleton:!1};Ll()(Gl.Z,Vl);Gl.Z.locals;const zl=Ml(Ul,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{ref:"trigger"},[t._t("default"),t._v(" "),i("transition",{attrs:{name:t.effect}},[t.show?i("div",{ref:"popover",class:["popover",t.placement]},[i("div",{staticClass:"arrow"}),t._v(" "),t.title?i("h3",{staticClass:"popover-title"},[t._t("title",[t._v(t._s(t.title))])],2):t._e(),t._v(" "),i("div",{staticClass:"popover-content"},[t._t("content",[i("span",{domProps:{innerHTML:t._s(t.content)}})])],2)]):t._e()])],2)}),[],!1,null,null,null).exports;const ql=Ml({props:{disabled:{type:Boolean,default:!1},header:{type:String}},data:()=>({fadein:!1}),computed:{active(){var t=!this._tabs||this._tabs.show===this;return this.fadein=!1,t&&setTimeout((()=>{this.fadein=!0}),0),t},index(){return this._tabs.tabs.indexOf(this)},transition(){return this._tabs?this._tabs.effect:null}},created(){this._isTab=!0;let t=this;for(;!this._tabs&&t.$parent;)t._isTabGroup&&(t.tabs.push(this),this._tabGroup=t),t._isTabs&&(t.tabs.push(this),this._tabs=t,this._tabGroup||t.headers.push(this)),t=t.$parent;if(!this._tabs)throw Error("tab depend on tabs.")},beforeDestroy(){if(this._tabGroup&&(this._tabGroup.tabs=this._tabGroup.tabs.filter((t=>t!==this))),this._tabs&&(this._tabs.tabs=this._tabs.tabs.filter((t=>t!==this))),this._tabs&&(this._tabs.active===this.index&&(this._tabs.index=0),this._ingroup)){let t=this.$parent.tabs.indexOf(this);~t&&this.$parent.tabs.splice(t,1)}if(this._tabs){let t=this._tabs.tabs.indexOf(this);~t&&this._tabs.tabs.splice(t,1)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{ref:"panel",class:["tab-pane",{"active fade":t.active,in:t.fadein}],attrs:{role:"tabpanel"}},[t._t("default")],2)}),[],!1,null,null,null).exports;const Wl={props:{disabled:{type:Boolean,default:!1},header:{type:String}},data:()=>({show:!1,tabs:[]}),computed:{active(){return~this.tabs.indexOf(this._tabs.show)}},methods:{blur(){this.show=!1},toggle(){this.show=!this.show}},created(){if(this._isTabGroup=!0,this.$parent){if(this.$parent._isTabGroup)throw Error("Can't nest tab-groups.");if(!this.$parent._isTabs)throw Error("tab-group depend on tabs.")}this._tabs=this.$parent,this._tabs.headers.push(this)}};var Kl=i(3698),Xl={insert:"head",singleton:!1};Ll()(Kl.Z,Xl);Kl.Z.locals;const Yl=Ml(Wl,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",[t._t("default")],2)}),[],!1,null,null,null).exports;const Hl={components:{dropdown:Bl},props:{justified:!1,navStyle:{type:String,default:null},value:{type:Number,default:0}},data(){return{index:this.value||0,headers:[],tabs:[]}},watch:{index(t){this.$emit("active",t),this.$emit("input",t)},value(t){this.index=t}},computed:{navStyleClass(){return["nav",~["pills","stacked"].indexOf(this.navStyle)?"nav-"+this.navStyle:"nav-tabs",{"nav-justified":vl.boolean(this.justified),"nav-pills":"stacked"===this.navStyle}]},show(){return this.tabs[this.index]||this.tabs[0]}},methods:{select(t){t.disabled||(this.index=this.tabs.indexOf(t))}},created(){this._isTabs=!0}};var Zl=i(5306),Jl={insert:"head",singleton:!1};Ll()(Zl.Z,Jl);Zl.Z.locals;const Ql=Ml(Hl,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{tabs:""}},[i("ul",{class:t.navStyleClass,attrs:{role:"tablist"}},[t._l(t.headers,(function(e){return[e._isTab?i("li",{class:{active:e.active,disabled:e.disabled},on:{click:function(i){return i.preventDefault(),t.select(e)}}},[t._t("header",[i("a",{attrs:{href:"#"},domProps:{innerHTML:t._s(e.header)}})])],2):t._e(),t._v(" "),e._isTabGroup?i("dropdown",{class:{active:e.active},attrs:{text:e.header,disabled:e.disabled}},t._l(e.tabs,(function(e){return i("li",{class:{disabled:e.disabled}},[i("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.select(e)}}},[t._v(t._s(e.header))])])})),0):t._e()]}))],2),t._v(" "),i("div",{staticClass:"tab-content"},[t._t("default")],2)])}),[],!1,null,null,null).exports;const tu={props:{async:{type:String},data:{type:Array},delay:{type:Number,default:300},asyncKey:{type:String,default:null},limit:{type:Number,default:8},matchCase:{type:Boolean,default:!1},matchStart:{type:Boolean,default:!1},matchProperty:{type:String},onHit:{type:Function,default:t=>t},placeholder:{type:String},template:{type:String},type:{type:String,default:"text"},value:{type:String,default:""}},data(){return{asign:"",showDropdown:!1,noResults:!0,current:0,items:[],val:this.value}},computed:{templateComp(){return{template:"string"==typeof this.template?"<span>"+this.template+"</span>":this.template,props:{item:{default:null}}}}},watch:{val(t,e){this.$emit("input",t),t!==e&&t!==this.asign&&this.__update()},value(t){this.val!==t&&(this.val=t)}},methods:{setItems(t){this.async?(this.items=this.asyncKey?t[this.asyncKey]:t,this.items=this.items.slice(0,this.limit)):this.items=(t||[]).filter((t=>{if("object"==typeof t){if(!this.matchProperty)return!0;t=t[this.matchProperty]}t=this.matchCase?t:t.toLowerCase();var e=this.matchCase?this.val:this.val.toLowerCase();return this.matchStart?0===t.indexOf(e):-1!==t.indexOf(e)})).slice(0,this.limit),this.showDropdown=this.items.length>0},setValue(t){this.asign=t,this.val=t,this.items=[],this.loading=!1,this.showDropdown=!1,this.current=0},clear(){this.reset(),this.$emit("clear")},reset(){this.setValue(null)},setActive(t){this.current=t},isActive(t){return this.current===t},hit(){0!==this.items.length&&this.setValue(this.onHit(this.items[this.current],this))},up(){this.current>0?this.current--:this.current=this.items.length-1},down(){this.current<this.items.length-1?this.current++:this.current=0}},created(){this.__update=yl((function(){this.val?(this.asign="",this.async?function(t){var e=new window.XMLHttpRequest,i={},n={then:(t,e)=>n.done(t).fail(e),catch:t=>n.fail(t),always:t=>n.done(t).fail(t)};return["done","fail"].forEach((t=>{i[t]=[],n[t]=e=>(e instanceof Function&&i[t].push(e),n)})),n.done(JSON.parse),e.onreadystatechange=()=>{if(4===e.readyState){let o={status:e.status};if(200===e.status)try{var t=e.responseText;for(var n in i.done){var r=i.done[n](t);void 0!==r&&(t=r)}}catch(t){i.fail.forEach((e=>e(t)))}else i.fail.forEach((t=>t(o)))}},e.open("GET",t),e.setRequestHeader("Accept","application/json"),e.send(),n}(this.async+this.val).then((t=>{this.setItems(t)})):this.data&&this.setItems(this.data)):this.reset()}),"delay",300)}};var eu=i(9118),iu={insert:"head",singleton:!1};Ll()(eu.Z,iu);eu.Z.locals;const nu=Ml(tu,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:{open:t.showDropdown},style:{position:"relative"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.val,expression:"val"}],staticClass:"form-control",attrs:{autocomplete:"off",placeholder:t.placeholder,type:t.type},domProps:{value:t.val},on:{blur:function(e){t.showDropdown=!1},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.down(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.hit(e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.clear(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.up(e))}],input:function(e){e.target.composing||(t.val=e.target.value)}}}),t._v(" "),i("ul",{ref:"dropdown",staticClass:"dropdown-menu"},t._l(t.items,(function(e,n){return i("li",{class:{active:t.isActive(n)}},[i("a",{on:{mousedown:function(e){return e.preventDefault(),t.hit(e)},mousemove:function(e){return t.setActive(n)}}},[i(t.templateComp,{tag:"component",attrs:{item:e}})],1)])})),0)])}),[],!1,null,null,null).exports;const ru={directives:{ClickOutside:Sl,Scroll:Al},utils:{$:ml,coerce:vl},alert:Ol,datepicker:Nl,dropdown:Bl,popover:zl,tab:ql,tabGroup:Yl,tabs:Ql,typeahead:nu};window.Vue=ya,window.Vue.use(hl),window.VueStrap=ru;var ou=function(t,e){window.addEventListener("load",(function(){var i=document.getElementById(t);i&&(e instanceof Vue||(e=new Vue(e)),e.$mount(i))}))},su=function(t){t=Array.isArray(t)?t:t.split("."),window.biigle||(window.biigle={});for(var e=window.biigle,i=0,n=t.length;i<n;i++)e.hasOwnProperty(t[i])||(e[t[i]]={}),e=e[t[i]];return e};const au=Vue.resource("api/v1/annotations{/id}",{},{attachLabel:{method:"POST",url:"api/v1/annotations{/id}/labels"},detachLabel:{method:"DELETE",url:"api/v1/annotation-labels{/annotation_label_id}"}}),lu=Vue.resource("api/v1/images{/id}",{},{getFile:{method:"GET",url:"api/v1/images{/id}/file"},getAnnotations:{method:"GET",url:"api/v1/images{/id}/annotations"},saveAnnotations:{method:"POST",url:"api/v1/images{/id}/annotations"}}),uu=Vue.resource("api/v1/labels{/id}",{},{save:{method:"POST",url:"api/v1/label-trees{/label_tree_id}/labels"}}),hu=Vue.resource("api/v1/label-sources{/id}/find"),cu=Vue.resource("api/v1/label-trees{/id}",{},{addAuthorizedProject:{method:"POST",url:"api/v1/label-trees{/id}/authorized-projects"},removeAuthorizedProject:{method:"DELETE",url:"api/v1/label-trees{/id}/authorized-projects{/project_id}"},addUser:{method:"POST",url:"api/v1/label-trees{/id}/users"},updateUser:{method:"PUT",url:"api/v1/label-trees{/id}/users{/user_id}"},removeUser:{method:"DELETE",url:"api/v1/label-trees{/id}/users{/user_id}"}}),du=Vue.resource("api/v1/label-tree-versions{/id}",{},{save:{method:"POST",url:"api/v1/label-trees{/id}/version"}}),fu=Vue.resource("api/v1/notifications{/id}",{},{markRead:{method:"PUT"}}),pu=Vue.resource("api/v1/projects{/id}",{},{queryVolumes:{method:"GET",url:"api/v1/projects{/id}/volumes"},saveVolume:{method:"POST",url:"api/v1/projects{/id}/volumes"},attachVolume:{method:"POST",url:"api/v1/projects{/id}/volumes{/volume_id}"},detachVolume:{method:"DELETE",url:"api/v1/projects{/id}/volumes{/volume_id}"},addUser:{method:"POST",url:"api/v1/projects{/id}/users{/user_id}"},updateUser:{method:"PUT",url:"api/v1/projects{/id}/users{/user_id}"},removeUser:{method:"DELETE",url:"api/v1/projects{/id}/users{/user_id}"},queryAvailableLabelTrees:{method:"GET",url:"api/v1/projects{/id}/label-trees/available"},attachLabelTree:{method:"POST",url:"api/v1/projects{/id}/label-trees"},detachLabelTree:{method:"DELETE",url:"api/v1/projects{/id}/label-trees{/label_tree_id}"}}),gu=Vue.resource("api/v1/users{/id}",{},{find:{method:"GET",url:"api/v1/users/find{/query}"}}),mu=Vue.resource("api/v1/volumes{/id}");const vu=Ml({props:{active:{type:Boolean,required:!0},fancy:{type:Boolean,default:!1}},computed:{classObject:function(){return{"loader--active":this.active,"loader--fancy":this.fancy}}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"loader",class:t.classObject})}),[],!1,null,null,null).exports;const yu=Ml({components:{loader:vu},props:{active:{type:Boolean,required:!0}},computed:{classObject:function(){return{"loader-block--active":this.active}}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loader-block",class:t.classObject},[i("loader",{attrs:{active:t.active,fancy:!0}})],1)}),[],!1,null,null,null).exports;const _u=Ml({props:{active:{type:Boolean,required:!0},title:{type:String,default:""},titleOn:{type:String,default:""},titleOff:{type:String,default:""},type:{type:String,default:"info"},icon:{type:String,default:"power-off"},disabled:{type:Boolean,default:!1}},computed:{currentTitle:function(){return this.active?this.titleOn||this.title:this.titleOff||this.title},label:function(){return this.$slots.default?this.$slots.default[0].text:""},objectClass:function(){var t={active:this.active};return t["btn-".concat(this.type)]=this.active,t},iconClass:function(){return"fa-".concat(this.icon)}},methods:{handleClick:function(){this.active?this.$emit("off"):this.$emit("on")}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"power-toggle"},[i("button",{staticClass:"btn btn-default",class:t.objectClass,attrs:{type:"button",title:t.currentTitle,disabled:t.disabled},on:{click:t.handleClick}},[i("i",{staticClass:"fa fa-fw",class:t.iconClass})]),t._v(" "),t.label?i("span",{staticClass:"power-toggle__label",domProps:{textContent:t._s(t.label)}}):t._e()])}),[],!1,null,null,null).exports;const bu=Ml({props:{tab:{type:Object,required:!0},direction:{type:String,default:"right",validator:function(t){return"left"===t||"right"===t}}},computed:{highlightClass:function(){return"string"==typeof this.tab.highlight?"btn-".concat(this.tab.highlight):"btn-info"},iconClass:function(){return"fa fa-".concat(this.tab.icon)},chevronClass:function(){return"fa fa-chevron-".concat(this.direction)},classObject:function(){var t={active:this.open};return!1!==this.tab.highlight&&(t[this.highlightClass]=!0),t},disabled:function(){return this.tab.disabled},href:function(){return this.disabled?null:this.tab.href},open:function(){return this.tab.open}},methods:{toggle:function(t){this.disabled||this.href||(t.preventDefault(),this.open?this.$parent.$emit("close",this.tab.name):this.$parent.$emit("open",this.tab.name))}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"sidebar__button btn btn-default btn-lg",class:t.classObject,attrs:{href:t.href,disabled:t.disabled,title:t.tab.title},on:{click:t.toggle}},[t.open?i("span",{class:t.chevronClass,attrs:{"aria-hidden":"true"}}):i("span",{class:t.iconClass,attrs:{"aria-hidden":"true"}})])}),[],!1,null,null,null).exports,wu=new Vue;const xu=Ml(new Vue({data:{activeListenerSetName:"default",listenerSets:{default:{}},compatibilityMaps:[{hyper:"os",meta:"os",super:"os"},{meta:"os",scrolllock:"Scroll"," ":"spacebar",arrowdown:"down",arrowleft:"left",arrowright:"right",arrowup:"up",crsel:"crsel",delete:"del",exsel:"exsel",contextmenu:"apps",escape:"esc"}],ignoredTags:["input","textarea","select"],pressedKeysArray:[]},computed:{activeListenerSet:function(){return this.listenerSets[this.activeListenerSetName]||{}},pressedKeys:function(){return this.pressedKeysArray.slice().sort().join("+")}},methods:{isKeyIdentifier:function(t){return"string"==typeof t||t instanceof String},prepareKeys:function(t){var e=this;return Array.isArray(t)||(t=t.split("+")),t.slice().map((function(t){if(!e.isKeyIdentifier(t))throw"".concat(t," is not a valid key.");return t.toLowerCase()})).sort()},shouldIgnoreTarget:function(t){return-1!==this.ignoredTags.indexOf(t.target.tagName.toLowerCase())},handleKeyDown:function(t){t=t||event,this.shouldIgnoreTarget(t)||(t.repeat||this.pressedKeysArray.push(t.key.toLowerCase()),this.maybeInjectModifierKeys(t),this.handleKeyEvents(t,this.pressedKeys))},maybeInjectModifierKeys:function(t){t.altKey&&-1===this.pressedKeysArray.indexOf("alt")&&this.pressedKeysArray.push("alt"),t.ctrlKey&&-1===this.pressedKeysArray.indexOf("control")&&this.pressedKeysArray.push("control"),t.metaKey&&-1===this.pressedKeysArray.indexOf("meta")&&this.pressedKeysArray.push("meta"),t.shiftKey&&-1===this.pressedKeysArray.indexOf("shift")&&this.pressedKeysArray.push("shift")},handleKeyUp:function(t){var e=this.pressedKeysArray.indexOf(t.key.toLowerCase());-1!==e&&this.pressedKeysArray.splice(e,1)},handleKeyEvents:function(t,e){this.activeListenerSet.hasOwnProperty(e)&&this.executeCallbacks(this.activeListenerSet[e],t)},clearPressedKeys:function(){this.pressedKeysArray=[]},executeCallbacks:function(t,e){e.preventDefault();for(var i=t.length-1;i>=0;i--)if(!1===t[i].callback(e))return},on:function(t,e,i,n){var r=this,o=(t=this.prepareKeys(t)).join("+");this.compatibilityMaps.forEach((function(s){var a=t.map((function(t){return s.hasOwnProperty(t)?s[t]:t}));o!==a.join("+")&&r.on(a,e,i,n)}));var s={callback:e,priority:i=i||0};n=n||"default",this.listenerSets.hasOwnProperty(n)||(this.listenerSets[n]={});var a=this.listenerSets[n];if(a.hasOwnProperty(o)){var l,u=a[o];for(l=0;l<u.length&&!(u[l].priority>=i);l++);l===u.length-1?u.push(s):u.splice(l,0,s)}else a[o]=[s]},off:function(t,e,i){t=this.prepareKeys(t).join("+"),i=i||"default";var n=this.listenerSets[i];if(n&&n.hasOwnProperty(t))for(var r=n[t],o=r.length-1;o>=0;o--)if(r[o].callback===e){r.splice(o,1);break}},setActiveSet:function(t){this.activeListenerSetName=t}},created:function(){document.body.addEventListener("keydown",this.handleKeyDown),document.body.addEventListener("keyup",this.handleKeyUp),window.addEventListener("focus",this.clearPressedKeys)}}),undefined,undefined,!1,null,null,null).exports;const Su=Ml({components:{sidebarButton:bu},data:function(){return{open:!1,tabs:[],lastOpenedTab:null,tabIdSequence:0}},props:{openTab:{type:String},showButtons:{type:Boolean,default:!0},direction:{type:String,default:"right",validator:function(t){return"left"===t||"right"===t}},toggleOnKeyboard:{type:Boolean,default:!1}},computed:{classObject:function(){return{"sidebar--open":this.open,"sidebar--left":this.isLeft,"sidebar--right":!this.isLeft}},isLeft:function(){return"left"===this.direction}},methods:{registerTab:function(t){t.id=this.tabIdSequence++,this.tabs.push(t)},handleOpenTab:function(t){this.open=!0,this.lastOpenedTab=t,this.$emit("toggle",t),wu.$emit("sidebar.toggle",t),wu.$emit("sidebar.open.".concat(t))},handleCloseTab:function(t){this.open=!1,this.$emit("toggle",t),wu.$emit("sidebar.toggle",t),wu.$emit("sidebar.close.".concat(t))},toggleLastOpenedTab:function(t){this.open?(t.preventDefault(),this.$emit("close",this.lastOpenedTab)):this.lastOpenedTab?(t.preventDefault(),this.$emit("open",this.lastOpenedTab)):this.tabs.length>0&&(t.preventDefault(),this.$emit("open",this.tabs[0].name))}},watch:{openTab:function(t){this.$emit("open",t)}},created:function(){this.$on("open",this.handleOpenTab),this.$on("close",this.handleCloseTab),this.toggleOnKeyboard&&xu.on("Tab",this.toggleLastOpenedTab)},mounted:function(){this.openTab&&this.$emit("open",this.openTab)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("aside",{staticClass:"sidebar",class:t.classObject},[t.showButtons?i("div",{staticClass:"sidebar__buttons"},t._l(t.tabs,(function(e){return i("sidebar-button",{key:e.id,attrs:{tab:e,direction:t.direction}})})),1):t._e(),t._v(" "),i("div",{staticClass:"sidebar__tabs"},[t._t("default")],2)])}),[],!1,null,null,null).exports;const Cu=Ml({data:function(){return{id:null,open:!1}},props:{name:{type:String,required:!0},icon:{type:String,required:!0},title:{type:String},href:{type:String},disabled:{type:Boolean,default:!1},highlight:{default:!1}},computed:{classObject:function(){return{"sidebar__tab--open":this.open}}},beforeCreate:function(){var t=this;this.$parent.$on("open",(function(e){t.open=e===t.name})),this.$parent.$on("close",(function(){t.open=!1})),this.$parent.registerTab(this)}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"sidebar__tab",class:t.classObject},[t._t("default")],2)}),[],!1,null,null,null).exports;const Eu=Ml({components:{typeahead:VueStrap.typeahead},props:{items:{type:Array,required:!0},placeholder:{type:String,default:"Item name"},disabled:{type:Boolean,default:!1},value:{type:String,default:""},clearOnSelect:{type:Boolean,default:!1},template:{default:"{{item.name}}"}},methods:{selectItem:function(t){if(t)return this.$emit("select",t),this.clearOnSelect?null:t.name},clear:function(){this.$emit("select",void 0)},updateValue:function(){this.$refs.typeahead.setValue(this.value)},emitFocus:function(t){this.$emit("focus",t)},emitBlur:function(t){this.$emit("blur",t)}},watch:{value:function(){this.updateValue()}},mounted:function(){this.updateValue(),this.$refs.typeahead.$el.firstChild.addEventListener("focus",this.emitFocus),this.$refs.typeahead.$el.firstChild.addEventListener("blur",this.emitBlur)}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("typeahead",{ref:"typeahead",staticClass:"typeahead clearfix",attrs:{"match-property":"name",data:t.items,disabled:t.disabled,"on-hit":t.selectItem,placeholder:t.placeholder,template:t.template},on:{clear:t.clear}})}),[],!1,null,null,null).exports;var Tu={},Iu=function(t,e,i){Tu.hasOwnProperty(i)&&window.clearTimeout(Tu[i]),Tu[i]=window.setTimeout(t,e)},Au=new Vue({data:{params:{}},methods:{setSlug:function(t,e){e=e||-1;var i=window.location.pathname.replace(/\/$/,""),n=i.split("/");n.splice(e,1,t),n=n.join("/"),this.replaceState(window.location.href.replace(i,n))},set:function(t){this.params=t,this.updateSearch()},unset:function(t){delete this.params[t],this.updateSearch()},get:function(t){return this.params[t]},updateSearch:function(){var t=[],e=window.location.href;for(var i in this.params)this.params.hasOwnProperty(i)&&t.push(i+"="+this.params[i]);t=t.length>0?"?"+t.join("&"):"",window.location.search?this.replaceState(e.replace(window.location.search,t)):-1!==e.indexOf("#")?window.location.hash?this.replaceState(e.replace(window.location.hash,t+window.location.hash)):this.replaceState(e.slice(0,-1)+t):this.replaceState(e+t)},replaceState:function(t){history.replaceState(null,null,t)}},created:function(){var t=window.location.search.substr(1);if(t)for(var e,i=(t=t.split("&")).length-1;i>=0;i--)e=t[i].split("="),this.params[e[0]]=e[1]}}),ku={},Pu={},Lu=function(t,e,i){Pu[i]=t,ku.hasOwnProperty(i)||(ku[i]=window.setTimeout((function(){Pu[i](),delete ku[i]}),e))},Ru=function(t){return"string"!=typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)},Fu=new Vue({data:{max:1,all:[]},methods:{post:function(t,e){document.fullscreenElement&&(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()),this.all.unshift({id:Date.now(),type:t,text:e}),this.all.length>this.max&&this.all.pop()},danger:function(t){this.post("danger",t)},warning:function(t){this.post("warning",t)},success:function(t){this.post("success",t)},info:function(t){this.post("info",t)},close:function(t){for(var e=this.all.length-1;e>=0;e--)this.all[e].id===t&&this.all.splice(e,1)},handleErrorResponse:function(t){var e=t.body;if(e){if(422===t.status&&e.errors){for(var i in e.errors)this.danger(e.errors[i][0]);return}if(e.message)return void this.danger(e.message);if("string"==typeof e)return void this.danger(e)}403===t.status?this.danger("You have no permission to do that."):401===t.status?this.danger("Please log in (again)."):this.danger("The server didn't respond, sorry.")},handleResponseError:function(t){return this.handleErrorResponse(t)}}}),Mu=Fu.handleErrorResponse;const Ou=Ml(Fu,undefined,undefined,!1,null,null,null).exports;const Du=Ml({data:function(){return{editing:!1}},methods:{startEditing:function(){this.editing=!0,this.$emit("editing.start")},finishEditing:function(){this.editing=!1,this.$emit("editing.stop")},toggleEditing:function(){this.editing?this.finishEditing():this.startEditing()}}},undefined,undefined,!1,null,null,null).exports;const $u=Ml({components:{loader:vu,loaderBlock:yu},data:function(){return{instancesLoading:0}},computed:{loading:function(){return this.instancesLoading>0}},watch:{loading:function(t){this.$emit("loading",t)}},methods:{startLoading:function(){this.instancesLoading+=1},finishLoading:function(){this.instancesLoading>0&&(this.instancesLoading-=1)},handleErrorResponse:function(t){return Ou.handleErrorResponse(t)}}},undefined,undefined,!1,null,null,null).exports;const ju=Ml(Vue.extend({data:function(){return{urlParams:[],storageKey:"biigle.settings",defaults:{},data:{}}},methods:{set:function(t,e){e===this.defaults[t]?this.delete(t):this.has(t)?this.data[t]=e:Vue.set(this.data,t,e),Iu(this.persist,100,this.storageKey)},delete:function(t){Vue.delete(this.data,t),this.persist()},get:function(t){return this.has(t)?this.data[t]:this.defaults[t]},has:function(t){return this.data.hasOwnProperty(t)},persist:function(){Object.keys(this.data).length>0?window.localStorage.setItem(this.storageKey,JSON.stringify(this.data)):window.localStorage.removeItem(this.storageKey)},restoreFromLocalStorage:function(){var t=JSON.parse(window.localStorage.getItem(this.storageKey));t&&Vue.set(this,"data",t)},restoreFromUrlParams:function(t){var e=this,i=Au.params;(t=t||Object.keys(i)).forEach((function(t){i.hasOwnProperty(t)&&Vue.set(e.data,t,i[t])}))},watch:function(t,e){return this.$watch("data.".concat(t),e)}},created:function(){this.restoreFromLocalStorage(),this.urlParams.length>0&&this.restoreFromUrlParams(this.urlParams)}}),undefined,undefined,!1,null,null,null).exports;window.biigle={},window.biigle.$mount=ou,window.biigle.$declare=function(t,e){var i=(t=t.split(".")).pop();return su(t)[i]=e,e},window.biigle.$require=su,biigle.$declare("api.annotations",au),biigle.$declare("api.images",lu),biigle.$declare("api.labels",uu),biigle.$declare("api.labelSource",hu),biigle.$declare("api.labelTree",cu),biigle.$declare("api.labelTreeVersion",du),biigle.$declare("api.notifications",fu),biigle.$declare("api.projects",pu),biigle.$declare("api.users",gu),biigle.$declare("api.volumes",mu),biigle.$declare("core.components.loader",vu),biigle.$declare("core.components.loaderBlock",yu),biigle.$declare("core.components.powerToggle",_u),biigle.$declare("core.components.sidebar",Su),biigle.$declare("core.components.sidebarTab",Cu),biigle.$declare("core.components.typeahead",Eu),biigle.$declare("messages",Ou),biigle.$declare("messages.store",Ou),window.$biiglePostMessage=Ou.post,biigle.$declare("core.mixins.editor",Du),biigle.$declare("core.mixins.loader",$u),biigle.$declare("core.models.Settings",ju),biigle.$declare("utils.debounce",Iu),biigle.$declare("utils.urlParams",Au),biigle.$declare("urlParams",Au),biigle.$declare("utils.throttle",Lu),biigle.$declare("events",wu),biigle.$declare("keyboard",xu),biigle.$declare("core.keyboard",xu);const Nu=Ml({components:{message:{props:{id:{type:Number,required:!0},text:{type:String,required:!0},type:{type:String,default:"info"}},computed:{typeClass:function(){return"alert-".concat(this.type)}},methods:{close:function(){Ou.close(this.id)},cancelTimeout:function(){this.closeTimeoutId&&(window.clearTimeout(this.closeTimeoutId),this.closeTimeoutId=null)}},mounted:function(){"danger"!==this.type&&(this.closeTimeoutId=window.setTimeout(this.close,15e3))}}},data:function(){return{messages:Ou.all}},mounted:function(){var t=biigle.$require("staticMessage");t.text&&t.type&&this.$nextTick((function(){Ou.post(t.type,t.text)}))}},undefined,undefined,!1,null,null,null).exports;const Bu=Ml(new Vue({data:{all:[],initialized:!1},computed:{unread:function(){return this.all.filter((function(t){return null===t.read_at}))},count:function(){return this.all.length},countUnread:function(){return this.unread.length}},methods:{remove:function(t){for(var e=this.all.length-1;e>=0;e--)this.all[e].id===t&&this.all.splice(e,1)},initialize:function(){if(!this.initialized){var t=biigle.$require("initialNotifications");this.all=t||[],this.initialized=!0}}}}),undefined,undefined,!1,null,null,null).exports;const Uu=Ml({components:{notification:{props:["item","removeItem"],data:function(){return{isLoading:!1}},computed:{classObject:function(){return this.item.data.type?"panel-".concat(this.item.data.type):"panel-default"},isUnread:function(){return null===this.item.read_at}},methods:{markRead:function(){var t=this;return this.isLoading=!0,fu.markRead({id:this.item.id},{}).then((function(){t.item.read_at=new Date,t.removeItem&&Bu.remove(t.item.id)})).catch(Ou.handleErrorResponse).finally((function(){t.isLoading=!1}))},markReadAndOpenLink:function(){var t=this.item.data.actionLink;this.item.read_at?window.location=t:this.markRead().finally((function(){window.location=t}))}}}},data:function(){return{notifications:[]}},computed:{hasNotifications:function(){return Bu.count>0},hasUnreadNotifications:function(){return Bu.countUnread>0}},created:function(){Bu.initialize(),this.notifications=Bu.all}},undefined,undefined,!1,null,null,null).exports;const Gu=Ml({computed:{unread:function(){return Bu.initialized?Bu.countUnread:parseInt(this.$el.attributes.unread.value)},hasUnread:function(){return this.unread>0},unreadText:function(){return this.hasUnread?this.unread:"no"},title:function(){return"You have ".concat(this.unreadText," unread notification(s)")}}},undefined,undefined,!1,null,null,null).exports;const Vu=Ml({computed:{count:function(){return Bu.countUnread}}},undefined,undefined,!1,null,null,null).exports;const zu=Ml({data:function(){return{body:""}},beforeMount:function(){var t=document.getElementById("system-messages-edit-form").querySelector('textarea[name="body"]');t&&(this.body=t.value)}},undefined,undefined,!1,null,null,null).exports;ou("messages-display",Nu),ou("notifications-list",Uu),ou("notifications-navbar-indicator",Gu),ou("notifications-unread-count",Vu),ou("system-messages-edit-form",zu);i(1755);var qu=Ml({name:"label-tree-label",data:function(){return{hover:!1,editing:!1,oldName:"",oldColor:"",newName:"",newColor:"",internalLabel:null}},props:{label:{type:Object,required:!0},showFavourites:{type:Boolean,required:!1},editable:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{showColor:function(){return!this.expandable||!this.hover},showChevronUp:function(){return!this.showColor&&this.label.open},showChevronDown:function(){return!this.showColor&&!this.label.open},classObject:function(){return{"label-tree-label--selected":this.label.selected,"label-tree-label--expandable":this.expandable,"label-tree-label--editing":this.editing}},colorStyle:function(){return{"background-color":"#"+this.label.color}},chevronStyle:function(){return{color:"#"+this.label.color}},favouriteClass:function(){return{selected:this.label.favourite}},favouriteTitle:function(){return(this.label.favourite?"Remove":"Add")+" as favourite"},editTitle:function(){return"Edit label "+this.label.name},deleteTitle:function(){return"Remove label "+this.label.name},expandable:function(){return!this.flat&&!!this.label.children},showEditButton:function(){return this.editable&&this.hover&&!this.editing}},methods:{toggleSelect:function(t){this.editing||(t.preventDefault(),this.label.selected?this.$emit("deselect",this.label,t):this.$emit("select",this.label,t))},editThis:function(){this.editing=!0,this.oldName=this.label.name,this.oldColor=this.label.color,this.newName=this.label.name,this.newColor="#"+this.label.color},saveThis:function(){var t=this;this.internalLabel.name=this.newName,this.internalLabel.color=this.newColor.substr(1),this.editing=!1,this.oldName===this.label.name&&this.oldColor===this.label.color||this.emitSave(this.label,(function(){return t.editing=!0}))},revertThis:function(){this.editing=!1,this.internalLabel.name=this.oldName,this.internalLabel.color=this.oldColor},deleteThis:function(){this.emitDelete(this.label)},toggleOpen:function(t){this.editing||(this.expandable?this.internalLabel.open=!this.label.open:this.toggleSelect(t))},toggleFavourite:function(){this.label.favourite?this.emitRemoveFavourite(this.label):this.emitAddFavourite(this.label)},emitSelect:function(t,e){this.$emit("select",t,e)},emitDeselect:function(t,e){this.$emit("deselect",t,e)},emitDelete:function(t){this.$emit("delete",t)},emitSave:function(t,e){this.$emit("save",t,e)},emitAddFavourite:function(t){this.$emit("add-favourite",t)},emitRemoveFavourite:function(t){this.$emit("remove-favourite",t)},doHover:function(){this.hover=!0},dontHover:function(){this.hover=!1}},created:function(){this.internalLabel=this.label}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"label-tree-label",class:t.classObject},[i("div",{staticClass:"label-tree-label__name",on:{click:t.toggleOpen,mouseover:t.doHover,mouseleave:t.dontHover}},[t.editing?i("span",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newColor,expression:"newColor"}],staticClass:"form-control input-sm label-tree-color-input",attrs:{type:"color"},domProps:{value:t.newColor},on:{input:function(e){e.target.composing||(t.newColor=e.target.value)}}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.newName,expression:"newName"}],staticClass:"form-control input-sm label-tree-label__name-input",attrs:{type:"text"},domProps:{value:t.newName},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveThis(e)},input:function(e){e.target.composing||(t.newName=e.target.value)}}})]):i("span",[i("span",{directives:[{name:"show",rawName:"v-show",value:t.showColor,expression:"showColor"}],staticClass:"label-tree-label__color",style:t.colorStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showChevronDown,expression:"showChevronDown"}],staticClass:"label-tree-label__chevron label-tree-label__chevron--down",style:t.chevronStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showChevronUp,expression:"showChevronUp"}],staticClass:"label-tree-label__chevron label-tree-label__chevron--up",style:t.chevronStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.label.name)},on:{click:function(e){return e.stopPropagation(),t.toggleSelect(e)},mouseenter:t.dontHover}})]),t._v(" "),i("span",{staticClass:"label-tree-label__buttons"},[t.showFavourites?i("button",{staticClass:"label-tree-label__favourite",class:t.favouriteClass,attrs:{type:"button",title:t.favouriteTitle},on:{click:function(e){return e.stopPropagation(),t.toggleFavourite(e)}}},[i("span",{staticClass:"fa fa-star",attrs:{"aria-hidden":"true",title:""}})]):t._e(),t._v(" "),i("span",{attrs:{if:"editable"}},[i("button",{directives:[{name:"show",rawName:"v-show",value:t.showEditButton,expression:"showEditButton"}],staticClass:"btn btn-default btn-xs",attrs:{title:t.editTitle},on:{click:function(e){return e.stopPropagation(),t.editThis(e)}}},[i("span",{staticClass:"fa fa-pencil-alt",attrs:{"aria-hidden":"true"}})]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-danger btn-sm",attrs:{title:t.deleteTitle},on:{click:function(e){return e.stopPropagation(),t.deleteThis(e)}}},[i("span",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-success btn-sm",attrs:{title:"Save changes"},on:{click:function(e){return e.stopPropagation(),t.saveThis(e)}}},[i("span",{staticClass:"fa fa-check",attrs:{"aria-hidden":"true"}})]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-default btn-sm",attrs:{title:"Revert changes"},on:{click:function(e){return e.stopPropagation(),t.revertThis(e)}}},[i("span",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}})])])])]),t._v(" "),t.expandable&&t.label.open?i("ul",{staticClass:"label-tree__list"},t._l(t.label.children,(function(e){return i("label-tree-label",{key:e.id,attrs:{label:e,editable:t.editable,"show-favourites":t.showFavourites},on:{select:t.emitSelect,deselect:t.emitDeselect,save:t.emitSave,delete:t.emitDelete,"add-favourite":t.emitAddFavourite,"remove-favourite":t.emitRemoveFavourite}})})),1):t._e()])}),[],!1,null,null,null);const Wu=Ml({data:function(){return{collapsed:!1}},components:{labelTreeLabel:qu.exports},props:{name:{type:String,required:!0},labels:{type:Array,required:!0},showTitle:{type:Boolean,default:!0},standalone:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},editable:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},flat:{type:Boolean,default:!1}},computed:{labelMap:function(){for(var t={},e=this.labels.length-1;e>=0;e--)t[this.labels[e].id]=this.labels[e];return t},compiledLabels:function(){var t={null:[]};return this.flat?this.labels.forEach((function(e){t.null.push(e)})):(this.labels.forEach((function(e){t.hasOwnProperty(e.parent_id)?t[e.parent_id].push(e):t[e.parent_id]=[e]})),this.labels.forEach((function(e){t.hasOwnProperty(e.id)?Vue.set(e,"children",t[e.id]):(Vue.set(e,"children",void 0),e.open=!1)}))),t},rootLabels:function(){return this.compiledLabels.null},collapseTitle:function(){return this.collapsed?"Expand":"Collapse"},hasNoLabels:function(){return 0===this.rootLabels.length}},methods:{hasLabel:function(t){return this.labelMap.hasOwnProperty(t)},getLabel:function(t){return this.labelMap[t]},getParents:function(t){for(var e=[];null!==t.parent_id;)t=this.getLabel(t.parent_id),e.unshift(t.id);return e},getSiblings:function(t){return null===t.parent_id?this.rootLabels:this.getLabel(t.parent_id).children},selectSiblings:function(t){this.getSiblings(t).forEach((function(t){t.selected=!0}))},deselectSiblings:function(t){this.getSiblings(t).forEach((function(t){t.selected=!1}))},selectChildren:function(t){var e=this;t.children&&t.children.forEach((function(t){t.selected=!0,e.selectChildren(t)}))},deselectChildren:function(t){var e=this;t.children&&t.children.forEach((function(t){t.selected=!1,e.deselectChildren(t)}))},emitSelect:function(t,e){this.$emit("select",t,e)},emitDeselect:function(t,e){this.$emit("deselect",t,e)},emitSave:function(t,e){this.$emit("save",t,e)},emitDelete:function(t){this.$emit("delete",t)},conditionSelectSiblings:function(t){return this.allowSelectSiblings&&t.altKey},conditionSelectChildren:function(t){return this.allowSelectChildren&&t.ctrlKey},selectLabel:function(t,e){var i=this;this.multiselect||this.clearSelectedLabels(),t&&this.hasLabel(t.id)&&(t.selected=!0,this.collapsed=!1,this.flat||(this.getParents(t).forEach((function(t){i.getLabel(t).open=!0})),this.multiselect&&(this.conditionSelectSiblings(e)&&this.selectSiblings(t),this.conditionSelectChildren(e)&&(this.selectChildren(t),this.conditionSelectSiblings(e)&&this.getSiblings(t).forEach(this.selectChildren)))))},deselectLabel:function(t,e){this.hasLabel(t.id)&&(t.selected=!1,this.conditionSelectSiblings(e)&&this.deselectSiblings(t),this.conditionSelectChildren(e)&&(this.deselectChildren(t),this.conditionSelectSiblings(e)&&this.getSiblings(t).forEach(this.deselectChildren)))},clearSelectedLabels:function(){this.labels.forEach((function(t){t.selected=!1}))},collapse:function(){if(this.collapsed)this.collapsed=!1;else{var t=!1;this.labels.forEach((function(e){t|=e.open,e.open=!1})),this.collapsed=!t}},emitAddFavourite:function(t){this.$emit("add-favourite",t)},emitRemoveFavourite:function(t){this.$emit("remove-favourite",t)},addFavouriteLabel:function(t){this.hasLabel(t.id)&&(t.favourite=!0)},removeFavouriteLabel:function(t){this.hasLabel(t.id)&&(t.favourite=!1)}},created:function(){this.labels.forEach((function(t){t.hasOwnProperty("open")||Vue.set(t,"open",!1),t.hasOwnProperty("selected")||Vue.set(t,"selected",!1),t.hasOwnProperty("favourite")||Vue.set(t,"favourite",!1)})),this.standalone?(this.$on("select",this.selectLabel),this.$on("deselect",this.deselectLabel)):(this.$parent.$on("select",this.selectLabel),this.$parent.$on("deselect",this.deselectLabel),this.$parent.$on("clear",this.clearSelectedLabels),this.$parent.$on("add-favourite",this.addFavouriteLabel),this.$parent.$on("remove-favourite",this.removeFavouriteLabel))}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-tree"},[t.showTitle?i("h4",{staticClass:"label-tree__title"},[t.collapsible?i("button",{staticClass:"btn btn-default btn-xs pull-right",attrs:{title:t.collapseTitle,type:"button"},on:{click:function(e){return e.stopPropagation(),t.collapse(e)}}},[t.collapsed?i("span",{staticClass:"fa fa-chevron-down",attrs:{"aria-hidden":"true"}}):i("span",{staticClass:"fa fa-chevron-up",attrs:{"aria-hidden":"true"}})]):t._e(),t._v("\n        "+t._s(t.name)+"\n    ")]):t._e(),t._v(" "),t.collapsed?t._e():i("ul",{staticClass:"label-tree__list"},[t._l(t.rootLabels,(function(e){return i("label-tree-label",{key:e.id,attrs:{label:e,editable:t.editable,"show-favourites":t.showFavourites,flat:t.flat},on:{select:t.emitSelect,deselect:t.emitDeselect,save:t.emitSave,delete:t.emitDelete,"add-favourite":t.emitAddFavourite,"remove-favourite":t.emitRemoveFavourite}})})),t._v(" "),t.hasNoLabels?i("li",{staticClass:"text-muted"},[t._v("No labels")]):t._e()],2)])}),[],!1,null,null,null).exports;const Ku=Ml({mixins:[Eu],props:{template:{default:'<span class="label-typeahead-item"><span v-if="item.color" :style="{\'background-color\': \'#\' + item.color}" class="label-color"></span><span v-text="item.name"></span></span>'}}},undefined,undefined,!1,null,null,null).exports;const Xu=Ml({components:{typeahead:Ku,labelTree:Wu},data:function(){return{favourites:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.tree.versionedName"></small>'}},props:{trees:{type:Array,required:!0},id:{type:String},typeahead:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},multiselect:{type:Boolean,default:!1},allowSelectSiblings:{type:Boolean,default:!1},allowSelectChildren:{type:Boolean,default:!1},showFavourites:{type:Boolean,default:!1},collapsible:{type:Boolean,default:!0},listenerSet:{type:String,default:"default"}},computed:{localeCompareSupportsLocales:function(){try{"foo".localeCompare("bar","i")}catch(t){return"RangeError"===t.name}return!1},labels:function(){var t=[];if(this.trees.forEach((function(e){Array.prototype.push.apply(t,e.labels)})),this.localeCompareSupportsLocales){var e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});t.sort((function(t,i){return e.compare(t.name,i.name)}))}else t.sort((function(t,e){return t.name<e.name?-1:1}));return t},favouriteIds:function(){return this.favourites.map((function(t){return t.id}))},canHaveMoreFavourites:function(){return this.favourites.length<10},hasFavourites:function(){return this.favourites.length>0},ownId:function(){if(this.id)return this.id;var t=[];for(var e in this.trees)this.trees.hasOwnProperty(e)&&t.push(this.trees[e].id);return t.join("-")},favouriteStorageKey:function(){return"biigle.label-trees.".concat(this.ownId,".favourites")}},methods:{handleSelect:function(t,e){t&&this.$emit("select",t,e)},handleDeselect:function(t,e){this.$emit("deselect",t,e)},clear:function(){this.$emit("clear")},handleAddFavourite:function(t){this.canHaveMoreFavourites&&(this.$emit("add-favourite",t),this.favourites.push(t),this.updateFavouriteStorage())},handleRemoveFavourite:function(t){this.$emit("remove-favourite",t);var e=this.favourites.indexOf(t);-1!==e&&this.favourites.splice(e,1),this.updateFavouriteStorage()},updateFavouriteStorage:function(){this.hasFavourites?localStorage.setItem(this.favouriteStorageKey,JSON.stringify(this.favouriteIds)):localStorage.removeItem(this.favouriteStorageKey)},selectFavourite:function(t){this.favourites[t]&&this.handleSelect(this.favourites[t])}},watch:{trees:{immediate:!0,handler:function(t){t.forEach((function(t){t.version?t.versionedName=t.name+" @ "+t.version.name:t.versionedName=t.name,t.labels.forEach((function(e){e.tree=t}))}))}}},mounted:function(){var t=this;if(this.showFavourites){var e=JSON.parse(localStorage.getItem(this.favouriteStorageKey));if(e){var i=[];this.labels.forEach((function(t){var n=e.indexOf(t.id);-1!==n&&(i[n]=t)})),i.filter(Boolean).forEach((function(e){t.handleAddFavourite(e)}))}for(var n=function(e,i){xu.on(e,(function(){t.selectFavourite(i)}),0,t.listenerSet)},r=1;r<=9;r++)n(r.toString(),r-1);n("0",9)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-trees"},[t.typeahead||t.clearable?i("div",{staticClass:"label-trees__head"},[t.clearable?i("button",{staticClass:"btn btn-default",attrs:{title:"Clear selected labels",type:"button"},on:{click:t.clear}},[i("span",{staticClass:"fa fa-times fa-fw",attrs:{"aria-hidden":"true"}})]):t._e(),t._v(" "),t.typeahead?i("typeahead",{attrs:{items:t.labels,template:t.typeaheadTemplate,placeholder:"Find label"},on:{select:t.handleSelect}}):t._e()],1):t._e(),t._v(" "),i("div",{staticClass:"label-trees__body"},[t.hasFavourites?i("label-tree",{attrs:{name:"Favourites",labels:t.favourites,"show-favourites":t.showFavourites,flat:!0,collapsible:t.collapsible},on:{select:t.handleSelect,deselect:t.handleDeselect,"remove-favourite":t.handleRemoveFavourite}}):t._e(),t._v(" "),t._l(t.trees,(function(e){return i("label-tree",{key:e.id,attrs:{name:e.versionedName,labels:e.labels,multiselect:t.multiselect,"allow-select-siblings":t.allowSelectSiblings,"allow-select-children":t.allowSelectChildren,"show-favourites":t.showFavourites,collapsible:t.collapsible},on:{select:t.handleSelect,deselect:t.handleDeselect,"add-favourite":t.handleAddFavourite,"remove-favourite":t.handleRemoveFavourite}})}))],2)])}),[],!1,null,null,null).exports;biigle.$declare("labelTrees.components.labelTrees",Xu),biigle.$declare("labelTrees.components.labelTypeahead",Ku);const Yu=Ml({mixins:[$u],data:function(){return{labelTree:null,ownProjects:[],authorizedProjects:[],authorizedOwnProjects:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.description"></small>',privateId:null}},components:{typeahead:Eu},computed:{isPrivate:function(){return this.labelTree.visibility_id===this.privateId},authorizableProjects:function(){var t=this;return this.ownProjects.filter((function(e){for(var i=t.authorizedProjects.length-1;i>=0;i--)if(t.authorizedProjects[i].id===e.id)return!1;return!0}))},hasAuthorizedProjects:function(){return this.authorizedProjects.length>0}},methods:{fetchOwnProjects:function(){var t=this;pu.query().then((function(e){Vue.set(t,"ownProjects",e.body)}),Mu)},addAuthorizedProject:function(t){var e=this;t&&!this.loading&&(this.startLoading(),cu.addAuthorizedProject({id:this.labelTree.id},{id:t.id}).then((function(){return e.authorizedProjectAdded(t)}),Mu).finally(this.finishLoading))},authorizedProjectAdded:function(t){this.authorizedProjects.push(t),this.authorizedOwnProjects.push(t.id)},removeAuthorizedProject:function(t){var e=this;this.startLoading(),cu.removeAuthorizedProject({id:this.labelTree.id,project_id:t.id}).then((function(){return e.authorizedProjectRemoved(t)}),Mu).finally(this.finishLoading)},authorizedProjectRemoved:function(t){var e;for(e=this.authorizedProjects.length-1;e>=0;e--)this.authorizedProjects[e].id===t.id&&this.authorizedProjects.splice(e,1);-1!==(e=this.authorizedOwnProjects.indexOf(t.id))&&this.authorizedOwnProjects.splice(e,1)},isOwnProject:function(t){return-1!==this.authorizedOwnProjects.indexOf(t.id)}},created:function(){this.privateId=biigle.$require("labelTrees.privateVisibilityId"),this.labelTree=biigle.$require("labelTrees.labelTree"),this.authorizedProjects=biigle.$require("labelTrees.authorizedProjects"),this.authorizedOwnProjects=biigle.$require("labelTrees.authorizedOwnProjects"),this.fetchOwnProjects()}},undefined,undefined,!1,null,null,null).exports;var Hu=[0,.5,.9],Zu=[360,1,1],Ju=[0,2,2],Qu=function(){for(var t,e,i=[0,0,0],n=i.length-1;n>=0;n--)t=10*Ju[n],i[n]=(Zu[n]-Hu[n])*Math.random()+Hu[n],i[n]=0!==t?Math.round(i[n]*t)/t:Math.round(i[n]);return"#"+(e=function(t){var e,i=t[0]/60,n=Math.floor(i),r=i-n,o=[t[2]*(1-t[1]),t[2]*(1-t[1]*r),t[2]*(1-t[1]*(1-r))];switch(n){case 1:e=[o[1],t[2],o[0]];break;case 2:e=[o[0],t[2],o[2]];break;case 3:e=[o[0],o[1],t[2]];break;case 4:e=[o[2],o[0],t[2]];break;case 5:e=[t[2],o[0],o[1]];break;default:e=[t[2],o[2],o[0]]}return e.map((function(t){return Math.round(255*t)}))}(i),e.map((function(t){return 1===(t=t.toString(16)).length?"0"+t:t}))).join("")};const th=Ml({props:{labels:{type:Array,required:!0},color:{type:String,default:""},parent:{type:Object,default:null},name:{type:String,default:""}},components:{typeahead:Ku},computed:{selectedColor:{get:function(){return this.color},set:function(t){this.$emit("color",t)}},selectedName:{get:function(){return this.name},set:function(t){this.$emit("name",t)}},selectedParent:function(){return this.parent?this.parent.name:""},hasNoLabels:function(){return 0===this.labels.length},hasNoParent:function(){return!this.parent},hasNoName:function(){return!this.name}},methods:{refreshColor:function(){this.selectedColor=Qu()},resetParent:function(){this.$emit("parent",null)},selectLabel:function(t){this.$emit("parent",t)}}},undefined,undefined,!1,null,null,null).exports;const eh=Ml({mixins:[th],methods:{submit:function(){var t={name:this.selectedName,color:this.selectedColor};this.parent&&(t.parent_id=this.parent.id),this.$emit("submit",t)}}},undefined,undefined,!1,null,null,null).exports;var ih=Ml({props:{item:{type:Object,required:!0},recursive:{type:Boolean,required:!0},labels:{type:Array,required:!0},parent:{type:Object,default:null}},computed:{classification:function(){return this.item.parents.join(" > ")},buttonTitle:function(){return this.recursive?"Add ".concat(this.item.name," and all WoRMS parents as new labels"):this.parent?"Add ".concat(this.item.name," as a child of ").concat(this.parent.name):"Add ".concat(this.item.name," as a root label")},classObject:function(){return{"list-group-item-success":this.selected}},selected:function(){var t=this;return this.labels.some((function(e){return e.source_id==t.item.aphia_id}))}},methods:{select:function(){this.selected||this.$emit("select",this.item)}}},undefined,undefined,!1,null,null,null);const nh=Ml({mixins:[th],components:{wormsResultItem:ih.exports},data:function(){return{results:[],recursive:!1,hasSearched:!1,unaccepted:!1,worms:null}},computed:{hasResults:function(){return this.results.length>0},recursiveButtonClass:function(){return{active:this.recursive,"btn-info":this.recursive}},unacceptedButtonClass:function(){return{active:this.unaccepted,"btn-info":this.unaccepted}}},methods:{findName:function(){var t=this;this.$emit("load-start");var e={id:this.worms.id,query:this.selectedName};this.unaccepted&&(e.unaccepted="true"),hu.query(e).then(this.updateResults,Mu).finally((function(){t.hasSearched=!0,t.$emit("load-finish")}))},updateResults:function(t){this.results=t.data},importItem:function(t){var e={name:t.name,color:this.selectedColor,source_id:t.aphia_id,label_source_id:this.worms.id};this.recursive?e.recursive="true":this.parent&&(e.parent_id=this.parent.id),this.$emit("submit",e)},toggleRecursive:function(){this.recursive=!this.recursive},toggleUnaccepted:function(){this.unaccepted=!this.unaccepted}},created:function(){this.worms=biigle.$require("labelTrees.wormsLabelSource")}},undefined,undefined,!1,null,null,null).exports;const rh=Ml({mixins:[$u],data:function(){return{labelTree:null,labels:[],selectedColor:Qu(),selectedLabel:null,selectedName:"",canEdit:!1}},components:{tabs:VueStrap.tabs,tab:VueStrap.tab,labelTree:Wu,manualLabelForm:eh,wormsLabelForm:nh},computed:{editable:function(){return!this.loading&&this.canEdit}},methods:{saveLabel:function(t,e){this.startLoading(),uu.update({id:t.id},{name:t.name,color:t.color}).catch((function(t){e(),Mu(t)})).finally(this.finishLoading)},deleteLabel:function(t){var e=this;this.startLoading(),uu.delete({id:t.id}).then((function(){e.labelDeleted(t)}),Mu).finally(this.finishLoading)},labelDeleted:function(t){this.selectedLabel&&this.selectedLabel.id===t.id&&this.deselectLabel(t);for(var e=this.labels.length-1;e>=0;e--)if(this.labels[e].id===t.id){this.labels.splice(e,1);break}},selectLabel:function(t){this.selectedLabel=t,t?(this.selectedColor="#"+t.color,this.$emit("select",t),wu.$emit("selectLabel",t)):(this.$emit("clear"),wu.$emit("selectLabel",null))},deselectLabel:function(t){this.selectedLabel=null,this.$emit("deselect",t),wu.$emit("selectLabel",null)},selectColor:function(t){this.selectedColor=t},selectName:function(t){this.selectedName=t},insertLabel:function(t){Vue.set(t,"open",!1),Vue.set(t,"selected",!1);for(var e=t.name.toLowerCase(),i=0,n=this.labels.length;i<n;i++)if(this.labels[i].name.toLowerCase()>=e)return void this.labels.splice(i,0,t);this.labels.push(t)},createLabel:function(t){this.loading||(this.startLoading(),uu.save({label_tree_id:this.labelTree.id},t).then(this.labelCreated,Mu).finally(this.finishLoading))},labelCreated:function(t){t.data.forEach(this.insertLabel),this.selectedColor=Qu(),this.selectedName=""}},watch:{labels:function(t){wu.$emit("label-trees.labels.count",t.length)}},created:function(){this.labelTree=biigle.$require("labelTrees.labelTree"),this.labels=biigle.$require("labelTrees.labels"),this.canEdit=biigle.$require("labelTrees.canEdit")}},undefined,undefined,!1,null,null,null).exports;const oh=Ml({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){wu.$on("label-trees.labels.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;const sh=Ml({mixins:[$u],props:{members:{type:Array,required:!0},roles:{type:Array,required:!0},defaultRole:{type:Object},disabled:{type:Boolean,default:!1}},components:{typeahead:Eu},data:function(){return{selectedMember:null,selectedRole:null,usersLoaded:!1,users:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},computed:{memberIds:function(){return this.members.map((function(t){return t.id}))},availableUsers:function(){var t=this;return this.users.filter((function(e){return!t.memberIds.includes(e.id)}))},canAttachMember:function(){return!this.disabled&&this.selectedMember&&this.selectedRole},selectedMemberName:function(){return this.selectedMember?this.selectedMember.name:""}},methods:{selectMember:function(t){this.selectedMember=t},attachMember:function(){var t={id:this.selectedMember.id,role_id:this.selectedRole,firstname:this.selectedMember.firstname,lastname:this.selectedMember.lastname,affiliation:this.selectedMember.affiliation};this.$emit("attach",t),this.selectedMember=null},loadUsers:function(){this.usersLoaded||(this.usersLoaded=!0,this.startLoading(),gu.query().then(this.loadedUsers,Mu).finally(this.finishLoading))},loadedUsers:function(t){this.users=t.data.map((function(t){return t.name=t.firstname+" "+t.lastname,t}))}},created:function(){this.defaultRole?this.selectedRole=this.defaultRole.id:this.selectedRole=this.roles[0].id}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{staticClass:"form-inline",on:{submit:function(e){return e.preventDefault(),t.attachMember(e)}}},[i("loader",{attrs:{active:t.loading}}),t._v(" "),i("typeahead",{attrs:{disabled:t.disabled,items:t.availableUsers,placeholder:"User name",value:t.selectedMemberName,template:t.typeaheadTemplate},on:{select:t.selectMember,focus:t.loadUsers}}),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedRole,expression:"selectedRole"}],staticClass:"form-control",attrs:{disabled:t.disabled,title:"Role of the new user"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selectedRole=e.target.multiple?i:i[0]}}},t._l(t.roles,(function(e){return i("option",{domProps:{value:e.id,textContent:t._s(e.name)}})})),0),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"submit",disabled:!t.canAttachMember}},[t._v("Add member")])],1)}),[],!1,null,null,null).exports;const ah=Ml({props:{member:{type:Object,required:!0},ownId:{type:Number,required:!0},editable:{type:Boolean,required:!0},editing:{type:Boolean,default:!1},roles:{type:Array,required:!0}},data:function(){return{roleId:null}},computed:{isOwnUser:function(){return this.member.id===this.ownId},isEditing:function(){return this.editing&&!this.isOwnUser},name:function(){return this.member.firstname+" "+this.member.lastname},role:function(){var t=this;return this.roles.find((function(e){return t.member.role_id===e.id}))},labelClass:function(){switch(this.role.name){case"admin":return"label-danger";case"expert":return"label-warning";case"editor":return"label-primary";default:return"label-default"}}},methods:{removeMember:function(){this.$emit("remove",this.member)},changeRole:function(){this.$emit("update",this.member,{role_id:this.roleId})},emitEnter:function(){this.$emit("enter",this.member)}},created:function(){this.roleId=this.member.role_id}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"list-group-item clearfix",on:{mouseenter:t.emitEnter}},[i("h4",{staticClass:"list-group-item-heading"},[t.editable?i("span",{directives:[{name:"show",rawName:"v-show",value:t.isEditing,expression:"isEditing"}],staticClass:"pull-right"},[i("form",{staticClass:"form-inline"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.roleId,expression:"roleId"}],staticClass:"form-control input-sm",attrs:{disabled:t.isOwnUser,title:"Change the role of "+t.name},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.roleId=e.target.multiple?i:i[0]},t.changeRole]}},t._l(t.roles,(function(e){return i("option",{domProps:{value:e.id,textContent:t._s(e.name)}})})),0),t._v(" "),i("button",{staticClass:"btn btn-default btn-sm",attrs:{disabled:t.isOwnUser,type:"button",title:"Remove "+t.name},on:{click:t.removeMember}},[i("i",{staticClass:"fa fa-trash"})])])]):t._e(),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEditing,expression:"!isEditing"}],staticClass:"pull-right label",class:t.labelClass,domProps:{textContent:t._s(t.role.name)}}),t._v(" "),i("span",{domProps:{textContent:t._s(t.name)}}),t._v(" "),t.isOwnUser?i("span",{staticClass:"text-muted"},[t._v("(you)")]):t._e()]),t._v(" "),t.member.affiliation?i("p",{staticClass:"list-group-item-text text-muted",domProps:{textContent:t._s(t.member.affiliation)}}):t._e()])}),[],!1,null,null,null).exports;const lh=Ml({props:{members:{type:Array,required:!0},ownId:{type:Number,required:!0},editable:{type:Boolean,required:!0},roles:{type:Array,required:!0}},components:{memberListItem:ah},data:function(){return{editingMemberId:null}},computed:{sortedMembers:function(){var t=this,e=this.members.slice();return e.sort((function(e,i){return e.id===t.ownId?-1:i.id===t.ownId?1:0})),e}},methods:{emitRemove:function(t){this.$emit("remove",t)},emitUpdate:function(t,e){this.$emit("update",t,e)},handleEnter:function(t){this.editable&&(this.editingMemberId=t.id)},handleLeave:function(t){null!==t.relatedTarget&&(this.editingMemberId=null)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"list-group",on:{mouseleave:t.handleLeave}},t._l(t.sortedMembers,(function(e){return i("member-list-item",{key:e.id,attrs:{member:e,"own-id":t.ownId,editable:t.editable,editing:t.editingMemberId===e.id,roles:t.roles},on:{remove:t.emitRemove,update:t.emitUpdate,enter:t.handleEnter}})})),1)}),[],!1,null,null,null).exports;const uh=Ml({mixins:[$u],data:function(){return{labelTree:null,members:[],roles:[],defaultRole:null,userId:null}},components:{memberList:lh,addMemberForm:sh},computed:{hasMembers:function(){return 0!==this.members.length}},methods:{attachMember:function(t){var e=this;this.startLoading(),cu.addUser({id:this.labelTree.id},{id:t.id,role_id:t.role_id}).then((function(){return e.memberAttached(t)}),Mu).finally(this.finishLoading)},memberAttached:function(t){this.members.push(t)},updateMember:function(t,e){var i=this;this.startLoading(),cu.updateUser({id:this.labelTree.id,user_id:t.id},{role_id:e.role_id}).then((function(){return i.memberUpdated(t,e)}),Mu).finally(this.finishLoading)},memberUpdated:function(t,e){t.role_id=e.role_id},removeMember:function(t){var e=this;this.startLoading(),cu.removeUser({id:this.labelTree.id,user_id:t.id}).then((function(){return e.memberRemoved(t)}),Mu).finally(this.finishLoading)},memberRemoved:function(t){for(var e=this.members.length-1;e>=0;e--)this.members[e].id===t.id&&this.members.splice(e,1)}},watch:{members:function(t){wu.$emit("label-trees.members.count",t.length)}},created:function(){this.labelTree=biigle.$require("labelTrees.labelTree"),this.members=biigle.$require("labelTrees.members"),this.roles=biigle.$require("labelTrees.roles"),this.defaultRole=biigle.$require("labelTrees.defaultRole"),this.userId=biigle.$require("labelTrees.userId")}},undefined,undefined,!1,null,null,null).exports;const hh=Ml({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){wu.$on("label-trees.members.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;var ch=Ml({props:{item:{type:Object,required:!0},disabled:{type:Boolean,required:!1}},computed:{leftLabel:function(){return this.item.left},rightLabel:function(){return this.item.right},hasLeft:function(){return null!==this.leftLabel},hasRight:function(){return null!==this.rightLabel},labelToAdd:function(){return!this.hasLeft&&this.hasRight},labelToRemove:function(){return this.hasLeft&&!this.hasRight},labelsSame:function(){return this.hasLeft&&this.hasRight},leftColorStyle:function(){return{"background-color":"#"+this.leftLabel.color}},rightColorStyle:function(){return{"background-color":"#"+this.rightLabel.color}},classObject:function(){return{success:this.labelToAdd&&!this.accepted,"label-tree-diff-row--added":this.labelToAdd&&this.accepted,danger:this.labelToRemove&&!this.accepted,"label-tree-diff-row--removed":this.labelToRemove&&this.accepted}},labelStyle:function(){return{"padding-left":22*this.item.level+"px"}},addButtonClass:function(){return{"btn-success":this.accepted}},removeButtonClass:function(){return{"btn-danger":this.accepted}},accepted:function(){return this.item.accepted},acceptable:function(){return this.item.acceptable},labelAdded:function(){return this.labelToAdd&&this.accepted},removeTitle:function(){return this.acceptable?"Accept the deletion":"This label cannot be deleted because it or one of its child labels is used"}},methods:{emitResolved:function(){this.$emit("accepted",this.item)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",{staticClass:"label-tree-diff-row",class:t.classObject},[i("td",{staticClass:"label-tree-diff-row__button"},[t.labelToAdd?i("button",{staticClass:"btn btn-sm btn-default",class:t.addButtonClass,attrs:{disabled:t.disabled,title:"Accept the addition"},on:{click:t.emitResolved}},[i("i",{staticClass:"fa fa-plus"})]):t._e(),t._v(" "),t.labelToRemove?i("button",{staticClass:"btn btn-sm btn-default",class:t.removeButtonClass,attrs:{title:t.removeTitle,disabled:!t.acceptable||t.disabled},on:{click:t.emitResolved}},[i("i",{staticClass:"fa fa-minus"})]):t._e()]),t._v(" "),i("td",{staticClass:"label-tree-diff-row__left"},[t.hasLeft?i("div",{staticClass:"label-tree-label",style:t.labelStyle},[i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.leftColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.leftLabel.name)}})])]):t._e(),t._v(" "),t.labelAdded?i("div",{staticClass:"label-tree-label",style:t.labelStyle},[i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.rightColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.rightLabel.name)}})])]):t._e()]),t._v(" "),i("td",{staticClass:"label-tree-diff-row__right"},[i("div",{staticClass:"label-tree-label",style:t.labelStyle},[t.hasRight?i("div",{staticClass:"label-tree-label__name"},[i("span",{staticClass:"label-tree-label__color",style:t.rightColorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.rightLabel.name)}})]):t._e()])])])}),[],!1,null,null,null);const dh=Ml({components:{labelTreeDiffRow:ch.exports},data:function(){return{diff:[]}},props:{leftLabels:{type:Array,required:!0},leftName:{type:String,default:""},rightLabels:{type:Array,required:!0},rightName:{type:String,default:""},usedLabels:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1}},computed:{leftLabelsById:function(){var t={};return this.leftLabels.forEach((function(e){t[e.id]=e})),t},leftLabelsAsTree:function(){var t=this.generateChildMap(this.leftLabels);return this.generateLabelsAsTree(t.null,t)},rightLabelsAsTree:function(){var t=this.generateChildMap(this.rightLabels);return this.generateLabelsAsTree(t.null,t)},usedLabelMap:function(){var t=this,e={};return this.usedLabels.forEach((function(i){do{e[i]=null,i=t.leftLabelsById[i].parent_id}while(null!==i)})),e},cannotResolveAll:function(){return this.disabled||this.diff.reduce((function(t,e){return e.acceptable?t&&e.accepted:t}),!0)},cannotResolveNone:function(){return this.disabled||this.diff.reduce((function(t,e){return e.acceptable?t&&!e.accepted:t}),!0)},hasDiff:function(){return this.diff.length>0}},methods:{generateChildMap:function(t){var e={};return t.forEach((function(t){e.hasOwnProperty(t.parent_id)?e[t.parent_id].push(t):e[t.parent_id]=[t]})),e},generateLabelsAsTree:function(t,e){var i=this;return t.map((function(t){return e.hasOwnProperty(t.id)?t.children=i.generateLabelsAsTree(e[t.id],e):t.children=[],t})).sort((function(t,e){return t.name+"-"+t.color<=e.name+"-"+e.color?-1:1}))},generateTreeDiff:function(t,e,i,n){var r=this;for(t=t.slice(),e=e.slice(),i=i||[],n=n||0;t.length>0&&e.length>0;){var o=t[0],s=e[0];o.name===s.name?(t.shift(),e.shift(),i.push({id:o.id,level:n,left:o,right:s}),this.generateTreeDiff(o.children,s.children,i,n+1)):o.name<s.name?(t.shift(),i.push({id:o.id,level:n,accepted:!1,acceptable:!this.usedLabelMap.hasOwnProperty(o.id),left:o,right:null}),this.generateTreeDiff(o.children,[],i,n+1)):(e.shift(),i.push({id:s.id,level:n,accepted:!1,acceptable:!0,left:null,right:s}),this.generateTreeDiff([],s.children,i,n+1))}return t.length>0&&t.forEach((function(t){i.push({id:t.id,level:n,accepted:!1,acceptable:!r.usedLabelMap.hasOwnProperty(t.id),left:t,right:null}),r.generateTreeDiff(t.children,[],i,n+1)})),e.length>0&&e.forEach((function(t){i.push({id:t.id,level:n,accepted:!1,acceptable:!0,left:null,right:t}),r.generateTreeDiff([],t.children,i,n+1)})),i},filterRelevantItems:function(t){var e=[];return t.forEach((function(t,i){null!==t.left&&null!==t.right||e.push(i)})),e.forEach((function(e){t[e].relevant=!0;for(var i=t[e].level,n=e;n>=0&&i>0;)t[n].level<i&&(t[n].relevant=!0,i=t[n].level),n-=1})),t.filter((function(t){return t.relevant}))},handleResolved:function(t){t.acceptable&&(t.accepted?(this.cancelResolved(t),null===t.left?this.acceptCancelAddAllChildren(t):null===t.right&&this.acceptCancelDeleteAllParents(t)):(this.setResolved(t),null===t.left?this.acceptAddAllParents(t):null===t.right&&this.acceptDeleteAllChildren(t)))},cancelResolved:function(t){null===t.left?this.$emit("cancel-add",t.right):null===t.right&&this.$emit("cancel-remove",t.left),t.accepted=!1},setResolved:function(t){null===t.left?this.$emit("add",t.right):null===t.right&&this.$emit("remove",t.left),t.accepted=!0},acceptAll:function(){var t=this;this.diff.forEach((function(e){e.accepted||t.handleResolved(e)}))},acceptNone:function(){var t=this;this.diff.forEach((function(e){e.accepted&&t.handleResolved(e)}))},doForAllChildren:function(t,e){for(var i=t.level+1,n=this.diff.indexOf(t)+1;this.diff[n]&&this.diff[n].level>=i;)e.call(this,this.diff[n]),n+=1},doForAllParents:function(t,e){for(var i=t.level,n=this.diff.indexOf(t)-1;i>0&&n>=0;)this.diff[n].level<i&&(i=this.diff[n].level,e.call(this,this.diff[n])),n-=1},acceptDeleteAllChildren:function(t){this.doForAllChildren(t,(function(t){null===t.right&&this.setResolved(t)}))},acceptCancelAddAllChildren:function(t){this.doForAllChildren(t,(function(t){null===t.left&&this.cancelResolved(t)}))},acceptAddAllParents:function(t){this.doForAllParents(t,(function(t){null===t.left&&this.setResolved(t)}))},acceptCancelDeleteAllParents:function(t){this.doForAllParents(t,(function(t){null===t.right&&this.cancelResolved(t)}))},setLeftParentIds:function(t){var e={};return t.forEach((function(t){t.right&&t.left&&(e[t.right.id]=t.left.id)})),t.forEach((function(t){t.right&&t.right.parent_id&&(t.right.left_parent_id=e[t.right.parent_id])})),t}},created:function(){var t=this.generateTreeDiff(this.leftLabelsAsTree,this.rightLabelsAsTree);t=this.filterRelevantItems(t),t=this.setLeftParentIds(t),this.diff=t}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"label-tree-diff"},[t.hasDiff?i("div",[i("button",{staticClass:"btn btn-default",attrs:{title:"Accept all merge items",disabled:t.cannotResolveAll},on:{click:t.acceptAll}},[t._v("\n                Accept all\n        ")]),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{title:"Set all merge items as not accepted",disabled:t.cannotResolveNone},on:{click:t.acceptNone}},[t._v("\n                Accept none\n        ")])]):t._e(),t._v(" "),t.hasDiff?i("table",{staticClass:"table table-hover"},[i("thead",[i("tr",[i("th"),t._v(" "),i("th",{domProps:{textContent:t._s(t.leftName)}}),t._v(" "),i("th",{domProps:{textContent:t._s(t.rightName)}})])]),t._v(" "),i("tbody",t._l(t.diff,(function(e){return i("label-tree-diff-row",{key:e.id,attrs:{item:e,disabled:t.disabled},on:{accepted:t.handleResolved}})})),1)]):i("div",{staticClass:"text-center lead"},[t._v("\n        The label trees are identical.\n    ")])])}),[],!1,null,null,null).exports,fh=Vue.resource("api/v1/label-trees{/id}/merge-labels");const ph=Ml({mixins:[$u],components:{labelTreeDiff:dh},data:function(){return{baseTree:null,mergeTree:null,usedLabels:[],toAdd:[],toRemove:[],merged:!1}},computed:{baseTreeLabels:function(){return this.baseTree.labels},mergeTreeLabels:function(){return this.mergeTree.labels},cannotMerge:function(){return this.loading||0===this.toAdd.length&&0===this.toRemove.length},disableDiff:function(){return this.loading||this.merged}},methods:{handleAdd:function(t){-1===this.toAdd.indexOf(t)&&this.toAdd.push(t)},handleRemove:function(t){-1===this.toRemove.indexOf(t)&&this.toRemove.push(t)},handleCancelAdd:function(t){var e=this.toAdd.indexOf(t);-1!==e&&this.toAdd.splice(e,1)},handleCancelRemove:function(t){var e=this.toRemove.indexOf(t);-1!==e&&this.toRemove.splice(e,1)},bundleToAdd:function(t){var e={};t.forEach((function(t){e[t.id]={name:t.name,color:t.color,parent_id:t.parent_id,left_parent_id:t.left_parent_id}}));var i=[];return Object.keys(e).forEach((function(t){var n=e[t];n.parent_id&&e.hasOwnProperty(n.parent_id)?(e[n.parent_id].children?e[n.parent_id].children.push(n):e[n.parent_id].children=[n],delete n.parent_id,delete n.left_parent_id):(delete n.parent_id,n.left_parent_id&&(n.parent_id=n.left_parent_id),delete n.left_parent_id,i.push(n))})),i},bundleToRemove:function(t){return t.map((function(t){return t.id}))},submitMerge:function(){this.startLoading();var t=this.bundleToAdd(this.toAdd),e=this.bundleToRemove(this.toRemove);fh.save({id:this.baseTree.id},{create:t,remove:e}).then(this.handleMergeSuccess,this.handleMergeError)},handleMergeError:function(t){this.finishLoading(),Mu(t)},handleMergeSuccess:function(){this.merged=!0}},created:function(){this.baseTree=biigle.$require("labelTrees.baseTree"),this.mergeTree=biigle.$require("labelTrees.mergeTree"),this.usedLabels=biigle.$require("labelTrees.usedLabels")}},undefined,undefined,!1,null,null,null).exports;const gh=Ml({components:{typeahead:Eu},data:function(){return{mergeUrlTemplate:null,mergeCandidates:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.description"></small>',chosenCandidate:null}},computed:{cannotContinue:function(){return null===this.chosenCandidate},continueUrl:function(){return this.chosenCandidate?this.mergeUrlTemplate.replace(":id",this.chosenCandidate.id):""}},methods:{parseLabelTreeVersionedName:function(t){return t.version&&(t.name=t.name+" @ "+t.version.name),t},chooseCandidate:function(t){this.chosenCandidate=t}},created:function(){this.mergeUrlTemplate=biigle.$require("labelTrees.mergeUrlTemplate"),this.mergeCandidates=biigle.$require("labelTrees.mergeCandidates").map(this.parseLabelTreeVersionedName)}},undefined,undefined,!1,null,null,null).exports;const mh=Ml({mixins:[$u,Du],data:function(){return{labelTree:null,name:null,description:null,visibility_id:null,userId:null,redirectUrl:null,privateVisibilityId:null}},computed:{isPrivate:function(){return this.labelTree.visibility_id===this.privateVisibilityId},hasDescription:function(){return!!this.description},isChanged:function(){return this.name!==this.labelTree.name||this.description!==this.labelTree.description||parseInt(this.visibility_id)!==this.labelTree.visibility_id},disabledClass:function(){return this.loading?"disabled":""}},methods:{discardChanges:function(){this.finishEditing(),this.name=this.labelTree.name,this.description=this.labelTree.description,this.visibility_id=this.labelTree.visibility_id},leaveTree:function(){confirm("Do you really want to revoke your membership of label tree '".concat(this.labelTree.name,"'?"))&&(this.startLoading(),cu.removeUser({id:this.labelTree.id,user_id:this.userId}).then(this.treeLeft,Mu).finally(this.finishLoading))},treeLeft:function(){var t=this;this.isPrivate?(Ou.success("You left the label tree. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)):location.reload()},deleteTree:function(){confirm("Do you really want to delete the label tree '".concat(this.labelTree.name,"'?"))&&(this.startLoading(),cu.delete({id:this.labelTree.id}).then(this.treeDeleted,Mu).finally(this.finishLoading))},treeDeleted:function(){var t=this;Ou.success("The label tree was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},saveChanges:function(){this.startLoading(),cu.update({id:this.labelTree.id},{name:this.name,description:this.description,visibility_id:this.visibility_id}).then(this.changesSaved,Mu).finally(this.finishLoading)},changesSaved:function(){this.labelTree.name=this.name,this.labelTree.description=this.description,this.labelTree.visibility_id=parseInt(this.visibility_id),this.finishEditing()}},created:function(){this.privateVisibilityId=biigle.$require("labelTrees.privateVisibilityId"),this.labelTree=biigle.$require("labelTrees.labelTree"),this.userId=biigle.$require("labelTrees.userId"),this.redirectUrl=biigle.$require("labelTrees.redirectUrl"),this.name=this.labelTree.name,this.description=this.labelTree.description,this.visibility_id=this.labelTree.visibility_id}},undefined,undefined,!1,null,null,null).exports;const vh=Ml({mixins:[$u],data:function(){return{doi:"",doiSaved:!1,version:null}},computed:{doiUrl:function(){return"https://doi.org/"+this.doi},doiTitle:function(){return"DOI: "+this.doi}},methods:{cleanDoi:function(t){return t.replace(/^https?:\/\/doi\.org\//,"")},saveDoi:function(){this.doi=this.cleanDoi(this.doi),du.update({id:this.version.id},{doi:this.doi}).then(this.handleDoiSaved,Mu)},handleDoiSaved:function(){this.doiSaved=!0}},created:function(){this.version=biigle.$require("labelTrees.version")}},undefined,undefined,!1,null,null,null).exports;const yh=Ml({mixins:[$u],data:function(){return{version:null,redirectUrl:null}},computed:{disabledClass:function(){return this.loading?"disabled":""}},methods:{deleteVersion:function(){this.startLoading(),du.delete({id:this.version.id}).then(this.deleteSuccess,Mu)},deleteSuccess:function(){var t=this;Ou.success("The label tree version was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)}},created:function(){this.version=biigle.$require("labelTrees.version"),this.redirectUrl=biigle.$require("labelTrees.redirectUrl")}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("label-tree-version-doi",vh),biigle.$mount("label-tree-version-title",yh),biigle.$mount("label-trees-authorized-projects",Yu),biigle.$mount("label-trees-labels",rh),biigle.$mount("label-trees-labels-count",oh),biigle.$mount("label-trees-members",uh),biigle.$mount("label-trees-members-count",hh),biigle.$mount("label-trees-title",mh),biigle.$mount("merge-label-trees-container",ph),biigle.$mount("merge-label-trees-index-container",gh);const _h=Ml({props:{id:{type:Number,required:!0},thumbUris:{required:!0},removable:{type:Boolean,default:!1},removeTitle:{type:String,default:"Remove this volume"},icon:{type:String}},data:function(){return{index:0,uris:[],loaded:[],touched:!1,hovered:!1}},computed:{progress:function(){return 100*this.index/(this.uris.length-1)+"%"},showFallback:function(){return!1===this.uris[this.index]},showPreview:function(){return this.touched&&this.someLoaded},someLoaded:function(){return this.loaded.some((function(t){return t}))},iconClass:function(){return this.icon?"fa-"+this.icon:""},showIcon:function(){return this.removable?!this.hovered&&this.icon:this.icon},showRemove:function(){return this.removable&&this.hovered}},methods:{thumbShown:function(t){return this.index===t&&this.loaded[t]},updateIndex:function(t){var e=this.$el.getBoundingClientRect();this.index=Math.max(0,Math.floor(this.uris.length*(t.clientX-e.left)/e.width))},remove:function(){this.$emit("remove",this.id)},uriLoaded:function(t){this.loaded.splice(t,1,!0)},setHovered:function(){this.hovered=!0,this.touched=!0},unsetHovered:function(){this.hovered=!1},emitClick:function(t){this.$emit("click",t)}},created:function(){Array.isArray(this.thumbUris)?this.uris=this.thumbUris.slice():this.uris=this.thumbUris.split(","),this.loaded=this.uris.map((function(){return!1}))}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("figure",{staticClass:"preview-thumbnail",on:{mousemove:function(e){return t.updateIndex(e)},mouseenter:t.setHovered,mouseleave:t.unsetHovered,click:t.emitClick}},[t.showIcon?i("i",{staticClass:"preview-thumbnail__icon fas fa-lg",class:t.iconClass}):t._e(),t._v(" "),t.showRemove?i("button",{staticClass:"btn btn-default btn-sm preview-thumbnail__icon",attrs:{title:t.removeTitle},on:{click:function(e){return e.preventDefault(),t.remove(e)}}},[i("i",{staticClass:"fas fa-trash"})]):t._e(),t._v(" "),t.touched?i("div",{directives:[{name:"show",rawName:"v-show",value:t.showPreview,expression:"showPreview"}],staticClass:"preview-thumbnail__images"},t._l(t.uris,(function(e,n){return i("img",{directives:[{name:"show",rawName:"v-show",value:t.thumbShown(n),expression:"thumbShown(i)"}],attrs:{src:e},on:{load:function(e){return t.uriLoaded(n)}}})})),0):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.showPreview,expression:"!showPreview"}],staticClass:"preview-thumbnail__fallback"},[t._t("default")],2),t._v(" "),t._t("caption"),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.someLoaded,expression:"someLoaded"}],staticClass:"preview-thumbnail__progress",style:{width:t.progress}})],2)}),[],!1,null,null,null).exports;const bh=Ml({components:{previewThumbnail:_h}},undefined,undefined,!1,null,null,null).exports;const wh=Ml({props:{tree:{type:Object,required:!0},baseUri:{type:String,required:!0},editable:{type:Boolean,required:!0},editing:{type:Boolean,default:!1}},computed:{url:function(){return this.baseUri+"/"+this.tree.id}},methods:{emitRemove:function(){this.$emit("remove",this.tree)},emitEnter:function(){this.$emit("enter",this.tree)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"list-group-item",on:{mouseenter:t.emitEnter}},[i("h4",{staticClass:"list-group-item-heading"},[t.editable?i("button",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"btn btn-default btn-sm pull-right",attrs:{type:"button",title:"Detach this label tree"},on:{click:t.emitRemove}},[i("i",{staticClass:"fa fa-trash"})]):t._e(),t._v(" "),i("a",{attrs:{href:t.url},domProps:{textContent:t._s(t.tree.name)}})]),t._v(" "),t.tree.description?i("p",{staticClass:"list-group-item-text",domProps:{textContent:t._s(t.tree.description)}}):t._e()])}),[],!1,null,null,null).exports;var xh=Ml({props:{labelTrees:{type:Array,required:!0},baseUri:{type:String,required:!0},editable:{type:Boolean,required:!0}},components:{listItem:wh},data:function(){return{editingTreeId:null}},methods:{emitRemove:function(t){this.$emit("remove",t)},handleEnter:function(t){this.editable&&(this.editingTreeId=t.id)},handleLeave:function(t){null!==t.relatedTarget&&(this.editingTreeId=null)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"list-group",on:{mouseleave:t.handleLeave}},t._l(t.labelTrees,(function(e){return i("list-item",{key:e.id,attrs:{tree:e,editable:t.editable,"base-uri":t.baseUri,editing:t.editingTreeId===e.id},on:{remove:t.emitRemove,enter:t.handleEnter}})})),1)}),[],!1,null,null,null);const Sh=Ml({mixins:[$u],components:{typeahead:Eu,labelTreeList:xh.exports},data:function(){return{project:null,canEdit:!1,labelTrees:[],fetchedAvailableLabelTrees:!1,availableLabelTrees:[],typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.description"></small>'}},computed:{hasLabelTrees:function(){return this.labelTrees.length>0},labelTreeIds:function(){return this.labelTrees.map((function(t){return t.id}))},attachableLabelTrees:function(){var t=this;return this.availableLabelTrees.filter((function(e){return-1===t.labelTreeIds.indexOf(e.id)}))}},methods:{fetchAvailableLabelTrees:function(){this.fetchedAvailableLabelTrees||(this.fetchedAvailableLabelTrees=!0,this.startLoading(),pu.queryAvailableLabelTrees({id:this.project.id}).then(this.availableLabelTreesFetched,Mu).finally(this.finishLoading))},availableLabelTreesFetched:function(t){this.availableLabelTrees=t.data.map(this.parseLabelTreeVersionedName)},attachTree:function(t){var e=this;t&&(this.startLoading(),pu.attachLabelTree({id:this.project.id},{id:t.id}).then((function(){return e.treeAttached(t)}),Mu).finally(this.finishLoading))},treeAttached:function(t){for(var e=this.availableLabelTrees.length-1;e>=0;e--)this.availableLabelTrees[e].id===t.id&&this.availableLabelTrees.splice(e,1);this.labelTrees.push(t)},removeTree:function(t){var e=this;this.startLoading(),pu.detachLabelTree({id:this.project.id,label_tree_id:t.id}).then((function(){return e.treeRemoved(t)}),Mu).finally(this.finishLoading)},treeRemoved:function(t){for(var e=this.labelTrees.length-1;e>=0;e--)this.labelTrees[e].id===t.id&&this.labelTrees.splice(e,1);this.availableLabelTrees.push(t)},parseLabelTreeVersionedName:function(t){return t.version&&(t.name=t.name+" @ "+t.version.name),t}},watch:{labelTrees:function(t){wu.$emit("project.label-trees.count",t.length)}},created:function(){this.canEdit=biigle.$require("projects.canEdit"),this.labelTrees=biigle.$require("projects.labelTrees").map(this.parseLabelTreeVersionedName),this.project=biigle.$require("projects.project")}},undefined,undefined,!1,null,null,null).exports;const Ch=Ml({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){wu.$on("project.label-trees.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;const Eh=Ml({mixins:[$u],data:function(){return{project:null,canEdit:!1,members:[],roles:{},defaultRole:null,userId:null}},components:{memberList:lh,addMemberForm:sh},methods:{attachMember:function(t){var e=this;this.startLoading(),pu.addUser({id:this.project.id,user_id:t.id},{project_role_id:t.role_id}).then((function(){return e.memberAttached(t)}),Mu).finally(this.finishLoading)},memberAttached:function(t){this.members.push(t)},updateMember:function(t,e){var i=this;this.startLoading(),pu.updateUser({id:this.project.id,user_id:t.id},{project_role_id:e.role_id}).then((function(){return i.memberUpdated(t,e)}),Mu).finally(this.finishLoading)},memberUpdated:function(t,e){t.role_id=e.role_id},removeMember:function(t){var e=this;this.startLoading(),pu.removeUser({id:this.project.id,user_id:t.id}).then((function(){return e.memberRemoved(t)}),Mu).finally(this.finishLoading)},memberRemoved:function(t){for(var e=this.members.length-1;e>=0;e--)this.members[e].id===t.id&&this.members.splice(e,1)}},watch:{members:function(t){wu.$emit("project.members.count",t.length)}},created:function(){this.project=biigle.$require("projects.project"),this.canEdit=biigle.$require("projects.canEdit"),this.roles=biigle.$require("projects.roles"),this.defaultRole=biigle.$require("projects.defaultRole"),this.members=biigle.$require("projects.members"),this.userId=biigle.$require("projects.userId")}},undefined,undefined,!1,null,null,null).exports;const Th=Ml({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){wu.$on("project.members.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;const Ih=Ml({mixins:[$u,Du],data:function(){return{project:null,name:null,description:null,userId:null,redirectUrl:null}},computed:{hasDescription:function(){return!!this.description.length},isChanged:function(){return this.name!==this.project.name||this.description!==this.project.description},disabledClass:function(){return this.loading?"disabled":""}},methods:{discardChanges:function(){this.name=this.project.name,this.description=this.project.description,this.finishEditing()},leaveProject:function(){confirm('Do you really want to revoke your membership of project "'.concat(this.project.name,'"?'))&&(this.startLoading(),pu.removeUser({id:this.project.id,user_id:this.userId}).then(this.projectLeft,Mu).finally(this.finishLoading))},projectLeft:function(){var t=this;Ou.success("You left the project. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},deleteProject:function(){confirm("Do you really want to delete the project ".concat(this.project.name,"?"))&&(this.startLoading(),pu.delete({id:this.project.id}).then(this.projectDeleted,this.maybeForceDeleteProject).finally(this.finishLoading))},maybeForceDeleteProject:function(t){400===t.status?confirm("Deleting this project will delete one or more volumes with all annotations! Do you want to continue?")&&(this.startLoading(),pu.delete({id:this.project.id},{force:!0}).then(this.projectDeleted,Mu).finally(this.finishLoading)):Mu(t)},projectDeleted:function(){var t=this;Ou.success("The project was deleted. Redirecting..."),setTimeout((function(){return location.href=t.redirectUrl}),2e3)},saveChanges:function(){this.startLoading(),pu.update({id:this.project.id},{name:this.name,description:this.description}).then(this.changesSaved,Mu).finally(this.finishLoading)},changesSaved:function(){this.project.name=this.name,this.project.description=this.description,this.finishEditing()}},created:function(){this.project=biigle.$require("projects.project"),this.name=this.project.name,this.description=this.project.description,this.userId=biigle.$require("projects.userId"),this.redirectUrl=biigle.$require("projects.redirectUrl")}},undefined,undefined,!1,null,null,null).exports,Ah=Vue.resource("api/v1/projects{/id}/attachable-volumes");const kh=Ml({mixins:[$u],data:function(){return{project:null,volumes:[],fetchedAttachableVolumes:!1,attachableVolumes:[],filterString:"",showImageVolumes:!0,showVideoVolumes:!0}},components:{previewThumbnail:_h,typeahead:Eu},computed:{filteredVolumes:function(){var t=this.volumes;if(this.showImageVolumes||(t=t.filter((function(t){return"image"!==t.media_type.name}))),this.showVideoVolumes||(t=t.filter((function(t){return"video"!==t.media_type.name}))),this.hasFiltering){var e=this.filterString.toLowerCase();t=t.filter((function(t){return t.name.toLowerCase().includes(e)}))}return t},hasFiltering:function(){return this.filterString.length>0},filterInputClass:function(){return this.hasFiltering?"volume-filter--active":""},hasVolumes:function(){return this.volumes.length>0},hasNoMatchingVolumes:function(){return this.hasVolumes&&0===this.filteredVolumes.length},hasMixedMediaTypes:function(){return this.volumes.some((function(t){return"image"===t.media_type.name}))&&this.volumes.some((function(t){return"video"===t.media_type.name}))},toggleImageVolumesClass:function(){return this.showVideoVolumes?"btn-default":"btn-info active"},toggleVideoVolumesClass:function(){return this.showImageVolumes?"btn-default":"btn-info active"}},methods:{removeVolume:function(t){var e=this;this.startLoading(),pu.detachVolume({id:this.project.id,volume_id:t}).then((function(){return e.volumeRemoved(t)}),(function(i){400===i.status?confirm("The volume you are about to remove belongs only to this project and will be deleted. Are you sure you want to delete this volume?")&&e.forceRemoveVolume(t):Mu(i)})).finally(this.finishLoading)},forceRemoveVolume:function(t){var e=this;this.startLoading(),pu.detachVolume({id:this.project.id,volume_id:t},{force:!0}).then((function(){return e.volumeRemoved(t)}),Mu).finally(this.finishLoading)},volumeRemoved:function(t){for(var e=this.volumes.length-1;e>=0;e--)this.volumes[e].id===t&&(this.attachableVolumes.unshift(this.volumes[e]),this.volumes.splice(e,1))},hasVolume:function(t){for(var e=this.volumes.length-1;e>=0;e--)if(this.volumes[e].id===t)return!0;return!1},attachVolume:function(t){var e=this;t&&!this.hasVolume(t.id)&&(this.startLoading(),pu.attachVolume({id:this.project.id,volume_id:t.id},{}).then((function(){return e.volumeAttached(t)}),Mu).finally(this.finishLoading))},volumeAttached:function(t){this.volumes.unshift(t);for(var e=this.attachableVolumes.length-1;e>=0;e--)this.attachableVolumes[e].id===t.id&&this.attachableVolumes.splice(e,1)},fetchAttachableVolumes:function(){this.fetchedAttachableVolumes||(this.fetchedAttachableVolumes=!0,this.startLoading(),Ah.get({id:this.project.id}).then(this.attachableVolumesFetched,Mu).finally(this.finishLoading))},attachableVolumesFetched:function(t){this.attachableVolumes=t.data.map(this.processVolumes)},clearFiltering:function(t){t.preventDefault(),this.filterString=""},toggleImageVolumes:function(){this.showVideoVolumes=!this.showVideoVolumes,this.showImageVolumes||this.showVideoVolumes||(this.showImageVolumes=!0)},toggleVideoVolumes:function(){this.showImageVolumes=!this.showImageVolumes,this.showVideoVolumes||this.showImageVolumes||(this.showVideoVolumes=!0)},processVolumes:function(t){return t.icon="image"===t.media_type.name?"image":"film",t}},watch:{volumes:function(t){wu.$emit("project.volumes.count",t.length)}},created:function(){this.project=biigle.$require("projects.project"),this.volumes=biigle.$require("projects.volumes").map(this.processVolumes)}},undefined,undefined,!1,null,null,null).exports;const Ph=Ml({methods:{updateCount:function(t){this.$el.textContent=t}},created:function(){wu.$on("project.volumes.count",this.updateCount)}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("project-label-trees-count",Ch),biigle.$mount("project-members-count",Th),biigle.$mount("project-volumes-count",Ph),biigle.$mount("projects-dashboard-main",bh),biigle.$mount("projects-show-label-trees",Sh),biigle.$mount("projects-show-members",Eh),biigle.$mount("projects-show-volumes",kh),biigle.$mount("projects-title",Ih);const Lh=Ml({props:{rule:{type:Object,required:!0}},data:function(){return{name:this.rule.id}},computed:{dataName:function(){return this.rule.data?this.rule.data.name:""}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[i("strong",[t._v("with"),t.rule.negate?i("span",[t._v("out")]):t._e()]),t._v(" "),i("span",{domProps:{textContent:t._s(t.name)}}),t._v(" "),t.dataName?i("strong",{domProps:{textContent:t._s(t.dataName)}}):t._e()])}),[],!1,null,null,null).exports;const Rh=Ml({components:{typeahead:Eu},props:{volumeId:{type:Number,required:!0}},data:function(){return{items:[],placeholder:"",selectedItem:null,typeaheadTemplate:void 0}},computed:{value:function(){return this.selectedItem?this.selectedItem.name:""}},methods:{select:function(t){this.selectedItem=t},gotItems:function(t){this.items=t.data},parseUsernames:function(t){return t.data=t.data.map((function(t){return t.name=t.firstname+" "+t.lastname,t})),t},submit:function(){this.$emit("select",this.selectedItem)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filter-select"},[i("typeahead",{attrs:{items:t.items,value:t.value,placeholder:t.placeholder,template:t.typeaheadTemplate},on:{select:t.select}}),t._v(" "),i("button",{staticClass:"btn btn-default",attrs:{type:"submit",disabled:!t.selectedItem},on:{click:t.submit}},[t._v("Add rule")])],1)}),[],!1,null,null,null).exports,Fh=Vue.resource("api/v1/volumes{/id}",{},{queryFilesWithFileLabels:{method:"GET",url:"api/v1/volumes{/id}/files/filter/labels"},queryFilesWithLabel:{method:"GET",url:"api/v1/volumes{/id}/files/filter/labels{/label_id}"},queryFilesWithLabelFromUser:{method:"GET",url:"api/v1/volumes{/id}/files/filter/labels/users{/user_id}"},queryFilesWithFilename:{method:"GET",url:"api/v1/volumes{/id}/files/filter/filename{/pattern}"},queryUsedFileLabels:{method:"GET",url:"api/v1/volumes{/id}/file-labels"},queryFilenames:{method:"GET",url:"api/v1/volumes{/id}/filenames"},queryFileLabels:{method:"GET",url:"api/v1/volumes{/id}/files/labels"},queryUsers:{method:"GET",url:"api/v1/volumes{/id}/users"},queryFiles:{method:"GET",url:"api/v1/volumes{/id}/files"},saveFiles:{method:"POST",url:"api/v1/volumes{/id}/files"},queryFilesWithAnnotations:{method:"GET",url:"api/v1/volumes{/id}/files/filter/annotations"},queryFilesWithAnnotationLabel:{method:"GET",url:"api/v1/volumes{/id}/files/filter/annotation-label{/label_id}"},queryFilesWithAnnotationFromUser:{method:"GET",url:"api/v1/volumes{/id}/files/filter/annotation-user{/user_id}"},queryAnnotationLabels:{method:"GET",url:"api/v1/volumes{/id}/annotation-labels"}});const Mh=[{id:"fileLabels",types:["image"],label:"image labels",help:"All images that (don't) have image labels attached.",listComponent:{mixins:[Lh],data:function(){return{name:"image labels"}}},getSequence:function(t){return Fh.queryFilesWithFileLabels({id:t})}},{id:"fileLabels",types:["video"],label:"video labels",help:"All videos that (don't) have video labels attached.",listComponent:{mixins:[Lh],data:function(){return{name:"video labels"}}},getSequence:function(t){return Fh.queryFilesWithFileLabels({id:t})}},{id:"imageLabel",types:["image"],label:"image label",help:"All images that (don't) have the given image label attached.",listComponent:{mixins:[Lh],data:function(){return{name:"image label"}}},selectComponent:{mixins:[Rh],components:{typeahead:Ku},data:function(){return{placeholder:"Label name"}},created:function(){Fh.queryUsedFileLabels({id:this.volumeId}).then(this.gotItems,Mu)}},getSequence:function(t,e){return Fh.queryFilesWithLabel({id:t,label_id:e.id})}},{id:"videoLabel",types:["video"],label:"video label",help:"All videos that (don't) have the given video label attached.",listComponent:{mixins:[Lh],data:function(){return{name:"video label"}}},selectComponent:{mixins:[Rh],components:{typeahead:Ku},data:function(){return{placeholder:"Label name"}},created:function(){Fh.queryUsedFileLabels({id:this.volumeId}).then(this.gotItems,Mu)}},getSequence:function(t,e){return Fh.queryFilesWithLabel({id:t,label_id:e.id})}},{id:"imageLabelUser",types:["image"],label:"image label from user",help:"All images that (don't) have one or more image labels attached by the given user.",listComponent:{mixins:[Lh],data:function(){return{name:"image label from user"}}},selectComponent:{mixins:[Rh],data:function(){return{placeholder:"User name",typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},created:function(){Fh.queryUsers({id:this.volumeId}).then(this.parseUsernames,Mu).then(this.gotItems)}},getSequence:function(t,e){return Fh.queryFilesWithLabelFromUser({id:t,user_id:e.id})}},{id:"videoLabelUser",types:["video"],label:"video label from user",help:"All videos that (don't) have one or more video labels attached by the given user.",listComponent:{mixins:[Lh],data:function(){return{name:"video label from user"}}},selectComponent:{mixins:[Rh],data:function(){return{placeholder:"User name",typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},created:function(){Fh.queryUsers({id:this.volumeId}).then(this.parseUsernames,Mu).then(this.gotItems)}},getSequence:function(t,e){return Fh.queryFilesWithLabelFromUser({id:t,user_id:e.id})}},{id:"filename",types:["image","video"],label:"filename",help:"All :types that (don't) have a filename matching the given pattern. A pattern may contain the wildcard character * that matches any string of zero or more characters.",listComponent:{mixins:[Lh],computed:{dataName:function(){return this.rule.data}}},selectComponent:{template:'<div class="filter-select">\n            <div class="typeahead">\n                <input class="form-control" type="text" v-model="selectedItem" placeholder="Filename pattern">\n            </div>\n            <button type="submit" class="btn btn-default" @click="submit" :disabled="!selectedItem">Add rule</button>\n        </div>',data:function(){return{selectedItem:null}},methods:{submit:function(){this.$emit("select",this.selectedItem)}}},getSequence:function(t,e){return Fh.queryFilesWithFilename({id:t,pattern:e})}},{id:"annotations",types:["image","video"],label:"annotations",help:"All :types that (don't) contain annotations.",listComponent:Lh,getSequence:function(t){return Fh.queryFilesWithAnnotations({id:t})}},{id:"annotationLabels",types:["image","video"],label:"annotation with label",help:"All :types that (don't) contain one or more annotations with the given label.",listComponent:{mixins:[Lh],data:function(){return{name:"annotation with label"}}},selectComponent:{mixins:[Rh],components:{typeahead:Ku},data:function(){return{placeholder:"Label name"}},created:function(){Fh.queryAnnotationLabels({id:this.volumeId}).then(this.gotItems,Mu)}},getSequence:function(t,e){return Fh.queryFilesWithAnnotationLabel({id:t,label_id:e.id})}},{id:"annotationUser",types:["image","video"],label:"annotations from user",help:"All :types that (don't) contain one or more annotations from the given user.",listComponent:{mixins:[Lh],data:function(){return{name:"annotations from user"}}},selectComponent:{mixins:[Rh],data:function(){return{placeholder:"User name",typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},created:function(){Fh.queryUsers({id:this.volumeId}).then(this.parseUsernames,Mu).then(this.gotItems)}},getSequence:function(t,e){return Fh.queryFilesWithAnnotationFromUser({id:t,user_id:e.id})}}];const Oh=Ml({data:function(){return{thumbnailUrl:null,timeout:null}},props:{image:{type:Object,required:!0},emptyUrl:{type:String,required:!0},selectable:{type:Boolean,required:!1},selectedIcon:{type:String,default:"check"},selectedFade:{type:Boolean,default:!0},smallIcon:{type:Boolean,default:!1}},computed:{classObject:function(){return{"image-grid__image--selected":this.selected,"image-grid__image--selectable":this.selectable,"image-grid__image--fade":this.selectedFade,"image-grid__image--small-icon":this.smallIcon}},selected:function(){return!1},iconClass:function(){return"fa-"+this.selectedIcon},showIcon:function(){return this.selectable||this.selected},srcUrl:function(){return Array.isArray(this.thumbnailUrl)?this.thumbnailUrl[0]:this.thumbnailUrl?this.thumbnailUrl:this.emptyUrl}},methods:{toggleSelect:function(t){this.selectable&&this.$emit("select",this.image,t)},gotBlob:function(t){var e=window.URL||window.webkitURL;this.thumbnailUrl=e.createObjectURL(t.body),this.image.blob=this.thumbnailUrl},showEmptyImage:function(){this.thumbnailUrl=null}},created:function(){var t=this;this.image.thumbnailUrl?this.thumbnailUrl=this.image.thumbnailUrl:this.image.blob?this.thumbnailUrl=this.image.blob:this.getThumbnailUrl?this.thumbnailUrl=this.getThumbnailUrl():this.getBlob&&(this.timeout=setTimeout((function(){return t.getBlob().then(t.gotBlob)}),50))},beforeDestroy:function(){clearTimeout(this.timeout)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("figure",{staticClass:"image-grid__image",class:t.classObject},[t.showIcon?i("div",{staticClass:"image-icon"},[i("i",{staticClass:"fas",class:t.iconClass})]):t._e(),t._v(" "),i("img",{attrs:{src:t.srcUrl},on:{click:t.toggleSelect,error:t.showEmptyImage}})])}),[],!1,null,null,null).exports;var Dh=Ml({data:function(){return{scrolling:!1}},props:{progress:{type:Number,required:!0}},computed:{isAtTop:function(){return 0===this.progress},isAtBottom:function(){return 1===this.progress},progressHeight:function(){return 100*this.progress+"%"}},methods:{top:function(){this.$emit("top")},prevPage:function(){this.$emit("prev-page")},prevRow:function(){this.$emit("prev-row")},beginScrolling:function(){this.scrolling=!0},stopScrolling:function(){this.scrolling=!1},scroll:function(t){this.scrolling&&this.jump(t)},jump:function(t){var e=t.target.getBoundingClientRect();this.$emit("jump",(t.clientY-e.top)/e.height)},nextRow:function(){this.$emit("next-row")},nextPage:function(){this.$emit("next-page")},bottom:function(){this.$emit("bottom")}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid-progress"},[i("div",{staticClass:"btn-group-vertical"},[i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Go to top 𝗛𝗼𝗺𝗲",disabled:t.isAtTop},on:{click:t.top}},[i("span",{staticClass:"fa fa-fast-backward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Previous page 𝗣𝗮𝗴𝗲 𝘂𝗽/𝗔𝗿𝗿𝗼𝘄 𝗹𝗲𝗳𝘁",disabled:t.isAtTop},on:{click:t.prevPage}},[i("span",{staticClass:"fa fa-step-backward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Previous row 𝗔𝗿𝗿𝗼𝘄 𝘂𝗽",disabled:t.isAtTop},on:{click:t.prevRow}},[i("span",{staticClass:"fa fa-chevron-up"})])]),t._v(" "),i("div",{staticClass:"image-grid-progress__bar",on:{mousedown:t.beginScrolling,mouseup:t.stopScrolling,mouseleave:t.stopScrolling,mousemove:function(e){return e.preventDefault(),t.scroll(e)},click:t.jump}},[i("div",{staticClass:"image-grid-progress__wrapper"},[i("div",{staticClass:"image-grid-progress__inner",style:{height:t.progressHeight}})])]),t._v(" "),i("div",{staticClass:"btn-group-vertical"},[i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Next row 𝗔𝗿𝗿𝗼𝘄 𝗱𝗼𝘄𝗻",disabled:t.isAtBottom},on:{click:t.nextRow}},[i("span",{staticClass:"fa fa-chevron-down"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Next page 𝗣𝗮𝗴𝗲 𝗱𝗼𝘄𝗻/𝗔𝗿𝗿𝗼𝘄 𝗿𝗶𝗴𝗵𝘁",disabled:t.isAtBottom},on:{click:t.nextPage}},[i("span",{staticClass:"fa fa-step-forward fa-rotate-90"})]),t._v(" "),i("button",{staticClass:"btn btn-default btn-xs",attrs:{type:"button",title:"Go to bottom 𝗘𝗻𝗱",disabled:t.isAtBottom},on:{click:t.bottom}},[i("span",{staticClass:"fa fa-fast-forward fa-rotate-90"})])])])}),[],!1,null,null,null);const $h=Ml({data:function(){return{clientWidth:0,clientHeight:0,offset:0,imagesOffset:0,imagesOffsetTimeout:null}},components:{imageGridImage:Oh,imageGridProgress:Dh.exports},props:{images:{type:Array,required:!0},emptyUrl:{type:String,required:!0},width:{type:Number,default:135},height:{type:Number,default:180},margin:{type:Number,default:8},initialOffset:{type:Number,default:0},selectable:{type:Boolean,default:!1},selectedIcon:{type:String,default:"check"},listenerSet:{type:String,default:"default"}},computed:{columns:function(){return Math.max(1,Math.floor(this.clientWidth/(this.width+this.margin)))},rows:function(){return Math.max(1,Math.floor(this.clientHeight/(this.height+this.margin)))},imagesOffsetEnd:function(){return this.imagesOffset+this.columns*this.rows},displayedImages:function(){return this.images.slice(this.imagesOffset,this.imagesOffsetEnd)},progress:function(){return this.offset/(this.columns*this.lastRow)},lastRow:function(){return Math.max(0,Math.ceil(this.images.length/this.columns)-this.rows)},lastOffset:function(){return this.lastRow*this.columns},canScroll:function(){return this.lastRow>0}},methods:{updateDimensions:function(){this.$refs.images&&(this.clientHeight=this.$refs.images.clientHeight,this.clientWidth=this.$refs.images.clientWidth)},scrollRows:function(t,e){this.setOffset(this.offset+this.columns*t,e)},scroll:function(t){this.scrollRows(t.deltaY>=0?1:-1,!0)},advanceRow:function(){this.scrollRows(1)},advancePage:function(){this.scrollRows(this.rows)},reverseRow:function(){this.scrollRows(-1)},reversePage:function(){this.scrollRows(-this.rows)},jumpToPercent:function(t){this.setOffset(this.columns*Math.round(this.lastRow*t))},jumpToStart:function(){this.jumpToPercent(0)},jumpToEnd:function(){this.jumpToPercent(1)},emitSelect:function(t,e){this.$emit("select",t,e)},setOffset:function(t,e){var i=this;this.offset=Math.max(0,Math.min(this.lastOffset,t)),clearTimeout(this.imagesOffsetTimeout),e?this.imagesOffsetTimeout=setTimeout((function(){i.imagesOffset=i.offset}),25):this.imagesOffset=this.offset}},watch:{lastOffset:function(){this.setOffset(this.offset)},offset:function(){this.$emit("scroll",this.offset)}},created:function(){xu.on("ArrowUp",this.reverseRow,0,this.listenerSet),xu.on("w",this.reverseRow,0,this.listenerSet),xu.on("ArrowDown",this.advanceRow,0,this.listenerSet),xu.on("s",this.advanceRow,0,this.listenerSet),xu.on("ArrowLeft",this.reversePage,0,this.listenerSet),xu.on("a",this.reversePage,0,this.listenerSet),xu.on("ArrowRight",this.advancePage,0,this.listenerSet),xu.on("d",this.advancePage,0,this.listenerSet),xu.on("PageUp",this.reversePage,0,this.listenerSet),xu.on("PageDown",this.advancePage,0,this.listenerSet),xu.on("Home",this.jumpToStart,0,this.listenerSet),xu.on("End",this.jumpToEnd,0,this.listenerSet),this.setOffset(this.initialOffset)},mounted:function(){window.addEventListener("resize",this.updateDimensions),this.$on("resize",this.updateDimensions),this.$nextTick(this.updateDimensions),this.$watch("canScroll",this.updateDimensions)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll(e)}}},[i("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return i("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,selectable:t.selectable,"selected-icon":t.selectedIcon},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?i("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports;const jh=Ml({props:{activeSorter:{type:String,default:""}},computed:{active:function(){return this.activeSorter===this.id},classObject:function(){return{active:this.active}}},methods:{getSequence:function(){return new Vue.Promise.resolve([])},handleClick:function(){this.active||this.$emit("select",this)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"list-group-item",class:t.classObject,attrs:{title:t.title},domProps:{textContent:t._s(t.text)},on:{click:t.handleClick}})}),[],!1,null,null,null).exports;const Nh=[{id:"filename",types:["image","video"],component:{mixins:[jh],data:function(){return{fileIds:[],title:"Sort images by filename",text:"Filename",id:"filename"}},methods:{getSequence:function(){return new Vue.Promise.resolve(this.fileIds)}},created:function(){this.fileIds=biigle.$require("volumes.fileIds")}}},{id:"random",types:["image","video"],component:{mixins:[jh],data:function(){return{fileIds:[],title:"Sort images randomly",text:"Random",id:"random"}},methods:{shuffle:function(t){var e,i,n;for(e=t.length-1;e>0;e--)i=Math.floor(Math.random()*(e+1)),n=t[e],t[e]=t[i],t[i]=n;return t},getSequence:function(){var t=this.shuffle(this.fileIds.slice());return new Vue.Promise.resolve(t)},handleClick:function(){this.$emit("select",this)}},created:function(){this.fileIds=biigle.$require("volumes.fileIds")}}}];biigle.$declare("annotations.api.volumes",Fh),biigle.$declare("volumes.components.filterListComponent",Lh),biigle.$declare("volumes.components.imageGrid",$h),biigle.$declare("volumes.components.imageGridImage",Oh),biigle.$declare("volumes.mixins.sortComponent",jh),biigle.$declare("volumes.stores.filters",Mh),biigle.$declare("volumes.stores.sorters",Nh);const Bh=Ml({props:["session","editing","editId"],computed:{title:function(){return this.editing?"Edit this annotation session":this.session.name},active:function(){var t=new Date;return this.session.starts_at_iso8601<t&&this.session.ends_at_iso8601>=t},currentlyEdited:function(){return this.session.id===this.editId},classObject:function(){return{"session--active":this.active,"list-group-item-info":this.currentlyEdited}}},methods:{edit:function(){this.editing&&!this.currentlyEdited&&this.$emit("edit",this.session)}}},undefined,undefined,!1,null,null,null).exports,Uh=Vue.resource("api/v1/annotation-sessions{/id}",{},{query:{method:"GET",url:"api/v1/volumes{/volume_id}/annotation-sessions"},save:{method:"POST",url:"api/v1/volumes{/volume_id}/annotation-sessions"}});const Gh=Ml({props:["user"],computed:{name:function(){return this.user.firstname+" "+this.user.lastname},title:function(){return"Remove "+this.name}},methods:{remove:function(){this.$emit("remove",this.user)}}},undefined,undefined,!1,null,null,null).exports;const Vh=Ml({mixins:[$u,Du],data:function(){return{volumeId:null,sessions:null,editedSession:{name:null,description:null,starts_at_iso8601:null,starts_at:null,ends_at_iso8601:null,ends_at:null,hide_other_users_annotations:!1,hide_own_annotations:!1,users:[]},users:[],errors:{},typeaheadTemplate:'<span v-text="item.name"></span><br><small v-text="item.affiliation"></small>'}},components:{typeahead:Eu,listItem:Bh,userTag:Gh,datepicker:VueStrap.datepicker},computed:{classObject:function(){return{"panel-warning panel--editing":this.editing}},hasSessions:function(){return this.sessions.length>0},hasNewSession:function(){return void 0===this.editedSession.id},availableUsers:function(){var t=this.editedSession.users.map((function(t){return t.id}));return this.users.filter((function(e){return-1===t.indexOf(e.id)}))},orderedSessions:function(){return this.sessions.slice().sort((function(t,e){return e.starts_at_iso8601.getTime()-t.starts_at_iso8601.getTime()}))}},methods:{clone:function(t){return JSON.parse(JSON.stringify(t))},submit:function(t){var e=this;if(!this.loading){this.startLoading();var i=this.editedSession;if(this.hasNewSession)Uh.save({volume_id:this.volumeId},this.packSession(i)).then(this.sessionSaved).catch(this.handleErrorResponse).finally(this.finishLoading);else{var n={id:i.id};!0===t&&(n.force=1),Uh.update(n,this.packSession(i)).then((function(){return e.sessionUpdated(i)})).catch(this.handleConfirm("Use the Force and update the annotation session?",this.submit)).finally(this.finishLoading)}}},sessionUpdated:function(t){for(var e=this.sessions.length-1;e>=0;e--)this.sessions[e].id===t.id&&(this.sessions.splice(e,1,t),this.clearEditedSession())},sessionSaved:function(t){this.sessions.push(this.parseSession(t.data)),this.clearEditedSession()},packSession:function(t){return(t=this.clone(t)).users=t.users.map((function(t){return t.id})),t.starts_at=t.starts_at_iso8601,t.ends_at=t.ends_at_iso8601,delete t.starts_at_iso8601,delete t.ends_at_iso8601,t},handleConfirm:function(t,e){var i=this;return function(n){400===n.status?(i.finishLoading(),confirm(n.data.message+" "+t)&&e(!0)):i.handleErrorResponse(n)}},handleErrorResponse:function(t){422===t.status?this.errors=t.data.errors:Mu(t)},hasError:function(t){return this.errors.hasOwnProperty(t)},getError:function(t){return this.errors[t].join(" ")},editSession:function(t){this.editedSession=this.clone(t)},deleteSession:function(t){var e=this;if(!this.loading&&!this.hasNewSession&&(!0===t||confirm("Are you sure you want to delete the annotation session '".concat(this.editedSession.name,"'?")))){this.startLoading();var i=this.editedSession.id,n={id:i};!0===t&&(n.force=1),Uh.delete(n).then((function(){return e.sessionDeleted(i)})).catch(this.handleConfirm("Use the Force and delete the annotation session?",this.deleteSession)).finally(this.finishLoading)}},sessionDeleted:function(t){for(var e=this.sessions.length-1;e>=0;e--)if(this.sessions[e].id===t)return this.sessions.splice(e,1),void this.clearEditedSession()},clearEditedSession:function(){this.editedSession={name:null,description:null,starts_at_iso8601:null,starts_at:null,ends_at_iso8601:null,ends_at:null,hide_other_users_annotations:!1,hide_own_annotations:!1,users:[]}},loadUsers:function(){Fh.queryUsers({id:this.volumeId}).then(this.usersLoaded,Mu)},usersLoaded:function(t){t.data.forEach((function(t){t.name=t.firstname+" "+t.lastname})),Vue.set(this,"users",t.data)},selectUser:function(t){this.editedSession.users.push(t)},removeUser:function(t){for(var e=this.editedSession.users.length-1;e>=0;e--)this.editedSession.users[e].id===t.id&&this.editedSession.users.splice(e,1)},stringifyDate:function(t){var e=t.getMonth()+1;return e=e<10?"0"+e:e,t.getFullYear()+"-"+e+"-"+t.getDate()},parseDate:function(t){if(t)return t=t.split("-"),new Date(t[0],t[1]-1,t[2])},parseSession:function(t){var e=new Date(t.starts_at_iso8601);return t.starts_at_iso8601=e,t.starts_at=this.stringifyDate(e),e=new Date(t.ends_at_iso8601),t.ends_at_iso8601=e,t.ends_at=this.stringifyDate(e),t},setStartsAt:function(t){this.editedSession.starts_at_iso8601=this.parseDate(t),this.editedSession.starts_at=t},setEndsAt:function(t){this.editedSession.ends_at_iso8601=this.parseDate(t),this.editedSession.ends_at=t}},watch:{editedSession:function(){this.errors={}},loading:function(t){t&&(this.errors={})}},created:function(){this.volumeId=biigle.$require("volumes.id"),this.sessions=biigle.$require("volumes.annotationSessions").map(this.parseSession),this.$once("editing.start",this.loadUsers)}},undefined,undefined,!1,null,null,null).exports,zh=Vue.resource("api/v1/volumes/browser/directories{/disk}",{},{getImages:{method:"GET",url:"api/v1/volumes/browser/images{/disk}"},getVideos:{method:"GET",url:"api/v1/volumes/browser/videos{/disk}"}});const qh=Ml({mixins:[$u],data:function(){return{disks:[],url:null,mediaType:"",filenames:null,browsing:!1,storageDisk:null,breadCrumbs:[],currentDirectories:[],loadingBrowser:!1,directoryCache:{},fileCache:{}}},computed:{showFilenameWarning:function(){return this.filenames.includes(".tif")},hasDirectories:function(){return this.currentDirectories.length>0},buttonClass:function(){return{"btn-info":this.browsing}},canGoBack:function(){return this.breadCrumbs.length>0||this.disks.length>1},hasCurrentDirectory:function(){return this.breadCrumbs.length>0},currentDirectory:function(){return this.hasCurrentDirectory?this.breadCrumbs[this.breadCrumbs.length-1]:null},isImageMediaType:function(){return"image"===this.mediaType},isVideoMediaType:function(){return"video"===this.mediaType}},methods:{toggleBrowse:function(){this.browsing=!this.browsing},fetchDirectories:function(t,e){var i=this,n=t+"://"+e;if(!this.directoryCache.hasOwnProperty(n)){this.loadingBrowser=!0;var r=zh.get({disk:t,path:e});r.finally((function(){return i.loadingBrowser=!1})),this.directoryCache[n]=r}return this.directoryCache[n]},showDirectories:function(t){this.currentDirectories=t.body},openDirectory:function(t){this.breadCrumbs.push(t)},goBack:function(){this.breadCrumbs.length>0?this.breadCrumbs.pop():this.disks.length>1&&(this.storageDisk=null)},goTo:function(t){t>=-1&&t<this.breadCrumbs.length&&(this.breadCrumbs=this.breadCrumbs.slice(0,t+1))},fetchFiles:function(t,e){var i=this,n=t+"://"+e;if(!this.fileCache.hasOwnProperty(n)){this.loadingBrowser=!0;var r=zh.getImages({disk:t,path:e});r.finally((function(){return i.loadingBrowser=!1})),this.fileCache[n]=r}return this.fileCache[n]},setFiles:function(t){this.filenames=t.body.join(", ")},selectDirectory:function(t){var e=this,i=this.breadCrumbs.slice();t&&i.push(t),this.fetchFiles(this.storageDisk,i.join("/")).then(this.setFiles).then((function(){return e.url=e.storageDisk+"://"+i.join("/")})).catch(Mu)},selectImageMediaType:function(){this.mediaType="image"},selectVideoMediaType:function(){this.mediaType="video"}},watch:{storageDisk:function(t){t&&this.fetchDirectories(t,"").then(this.showDirectories,Mu)},breadCrumbs:function(t){this.fetchDirectories(this.storageDisk,t.join("/")).then(this.showDirectories).catch((function(e){t.pop(),Mu(e)}))}},created:function(){this.disks=biigle.$require("volumes.disks"),this.url=biigle.$require("volumes.url"),this.mediaType=biigle.$require("volumes.mediaType"),this.filenames=biigle.$require("volumes.filenames"),1===this.disks.length&&(this.storageDisk=this.disks[0])},mounted:function(){this.$refs.nameInput.focus()}},undefined,undefined,!1,null,null,null).exports;const Wh=Ml(new Vue({data:{count:0}}),undefined,undefined,!1,null,null,null).exports;const Kh=Ml({data:function(){return{fileIds:[]}},computed:{count:function(){return Wh.count},text:function(){return this.count===this.fileIds.length?this.count:this.count+" of "+this.fileIds.length}},created:function(){this.fileIds=biigle.$require("volumes.fileIds")}},undefined,undefined,!1,null,null,null).exports;const Xh=Ml({props:["file","type"],computed:{classObject:function(){return{"list-group-item-success":this.file.isNew}},title:function(){return"Delete ".concat(this.type," #").concat(this.file.id)}},methods:{remove:function(){this.$emit("remove",this.file)}}},undefined,undefined,!1,null,null,null).exports,Yh=Vue.resource("api/v1/videos{/id}",{},{save:{method:"POST",url:"api/v1/projects{/id}/videos"}});const Hh=Ml({mixins:[$u,Du],data:function(){return{volumeId:null,filenames:"",files:[],errors:{},type:""}},components:{fileItem:Xh},computed:{classObject:function(){return{"panel-warning panel--editing":this.editing}},orderedFiles:function(){return this.files.slice().sort((function(t,e){return t.filename<e.filename?-1:1}))},hasNoFiles:function(){return!this.loading&&0===this.files.length},fileApi:function(){return"image"===this.type?lu:Yh}},methods:{submit:function(){this.loading||(this.startLoading(),Fh.saveFiles({id:this.volumeId},{files:this.filenames}).then(this.filesSaved).catch(this.handleErrorResponse).finally(this.finishLoading))},filesSaved:function(t){for(var e=t.data.length-1;e>=0;e--)t.data[e].isNew=!0,this.files.push(t.data[e]);this.filenames=""},handleRemove:function(t){var e=this;!this.loading&&confirm("Are you sure that you want to delete the ".concat(this.type," #").concat(t.id," (").concat(t.filename,")?"))&&(this.startLoading(),this.fileApi.delete({id:t.id}).then((function(){return e.fileRemoved(t.id)})).catch((function(i){if(422!==i.status)throw i;if(confirm("The ".concat(e.type," contains annotations. Proceed to delete the ").concat(e.type,"?")))return e.fileApi.delete({id:t.id},{force:!0}).then((function(){return e.fileRemoved(t.id)}))})).catch(Mu).finally(this.finishLoading))},fileRemoved:function(t){for(var e=this.files,i=e.length-1;i>=0;i--)if(e[i].id===t)return void e.splice(i,1)},handleErrorResponse:function(t){422===t.status?this.errors=t.data.errors:Mu(t)},hasError:function(t){return this.errors.hasOwnProperty(t)},getError:function(t){return this.errors[t].join("\n")},setFiles:function(t){for(var e in t.body)t.body.hasOwnProperty(e),this.files.push({id:e,filename:t.body[e]})}},watch:{loading:function(t){t&&(this.errors={})}},created:function(){this.volumeId=biigle.$require("volumes.id"),this.type=biigle.$require("volumes.type"),this.startLoading(),Fh.queryFilenames({id:this.volumeId}).then(this.setFiles,Mu).finally(this.finishLoading)}},undefined,undefined,!1,null,null,null).exports,Zh=Vue.resource("api/v1/volumes{/id}/images/metadata");const Jh=Ml({mixins:[$u],data:function(){return{volumeId:null,csv:void 0,error:!1,success:!1,message:void 0}},methods:{handleSuccess:function(){this.error=!1,this.success=!0},handleError:function(t){this.success=!1,t.data.file?Array.isArray(t.data.file)?this.error=t.data.file[0]:this.error=t.data.file:Mu(t)},submit:function(){if(this.csv){this.startLoading();var t=new FormData;t.append("file",this.csv),Zh.save({id:this.volumeId},t).bind(this).then(this.handleSuccess,this.handleError).finally(this.finishLoading)}},setCsv:function(t){this.csv=t.target.files[0]}},created:function(){this.volumeId=biigle.$require("volumes.id")}},undefined,undefined,!1,null,null,null).exports;const Qh=Ml({components:{previewThumbnail:_h}},undefined,undefined,!1,null,null,null).exports;function tc(t){return(tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}const ec=Ml({mixins:[$u],components:{powerToggle:_u},props:{volumeId:{type:Number,required:!0},type:{type:String,required:!0},fileIds:{type:Array,required:!0},showFilenames:{type:Boolean,default:!1},loadingFilenames:{type:Boolean,default:!1}},data:function(){return{rules:[],selectedFilterId:null,negate:!1,mode:"filter",operator:"and"}},computed:{filters:function(){var t=this;return Mh.filter((function(e){return e.types&&e.types.includes(t.type)}))},selectedFilter:function(){return this.getFilter(this.selectedFilterId)},hasSelectComponent:function(){return this.selectedFilter&&this.selectedFilter.selectComponent},selectComponent:function(){return this.selectedFilter.selectComponent},hasRules:function(){return this.rules.length>0},sequence:function(){if(!this.hasRules)return this.fileIds;var t={},e={},i=0,n=0;return this.rules.forEach((function(r){r.negate?(i++,r.sequence.forEach((function(t){e[t]=e[t]+1||1}))):(n++,r.sequence.forEach((function(e){t[e]=t[e]+1||1})))})),"and"===this.operator?n>0?this.fileIds.filter((function(i){return t[i]===n&&!e.hasOwnProperty(i)})):this.fileIds.filter((function(t){return!e.hasOwnProperty(t)})):i>0?this.fileIds.filter((function(n){return t.hasOwnProperty(n)||e[n]!==i})):this.fileIds.filter((function(e){return t.hasOwnProperty(e)}))},inFilterMode:function(){return"filter"===this.mode},inFlagMode:function(){return"flag"===this.mode},usesAndOperator:function(){return"and"===this.operator},usesOrOperator:function(){return"or"===this.operator},helpText:function(){return this.selectedFilter?this.selectedFilter.help.replace(":type",this.type):null},rulesStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.rules")},modeStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.mode")},operatorStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".filter2.operator")},typeText:function(){return Ru(this.type)+"s"}},methods:{filterValid:function(t){return"string"==typeof t.id&&"string"==typeof t.label&&"object"===tc(t.listComponent)&&"function"==typeof t.getSequence},getFilter:function(t){for(var e=this.filters.length-1;e>=0;e--)if(this.filters[e].id===t)return this.filters[e];return null},hasRule:function(t){return-1!==this.rules.findIndex((function(e){return e.id===t.id&&e.negate===t.negate&&e.data===t.data}))},addRule:function(t){var e=this;if(this.selectedFilter){var i={id:this.selectedFilter.id,data:t,negate:this.negate};this.hasRule(i)||(this.startLoading(),this.selectedFilter.getSequence(this.volumeId,t).catch(Mu).then((function(t){return e.ruleAdded(i,t)})).finally(this.finishLoading))}},refreshRule:function(t){var e=this.getFilter(t.id);e&&(this.startLoading(),e.getSequence(this.volumeId,t.data).catch(Mu).then((function(e){return t.sequence=e.data})).finally(this.finishLoading))},ruleAdded:function(t,e){t.sequence=e.data,this.rules.push(t)},removeRule:function(t){this.rules.splice(t,1)},reset:function(){this.rules=[],this.selectedFilterId=null,this.negate=!1,this.mode="filter",this.operator="and"},activateFilterMode:function(){this.mode="filter"},activateFlagMode:function(){this.mode="flag"},activateAndOperator:function(){this.operator="and"},activateOrOperator:function(){this.operator="or"},emitUpdate:function(){this.$emit("update",this.sequence,this.mode,this.hasRules)},getListComponent:function(t){for(var e=this.filters.length-1;e>=0;e--)if(this.filters[e].id===t.id)return this.filters[e].listComponent},enableFilenames:function(){this.$emit("enable-filenames")},disableFilenames:function(){this.$emit("disable-filenames")}},watch:{sequence:function(){this.emitUpdate()},mode:function(){this.emitUpdate(),"filter"!==this.mode?localStorage.setItem(this.modeStorageKey,this.mode):localStorage.removeItem(this.modeStorageKey)},operator:function(){this.emitUpdate(),"and"!==this.operator?localStorage.setItem(this.operatorStorageKey,this.operator):localStorage.removeItem(this.operatorStorageKey)},rules:{handler:function(){this.rules.length>0?localStorage.setItem(this.rulesStorageKey,JSON.stringify(this.rules)):localStorage.removeItem(this.rulesStorageKey)},deep:!0}},created:function(){for(var t,e=0;e<this.filters.length;e++)t=this.filters[e],this.filterValid(t)||(console.error("Filter ".concat(t.id," invalid. Ignoring...")),this.filters.splice(e,1));var i=JSON.parse(localStorage.getItem(this.rulesStorageKey));i&&(this.rules=i);var n=localStorage.getItem(this.modeStorageKey);n&&(this.mode=n);var r=localStorage.getItem(this.operatorStorageKey);r&&(this.operator=r)}},undefined,undefined,!1,null,null,null).exports;const ic=Vue.resource("api/v1/image-labels{/id}",{},{query:{method:"GET",url:"api/v1/images{/image_id}/labels"},save:{method:"POST",url:"api/v1/images{/image_id}/labels"}}),nc=Vue.resource("api/v1/video-labels{/id}",{},{query:{method:"GET",url:"api/v1/videos{/video_id}/labels"},save:{method:"POST",url:"api/v1/videos{/video_id}/labels"}});var rc=Ml({props:{item:{type:Object,required:!0},deletable:{type:Boolean,default:!1},type:{type:String,default:"image"}},data:function(){return{deleting:!1}},computed:{label:function(){return this.item.label},colorStyle:function(){return{"background-color":"#"+this.label.color}},deleteTitle:function(){return"Detach label "+this.label.name},title:function(){return"Attached by ".concat(this.item.user.firstname," ").concat(this.item.user.lastname)},classObject:function(){return{"image-label--deleting":this.deleting}},labelsApi:function(){return"image"===this.type?ic:nc}},methods:{deleteThis:function(){var t=this;this.deleting||(this.deleting=!0,this.labelsApi.delete({id:this.item.id}).then(this.deleted,Mu).finally((function(){return t.deleting=!1})))},deleted:function(){this.$emit("deleted",this.item)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"file-label",class:t.classObject},[i("span",{staticClass:"file-label__color",style:t.colorStyle}),t._v(" "),i("span",{attrs:{title:t.title},domProps:{textContent:t._s(t.label.name)}}),t._v(" "),!t.deleting&&t.deletable?i("button",{staticClass:"close file-label__delete",attrs:{title:t.deleteTitle},on:{click:function(e){return e.stopPropagation(),t.deleteThis(e)}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]):t._e()])}),[],!1,null,null,null);const oc=Ml({components:{listItem:rc.exports},props:{fileLabels:{type:Array,required:!0},userId:{type:Number,required:!0},isAdmin:{type:Boolean,default:!1},type:{type:String,default:"image"}},computed:{hasImageLabels:function(){return this.fileLabels.length>0}},methods:{canDelete:function(t){return!0===this.isAdmin||this.userId===t.user.id},emitDeleted:function(t){this.$emit("deleted",t)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"file-label-list"},[t._l(t.fileLabels,(function(e){return i("list-item",{key:e.id,attrs:{item:e,deletable:t.canDelete(e),type:t.type},on:{deleted:t.emitDeleted}})})),t._v(" "),t.hasImageLabels?t._e():i("li",{staticClass:"text-muted"},[t._v("No "+t._s(t.type)+" labels")])],2)}),[],!1,null,null,null).exports;var sc=Ml({mixins:[Oh,$u],components:{fileLabelList:oc,previewThumbnail:_h},data:function(){return{userId:null,isAdmin:!1,attachingSuccess:null,timeout:null,saving:!1,showAnnotationRoute:null}},props:{selectedLabel:{type:Object,default:null},showFilename:{type:Boolean,default:!1},showLabels:{type:Boolean,default:!1},type:{type:String,default:"image"}},computed:{alreadyHasSelectedLabel:function(){var t=this.selectedLabel;return this.image.labels.reduce((function(e,i){return e||t.id===i.label_id}),!1)},showAnnotationLink:function(){return this.showAnnotationRoute?this.showAnnotationRoute+this.image.id:""},selected:function(){return this.image.flagged},canBeSelected:function(){return this.selectable&&this.selectedLabel&&!this.alreadyHasSelectedLabel&&!this.saving},classObject:function(){return{"image-grid__image--selected":this.selected,"image-grid__image--selectable":this.canBeSelected,"image-grid__image--saving":this.selectable&&this.saving,"image-grid__image--success":!0===this.attachingSuccess,"image-grid__image--error":!1===this.attachingSuccess}},title:function(){return this.canBeSelected?"Attach "+this.selectedLabel.name:""},linkTitle:function(){return"Annotate this ".concat(this.type)}},methods:{handleClick:function(){var t=this;this.canBeSelected&&(this.saving=!0,("image"===this.type?ic.save({image_id:this.image.id},{label_id:this.selectedLabel.id}):nc.save({video_id:this.image.id},{label_id:this.selectedLabel.id})).then(this.labelAttached,this.attachingFailed).finally(this.resetSuccess).finally((function(){return t.saving=!1})))},labelAttached:function(t){this.attachingSuccess=!0,this.image.labels.push(t.data)},attachingFailed:function(t){this.attachingSuccess=!1,Mu(t)},resetSuccess:function(){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return t.attachingSuccess=null}),3e3)},removeImageLabel:function(t){var e=this.image.labels.indexOf(t);-1!==e&&this.image.labels.splice(e,1)}},created:function(){this.userId=biigle.$require("volumes.userId"),this.isAdmin=biigle.$require("volumes.isAdmin"),this.showAnnotationRoute=biigle.$require("largo.showAnnotationRoute")}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid__image image-grid__image--volume",class:t.classObject,attrs:{title:t.title}},[!t.selectable&&t.image.annotateUrl?i("a",{staticClass:"image-link",attrs:{href:t.image.annotateUrl,title:t.linkTitle}},[i("preview-thumbnail",{attrs:{id:t.image.id,"thumb-uris":t.image.thumbnailUrl}},[i("img",{attrs:{src:t.srcUrl},on:{error:t.showEmptyImage}})])],1):i("preview-thumbnail",{attrs:{id:t.image.id,"thumb-uris":t.image.thumbnailUrl},on:{click:t.handleClick}},[i("img",{attrs:{src:t.srcUrl},on:{error:t.showEmptyImage}})]),t._v(" "),t.showFilename?i("span",{staticClass:"image-filename",attrs:{title:t.image.filename},domProps:{textContent:t._s(t.image.filename)}}):t._e(),t._v(" "),i("div",{staticClass:"image-buttons"},[t.image.infoUrl?i("a",{staticClass:"image-button",attrs:{href:t.image.infoUrl,title:"View image information"}},[i("span",{staticClass:"fa fa-info-circle",attrs:{"aria-hidden":"true"}})]):t._e()]),t._v(" "),t.showLabels?i("div",{staticClass:"image-labels",on:{wheel:function(t){t.stopPropagation()}}},[i("file-label-list",{attrs:{"file-labels":t.image.labels,"user-id":t.userId,"is-admin":t.isAdmin,type:t.type},on:{deleted:t.removeImageLabel}})],1):t._e()],1)}),[],!1,null,null,null);const ac=Ml({mixins:[$h],components:{imageGridImage:sc.exports},props:{selectedLabel:{type:Object,default:null},showFilenames:{type:Boolean,default:!1},showLabels:{type:Boolean,default:!1},type:{type:String,default:"image"}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"image-grid",on:{wheel:function(e){return e.preventDefault(),t.scroll(e)}}},[i("div",{ref:"images",staticClass:"image-grid__images"},t._l(t.displayedImages,(function(e){return i("image-grid-image",{key:e.id,attrs:{image:e,"empty-url":t.emptyUrl,"selected-label":t.selectedLabel,selectable:t.selectable,"selected-fade":!1,"show-filename":t.showFilenames,"show-labels":t.showLabels,type:t.type},on:{select:t.emitSelect}})})),1),t._v(" "),t.canScroll?i("image-grid-progress",{attrs:{progress:t.progress},on:{top:t.jumpToStart,"prev-page":t.reversePage,"prev-row":t.reverseRow,jump:t.jumpToPercent,"next-row":t.advanceRow,"next-page":t.advancePage,bottom:t.jumpToEnd}}):t._e()],1)}),[],!1,null,null,null).exports;const lc=Ml({mixins:[$u],components:{labelTrees:Xu,powerToggle:_u},props:{volumeId:{type:Number,required:!0},showLabels:{type:Boolean,default:!1},loadingLabels:{type:Boolean,default:!1}},data:function(){return{labelTrees:[]}},methods:{handleSelectedLabel:function(t){this.$emit("select",t)},handleDeselectedLabel:function(t){this.$emit("deselect",t)},enableLabels:function(){this.$emit("enable-labels")},disableLabels:function(){this.$emit("disable-labels")}},created:function(){this.labelTrees=biigle.$require("volumes.labelTrees")}},undefined,undefined,!1,null,null,null).exports;const uc=Ml({mixins:[$u],props:{volumeId:{type:Number,required:!0},type:{type:String,required:!0},fileIds:{type:Array,required:!0}},data:function(){return{direction:!0,activeSorter:null,privateSequence:[]}},computed:{sorters:function(){var t=this;return Nh.filter((function(e){return e.types&&e.types.includes(t.type)}))},defaultSorter:function(){return this.sorters[0]},isActive:function(){return this.activeSorter!==this.defaultSorter.id||!this.direction},isSortedAscending:function(){return this.direction},isSortedDescending:function(){return!this.direction},sorterStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".sorting2.sorter")},directionStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".sorting2.direction")},sequence:function(){return this.direction?this.privateSequence:this.privateSequence.slice().reverse()}},methods:{reset:function(){this.direction=!0,this.activeSorter=this.defaultSorter.id,this.privateSequence=biigle.$require("volumes.fileIds")},sortAscending:function(){this.direction=!0},sortDescending:function(){this.direction=!1},handleSelect:function(t){var e=this;this.loading||(this.startLoading(),t.getSequence().then((function(i){e.activeSorter=t.id,e.privateSequence=i})).catch(Mu).finally(this.finishLoading))},isValidSequence:function(t){for(var e={},i=this.fileIds,n=t.length-1;n>=0;n--)e[t[n]]=!0;for(var r=i.length-1;r>=0;r--)if(!e.hasOwnProperty(i[r]))return!1;return!0}},watch:{sequence:function(){this.$emit("update",this.sequence,this.isActive)},privateSequence:function(){this.activeSorter===this.defaultSorter.id?localStorage.removeItem(this.sorterStorageKey):localStorage.setItem(this.sorterStorageKey,JSON.stringify({id:this.activeSorter,sequence:this.privateSequence}))},direction:function(){this.direction?localStorage.removeItem(this.directionStorageKey):localStorage.setItem(this.directionStorageKey,this.direction)}},created:function(){this.privateSequence=biigle.$require("volumes.fileIds");var t=JSON.parse(localStorage.getItem(this.sorterStorageKey));t&&this.isValidSequence(t.sequence)?(this.activeSorter=t.id,this.privateSequence=t.sequence):(this.activeSorter=this.defaultSorter.id,localStorage.removeItem(this.sorterStorageKey));var e=JSON.parse(localStorage.getItem(this.directionStorageKey));null!==e&&(this.direction=e)}},undefined,undefined,!1,null,null,null).exports;var hc=function(t){return t[0]+t[1]+"/"+t[2]+t[3]+"/"+t};const cc=Ml({mixins:[$u],components:{sidebar:Su,sidebarTab:Cu,imageGrid:ac,filterTab:ec,sortingTab:uc,labelsTab:lc},data:function(){return{fileIds:[],files:[],filterSequence:[],filterMode:null,filterActive:!1,sortingSequence:[],sortingActive:!1,volumeId:null,imageLabelMode:!1,selectedLabel:null,loadingFilenames:!1,showFilenames:!1,filenamesPromise:null,loadingLabels:!1,showLabels:!1,labelsPromise:null,settings:null,type:null}},computed:{sortingMap:function(){var t={};return this.sortingSequence.forEach((function(e,i){t[e]=i})),t},sortedFiles:function(){var t=this.sortingMap,e=[];return this.files.forEach((function(i){e[t[i.id]]=i})),e},filterMap:function(){var t={};return this.filterSequence.forEach((function(e){t[e]=null})),t},filesToShow:function(){var t=this.filterMap;return"flag"===this.filterMode?this.sortedFiles.map((function(e){return e.flagged=t.hasOwnProperty(e.id),e})):this.sortedFiles.filter((function(e){return e.flagged=!1,t.hasOwnProperty(e.id)}))},fileIdsToShow:function(){return this.filesToShow.map((function(t){return t.id}))},filesStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".files")},offsetStorageKey:function(){return"biigle.volumes.".concat(this.volumeId,".offset")},initialOffset:function(){return parseInt(Au.get("offset"))||parseInt(localStorage.getItem(this.offsetStorageKey))||0},filterEmpty:function(){return this.filterActive&&"flag"!==this.filterMode&&0===this.filterSequence.length}},methods:{handleSidebarToggle:function(){var t=this;this.$nextTick((function(){return t.$refs.imageGrid.$emit("resize")}))},handleSidebarOpen:function(t){this.imageLabelMode="labels"===t},handleSidebarClose:function(){this.imageLabelMode=!1},toggleLoading:function(t){t?this.startLoading():this.finishLoading()},updateFilterSequence:function(t,e,i){this.filterSequence=t,this.filterMode=e,this.filterActive=i},handleScroll:function(t){t>0?(Au.set({offset:t}),localStorage.setItem(this.offsetStorageKey,t)):(Au.unset("offset"),localStorage.removeItem(this.offsetStorageKey))},handleSelectedLabel:function(t){this.selectedLabel=t},handleDeselectedLabel:function(){this.selectedLabel=null},updateSortingSequence:function(t,e){this.sortingSequence=t,this.sortingActive=e},enableFilenames:function(){var t=this;this.filenamesPromise||(this.loadingFilenames=!0,this.filenamesPromise=Fh.queryFilenames({id:this.volumeId}).then(this.setFilenames).finally((function(){return t.loadingFilenames=!1}))),this.filenamesPromise.then((function(){return t.showFilenames=!0}))},disableFilenames:function(){this.showFilenames=!1},setFilenames:function(t){this.files.forEach((function(e){e.filename=t.body[e.id]}))},enableLabels:function(){var t=this;this.labelsPromise||(this.loadingLabels=!0,this.labelsPromise=Fh.queryFileLabels({id:this.volumeId}).then(this.setLabels).finally((function(){return t.loadingLabels=!1}))),this.labelsPromise.then((function(){return t.showLabels=!0}))},disableLabels:function(){this.showLabels=!1},setLabels:function(t){this.files.forEach((function(e){e.labels=t.body[e.id]}))},restoreSettings:function(){!0===this.settings.get("showFilenames")&&this.enableFilenames(),!0===this.settings.get("showLabels")&&this.enableLabels()}},watch:{fileIdsToShow:function(t){var e=this.fileIds,i=t.length===e.length;if(i)for(var n=t.length-1;n>=0;n--)if(t[n]!==e[n]){i=!1;break}i?localStorage.removeItem(this.filesStorageKey):localStorage.setItem(this.filesStorageKey,JSON.stringify(t)),Wh.count=t.length},showFilenames:function(t){this.settings.set("showFilenames",t)},showLabels:function(t){this.settings.set("showLabels",t)}},created:function(){this.type=biigle.$require("volumes.type"),this.fileIds=biigle.$require("volumes.fileIds"),this.filterSequence=this.fileIds,this.sortingSequence=this.fileIds,this.volumeId=biigle.$require("volumes.volumeId"),this.settings=new ju({data:{storageKey:"biigle.volumes.settings",defaults:{showFilenames:!1,showLabels:!1}}});var t=biigle.$require("volumes.fileUuids"),e=biigle.$require("volumes.thumbUri"),i=biigle.$require("volumes.thumbCount"),n=biigle.$require("volumes.annotateUri"),r=biigle.$require("volumes.infoUri");this.files=this.fileIds.map((function(o){var s;return s=i>1?Array.from(Array(i).keys()).map((function(i){return e.replace(":uuid",hc(t[o])+"/"+i)})):e.replace(":uuid",hc(t[o])),{id:o,thumbnailUrl:s,annotateUrl:n.replace(":id",o),infoUrl:r?r.replace(":id",o):void 0,flagged:!1,filename:null,labels:[]}})),this.restoreSettings()}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("annotation-session-panel",Vh),biigle.$mount("create-volume-form",qh),biigle.$mount("volume-file-count",Kh),biigle.$mount("file-panel",Hh),biigle.$mount("search-results",Qh),biigle.$mount("volume-container",cc),biigle.$mount("volume-metadata-upload",Jh);const dc="postrender",fc="movestart",pc="moveend";function gc(){return function(){throw new Error("Unimplemented abstract method.")}()}var mc=0;function vc(t){return t.ol_uid||(t.ol_uid=String(++mc))}var yc="5.3.0";const _c="propertychange";var bc="function"==typeof Object.assign?Object.assign:function(t,e){var i=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1,o=arguments.length;r<o;++r){var s=i[r];if(null!=s)for(var a in s)s.hasOwnProperty(a)&&(n[a]=s[a])}return n};function wc(t){for(var e in t)delete t[e]}function xc(t){var e=[];for(var i in t)e.push(t[i]);return e}function Sc(t){var e;for(e in t)return!1;return!e}function Cc(t,e,i,n){for(var r,o=0,s=t.length;o<s;++o)if((r=t[o]).listener===e&&r.bindTo===i)return n&&(r.deleteIndex=o),r}function Ec(t,e){var i=Tc(t);return i?i[e]:void 0}function Tc(t,e){var i=t.ol_lm;return!i&&e&&(i=t.ol_lm={}),i}function Ic(t,e){var i=Ec(t,e);if(i){for(var n=0,r=i.length;n<r;++n)t.removeEventListener(e,i[n].boundListener),wc(i[n]);i.length=0;var o=Tc(t);o&&(delete o[e],0===Object.keys(o).length&&function(t){delete t.ol_lm}(t))}}function Ac(t,e,i,n,r){var o=Tc(t,!0),s=o[e];s||(s=o[e]=[]);var a=Cc(s,i,n,!1);return a?r||(a.callOnce=!1):(a={bindTo:n,callOnce:!!r,listener:i,target:t,type:e},t.addEventListener(e,function(t){var e=function(e){var i=t.listener,n=t.bindTo||t.target;return t.callOnce&&Lc(t),i.call(n,e)};return t.boundListener=e,e}(a)),s.push(a)),a}function kc(t,e,i,n){return Ac(t,e,i,n,!0)}function Pc(t,e,i,n){var r=Ec(t,e);if(r){var o=Cc(r,i,n,!0);o&&Lc(o)}}function Lc(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=Ec(t.target,t.type);if(e){var i="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==i&&e.splice(i,1),0===e.length&&Ic(t.target,t.type)}wc(t)}}var Rc=function(){this.disposed_=!1};Rc.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},Rc.prototype.disposeInternal=function(){};const Fc=Rc;function Mc(){return!0}function Oc(){return!1}function Dc(){}var $c=function(t){this.propagationStopped,this.type=t,this.target=null};function jc(t){t.stopPropagation()}$c.prototype.preventDefault=function(){this.propagationStopped=!0},$c.prototype.stopPropagation=function(){this.propagationStopped=!0};const Nc=$c;const Bc=function(t){function e(){t.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addEventListener=function(t,e){var i=this.listeners_[t];i||(i=this.listeners_[t]=[]),-1===i.indexOf(e)&&i.push(e)},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Nc(t):t,i=e.type;e.target=this;var n,r=this.listeners_[i];if(r){i in this.dispatching_||(this.dispatching_[i]=0,this.pendingRemovals_[i]=0),++this.dispatching_[i];for(var o=0,s=r.length;o<s;++o)if(!1===r[o].call(this,e)||e.propagationStopped){n=!1;break}if(--this.dispatching_[i],0===this.dispatching_[i]){var a=this.pendingRemovals_[i];for(delete this.pendingRemovals_[i];a--;)this.removeEventListener(i,Dc);delete this.dispatching_[i]}return n}},e.prototype.disposeInternal=function(){!function(t){var e=Tc(t);if(e)for(var i in e)Ic(t,i)}(this)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var i=this.listeners_[t];if(i){var n=i.indexOf(e);t in this.pendingRemovals_?(i[n]=Dc,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t])}},e}(Fc),Uc="change",Gc="clear",Vc="contextmenu",zc="click",qc="dblclick",Wc="error",Kc="keydown",Xc="keypress",Yc="load",Hc="mousedown",Zc="mousewheel",Jc="MSPointerDown",Qc="resize",td="touchstart",ed="wheel";const id=function(t){function e(){t.call(this),this.revision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){++this.revision_,this.dispatchEvent(Uc)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=Ac(this,t[r],e);return n}return Ac(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=kc(this,t[r],e);return n}return kc(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var i=0,n=t.length;i<n;++i)Pc(this,t[i],e);else Pc(this,t,e)},e}(Bc);var nd=function(t){function e(e,i,n){t.call(this,e),this.key=i,this.oldValue=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc),rd={};function od(t){return rd.hasOwnProperty(t)?rd[t]:rd[t]="change:"+t}const sd=function(t){function e(e){t.call(this),vc(this),this.values_={},void 0!==e&&this.setProperties(e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},e.prototype.getKeys=function(){return Object.keys(this.values_)},e.prototype.getProperties=function(){return bc({},this.values_)},e.prototype.notify=function(t,e){var i;i=od(t),this.dispatchEvent(new nd(i,t,e)),i=_c,this.dispatchEvent(new nd(i,t,e))},e.prototype.set=function(t,e,i){if(i)this.values_[t]=e;else{var n=this.values_[t];this.values_[t]=e,n!==e&&this.notify(t,n)}},e.prototype.setProperties=function(t,e){for(var i in t)this.set(i,t[i],e)},e.prototype.unset=function(t,e){if(t in this.values_){var i=this.values_[t];delete this.values_[t],e||this.notify(t,i)}},e}(id),ad="bottom-left",ld="bottom-center",ud="bottom-right",hd="center-left",cd="center-center",dd="center-right",fd="top-left",pd="top-center",gd="top-right";var md="ol-hidden",vd="ol-unselectable",yd="ol-control",_d="ol-collapsed",bd=function(){var t,e={};return function(i){if(t||(t=document.createElement("div").style),!(i in e)){t.font=i;var n=t.fontFamily;if(t.font="",!n)return null;e[i]=n.split(/,\s?/)}return e[i]}}();function wd(t,e){var i=document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function xd(t){var e=t.offsetWidth,i=getComputedStyle(t);return e+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function Sd(t){var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function Cd(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function Ed(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function Td(t){for(;t.lastChild;)t.removeChild(t.lastChild)}const Id=function(t){function e(e){var i="Assertion failed. See https://openlayers.org/en/"+("v"+yc.split("-")[0])+"/doc/errors/#"+e+" for details.";t.call(this,i),this.code=e,this.name="AssertionError",this.message=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);function Ad(t,e){if(!t)throw new Id(e)}const kd="bottom-left",Pd="bottom-right",Ld="top-left",Rd="top-right",Fd=0,Md=1,Od=2,Dd=4,$d=8,jd=16;function Nd(t){for(var e=Kd(),i=0,n=t.length;i<n;++i)tf(e,t[i]);return e}function Bd(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Ud(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Gd(t,e,i){var n,r;return(n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*n+(r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*r}function Vd(t,e){return qd(t,e[0],e[1])}function zd(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function qd(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function Wd(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=e[0],a=e[1],l=Fd;return s<i?l|=jd:s>r&&(l|=Dd),a<n?l|=$d:a>o&&(l|=Od),l===Fd&&(l=Md),l}function Kd(){return[1/0,1/0,-1/0,-1/0]}function Xd(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function Yd(t){return Xd(1/0,1/0,-1/0,-1/0,t)}function Hd(t,e){var i=t[0],n=t[1];return Xd(i,n,i,n,e)}function Zd(t,e,i,n,r){return nf(Yd(r),t,e,i,n)}function Jd(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Qd(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function tf(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function ef(t,e){for(var i=0,n=e.length;i<n;++i)tf(t,e[i]);return t}function nf(t,e,i,n,r){for(;i<n;i+=r)rf(t,e[i],e[i+1]);return t}function rf(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function of(t,e,i){var n;return(n=e.call(i,af(t)))||(n=e.call(i,lf(t)))||(n=e.call(i,gf(t)))?n:(n=e.call(i,pf(t)))||!1}function sf(t){var e=0;return yf(t)||(e=mf(t)*df(t)),e}function af(t){return[t[0],t[1]]}function lf(t){return[t[2],t[1]]}function uf(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function hf(t,e){var i;return e===kd?i=af(t):e===Pd?i=lf(t):e===Ld?i=pf(t):e===Rd?i=gf(t):Ad(!1,13),i}function cf(t,e,i,n,r){var o=e*n[0]/2,s=e*n[1]/2,a=Math.cos(i),l=Math.sin(i),u=o*a,h=o*l,c=s*a,d=s*l,f=t[0],p=t[1],g=f-u+d,m=f-u-d,v=f+u-d,y=f+u+d,_=p-h-c,b=p-h+c,w=p+h+c,x=p+h-c;return Xd(Math.min(g,m,v,y),Math.min(_,b,w,x),Math.max(g,m,v,y),Math.max(_,b,w,x),r)}function df(t){return t[3]-t[1]}function ff(t,e,i){var n=i||[1/0,1/0,-1/0,-1/0];return vf(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Yd(n),n}function pf(t){return[t[0],t[3]]}function gf(t){return[t[2],t[3]]}function mf(t){return t[2]-t[0]}function vf(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function yf(t){return t[2]<t[0]||t[3]<t[1]}var _f="element",bf="map",wf="offset",xf="position",Sf="positioning";const Cf=function(t){function e(e){t.call(this),this.options=e,this.id=e.id,this.insertFirst=void 0===e.insertFirst||e.insertFirst,this.stopEvent=void 0===e.stopEvent||e.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==e.className?e.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.autoPan=void 0!==e.autoPan&&e.autoPan,this.autoPanAnimation=e.autoPanAnimation||{},this.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,this.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},this.mapPostrenderListenerKey=null,Ac(this,od(_f),this.handleElementChanged,this),Ac(this,od(bf),this.handleMapChanged,this),Ac(this,od(wf),this.handleOffsetChanged,this),Ac(this,od(xf),this.handlePositionChanged,this),Ac(this,od(Sf),this.handlePositioningChanged,this),void 0!==e.element&&this.setElement(e.element),this.setOffset(void 0!==e.offset?e.offset:[0,0]),this.setPositioning(void 0!==e.positioning?e.positioning:fd),void 0!==e.position&&this.setPosition(e.position)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getElement=function(){return this.get(_f)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(bf)},e.prototype.getOffset=function(){return this.get(wf)},e.prototype.getPosition=function(){return this.get(xf)},e.prototype.getPositioning=function(){return this.get(Sf)},e.prototype.handleElementChanged=function(){Td(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(Ed(this.element),Lc(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=Ac(t,dc,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(xf)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(_f,t)},e.prototype.setMap=function(t){this.set(bf,t)},e.prototype.setOffset=function(t){this.set(wf,t)},e.prototype.setPosition=function(t){this.set(xf,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[xd(i),Sd(i)]),r=this.autoPanMargin;if(!zd(e,n)){var o=n[0]-e[0],s=e[2]-n[2],a=n[1]-e[1],l=e[3]-n[3],u=[0,0];if(o<0?u[0]=o-r:s<0&&(u[0]=Math.abs(s)+r),a<0?u[1]=a-r:l<0&&(u[1]=Math.abs(l)+r),0!==u[0]||0!==u[1]){var h=t.getView().getCenter(),c=t.getPixelFromCoordinate(h),d=[c[0]+u[0],c[1]+u[1]];t.getView().animate({center:t.getCoordinateFromPixel(d),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]},e.prototype.setPositioning=function(t){this.set(Sf,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var o=n[0],s=n[1];if(r==ud||r==dd||r==gd){""!==this.rendered.left_&&(this.rendered.left_=i.left="");var a=Math.round(e[0]-t[0]-o)+"px";this.rendered.right_!=a&&(this.rendered.right_=i.right=a)}else{""!==this.rendered.right_&&(this.rendered.right_=i.right=""),r!=ld&&r!=cd&&r!=pd||(o-=this.element.offsetWidth/2);var l=Math.round(t[0]+o)+"px";this.rendered.left_!=l&&(this.rendered.left_=i.left=l)}if(r==ad||r==ld||r==ud){""!==this.rendered.top_&&(this.rendered.top_=i.top="");var u=Math.round(e[1]-t[1]-s)+"px";this.rendered.bottom_!=u&&(this.rendered.bottom_=i.bottom=u)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_=i.bottom=""),r!=hd&&r!=cd&&r!=dd||(s-=this.element.offsetHeight/2);var h=Math.round(t[1]+s)+"px";this.rendered.top_!=h&&(this.rendered.top_=i.top=h)}},e.prototype.getOptions=function(){return this.options},e}(sd);const Ef=Ml({props:{watch:{required:!0,type:String},position:{required:!0,type:Array},show:{required:!0,type:Boolean},positioning:{type:String,default:"top-left"}},data:function(){return{annotations:[]}},computed:{hasAnnotations:function(){return this.annotations.length>0},showThis:function(){return this.show&&this.hasAnnotations}},methods:{updateAnnotations:function(t){this.annotations=t.map((function(t){return t.get("annotation")}))}},watch:{show:{immediate:!0,handler:function(t){t?this.$parent.$on(this.watch,this.updateAnnotations):this.$parent.$off(this.watch,this.updateAnnotations)}},position:function(t){this.overlay.setPosition(t)},showThis:function(t){t?this.$parent.map.addOverlay(this.overlay):this.$parent.map.removeOverlay(this.overlay)}},mounted:function(){this.overlay=new Cf({element:this.$el,offset:[15,0],positioning:this.positioning})},beforeDestroy:function(){this.$parent.map.removeOverlay(this.overlay)}},undefined,undefined,!1,null,null,null).exports;const Tf=Ml({mixins:[Ef],computed:{annotationLabels:function(){return this.annotations.map((function(t){return t.labels.map((function(t){return t.label.name}))}))}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tooltip"},[i("ul",{staticClass:"annotation-tooltip__annotations"},t._l(t.annotationLabels,(function(e){return i("li",[i("ul",{staticClass:"annotation-tooltip__labels"},t._l(e,(function(e){return i("li",{domProps:{textContent:t._s(e)}})})),0)])})),0)])}),[],!1,null,null,null).exports;const If=Ml({props:{image:{required:!0},areas:{required:!0}},data:function(){return{unitMultipliers:[1e3,1,.01,.001,1e-6,1e-9],unitNames:["km","m","cm","mm","µm","nm"]}},computed:{area:function(){return this.areas&&this.image&&this.areas[this.image.id]||-1},hasArea:function(){return-1!==this.area},pxWidthInMeter:function(){return Math.sqrt(this.area/(this.image.width*this.image.height))}},methods:{powerOfTen:function(t){return Math.pow(10,Math.floor(Math.log10(t)))}}},undefined,undefined,!1,null,null,null).exports;function Af(t,e){return t>e?1:t<e?-1:0}function kf(t,e){return t.indexOf(e)>=0}function Pf(t,e,i){var n,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(i>0){for(n=1;n<r;++n)if(t[n]<e)return n-1}else if(i<0){for(n=1;n<r;++n)if(t[n]<=e)return n}else for(n=1;n<r;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return r-1}function Lf(t,e,i){for(;e<i;){var n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function Rf(t,e){for(var i=Array.isArray(e)?e:[e],n=i.length,r=0;r<n;r++)t[t.length]=i[r]}function Ff(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}const Mf="XY",Of="XYZ",Df="XYM",$f="XYZM",jf="Point",Nf="LineString",Bf="LinearRing",Uf="Polygon",Gf="MultiPoint",Vf="MultiLineString",zf="MultiPolygon",qf="GeometryCollection",Wf="Circle",Kf="Rectangle",Xf="Ellipse";function Yf(t,e,i,n,r,o){for(var s=o||[],a=0,l=e;l<i;l+=n){var u=t[l],h=t[l+1];s[a++]=r[0]*u+r[2]*h+r[4],s[a++]=r[1]*u+r[3]*h+r[5]}return o&&s.length!=a&&(s.length=a),s}function Hf(t,e,i){return Math.min(Math.max(t,e),i)}var Zf="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function Jf(t,e,i,n,r,o){var s=r-i,a=o-n;if(0!==s||0!==a){var l=((t-i)*s+(e-n)*a)/(s*s+a*a);l>1?(i=r,n=o):l>0&&(i+=s*l,n+=a*l)}return Qf(t,e,i,n)}function Qf(t,e,i,n){var r=i-t,o=n-e;return r*r+o*o}function tp(t){return t*Math.PI/180}function ep(t,e){var i=t%e;return i*e<0?i+e:i}function ip(t,e,i){return t+i*(e-t)}var np=6371008.8;function rp(t,e,i){var n=i||np,r=tp(t[1]),o=tp(e[1]),s=(o-r)/2,a=tp(e[0]-t[0])/2,l=Math.sin(s)*Math.sin(s)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))}var op={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},sp={};sp[op.DEGREES]=2*Math.PI*6370997/360,sp[op.FEET]=.3048,sp[op.METERS]=1,sp[op.USFEET]=1200/3937;const ap=op;var lp=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit};lp.prototype.canWrapX=function(){return this.canWrapX_},lp.prototype.getCode=function(){return this.code_},lp.prototype.getExtent=function(){return this.extent_},lp.prototype.getUnits=function(){return this.units_},lp.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||sp[this.units_]},lp.prototype.getWorldExtent=function(){return this.worldExtent_},lp.prototype.getAxisOrientation=function(){return this.axisOrientation_},lp.prototype.isGlobal=function(){return this.global_},lp.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},lp.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},lp.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},lp.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},lp.prototype.setWorldExtent=function(t){this.worldExtent_=t},lp.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},lp.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};const up=lp;var hp=6378137,cp=Math.PI*hp,dp=[-cp,-cp,cp,cp],fp=[-180,-85,180,85],pp=function(t){function e(e){t.call(this,{code:e,units:ap.METERS,extent:dp,global:!0,worldExtent:fp,getPointResolution:function(t,e){return t/Zf(e[1]/hp)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(up),gp=[new pp("EPSG:3857"),new pp("EPSG:102100"),new pp("EPSG:102113"),new pp("EPSG:900913"),new pp("urn:ogc:def:crs:EPSG:6.18:3:3857"),new pp("urn:ogc:def:crs:EPSG::3857"),new pp("http://www.opengis.net/gml/srs/epsg.xml#3857")];function mp(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=cp,a=0;a<n;a+=r){o[a]=s*t[a]/180;var l=hp*Math.log(Math.tan(Math.PI*(t[a+1]+90)/360));l>s?l=s:l<-s&&(l=-s),o[a+1]=l}return o}function vp(t,e,i){var n=t.length,r=i>1?i:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(n));for(var s=0;s<n;s+=r)o[s]=180*t[s]/cp,o[s+1]=360*Math.atan(Math.exp(t[s+1]/hp))/Math.PI-90;return o}var yp=[-180,-90,180,90],_p=6378137*Math.PI/180,bp=function(t){function e(e,i){t.call(this,{code:e,units:ap.DEGREES,extent:yp,axisOrientation:i,global:!0,metersPerUnit:_p,worldExtent:yp})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(up),wp=[new bp("CRS:84"),new bp("EPSG:4326","neu"),new bp("urn:ogc:def:crs:EPSG::4326","neu"),new bp("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new bp("urn:ogc:def:crs:OGC:1.3:CRS84"),new bp("urn:ogc:def:crs:OGC:2:84"),new bp("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new bp("urn:x-ogc:def:crs:EPSG:4326","neu")],xp={};var Sp,Cp,Ep,Tp={};function Ip(t,e,i){var n=t.getCode(),r=e.getCode();n in Tp||(Tp[n]={}),Tp[n][r]=i}function Ap(t,e,i){var n;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];n=e}else n=t.slice();return n}function kp(t,e,i){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function Pp(t){!function(t,e){xp[t]=e}(t.getCode(),t),Ip(t,t,Ap)}function Lp(t){return"string"==typeof t?xp[t]||null:t||null}function Rp(t,e,i,n){var r,o=(t=Lp(t)).getPointResolutionFunc();if(o)r=o(e,i);else if(t.getUnits()==ap.DEGREES&&!n||n==ap.DEGREES)r=e;else{var s=Dp(t,Lp("EPSG:4326")),a=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];r=(rp((a=s(a,a,2)).slice(0,2),a.slice(2,4))+rp(a.slice(4,6),a.slice(6,8)))/2;var l=n?sp[n]:t.getMetersPerUnit();void 0!==l&&(r/=l)}return r}function Fp(t){!function(t){t.forEach(Pp)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Ip(e,t,Ap)}))}))}function Mp(t,e){return t?"string"==typeof t?Lp(t):t:Lp(e)}function Op(t,e){if(t===e)return!0;var i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Dp(t,e)===Ap)&&i}function Dp(t,e){var i=function(t,e){var i;return t in Tp&&e in Tp[t]&&(i=Tp[t][e]),i}(t.getCode(),e.getCode());return i||(i=kp),i}function $p(t,e){return Dp(Lp(t),Lp(e))}function jp(t,e,i){return $p(e,i)(t,void 0,t.length)}Fp(gp),Fp(wp),Sp=gp,Cp=mp,Ep=vp,wp.forEach((function(t){Sp.forEach((function(e){Ip(t,e,Cp),Ip(e,t,Ep)}))}));var Np=new Array(6);function Bp(t){return Gp(t,1,0,0,1,0,0)}function Up(t,e){var i=t[0],n=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=e[0],u=e[1],h=e[2],c=e[3],d=e[4],f=e[5];return t[0]=i*l+r*u,t[1]=n*l+o*u,t[2]=i*h+r*c,t[3]=n*h+o*c,t[4]=i*d+r*f+s,t[5]=n*d+o*f+a,t}function Gp(t,e,i,n,r,o,s){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=o,t[5]=s,t}function Vp(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function zp(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function qp(t,e,i){return Up(t,Gp(Np,e,0,0,i,0,0))}function Wp(t,e,i){return Up(t,Gp(Np,1,0,0,1,e,i))}function Kp(t,e,i,n,r,o,s,a){var l=Math.sin(o),u=Math.cos(o);return t[0]=n*u,t[1]=r*l,t[2]=-n*l,t[3]=r*u,t[4]=s*n*u-a*n*l+e,t[5]=s*r*l+a*r*u+i,t}var Xp=[1,0,0,1,0,0];function Yp(t){var e;return t==Mf?e=2:t==Of||t==Df?e=3:t==$f&&(e=4),e}const Hp=function(t){function e(){t.call(this),this.layout=Mf,this.stride=2,this.flatCoordinates=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeExtent=function(t){return Zd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return gc()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(wc(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var i=this.getSimplifiedGeometryInternal(t);return i.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=i,i):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=Yp(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){gc()},e.prototype.setLayout=function(t,e,i){var n;if(t)n=Yp(t);else{for(var r=0;r<i;++r){if(0===e.length)return this.layout=Mf,void(this.stride=2);e=e[0]}t=function(t){var e;2==t?e=Mf:3==t?e=Of:4==t&&(e=$f);return e}(n=e.length)}this.layout=t,this.stride=n},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],l=Math.cos(r),u=Math.sin(r),h=o[0],c=o[1],d=0,f=e;f<i;f+=n){var p=t[f]-h,g=t[f+1]-c;a[d++]=h+p*l-g*u,a[d++]=c+p*u+g*l;for(var m=f+2;m<f+n;++m)a[d++]=t[m]}s&&a.length!=d&&(a.length=d)}(i,0,i.length,n,t,e,i),this.changed()}},e.prototype.scale=function(t,e,i){var n=e;void 0===n&&(n=t);var r=i;r||(r=uf(this.getExtent()));var o=this.getFlatCoordinates();if(o){var s=this.getStride();!function(t,e,i,n,r,o,s,a){for(var l=a||[],u=s[0],h=s[1],c=0,d=e;d<i;d+=n){var f=t[d]-u,p=t[d+1]-h;l[c++]=u+r*f,l[c++]=h+o*p;for(var g=d+2;g<d+n;++g)l[c++]=t[g]}a&&l.length!=c&&(l.length=c)}(o,0,o.length,s,t,n,r,o),this.changed()}},e.prototype.translate=function(t,e){var i=this.getFlatCoordinates();if(i){var n=this.getStride();!function(t,e,i,n,r,o,s){for(var a=s||[],l=0,u=e;u<i;u+=n){a[l++]=t[u]+r,a[l++]=t[u+1]+o;for(var h=u+2;h<u+n;++h)a[l++]=t[h]}s&&a.length!=l&&(a.length=l)}(i,0,i.length,n,t,e,i),this.changed()}},e}(function(t){function e(){t.call(this),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return gc()},e.prototype.closestPointXY=function(t,e,i,n){return gc()},e.prototype.containsXY=function(t,e){return!1},e.prototype.getClosestPoint=function(t,e){var i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},e.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},e.prototype.computeExtent=function(t){return gc()},e.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)},e.prototype.rotate=function(t,e){gc()},e.prototype.scale=function(t,e,i){gc()},e.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},e.prototype.getSimplifiedGeometry=function(t){return gc()},e.prototype.getType=function(){return gc()},e.prototype.applyTransform=function(t){gc()},e.prototype.intersectsExtent=function(t){return gc()},e.prototype.translate=function(t,e){gc()},e.prototype.transform=function(t,e){var i=Lp(t),n=i.getUnits()==ap.TILE_PIXELS?function(t,n,r){var o=i.getExtent(),s=i.getWorldExtent(),a=df(s)/df(o);return Kp(Xp,s[0],s[3],a,-a,0,0,0),Yf(t,0,t.length,r,Xp,n),$p(i,e)(t,n,r)}:$p(i,e);return this.applyTransform(n),this},e}(sd));function Zp(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];r+=s*a-o*l,o=a,s=l}return r/2}function Jp(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=Zp(t,e,a,n),e=a}return r}function Qp(t,e,i,n,r,o,s){var a,l=t[e],u=t[e+1],h=t[i]-l,c=t[i+1]-u;if(0===h&&0===c)a=e;else{var d=((r-l)*h+(o-u)*c)/(h*h+c*c);if(d>1)a=i;else{if(d>0){for(var f=0;f<n;++f)s[f]=ip(t[e+f],t[i+f],d);return void(s.length=n)}a=e}}for(var p=0;p<n;++p)s[p]=t[a+p];s.length=n}function tg(t,e,i,n,r){var o=t[e],s=t[e+1];for(e+=n;e<i;e+=n){var a=t[e],l=t[e+1],u=Qf(o,s,a,l);u>r&&(r=u),o=a,s=l}return r}function eg(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=tg(t,e,a,n,r),e=a}return r}function ig(t,e,i,n,r,o,s,a,l,u,h){if(e==i)return u;var c,d;if(0===r){if((d=Qf(s,a,t[e],t[e+1]))<u){for(c=0;c<n;++c)l[c]=t[e+c];return l.length=n,d}return u}for(var f=h||[NaN,NaN],p=e+n;p<i;)if(Qp(t,p-n,p,n,s,a,f),(d=Qf(s,a,f[0],f[1]))<u){for(u=d,c=0;c<n;++c)l[c]=f[c];l.length=n,p+=n}else p+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(o&&(Qp(t,i-n,e,n,s,a,f),(d=Qf(s,a,f[0],f[1]))<u)){for(u=d,c=0;c<n;++c)l[c]=f[c];l.length=n}return u}function ng(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,f=i.length;d<f;++d){var p=i[d];u=ig(t,e,p,n,r,o,s,a,l,u,c),e=p}return u}function rg(t,e,i,n){for(var r=0,o=i.length;r<o;++r)t[e++]=i[r];return e}function og(t,e,i,n){for(var r=0,o=i.length;r<o;++r)for(var s=i[r],a=0;a<n;++a)t[e++]=s[a];return e}function sg(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=og(t,e,i[a],n);o[s++]=u,e=u}return o.length=s,o}function ag(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=e;a<i;a+=n)o[s++]=t.slice(a,a+n);return o.length=s,o}function lg(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=ag(t,e,u,n,o[s]),e=u}return o.length=s,o}function ug(t,e,i,n,r){for(var o=void 0!==r?r:[],s=0,a=0,l=i.length;a<l;++a){var u=i[a];o[s++]=lg(t,e,u,n,o[s]),e=u[u.length-1]}return o.length=s,o}function hg(t,e,i,n,r,o,s){var a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[s++]=t[e],o[s++]=t[e+1];return s}var l=new Array(a);l[0]=1,l[a-1]=1;for(var u=[e,i-n],h=0;u.length>0;){for(var c=u.pop(),d=u.pop(),f=0,p=t[d],g=t[d+1],m=t[c],v=t[c+1],y=d+n;y<c;y+=n){var _=Jf(t[y],t[y+1],p,g,m,v);_>f&&(h=y,f=_)}f>r&&(l[(h-e)/n]=1,d+n<h&&u.push(d,h),h+n<c&&u.push(h,c))}for(var b=0;b<a;++b)l[b]&&(o[s++]=t[e+b*n],o[s++]=t[e+b*n+1]);return s}function cg(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=hg(t,e,h,n,r,o,s),a.push(s),e=h}return s}function dg(t,e){return e*Math.round(t/e)}function fg(t,e,i,n,r,o,s){if(e==i)return s;var a,l,u=dg(t[e],r),h=dg(t[e+1],r);e+=n,o[s++]=u,o[s++]=h;do{if(a=dg(t[e],r),l=dg(t[e+1],r),(e+=n)==i)return o[s++]=a,o[s++]=l,s}while(a==u&&l==h);for(;e<i;){var c=dg(t[e],r),d=dg(t[e+1],r);if(e+=n,c!=a||d!=l){var f=a-u,p=l-h,g=c-u,m=d-h;f*m==p*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(p<0&&m<p||p==m||p>0&&m>p)?(a=c,l=d):(o[s++]=a,o[s++]=l,u=a,h=l,a=c,l=d)}}return o[s++]=a,o[s++]=l,s}function pg(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l];s=fg(t,e,h,n,r,o,s),a.push(s),e=h}return s}function gg(t,e){return e=e?Math.pow(10,e):1e3,t.map((function(t){return t.map((function(t){return t.map((function(t){return Math.round(t*e)/e}))}))}))}const mg=function(t){function e(e,i){t.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Gd(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ig(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.getArea=function(){return Zp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return ag(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=hg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,Mf)},e.prototype.getType=function(){return Bf},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=og(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Hp);const vg=function(t){function e(e,i){t.call(this),this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=Qf(t,e,r[0],r[1]);if(o<n){for(var s=this.stride,a=0;a<s;++a)i[a]=r[a];return i.length=s,o}return n},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Hd(this.flatCoordinates,t)},e.prototype.getType=function(){return jf},e.prototype.intersectsExtent=function(t){return qd(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rg(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Hp);function yg(t,e,i,n,r){return!of(r,(function(r){return!_g(t,e,i,n,r[0],r[1])}))}function _g(t,e,i,n,r,o){for(var s=0,a=t[i-n],l=t[i-n+1];e<i;e+=n){var u=t[e],h=t[e+1];l<=o?h>o&&(u-a)*(o-l)-(r-a)*(h-l)>0&&s++:h<=o&&(u-a)*(o-l)-(r-a)*(h-l)<0&&s--,a=u,l=h}return 0!==s}function bg(t,e,i,n,r,o){if(0===i.length)return!1;if(!_g(t,e,i[0],n,r,o))return!1;for(var s=1,a=i.length;s<a;++s)if(_g(t,i[s-1],i[s],n,r,o))return!1;return!0}function wg(t,e,i,n,r,o,s){for(var a,l,u,h,c,d,f,p=r[o+1],g=[],m=0,v=i.length;m<v;++m){var y=i[m];for(h=t[y-n],d=t[y-n+1],a=e;a<y;a+=n)c=t[a],f=t[a+1],(p<=d&&f<=p||d<=p&&p<=f)&&(u=(p-d)/(f-d)*(c-h)+h,g.push(u)),h=c,d=f}var _=NaN,b=-1/0;for(g.sort(Af),h=g[0],a=1,l=g.length;a<l;++a){c=g[a];var w=Math.abs(c-h);w>b&&bg(t,e,i,n,u=(h+c)/2,p)&&(_=u,b=w),h=c}return isNaN(_)&&(_=r[o]),s?(s.push(_,p,b),s):[_,p,b]}function xg(t,e,i,n,r,o){for(var s,a=[t[e],t[e+1]],l=[];e+n<i;e+=n){if(l[0]=t[e+n],l[1]=t[e+n+1],s=r.call(o,a,l))return s;a[0]=l[0],a[1]=l[1]}return!1}function Sg(t,e,i,n,r){var o=nf([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!vf(r,o)&&(!!zd(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||xg(t,e,i,n,(function(t,e){return function(t,e,i){var n=!1,r=Wd(t,e),o=Wd(t,i);if(r===Md||o===Md)n=!0;else{var s,a,l=t[0],u=t[1],h=t[2],c=t[3],d=e[0],f=e[1],p=i[0],g=i[1],m=(g-f)/(p-d);o&Od&&!(r&Od)&&(n=(s=p-(g-c)/m)>=l&&s<=h),n||!(o&Dd)||r&Dd||(n=(a=g-(p-h)*m)>=u&&a<=c),n||!(o&$d)||r&$d||(n=(s=p-(g-u)/m)>=l&&s<=h),n||!(o&jd)||r&jd||(n=(a=g-(p-l)*m)>=u&&a<=c)}return n}(r,t,e)})))))}function Cg(t,e,i,n,r){if(!function(t,e,i,n,r){return!!(Sg(t,e,i,n,r)||_g(t,e,i,n,r[0],r[1])||_g(t,e,i,n,r[0],r[3])||_g(t,e,i,n,r[2],r[1])||_g(t,e,i,n,r[2],r[3]))}(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(var o=1,s=i.length;o<s;++o)if(yg(t,i[o-1],i[o],n,r)&&!Sg(t,i[o-1],i[o],n,r))return!1;return!0}function Eg(t,e,i,n){for(;e<i-n;){for(var r=0;r<n;++r){var o=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=o}e+=n,i-=n}}function Tg(t,e,i,n){for(var r=0,o=t[i-n],s=t[i-n+1];e<i;e+=n){var a=t[e],l=t[e+1];r+=(a-o)*(l+s),o=a,s=l}return r>0}function Ig(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=Tg(t,e,l,n);if(0===s){if(o&&u||!o&&!u)return!1}else if(o&&!u||!o&&u)return!1;e=l}return!0}function Ag(t,e,i,n,r){for(var o=void 0!==r&&r,s=0,a=i.length;s<a;++s){var l=i[s],u=Tg(t,e,l,n);(0===s?o&&u||!o&&!u:o&&!u||!o&&u)&&Eg(t,e,l,n),e=l}return e}function kg(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)e=Ag(t,e,i[o],n,r);return e}var Pg=function(t){function e(e,i,n){t.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==i&&n?(this.setFlatCoordinates(i,e),this.ends_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLinearRing=function(t){this.flatCoordinates?Rf(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Gd(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(eg(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ng(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return bg(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return Jp(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?Ag(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,lg(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=uf(this.getExtent());this.flatInteriorPoint_=wg(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new vg(this.getFlatInteriorPoint(),Df)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new mg(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o],l=new mg(e.slice(r,a),t);n.push(l),r=a}return n},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Ig(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ag(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=pg(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),i,0,n),new e(i,Mf,n)},e.prototype.getType=function(){return Uf},e.prototype.intersectsExtent=function(t){return Cg(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=sg(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(Hp);const Lg=Pg;function Rg(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=[e,i,e,r,n,r,n,i,e,i];return new Pg(o,Mf,[o.length])}function Fg(t,e,i){for(var n=e||32,r=t.getStride(),o=t.getLayout(),s=t.getCenter(),a=r*(n+1),l=new Array(a),u=0;u<a;u+=r){l[u]=0,l[u+1]=0;for(var h=2;h<r;h++)l[u+h]=s[h]}var c=[l.length],d=new Pg(l,o,c);return function(t,e,i,n){for(var r=t.getFlatCoordinates(),o=t.getStride(),s=r.length/o-1,a=n||0,l=0;l<=s;++l){var u=l*o,h=a+2*ep(l,s)*Math.PI/s;r[u]=e[0]+i*Math.cos(h),r[u+1]=e[1]+i*Math.sin(h)}t.changed()}(d,s,t.getRadius(),i),d}var Mg=function(t){function e(e,i,n){if(t.call(this),void 0!==n&&void 0===i)this.setFlatCoordinates(n,e);else{var r=i||0;this.setCenterAndRadius(e,r,n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,i,n){var r=this.flatCoordinates,o=t-r[0],s=e-r[1],a=o*o+s*s;if(a<n){if(0===a)for(var l=0;l<this.stride;++l)i[l]=r[l];else{var u=this.getRadius()/Math.sqrt(a);i[0]=r[0]+u*o,i[1]=r[1]+u*s;for(var h=2;h<this.stride;++h)i[h]=r[h]}return i.length=this.stride,a}return n},e.prototype.containsXY=function(t,e){var i=this.flatCoordinates,n=t-i[0],r=e-i[1];return n*n+r*r<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,i=e[this.stride]-e[0];return Xd(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return Wf},e.prototype.intersectsExtent=function(t){if(vf(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||(t[1]<=e[1]&&t[3]>=e[1]||of(t,this.intersectsCoordinate,this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(var r=1;r<e;++r)n[e+r]=t[r];this.setFlatCoordinates(this.layout,n),this.changed()},e.prototype.setCenterAndRadius=function(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var n=this.flatCoordinates,r=rg(n,0,t,this.stride);n[r++]=n[0]+e;for(var o=1,s=this.stride;o<s;++o)n[r++]=n[o];n.length=r,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e}(Hp);Mg.prototype.transform;const Og=Mg;function Dg(t,e,i,n,r,o){var s=NaN,a=NaN,l=(i-e)/n;if(1===l)s=t[e],a=t[e+1];else if(2==l)s=(1-r)*t[e]+r*t[e+n],a=(1-r)*t[e+1]+r*t[e+n+1];else if(0!==l){for(var u=t[e],h=t[e+1],c=0,d=[0],f=e+n;f<i;f+=n){var p=t[f],g=t[f+1];c+=Math.sqrt((p-u)*(p-u)+(g-h)*(g-h)),d.push(c),u=p,h=g}var m=r*c,v=function(t,e,i){for(var n,r,o=i||Af,s=0,a=t.length,l=!1;s<a;)(r=+o(t[n=s+(a-s>>1)],e))<0?s=n+1:(a=n,l=!r);return l?s:~s}(d,m);if(v<0){var y=(m-d[-v-2])/(d[-v-1]-d[-v-2]),_=e+(-v-2)*n;s=ip(t[_],t[_+n],y),a=ip(t[_+1],t[_+n+1],y)}else s=t[e+v*n],a=t[e+v*n+1]}return o?(o[0]=s,o[1]=a,o):[s,a]}function $g(t,e,i,n,r,o){if(i==e)return null;var s;if(r<t[e+n-1])return o?((s=t.slice(e,e+n))[n-1]=r,s):null;if(t[i-1]<r)return o?((s=t.slice(i-n,i))[n-1]=r,s):null;if(r==t[e+n-1])return t.slice(e,e+n);for(var a=e/n,l=i/n;a<l;){var u=a+l>>1;r<t[(u+1)*n-1]?l=u:a=u+1}var h=t[a*n-1];if(r==h)return t.slice((a-1)*n,(a-1)*n+n);var c=(r-h)/(t[(a+1)*n-1]-h);s=[];for(var d=0;d<n-1;++d)s.push(ip(t[(a-1)*n+d],t[a*n+d],c));return s.push(r),s}function jg(t,e,i,n){for(var r=t[e],o=t[e+1],s=0,a=e+n;a<i;a+=n){var l=t[a],u=t[a+1];s+=Math.sqrt((l-r)*(l-r)+(u-o)*(u-o)),r=l,o=u}return s}const Ng=function(t){function e(e,i){t.call(this),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?this.setCoordinates(e,i):this.setFlatCoordinates(i,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendCoordinate=function(t){this.flatCoordinates?Rf(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){return n<Gd(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(tg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ig(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.forEachSegment=function(t){return xg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=Df&&this.layout!=$f)return null;var i=void 0!==e&&e;return $g(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return ag(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Dg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return jg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=hg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,Mf)},e.prototype.getType=function(){return Nf},e.prototype.intersectsExtent=function(t){return Sg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=og(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Hp);var Bg=Ml({mixins:[Ef,If],data:function(){return{measuredGeometries:[]}},computed:{areaUnitMultipliers:function(){return this.unitMultipliers.map((function(t){return Math.pow(t,2)}))}},methods:{updateGeometries:function(t){var e=this;this.measuredGeometries=t.map((function(t){return t.getGeometry()})).filter((function(t){return e.isAeraGeometry(t)||e.isLengthGeometry(t)})).map((function(t){return e.measure(t)}))},measure:function(t){return t.getArea?this.formatArea(t.getArea()):t.getLength?this.formatLength(t.getLength()):t.getRadius?this.formatArea(Math.pow(t.getRadius(),2)*Math.PI):""},isAeraGeometry:function(t){return t instanceof Lg||t instanceof Og},isLengthGeometry:function(t){return t instanceof Ng},formatArea:function(t){var e="px²";if(this.hasArea){t*=Math.pow(this.pxWidthInMeter,2);var i=this.unitNearest(t,this.areaUnitMultipliers,.001);e=this.unitNames[i]+"²",t/=this.areaUnitMultipliers[i]}return this.formatMeasurement(t,e,3)},formatLength:function(t){var e="px";if(this.hasArea){t*=this.pxWidthInMeter;var i=this.unitNearest(t,this.unitMultipliers);e=this.unitNames[i],t/=this.unitMultipliers[i]}return this.formatMeasurement(t,e)},formatMeasurement:function(t,e,i){return i=Math.pow(10,i||1),Math.round(t*i)/i+" "+e},unitNearest:function(t,e,i){if(0===t)return e.length-1;var n,r;for(i=i||1,r=e.length-1;r>=0&&!((n=t/e[r])>=i&&n<1e3);r--);return r}},watch:{show:function(t){t?this.$parent.$on(this.watch,this.updateGeometries):this.$parent.$off(this.watch,this.updateGeometries)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tooltip"},[i("ul",{staticClass:"annotation-tooltip__annotations"},t._l(t.measuredGeometries,(function(e){return i("li",{domProps:{textContent:t._s(e)}})})),0)])}),[],!1,null,null,null);const Ug=Ml({components:{labelTooltip:Tf,measureTooltip:Bg.exports},props:{showLabelTooltip:{type:Boolean,default:!1},showMeasureTooltip:{type:Boolean,default:!1}},computed:{showAnnotationTooltip:function(){return this.isDefaultInteractionMode&&(this.showLabelTooltip||this.showMeasureTooltip)}},data:function(){return{hoveredFeaturesHash:""}},methods:{annotationLayerFilter:function(t){return"annotations"===t.get("name")},updateHoveredAnnotations:function(t){var e=this.map.getFeaturesAtPixel(t.pixel,{layerFilter:this.annotationLayerFilter})||[],i=e.map((function(t){return t.getId()})).join("-");this.hoveredFeaturesHash!==i&&(this.hoveredFeaturesHash=i,this.$emit("hoverFeatures",e))},resetHoveredAnnotations:function(){this.hoveredFeaturesHash="",this.$emit("hoverFeatures",[])}},watch:{showAnnotationTooltip:function(t){t?this.map.on("pointermove",this.updateHoveredAnnotations):(this.map.un("pointermove",this.updateHoveredAnnotations),this.resetHoveredAnnotations())}}},undefined,undefined,!1,null,null,null).exports,Gg={SINGLECLICK:"singleclick",CLICK:zc,DBLCLICK:qc,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};function Vg(t){return Math.pow(t,3)}function zg(t){return 1-Vg(1-t)}function qg(t){return 3*t*t-2*t*t*t}function Wg(t){return t}const Kg="active";function Xg(t,e,i,n){e=t.constrainRotation(e,0),Yg(t,e,i,n)}function Yg(t,e,i,n){if(void 0!==e){var r=t.getRotation(),o=t.getCenter();void 0!==r&&o&&n>0?t.animate({rotation:e,anchor:i,duration:n,easing:zg}):t.rotate(e,i)}}function Hg(t,e,i,n){var r=t.getResolution(),o=t.constrainResolution(r,e,0);if(void 0!==o){var s=t.getResolutions();o=Hf(o,t.getMinResolution()||s[s.length-1],t.getMaxResolution()||s[0])}if(i&&void 0!==o&&o!==r){var a=t.getCenter(),l=t.calculateCenterZoom(o,i);l=t.constrainCenter(l),i=[(o*a[0]-r*l[0])/(o-r),(o*a[1]-r*l[1])/(o-r)]}Zg(t,o,i,n)}function Zg(t,e,i,n){if(e){var r=t.getResolution(),o=t.getCenter();if(void 0!==r&&o&&e!==r&&n)t.animate({resolution:e,anchor:i,duration:n,easing:zg});else{if(i){var s=t.calculateCenterZoom(e,i);t.setCenter(s)}t.setResolution(e)}}}const Jg=function(t){function e(e){t.call(this),e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getActive=function(){return this.get(Kg)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(Kg,t)},e.prototype.setMap=function(t){this.map_=t},e}(sd);function Qg(t){for(var e=t.length,i=0,n=0,r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return[i/e,n/e]}const tm=function(t){function e(e){var i=e||{};t.call(this,i),i.handleDownEvent&&(this.handleDownEvent=i.handleDownEvent),i.handleDragEvent&&(this.handleDragEvent=i.handleDragEvent),i.handleMoveEvent&&(this.handleMoveEvent=i.handleMoveEvent),i.handleUpEvent&&(this.handleUpEvent=i.handleUpEvent),i.stopDown&&(this.stopDown=i.stopDown),this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){return!1},e.prototype.handleDragEvent=function(t){},e.prototype.handleEvent=function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Gg.POINTERDRAG)this.handleDragEvent(t);else if(t.type==Gg.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==Gg.POINTERDOWN){var n=this.handleDownEvent(t);n&&t.preventDefault(),this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Gg.POINTERMOVE&&this.handleMoveEvent(t);return!e},e.prototype.handleMoveEvent=function(t){},e.prototype.handleUpEvent=function(t){return!1},e.prototype.stopDown=function(t){return t},e.prototype.updateTrackedPointers_=function(t){if(function(t){var e=t.type;return e===Gg.POINTERDOWN||e===Gg.POINTERDRAG||e===Gg.POINTERUP}(t)){var e=t.pointerEvent,i=e.pointerId.toString();t.type==Gg.POINTERUP?delete this.trackedPointers_[i]:(t.type==Gg.POINTERDOWN||i in this.trackedPointers_)&&(this.trackedPointers_[i]=e),this.targetPointers=xc(this.trackedPointers_)}},e}(Jg);function em(t){return(em="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function im(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nm(t,e){return(nm=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rm(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=sm(t);if(e){var r=sm(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return om(this,i)}}function om(t,e){return!e||"object"!==em(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function sm(t){return(sm=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const am=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nm(t,e)}(o,t);var e,i,n,r=rm(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).on("change:active",e.toggleActive),e.features=void 0!==t.features?t.features:null,e.currentFeature=void 0,e.map=t.map,e}return e=o,(i=[{key:"toggleActive",value:function(t){if(t.oldValue){var e=this.map.getTargetElement();e&&(e.style.cursor="")}}},{key:"handleDownEvent",value:function(t){return this.currentFeature=this.featuresAtPixel(t.pixel,t.map),!!this.currentFeature}},{key:"handleUpEvent",value:function(){this.currentFeature&&this.currentFeature.get("annotation")&&this.dispatchEvent({type:"attach",feature:this.currentFeature}),this.currentFeature=void 0}},{key:"handleMoveEvent",value:function(t){var e=t.map.getTargetElement(),i=this.featuresAtPixel(t.pixel,t.map);e.style.cursor=i?"pointer":""}},{key:"featuresAtPixel",value:function(t,e){var i=null,n=e.forEachFeatureAtPixel(t,(function(t){return t}),this);return this.handlesFeature(n)&&(i=n),i}},{key:"handlesFeature",value:function(t){return!!this.features&&-1!==this.features.getArray().indexOf(t)}}])&&im(e.prototype,i),n&&im(e,n),o}(tm);var lm,um;const hm=Ml({computed:{isAttaching:function(){return"attach"===this.interactionMode},isSwapping:function(){return"swap"===this.interactionMode}},methods:{toggleAttaching:function(){this.isAttaching?this.resetInteractionMode():this.interactionMode="attach"},toggleSwapping:function(){this.isSwapping?this.resetInteractionMode():this.interactionMode="swap"},handleAttachLabel:function(t){this.$emit("attach",t.feature.get("annotation"),this.selectedLabel)},handleSwapLabel:function(t){this.$emit("swap",t.feature.get("annotation"),this.selectedLabel)}},watch:{isAttaching:function(t){this.canAdd&&(t&&!this.hasSelectedLabel?this.requireSelectedLabel():lm.setActive(t))},isSwapping:function(t){this.canAdd&&(t&&!this.hasSelectedLabel?this.requireSelectedLabel():um.setActive(t))},selectedLabel:function(t){t||!this.isAttaching&&!this.isSwapping||this.resetInteractionMode()}},mounted:function(){this.canAdd&&((lm=new am({features:this.annotationFeatures,map:this.map})).setActive(!1),lm.on("attach",this.handleAttachLabel),this.map.addInteraction(lm),(um=new am({features:this.annotationFeatures,map:this.map})).setActive(!1),um.on("attach",this.handleSwapLabel),this.map.addInteraction(um),xu.on("l",this.toggleAttaching,0,this.listenerSet),xu.on("Shift+l",this.toggleSwapping,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const cm=0,dm=1,fm=2,pm=3;const gm=function(t){function e(e,i,n,r){t.call(this),this.extent=e,this.pixelRatio_=n,this.resolution=i,this.state=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(Uc)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return gc()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){gc()},e}(Bc);function mm(t,e,i,n){var r=jp(i,e,t),o=Rp(e,n,i),s=e.getMetersPerUnit();void 0!==s&&(o*=s);var a=t.getMetersPerUnit();void 0!==a&&(o/=a);var l=t.getExtent();if(!l||Vd(l,r)){var u=Rp(t,o,r)/o;isFinite(u)&&u>0&&(o/=u)}return o}function vm(t,e,i,n){var r=i-t,o=n-e,s=Math.sqrt(r*r+o*o);return[Math.round(i+r/s),Math.round(n+o/s)]}function ym(t,e,i,n,r,o,s,a,l,u,h){var c=wd(Math.round(i*t),Math.round(i*e));if(0===l.length)return c.canvas;c.scale(i,i);var d=[1/0,1/0,-1/0,-1/0];l.forEach((function(t,e,i){Qd(d,t.extent)}));var f=mf(d),p=df(d),g=wd(Math.round(i*f/n),Math.round(i*p/n)),m=i/n;l.forEach((function(t,e,i){var n=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=mf(t.extent),s=df(t.extent);g.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,n*m,r*m,o*m,s*m)}));var v=pf(s);return a.getTriangles().forEach((function(t,e,r){var s=t.source,a=t.target,l=s[0][0],u=s[0][1],h=s[1][0],f=s[1][1],p=s[2][0],m=s[2][1],y=(a[0][0]-v[0])/o,_=-(a[0][1]-v[1])/o,b=(a[1][0]-v[0])/o,w=-(a[1][1]-v[1])/o,x=(a[2][0]-v[0])/o,S=-(a[2][1]-v[1])/o,C=l,E=u;l=0,u=0;var T=function(t){for(var e=t.length,i=0;i<e;i++){for(var n=i,r=Math.abs(t[i][i]),o=i+1;o<e;o++){var s=Math.abs(t[o][i]);s>r&&(r=s,n=o)}if(0===r)return null;var a=t[n];t[n]=t[i],t[i]=a;for(var l=i+1;l<e;l++)for(var u=-t[l][i]/t[i][i],h=i;h<e+1;h++)i==h?t[l][h]=0:t[l][h]+=u*t[i][h]}for(var c=new Array(e),d=e-1;d>=0;d--){c[d]=t[d][e]/t[d][d];for(var f=d-1;f>=0;f--)t[f][e]-=t[f][d]*c[d]}return c}([[h-=C,f-=E,0,0,b-y],[p-=C,m-=E,0,0,x-y],[0,0,h,f,w-_],[0,0,p,m,S-_]]);if(T){c.save(),c.beginPath();var I=(y+b+x)/3,A=(_+w+S)/3,k=vm(I,A,y,_),P=vm(I,A,b,w),L=vm(I,A,x,S);c.moveTo(P[0],P[1]),c.lineTo(k[0],k[1]),c.lineTo(L[0],L[1]),c.clip(),c.transform(T[0],T[2],T[1],T[3],y,_),c.translate(d[0]-C,d[3]-E),c.scale(n/i,-n/i),c.drawImage(g.canvas,0,0),c.restore()}})),h&&(c.save(),c.strokeStyle="black",c.lineWidth=1,a.getTriangles().forEach((function(t,e,i){var n=t.target,r=(n[0][0]-v[0])/o,s=-(n[0][1]-v[1])/o,a=(n[1][0]-v[0])/o,l=-(n[1][1]-v[1])/o,u=(n[2][0]-v[0])/o,h=-(n[2][1]-v[1])/o;c.beginPath(),c.moveTo(a,l),c.lineTo(r,s),c.lineTo(u,h),c.closePath(),c.stroke()})),c.restore()),c.canvas}var _m=function(t,e,i,n,r){this.sourceProj_=t,this.targetProj_=e;var o={},s=$p(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=s(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&mf(n)==mf(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?mf(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?mf(this.targetProj_.getExtent()):null;var a=pf(i),l=gf(i),u=lf(i),h=af(i),c=this.transformInv_(a),d=this.transformInv_(l),f=this.transformInv_(u),p=this.transformInv_(h);if(this.addQuad_(a,l,u,h,c,d,f,p,10),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach((function(t,e,i){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-g>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-g>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-g>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var i=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2&&(t.source=e)}}.bind(this))}o={}};_m.prototype.addTriangle_=function(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})},_m.prototype.addQuad_=function(t,e,i,n,r,o,s,a,l){var u=Nd([r,o,s,a]),h=this.sourceWorldWidth_?mf(u)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1,f=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_)f=mf(Nd([t,e,i,n]))/this.targetWorldWidth_>.25||f;!d&&this.sourceProj_.isGlobal()&&h&&(f=h>.25||f)}if(f||!this.maxSourceExtent_||vf(u,this.maxSourceExtent_)){if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1]))){if(!(l>0))return;f=!0}if(l>0){if(!f){var p,g=[(t[0]+i[0])/2,(t[1]+i[1])/2],m=this.transformInv_(g);if(d)p=(ep(r[0],c)+ep(s[0],c))/2-ep(m[0],c);else p=(r[0]+s[0])/2-m[0];var v=(r[1]+s[1])/2-m[1];f=p*p+v*v>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var y=[(e[0]+i[0])/2,(e[1]+i[1])/2],_=this.transformInv_(y),b=[(n[0]+t[0])/2,(n[1]+t[1])/2],w=this.transformInv_(b);this.addQuad_(t,e,y,b,r,o,_,w,l-1),this.addQuad_(b,y,i,n,w,_,s,a,l-1)}else{var x=[(t[0]+e[0])/2,(t[1]+e[1])/2],S=this.transformInv_(x),C=[(i[0]+n[0])/2,(i[1]+n[1])/2],E=this.transformInv_(C);this.addQuad_(t,x,C,n,r,S,E,a,l-1),this.addQuad_(x,e,i,C,S,o,s,E,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,i,n,r,s,a),this.addTriangle_(t,e,i,r,o,s)}},_m.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){var r=e.source;tf(t,r[0]),tf(t,r[1]),tf(t,r[2])})),t},_m.prototype.getTriangles=function(){return this.triangles_};const bm=_m;const wm=function(t){function e(e,i,n,r,o,s){var a=e.getExtent(),l=i.getExtent(),u=l?ff(n,l):n,h=mm(e,i,uf(u),r),c=new bm(e,i,u,a,.5*h),d=s(c.calculateSourceExtent(),h,o),f=fm;d&&(f=cm);var p=d?d.getPixelRatio():1;t.call(this,n,r,p,f),this.targetProj_=i,this.maxSourceExtent_=a,this.triangulation_=c,this.targetResolution_=r,this.targetExtent_=n,this.sourceImage_=d,this.sourcePixelRatio_=p,this.canvas_=null,this.sourceListenerKey_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==dm&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==fm){var e=mf(this.targetExtent_)/this.targetResolution_,i=df(this.targetExtent_)/this.targetResolution_;this.canvas_=ym(e,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==cm){this.state=dm,this.changed();var t=this.sourceImage_.getState();t==fm||t==pm?this.reproject_():(this.sourceListenerKey_=Ac(this.sourceImage_,Uc,(function(t){var e=this.sourceImage_.getState();e!=fm&&e!=pm||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){Lc(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(gm),xm="undefined",Sm="ready";function Cm(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const Em=function(t){function e(e){t.call(this),this.projection_=Lp(e.projection),this.attributions_=Cm(e.attributions),this.attributionsCollapsible_=void 0===e.attributionsCollapsible||e.attributionsCollapsible,this.loading=!1,this.state_=void 0!==e.state?e.state:Sm,this.wrapX_=void 0!==e.wrapX&&e.wrapX}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getAttributions=function(){return this.attributions_},e.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolutions=function(){return gc()},e.prototype.getState=function(){return this.state_},e.prototype.getWrapX=function(){return this.wrapX_},e.prototype.refresh=function(){this.changed()},e.prototype.setAttributions=function(t){this.attributions_=Cm(t),this.changed()},e.prototype.setState=function(t){this.state_=t,this.changed()},e}(sd);var Tm="imageloadstart",Im="imageloadend",Am="imageloaderror",km=function(t){function e(e,i){t.call(this,e),this.image=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);const Pm=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state}),this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=Pf(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,i,n){var r=this.getProjection();if(r&&n&&!Op(r,n)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Op(this.reprojectedImage_.getProjection(),n)&&this.reprojectedImage_.getResolution()==e&&Jd(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new wm(r,n,t,e,i,function(t,e,i){return this.getImageInternal(t,e,i,r)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(n=r),this.getImageInternal(t,e,i,n)},e.prototype.getImageInternal=function(t,e,i,n){return gc()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case dm:this.loading=!0,this.dispatchEvent(new km(Tm,e));break;case fm:this.loading=!1,this.dispatchEvent(new km(Im,e));break;case pm:this.loading=!1,this.dispatchEvent(new km(Am,e))}},e}(Em);const Lm=function(t){function e(e,i,n,r,o){var s=void 0!==o?cm:fm;void 0===i&&(i=df(e)/r.height),t.call(this,e,i,n,s),this.loader_=void 0!==o?o:null,this.canvas_=r,this.error_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getError=function(){return this.error_},e.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=pm):this.state=fm,this.changed()},e.prototype.load=function(){this.state==cm&&(this.state=dm,this.changed(),this.loader_(this.handleLoad_.bind(this)))},e.prototype.getImage=function(){return this.canvas_},e}(gm);const Rm=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,resolutions:e.resolutions,state:e.state}),this.canvas_=new Lm(e.canvasExtent,void 0,1,e.canvas),this.canvasSize_=e.canvasSize?e.canvasSize:null,Ac(this.canvas_,Uc,this.handleImageChange,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImageInternal=function(t,e,i,n){return vf(t,this.canvas_.getExtent())?this.canvas_:null},e}(Pm),Fm="add",Mm="remove";var Om="length",Dm=function(t){function e(e,i){t.call(this,e),this.element=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);const $m=function(t){function e(e,i){t.call(this);var n=i||{};if(this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(var r=0,o=this.array_.length;r<o;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},e.prototype.extend=function(t){for(var e=0,i=t.length;e<i;++e)this.push(t[e]);return this},e.prototype.forEach=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)t(e[i],i,e)},e.prototype.getArray=function(){return this.array_},e.prototype.item=function(t){return this.array_[t]},e.prototype.getLength=function(){return this.get(Om)},e.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Dm(Fm,e))},e.prototype.pop=function(){return this.removeAt(this.getLength()-1)},e.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},e.prototype.remove=function(t){for(var e=this.array_,i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)},e.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Dm(Mm,e)),e},e.prototype.setAt=function(t,e){var i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Dm(Mm,n)),this.dispatchEvent(new Dm(Fm,e))}else{for(var r=i;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},e.prototype.updateLength_=function(){this.set(Om,this.array_.length)},e.prototype.assertUnique_=function(t,e){for(var i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Id(58)},e}(sd);const jm=Ml({props:{title:{type:String,default:""},icon:{type:String,required:!0},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},open:{type:Boolean,default:!1}},data:function(){return{mouseOver:!1,timeout:null,activeSubControls:0}},computed:{classObject:function(){return{active:this.active,"control-button--open":this.showSubControls}},iconClass:function(){return this.icon.startsWith("fa-")?"fa fa-fw "+this.icon:"icon icon-white "+this.icon},hasSubControls:function(){return this.$slots.hasOwnProperty("default")},showSubControls:function(){return this.mouseOver||this.hasActiveSubControl||this.open},hasActiveSubControl:function(){return this.activeSubControls>0}},methods:{handleClick:function(){this.disabled||this.$emit("click")},handleMouseEnter:function(){!this.disabled&&this.hover&&(this.mouseOver=!0),window.clearTimeout(this.timeout)},handleMouseLeave:function(){var t=this;window.clearTimeout(this.timeout),this.timeout=window.setTimeout((function(){t.mouseOver=!1}),200)},updateActiveSubControls:function(t){t?this.activeSubControls+=1:this.activeSubControls=Math.max(0,this.activeSubControls-1)}},watch:{active:function(t){this.$parent.$emit("control-button-active",t)}},created:function(){this.$on("control-button-active",this.updateActiveSubControls)},mounted:function(){this.active&&this.$parent.$emit("control-button-active",!0)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"control-button btn",class:t.classObject,attrs:{title:t.title,disabled:t.disabled},on:{click:t.handleClick,mouseenter:t.handleMouseEnter,mouseleave:t.handleMouseLeave}},[i("i",{class:t.iconClass,attrs:{"aria-hidden":"true"}}),t._v(" "),t.hasSubControls?i("span",{staticClass:"control-button__sub-controls btn-group",on:{click:function(t){t.stopPropagation()}}},[t._t("default")],2):t._e()])}),[],!1,null,null,null).exports;const Nm=function(t){function e(e){if(t.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,Ac(this,od(this.geometryName_),this.handleGeometryChanged_,this),e)if("function"==typeof e.getSimplifiedGeometry){var i=e;this.setGeometry(i)}else{var n=e;this.setProperties(n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e(this.getProperties());t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var n=this.getStyle();return n&&t.setStyle(n),t},e.prototype.getGeometry=function(){return this.get(this.geometryName_)},e.prototype.getId=function(){return this.id_},e.prototype.getGeometryName=function(){return this.geometryName_},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.handleGeometryChange_=function(){this.changed()},e.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Lc(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Ac(t,Uc,this.handleGeometryChange_,this)),this.changed()},e.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},e.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;var e;Array.isArray(t)?e=t:(Ad("function"==typeof t.getZIndex,41),e=[t]);return function(){return e}}(t):void 0,this.changed()},e.prototype.setId=function(t){this.id_=t,this.changed()},e.prototype.setGeometryName=function(t){Pc(this,od(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,Ac(this,od(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},e}(sd);const Bm=function(t){function e(e,i,n){t.call(this,e),this.map=i,this.frameState=void 0!==n?n:null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);const Um=function(t){function e(e,i,n,r,o){t.call(this,e,i,o),this.originalEvent=n,this.pixel=i.getEventPixel(n),this.coordinate=i.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Bm);const Gm=function(t){function e(e,i,n,r,o){t.call(this,e,i,n.originalEvent,r,o),this.pointerEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Um);function Vm(t,e){return t[0]+=e[0],t[1]+=e[1],t}function zm(t,e){var i,n,r=t[0],o=t[1],s=e[0],a=e[1],l=s[0],u=s[1],h=a[0],c=a[1],d=h-l,f=c-u,p=0===d&&0===f?0:(d*(r-l)+f*(o-u))/(d*d+f*f||0);return p<=0?(i=l,n=u):p>=1?(i=h,n=c):(i=l+p*d,n=u+p*f),[i,n]}function qm(t,e){for(var i=!0,n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function Wm(t,e){var i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=r,t[1]=o,t}function Km(t,e){return t[0]*=e,t[1]*=e,t}function Xm(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function Ym(t,e){return Math.sqrt(Xm(t,e))}var Hm="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Zm=-1!==Hm.indexOf("firefox"),Jm=-1!==Hm.indexOf("safari")&&-1==Hm.indexOf("chrom"),Qm=-1!==Hm.indexOf("webkit")&&-1==Hm.indexOf("edge"),tv=-1!==Hm.indexOf("macintosh"),ev=window.devicePixelRatio||1,iv=function(){var t=!1;try{t=!!document.createElement("canvas").getContext("2d").setLineDash}catch(t){}return t}(),nv=(navigator,"ontouchstart"in window),rv="PointerEvent"in window,ov=!!navigator.msPointerEnabled,sv=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},av=function(t){return t.target.getTargetElement()===document.activeElement},lv=Mc,uv=function(t){return t.type==Gg.CLICK},hv=function(t){var e=t.originalEvent;return 0==e.button&&!(Qm&&tv&&e.ctrlKey)},cv=Oc,dv=function(t){return t.type==Gg.SINGLECLICK},fv=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},pv=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},gv=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},mv=function(t){var e=t.pointerEvent;return Ad(void 0!==e,56),"mouse"==e.pointerType},vv=function(t){var e=t.pointerEvent;return Ad(void 0!==e,56),e.isPrimary&&0===e.button};const yv=function(t){function e(e,i,n){if(t.call(this),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,i);else if(void 0!==i&&n)this.setFlatCoordinates(i,e),this.ends_=n;else{for(var r=this.getLayout(),o=e,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout()),Rf(s,h.getFlatCoordinates()),a.push(s.length)}this.setFlatCoordinates(r,s),this.ends_=a}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendLineString=function(t){this.flatCoordinates?Rf(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,i,n){return n<Gd(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(eg(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ng(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))},e.prototype.getCoordinateAtM=function(t,e,i){if(this.layout!=Df&&this.layout!=$f||0===this.flatCoordinates.length)return null;var n=void 0!==e&&e,r=void 0!==i&&i;return function(t,e,i,n,r,o,s){if(s)return $g(t,e,i[i.length-1],n,r,o);var a;if(r<t[n-1])return o?((a=t.slice(0,n))[n-1]=r,a):null;if(t[t.length-1]<r)return o?((a=t.slice(t.length-n))[n-1]=r,a):null;for(var l=0,u=i.length;l<u;++l){var h=i[l];if(e!=h){if(r<t[e+n-1])return null;if(r<=t[h-1])return $g(t,e,h,n,r,!1);e=h}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,n,r)},e.prototype.getCoordinates=function(){return lg(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new Ng(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[],r=0,o=0,s=e.length;o<s;++o){var a=e[o],l=new Ng(t.slice(r,a),i);n.push(l),r=a}return n},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,i=0,n=this.ends_,r=this.stride,o=0,s=n.length;o<s;++o){var a=n[o];Rf(t,Dg(e,i,a,r,.5)),i=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=cg(this.flatCoordinates,0,this.ends_,this.stride,t,i,0,n),new e(i,Mf,n)},e.prototype.getType=function(){return Vf},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){if(Sg(t,e,i[o],n,r))return!0;e=i[o]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=sg(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},e}(Hp);const _v=function(t){function e(e,i){t.call(this),i&&!Array.isArray(e[0])?this.setFlatCoordinates(i,e):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPoint=function(t){this.flatCoordinates?Rf(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,n){if(n<Gd(this.getExtent(),t,e))return n;for(var r=this.flatCoordinates,o=this.stride,s=0,a=r.length;s<a;s+=o){var l=Qf(t,e,r[s],r[s+1]);if(l<n){n=l;for(var u=0;u<o;++u)i[u]=r[s+u];i.length=o}}return n},e.prototype.getCoordinates=function(){return ag(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new vg(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,i=this.stride,n=[],r=0,o=t.length;r<o;r+=i){var s=new vg(t.slice(r,r+i),e);n.push(s)}return n},e.prototype.getType=function(){return Gf},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,i=this.stride,n=0,r=e.length;n<r;n+=i){if(qd(t,e[n],e[n+1]))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=og(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Hp);const bv=function(t){function e(e,i,n){if(t.call(this),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(e[0])){for(var r=this.getLayout(),o=e,s=[],a=[],l=0,u=o.length;l<u;++l){var h=o[l];0===l&&(r=h.getLayout());for(var c=s.length,d=h.getEnds(),f=0,p=d.length;f<p;++f)d[f]+=c;Rf(s,h.getFlatCoordinates()),a.push(d)}i=r,e=s,n=a}void 0!==i&&n?(this.setFlatCoordinates(i,e),this.endss_=n):this.setCoordinates(e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;Rf(this.flatCoordinates,t.getFlatCoordinates());for(var n=0,r=(e=t.getEnds().slice()).length;n<r;++n)e[n]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),n=0;n<t;++n)i[n]=this.endss_[n].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,n){return n<Gd(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];r=eg(t,e,a,n,r),e=a[a.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,o,s,a,l,u,h){for(var c=h||[NaN,NaN],d=0,f=i.length;d<f;++d){var p=i[d];u=ng(t,e,p,n,r,o,s,a,l,u,c),e=p[p.length-1]}return u}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))},e.prototype.containsXY=function(t,e){return function(t,e,i,n,r,o){if(0===i.length)return!1;for(var s=0,a=i.length;s<a;++s){var l=i[s];if(bg(t,e,l,n,r,o))return!0;e=l[l.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return function(t,e,i,n){for(var r=0,o=0,s=i.length;o<s;++o){var a=i[o];r+=Jp(t,e,a,n),e=a[a.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?kg(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,ug(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,i,n){for(var r=[],o=[1/0,1/0,-1/0,-1/0],s=0,a=i.length;s<a;++s){var l=i[s];o=Zd(t,e,l[0],n),r.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=l[l.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,i,n,r){for(var o=[],s=0,a=i.length;s<a;++s){var l=i[s];o=wg(t,e,l,n,r,2*s,o),e=l[l.length-1]}return o}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new _v(this.getFlatInteriorPoints().slice(),Df)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o)if(!Ig(t,e,i[o],n,r))return!1;return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=kg(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],n=[];return i.length=function(t,e,i,n,r,o,s,a){for(var l=0,u=i.length;l<u;++l){var h=i[l],c=[];s=pg(t,e,h,n,r,o,s,c),a.push(c),e=h[h.length-1]}return s}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,n),new e(i,Mf,n)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var n=this.endss_[t].slice(),r=n[n.length-1];if(0!==e)for(var o=0,s=n.length;o<s;++o)n[o]-=e;return new Lg(this.flatCoordinates.slice(e,r),this.layout,n)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[],r=0,o=0,s=i.length;o<s;++o){var a=i[o].slice(),l=a[a.length-1];if(0!==r)for(var u=0,h=a.length;u<h;++u)a[u]-=r;var c=new Lg(e.slice(r,l),t,a);n.push(c),r=l}return n},e.prototype.getType=function(){return zf},e.prototype.intersectsExtent=function(t){return function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(Cg(t,e,a,n,r))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=function(t,e,i,n,r){for(var o=r||[],s=0,a=0,l=i.length;a<l;++a){var u=sg(t,e,i[a],n,o[s]);o[s++]=u,e=u[u.length-1]}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var n=i[i.length-1];this.flatCoordinates.length=0===n.length?0:n[n.length-1]}this.changed()},e}(Hp);var wv=function(t,e){this.dispatcher=t,this.mapping_=e};wv.prototype.getEvents=function(){return Object.keys(this.mapping_)},wv.prototype.getHandlerForEvent=function(t){return this.mapping_[t]};const xv=wv;var Sv="mouse";function Cv(t){if(!this.isEventSimulatedFromTouch_(t)){1..toString()in this.pointerMap&&this.cancel(t);var e=kv(t,this.dispatcher);this.pointerMap[1..toString()]=t,this.dispatcher.down(e,t)}}function Ev(t){if(!this.isEventSimulatedFromTouch_(t)){var e=kv(t,this.dispatcher);this.dispatcher.move(e,t)}}function Tv(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[1..toString()];if(e&&e.button===t.button){var i=kv(t,this.dispatcher);this.dispatcher.up(i,t),this.cleanupMouse()}}}function Iv(t){if(!this.isEventSimulatedFromTouch_(t)){var e=kv(t,this.dispatcher);this.dispatcher.enterOver(e,t)}}function Av(t){if(!this.isEventSimulatedFromTouch_(t)){var e=kv(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}}function kv(t,e){var i=e.cloneEvent(t,t),n=i.preventDefault;return i.preventDefault=function(){t.preventDefault(),n()},i.pointerId=1,i.isPrimary=!0,i.pointerType=Sv,i}const Pv=function(t){function e(e){var i={mousedown:Cv,mousemove:Ev,mouseup:Tv,mouseover:Iv,mouseout:Av};t.call(this,e,i),this.pointerMap=e.pointerMap,this.lastTouches=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isEventSimulatedFromTouch_=function(t){for(var e=this.lastTouches,i=t.clientX,n=t.clientY,r=0,o=e.length,s=void 0;r<o&&(s=e[r]);r++){var a=Math.abs(i-s[0]),l=Math.abs(n-s[1]);if(a<=25&&l<=25)return!0}return!1},e.prototype.cancel=function(t){var e=kv(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},e.prototype.cleanupMouse=function(){delete this.pointerMap[1..toString()]},e}(xv),Lv="IMAGE",Rv="TILE",Fv="VECTOR_TILE",Mv="VECTOR",Ov="opacity",Dv="visible",$v="extent",jv="zIndex",Nv="maxResolution",Bv="minResolution",Uv="source";const Gv=function(t){function e(e){t.call(this);var i=bc({},e);i[Ov]=void 0!==e.opacity?e.opacity:1,i[Dv]=void 0===e.visible||e.visible,i[jv]=e.zIndex,i[Nv]=void 0!==e.maxResolution?e.maxResolution:1/0,i[Bv]=void 0!==e.minResolution?e.minResolution:0,this.setProperties(i),this.state_=null,this.type}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return this.type},e.prototype.getLayerState=function(){var t=this.state_||{layer:this,managed:!0};return t.opacity=Hf(this.getOpacity(),0,1),t.sourceState=this.getSourceState(),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=this.getZIndex()||0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),this.state_=t,t},e.prototype.getLayersArray=function(t){return gc()},e.prototype.getLayerStatesArray=function(t){return gc()},e.prototype.getExtent=function(){return this.get($v)},e.prototype.getMaxResolution=function(){return this.get(Nv)},e.prototype.getMinResolution=function(){return this.get(Bv)},e.prototype.getOpacity=function(){return this.get(Ov)},e.prototype.getSourceState=function(){return gc()},e.prototype.getVisible=function(){return this.get(Dv)},e.prototype.getZIndex=function(){return this.get(jv)},e.prototype.setExtent=function(t){this.set($v,t)},e.prototype.setMaxResolution=function(t){this.set(Nv,t)},e.prototype.setMinResolution=function(t){this.set(Bv,t)},e.prototype.setOpacity=function(t){this.set(Ov,t)},e.prototype.setVisible=function(t){this.set(Dv,t)},e.prototype.setZIndex=function(t){this.set(jv,t)},e}(sd),Vv="postcompose",zv="precompose",qv="render",Wv="rendercomplete";function Kv(t,e){return t.visible&&e>=t.minResolution&&e<t.maxResolution}const Xv=function(t){function e(e){var i=bc({},e);delete i.source,t.call(this,i),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,e.map&&this.setMap(e.map),Ac(this,od(Uv),this.handleSourcePropertyChange_,this);var n=e.source?e.source:null;this.setSource(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},e.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},e.prototype.getSource=function(){return this.get(Uv)||null},e.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():xm},e.prototype.handleSourceChange_=function(){this.changed()},e.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Lc(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Ac(t,Uc,this.handleSourceChange_,this)),this.changed()},e.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Lc(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Lc(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Ac(t,zv,(function(t){var e=t,i=this.getLayerState();i.managed=!1,void 0===this.getZIndex()&&(i.zIndex=1/0),e.frameState.layerStatesArray.push(i),e.frameState.layerStates[vc(this)]=i}),this),this.mapRenderKey_=Ac(this,Uc,t.render,t),this.changed())},e.prototype.setSource=function(t){this.set(Uv,t)},e}(Gv),Yv="image",Hv="vector";var Zv=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Jv=/^([a-z]*)$/i;function Qv(t){return"string"==typeof t?t:ey(t)}!function(){var t={},e=0}();function ty(t){return t[0]=Hf(t[0]+.5|0,0,255),t[1]=Hf(t[1]+.5|0,0,255),t[2]=Hf(t[2]+.5|0,0,255),t[3]=Hf(t[3],0,1),t}function ey(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function iy(t){return Array.isArray(t)?ey(t):t}const ny=function(t){function e(e){t.call(this),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},e.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(Gc)},e.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},e.prototype.forEach=function(t,e){for(var i=this.oldest_;i;)t.call(e,i.value_,i.key_,this),i=i.newer},e.prototype.get=function(t){var e=this.entries_[t];return Ad(void 0!==e,15),e===this.newest_||(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e),e.value_},e.prototype.remove=function(t){var e=this.entries_[t];return Ad(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},e.prototype.getCount=function(){return this.count_},e.prototype.getKeys=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.key_;return e},e.prototype.getValues=function(){var t,e=new Array(this.count_),i=0;for(t=this.newest_;t;t=t.older)e[i++]=t.value_;return e},e.prototype.peekLast=function(){return this.oldest_.value_},e.prototype.peekLastKey=function(){return this.oldest_.key_},e.prototype.peekFirstKey=function(){return this.newest_.key_},e.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},e.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},e.prototype.set=function(t,e){Ad(!(t in this.entries_),16);var i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_},e.prototype.setSize=function(t){this.highWaterMark=t},e.prototype.prune=function(){for(;this.canExpireCache();)this.pop()},e}(Bc);var ry="10px sans-serif",oy=[0,0,0,1],sy="round",ay=[],ly="round",uy=[0,0,0,1],hy="center",cy="middle",dy=[0,0,0,0],fy=new ny,py={},gy=null,my={},vy=function(){var t,e,i=py,n="32px ",r=["monospace","serif"],o=r.length,s="wmytzilWMYTZIL@#/&?$%10";function a(t){for(var i=yy(),a=100;a<=700;a+=300){for(var l=a+" ",u=!0,h=0;h<o;++h){var c=r[h];if(i.font=l+n+c,e=i.measureText(s).width,t!=c){i.font=l+n+t+","+c;var d=i.measureText(s).width;u=u&&d!=e}}if(u)return!0}return!1}function l(){var e=!0;for(var n in i)i[n]<60&&(a(n)?(i[n]=60,wc(my),gy=null,fy.clear()):(++i[n],e=!1));e&&(clearInterval(t),t=void 0)}return function(e){var n=bd(e);if(n)for(var r=0,o=n.length;r<o;++r){var s=n[r];s in i||(i[s]=60,a(s)||(i[s]=0,void 0===t&&(t=setInterval(l,32))))}}}();function yy(){return gy||(gy=wd(1,1)),gy}var _y,by,wy=(by=my,function(t){var e=by[t];return null==e&&(_y||((_y=document.createElement("span")).textContent="M",_y.style.margin=_y.style.padding="0 !important",_y.style.position="absolute !important",_y.style.left="-99999px !important"),_y.style.font=t,document.body.appendChild(_y),e=by[t]=_y.offsetHeight,document.body.removeChild(_y)),e});function xy(t,e){var i=yy();return t!=i.font&&(i.font=t),i.measureText(e).width}function Sy(t,e,i,n){0!==e&&(t.translate(i,n),t.rotate(e),t.translate(-i,-n))}var Cy=[1,0,0,1,0,0];function Ey(t,e,i,n,r,o,s,a,l,u,h){var c;1!=i&&(c=t.globalAlpha,t.globalAlpha=c*i),e&&t.setTransform.apply(t,e),t.drawImage(n,r,o,s,a,l,u,s*h,a*h),c&&(t.globalAlpha=c),e&&t.setTransform.apply(t,Cy)}var Ty=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale};Ty.prototype.clone=function(){return new Ty({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},Ty.prototype.getOpacity=function(){return this.opacity_},Ty.prototype.getRotateWithView=function(){return this.rotateWithView_},Ty.prototype.getRotation=function(){return this.rotation_},Ty.prototype.getScale=function(){return this.scale_},Ty.prototype.getSnapToPixel=function(){return!1},Ty.prototype.getAnchor=function(){return gc()},Ty.prototype.getImage=function(t){return gc()},Ty.prototype.getHitDetectionImage=function(t){return gc()},Ty.prototype.getImageState=function(){return gc()},Ty.prototype.getImageSize=function(){return gc()},Ty.prototype.getHitDetectionImageSize=function(){return gc()},Ty.prototype.getOrigin=function(){return gc()},Ty.prototype.getSize=function(){return gc()},Ty.prototype.setOpacity=function(t){this.opacity_=t},Ty.prototype.setRotateWithView=function(t){this.rotateWithView_=t},Ty.prototype.setRotation=function(t){this.rotation_=t},Ty.prototype.setScale=function(t){this.scale_=t},Ty.prototype.setSnapToPixel=function(t){},Ty.prototype.listenImageChange=function(t,e){return gc()},Ty.prototype.load=function(){gc()},Ty.prototype.unlistenImageChange=function(t,e){gc()};const Iy=function(t){function e(e){var i=void 0!==e.rotateWithView&&e.rotateWithView;t.call(this,{opacity:1,rotateWithView:i,rotation:void 0!==e.rotation?e.rotation:0,scale:1}),this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==e.fill?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=void 0!==e.radius?e.radius:e.radius1,this.radius2_=e.radius2,this.angle_=void 0!==e.angle?e.angle:0,this.stroke_=void 0!==e.stroke?e.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=e.atlasManager,this.render_(this.atlasManager_)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.getAnchor=function(){return this.anchor_},e.prototype.getAngle=function(){return this.angle_},e.prototype.getFill=function(){return this.fill_},e.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},e.prototype.getImage=function(t){return this.canvas_},e.prototype.getImageSize=function(){return this.imageSize_},e.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},e.prototype.getImageState=function(){return fm},e.prototype.getOrigin=function(){return this.origin_},e.prototype.getPoints=function(){return this.points_},e.prototype.getRadius=function(){return this.radius_},e.prototype.getRadius2=function(){return this.radius2_},e.prototype.getSize=function(){return this.size_},e.prototype.getStroke=function(){return this.stroke_},e.prototype.listenImageChange=function(t,e){},e.prototype.load=function(){},e.prototype.unlistenImageChange=function(t,e){},e.prototype.render_=function(t){var e,i,n="",r="",o=0,s=null,a=0,l=0;this.stroke_&&(null===(i=this.stroke_.getColor())&&(i=uy),i=iy(i),void 0===(l=this.stroke_.getWidth())&&(l=1),s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset(),iv||(s=null,a=0),void 0===(r=this.stroke_.getLineJoin())&&(r=ly),void 0===(n=this.stroke_.getLineCap())&&(n=sy),void 0===(o=this.stroke_.getMiterLimit())&&(o=10));var u=2*(this.radius_+l)+1,h={strokeStyle:i,strokeWidth:l,size:u,lineCap:n,lineDash:s,lineDashOffset:a,lineJoin:r,miterLimit:o};if(void 0===t){var c=wd(u,u);this.canvas_=c.canvas,e=u=this.canvas_.width,this.draw_(h,c,0,0),this.createHitDetectionCanvas_(h)}else{u=Math.round(u);var d,f=!this.fill_;f&&(d=this.drawHitDetectionCanvas_.bind(this,h));var p=this.getChecksum(),g=t.add(p,u,u,this.draw_.bind(this,h),d);this.canvas_=g.image,this.origin_=[g.offsetX,g.offsetY],e=g.image.width,f?(this.hitDetectionCanvas_=g.hitImage,this.hitDetectionImageSize_=[g.hitImage.width,g.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[u/2,u/2],this.size_=[u,u],this.imageSize_=[e,e]},e.prototype.draw_=function(t,e,i,n){var r,o,s;e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,s=r%2==0?this.radius_:l,e.lineTo(t.size/2+s*Math.cos(o),t.size/2+s*Math.sin(o))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u=oy),e.fillStyle=iy(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},e.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=wd(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},e.prototype.drawHitDetectionCanvas_=function(t,e,i,n){e.setTransform(1,0,0,1,0,0),e.translate(i,n),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o,s,a,l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(r*=2),o=0;o<=r;o++)a=2*o*Math.PI/r-Math.PI/2+this.angle_,s=o%2==0?this.radius_:l,e.lineTo(t.size/2+s*Math.cos(a),t.size/2+s*Math.sin(a))}e.fillStyle=Qv(oy),e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},e.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var i="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[i,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]},e}(Ty);const Ay=function(t){function e(e){var i=e||{};t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,atlasManager:i.atlasManager})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)},e}(Iy);var ky=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};ky.prototype.clone=function(){var t=this.getColor();return new ky({color:Array.isArray(t)?t.slice():t||void 0})},ky.prototype.getColor=function(){return this.color_},ky.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},ky.prototype.getChecksum=function(){if(void 0===this.checksum_){var t=this.color_;t?Array.isArray(t)||"string"==typeof t?this.checksum_="f"+Qv(t):this.checksum_=vc(this.color_):this.checksum_="f-"}return this.checksum_};const Py=ky;var Ly=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};Ly.prototype.clone=function(){var t=this.getColor();return new Ly({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},Ly.prototype.getColor=function(){return this.color_},Ly.prototype.getLineCap=function(){return this.lineCap_},Ly.prototype.getLineDash=function(){return this.lineDash_},Ly.prototype.getLineDashOffset=function(){return this.lineDashOffset_},Ly.prototype.getLineJoin=function(){return this.lineJoin_},Ly.prototype.getMiterLimit=function(){return this.miterLimit_},Ly.prototype.getWidth=function(){return this.width_},Ly.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},Ly.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},Ly.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},Ly.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},Ly.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},Ly.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},Ly.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},Ly.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=vc(this.color_):this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};const Ry=Ly;var Fy=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=$y,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};Fy.prototype.clone=function(){var t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Fy({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},Fy.prototype.getRenderer=function(){return this.renderer_},Fy.prototype.setRenderer=function(t){this.renderer_=t},Fy.prototype.getGeometry=function(){return this.geometry_},Fy.prototype.getGeometryFunction=function(){return this.geometryFunction_},Fy.prototype.getFill=function(){return this.fill_},Fy.prototype.setFill=function(t){this.fill_=t},Fy.prototype.getImage=function(){return this.image_},Fy.prototype.setImage=function(t){this.image_=t},Fy.prototype.getStroke=function(){return this.stroke_},Fy.prototype.setStroke=function(t){this.stroke_=t},Fy.prototype.getText=function(){return this.text_},Fy.prototype.setText=function(t){this.text_=t},Fy.prototype.getZIndex=function(){return this.zIndex_},Fy.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=$y,this.geometry_=t},Fy.prototype.setZIndex=function(t){this.zIndex_=t};var My=null;function Oy(t,e){if(!My){var i=new Py({color:"rgba(255,255,255,0.4)"}),n=new Ry({color:"#3399CC",width:1.25});My=[new Fy({image:new Ay({fill:i,stroke:n,radius:5}),fill:i,stroke:n})]}return My}function Dy(){var t={},e=[255,255,255,1],i=[0,153,255,1];return t[Uf]=[new Fy({fill:new Py({color:[255,255,255,.5]})})],t[zf]=t[Uf],t[Nf]=[new Fy({stroke:new Ry({color:e,width:5})}),new Fy({stroke:new Ry({color:i,width:3})})],t[Vf]=t[Nf],t[Wf]=t[Uf].concat(t[Nf]),t[jf]=[new Fy({image:new Ay({radius:6,fill:new Py({color:i}),stroke:new Ry({color:e,width:1.5})}),zIndex:1/0})],t[Gf]=t[jf],t[qf]=t[Uf].concat(t[Nf],t[jf]),t}function $y(t){return t.getGeometry()}const jy=Fy;var Ny="renderOrder",By=function(t){function e(e){var i=e||{},n=bc({},i);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,t.call(this,n),this.declutter_=void 0!==i.declutter&&i.declutter,this.renderBuffer_=void 0!==i.renderBuffer?i.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(i.style),this.updateWhileAnimating_=void 0!==i.updateWhileAnimating&&i.updateWhileAnimating,this.updateWhileInteracting_=void 0!==i.updateWhileInteracting&&i.updateWhileInteracting,this.renderMode_=i.renderMode||Hv,this.type=Mv}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.setDeclutter=function(t){this.declutter_=t},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Ny)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Ny,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Oy,this.styleFunction_=null===t?void 0:function(t){var e;if("function"==typeof t)e=t;else{var i;Array.isArray(t)?i=t:(Ad("function"==typeof t.getZIndex,41),i=[t]),e=function(){return i}}return e}(this.style_),this.changed()},e.prototype.getRenderMode=function(){return this.renderMode_},e}(Xv);By.prototype.getSource;const Uy=By,Gy="arraybuffer",Vy="json",zy="text",qy="xml";function Wy(t,e){return function(t,e,i,n){return function(r,o,s){var a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(r,o,s):t,!0),e.getType()==Gy&&(a.responseType="arraybuffer"),a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){var r,o=e.getType();o==Vy||o==zy?r=a.responseText:o==qy?(r=a.responseXML)||(r=(new DOMParser).parseFromString(a.responseText,"application/xml")):o==Gy&&(r=a.response),r?i.call(this,e.readFeatures(r,{featureProjection:s}),e.readProjection(r),e.getLastExtent()):n.call(this)}else n.call(this)}.bind(this),a.onerror=function(){n.call(this)}.bind(this),a.send()}}(t,e,(function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}),Dc)}function Ky(t,e){return[[-1/0,-1/0,1/0,1/0]]}const Xy="addfeature",Yy="changefeature",Hy="clear",Zy="removefeature";var Jy=i(5510),Qy=i.n(Jy),t_=function(t){this.rbush_=Qy()(t,void 0),this.items_={}};t_.prototype.insert=function(t,e){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[vc(e)]=i},t_.prototype.load=function(t,e){for(var i=new Array(e.length),n=0,r=e.length;n<r;n++){var o=t[n],s=e[n],a={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};i[n]=a,this.items_[vc(s)]=a}this.rbush_.load(i)},t_.prototype.remove=function(t){var e=vc(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)},t_.prototype.update=function(t,e){var i=this.items_[vc(e)];Jd([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))},t_.prototype.getAll=function(){return this.rbush_.all().map((function(t){return t.value}))},t_.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))},t_.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},t_.prototype.forEachInExtent=function(t,e,i){return this.forEach_(this.getInExtent(t),e,i)},t_.prototype.forEach_=function(t,e,i){for(var n,r=0,o=t.length;r<o;r++)if(n=e.call(i,t[r]))return n;return n},t_.prototype.isEmpty=function(){return Sc(this.items_)},t_.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t_.prototype.getExtent=function(t){var e=this.rbush_.toJSON();return Xd(e.minX,e.minY,e.maxX,e.maxY,t)},t_.prototype.concat=function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]};const e_=t_;var i_=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);const n_=function(t){function e(e){var i=e||{};t.call(this,{attributions:i.attributions,projection:void 0,state:Sm,wrapX:void 0===i.wrapX||i.wrapX}),this.loader_=Dc,this.format_=i.format,this.overlaps_=null==i.overlaps||i.overlaps,this.url_=i.url,void 0!==i.loader?this.loader_=i.loader:void 0!==this.url_&&(Ad(this.format_,7),this.loader_=Wy(this.url_,this.format_)),this.strategy_=void 0!==i.strategy?i.strategy:Ky;var n,r,o=void 0===i.useSpatialIndex||i.useSpatialIndex;this.featuresRtree_=o?new e_:null,this.loadedExtentsRtree_=new e_,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(i.features)?r=i.features:i.features&&(r=(n=i.features).getArray()),o||void 0!==n||(n=new $m(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==n&&this.bindFeaturesCollection_(n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},e.prototype.addFeatureInternal=function(t){var e=vc(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var i=t.getGeometry();if(i){var n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new i_(Xy,t))}},e.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Ac(e,Uc,this.handleFeatureChange_,this),Ac(e,_c,this.handleFeatureChange_,this)]},e.prototype.addToIndex_=function(t,e){var i=!0,n=e.getId();return void 0!==n?n.toString()in this.idIndex_?i=!1:this.idIndex_[n.toString()]=e:(Ad(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),i},e.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},e.prototype.addFeaturesInternal=function(t){for(var e=[],i=[],n=[],r=0,o=t.length;r<o;r++){var s=t[r],a=vc(s);this.addToIndex_(a,s)&&i.push(s)}for(var l=0,u=i.length;l<u;l++){var h=i[l],c=vc(h);this.setupChangeEvents_(c,h);var d=h.getGeometry();if(d){var f=d.getExtent();e.push(f),n.push(h)}else this.nullGeometryFeatures_[c]=h}this.featuresRtree_&&this.featuresRtree_.load(e,n);for(var p=0,g=i.length;p<g;p++)this.dispatchEvent(new i_(Xy,i[p]))},e.prototype.bindFeaturesCollection_=function(t){var e=!1;Ac(this,Xy,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),Ac(this,Zy,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),Ac(t,Fm,(function(t){e||(e=!0,this.addFeature(t.element),e=!1)}),this),Ac(t,Mm,(function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}),this),this.featuresCollection_=t},e.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_){this.featureChangeKeys_[e].forEach(Lc)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_)for(var i in this.featuresRtree_.forEach(this.removeFeatureInternal,this),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var n=new i_(Hy);this.dispatchEvent(n),this.changed()},e.prototype.forEachFeature=function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},e.prototype.forEachFeatureAtCoordinateDirect=function(t,e){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?e(i):void 0}))},e.prototype.forEachFeatureInExtent=function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},e.prototype.forEachFeatureIntersectingExtent=function(t,e){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var n=e(i);if(n)return n}}))},e.prototype.getFeaturesCollection=function(){return this.featuresCollection_},e.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Sc(this.nullGeometryFeatures_)||Rf(t,xc(this.nullGeometryFeatures_))),t},e.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e},e.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},e.prototype.getClosestFeatureToCoordinate=function(t,e){var i=t[0],n=t[1],r=null,o=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],l=e||Mc;return this.featuresRtree_.forEachInExtent(a,(function(t){if(l(t)){var e=t.getGeometry(),u=s;if((s=e.closestPointXY(i,n,o,s))<u){r=t;var h=Math.sqrt(s);a[0]=i-h,a[1]=n-h,a[2]=i+h,a[3]=n+h}}})),r},e.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},e.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getFormat=function(){return this.format_},e.prototype.getOverlaps=function(){return this.overlaps_},e.prototype.getUrl=function(){return this.url_},e.prototype.handleFeatureChange_=function(t){var e=t.target,i=vc(e),n=e.getGeometry();if(n){var r=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);var o=e.getId();if(void 0!==o){var s=o.toString();i in this.undefIdIndex_?(delete this.undefIdIndex_[i],this.idIndex_[s]=e):this.idIndex_[s]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[s]=e)}else i in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[i]=e);this.changed(),this.dispatchEvent(new i_(Yy,e))},e.prototype.hasFeature=function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:vc(t)in this.undefIdIndex_},e.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Sc(this.nullGeometryFeatures_)},e.prototype.loadFeatures=function(t,e,i){var n=this,r=this.loadedExtentsRtree_,o=this.strategy_(t,e);this.loading=!1;for(var s=function(t,s){var a=o[t];r.forEachInExtent(a,(function(t){return zd(t.extent,a)}))||(n.loader_.call(n,a,e,i),r.insert(a,{extent:a.slice()}),n.loading=n.loader_!==Dc)},a=0,l=o.length;a<l;++a)s(a)},e.prototype.removeLoadedExtent=function(t){var e,i=this.loadedExtentsRtree_;i.forEachInExtent(t,(function(i){if(Jd(i.extent,t))return e=i,!0})),e&&i.remove(e)},e.prototype.removeFeature=function(t){var e=vc(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},e.prototype.removeFeatureInternal=function(t){var e=vc(t);this.featureChangeKeys_[e].forEach(Lc),delete this.featureChangeKeys_[e];var i=t.getId();void 0!==i?delete this.idIndex_[i.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new i_(Zy,t))},e.prototype.removeFromIdIndex_=function(t){var e=!1;for(var i in this.idIndex_)if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}return e},e.prototype.setLoader=function(t){this.loader_=t},e}(Em);const r_=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return Kf},e.prototype.closestPointXY=function(t,e,i,n){var r,o,s,a=this.flatCoordinates,l=n;i[0]=a[0],i[1]=a[1];for(var u=0,h=a.length;u<h;u+=2)(r=(o=t-a[u])*o+(s=e-a[u+1])*s)<l&&(l=r,i[0]=a[u],i[1]=a[u+1]);return l},e}(Lg);const o_=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getType=function(){return Xf},e.prototype.closestPointXY=function(t,e,i,n){var r,o,s,a=this.flatCoordinates,l=n;i[0]=a[0],i[1]=a[1];for(var u=0,h=a.length;u<h;u+=2)(r=(o=t-a[u])*o+(s=e-a[u+1])*s)<l&&(l=r,i[0]=a[u],i[1]=a[u+1]);return l},e.prototype.getArea=function(){var t=this.flatCoordinates,e=Math.sqrt(Math.pow(t[0]-t[4],2)+Math.pow(t[1]-t[5],2)),i=Math.sqrt(Math.pow(t[2]-t[6],2)+Math.pow(t[3]-t[7],2));return Math.PI*e*i*.25},e}(Lg);var s_="Point",a_="LineString",l_="Polygon",u_="Circle",h_="Ellipse",c_="drawstart",d_="drawend",f_=function(t){function e(e,i){t.call(this,e),this.feature=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);function p_(){var t=Dy();return function(e,i){return t[e.getGeometry().getType()]}}const g_=function(t){function e(e){var i=e;i.stopDown||(i.stopDown=Oc),t.call(this,i),this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=function(t){var e;t===jf||t===Gf?e=s_:t===Nf||t===Vf||t===Kf?e=a_:t===Uf||t===zf?e=l_:t===Wf?e=u_:t===Xf&&(e=h_);return e}(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_===l_?3:2,this.maxPoints_=e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:Mc;var n=e.geometryFunction;if(!n)if(this.type_===Wf)n=function(t,e){var i=e||new Og([NaN,NaN]),n=Xm(t[0],t[1]);return i.setCenterAndRadius(t[0],Math.sqrt(n)),i};else if(this.type_===Kf)this.minPoints_=3,this.maxPoints_=3,n=function(t,e){if(t.length>2){var i=t[0],n=t[1],r=t[2],o=[n[0]-i[0],n[1]-i[1]];if(0===o[1])t=[[i,i,i,i]];else{var s=[-1*o[1],o[0]],a=o[0]/o[1],l=(r[0]+a*(n[1]-r[1])-n[0])/(s[0]-s[1]*a),u=[l*s[0],l*s[1]];t=[[[i[0]-u[0],i[1]-u[1]],[n[0]-u[0],n[1]-u[1]],[n[0]+u[0],n[1]+u[1]],[i[0]+u[0],i[1]+u[1]]]]}}else t=[t];var h=e;return h?h.setCoordinates(t):h=new r_(t),h};else if(this.type_===Xf)this.minPoints_=3,this.maxPoints_=3,n=function(t,e){if(t.length>2){var i=t[0],n=t[1],r=t[2],o=[n[0]-i[0],n[1]-i[1]],s=[i[0]+.5*o[0],i[1]+.5*o[1]];if(0===o[1])t=[[i,i,i,i]];else{var a=[-1*o[1],o[0]],l=o[0]/o[1],u=(r[0]+l*(n[1]-r[1])-n[0])/(a[0]-a[1]*l),h=[u*a[0],u*a[1]];t=[[[i[0],i[1]],[s[0]-h[0],s[1]-h[1]],[n[0],n[1]],[s[0]+h[0],s[1]+h[1]]]]}}else t=[t];var c=e;return c?c.setCoordinates(t):c=new o_(t),c};else{var r,o=this.mode_;o===s_?r=vg:o===a_?r=Ng:o===l_&&(r=Lg),n=function(t,e){var i=e;return i?o===l_?t[0].length?i.setCoordinates([t[0].concat([t[0][0]])]):i.setCoordinates([]):i.setCoordinates(t):i=new r(t),i}}this.geometryFunction_=n,this.dragVertexDelay_=void 0!==e.dragVertexDelay?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Uy({source:new n_({useSpatialIndex:!1,wrapX:!!e.wrapX&&e.wrapX}),style:e.style?e.style:p_(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:fv,this.freehandCondition_,e.freehand?this.freehandCondition_=lv:this.freehandCondition_=e.freehandCondition?e.freehandCondition:pv,Ac(this,od(Kg),this.updateState_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),this.updateState_()},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleEvent=function(e){e.originalEvent.type===Vc&&e.preventDefault(),this.freehand_=this.mode_!==s_&&this.freehandCondition_(e);var i=e.type===Gg.POINTERMOVE,n=!0;!this.freehand_&&this.lastDragTime_&&e.type===Gg.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,i=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&e.type===Gg.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(e),n=!1):this.freehand_&&e.type===Gg.POINTERDOWN?n=!1:i?(n=e.type===Gg.POINTERMOVE)&&this.freehand_?n=this.handlePointerMove_(e):(e.pointerEvent.pointerType==Sv||e.type===Gg.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(e):e.type===Gg.DBLCLICK&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):!!this.condition_(t)&&(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Gm(Gg.POINTERMOVE,t.map,t.pointerEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0)},e.prototype.handleUpEvent=function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var i=this.mode_===u_;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||i?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t):(this.startDrawing_(t),this.mode_===s_&&this.finishDrawing()),e=!1):this.freehand_&&(this.finishCoordinate_=null,this.abortDrawing_()),!e&&this.stopClick_&&t.stopPropagation(),e},e.prototype.handlePointerMove_=function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,i=t.pixel,n=e[0]-i[0],r=e[1]-i[1],o=n*n+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0},e.prototype.atFinish_=function(t){var e=!1;if(this.sketchFeature_){var i=!1,n=[this.finishCoordinate_];if(this.mode_===a_)i=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===l_){var r=this.sketchCoords_;i=r[0].length>this.minPoints_,n=[r[0][0],r[0][r[0].length-2]]}if(i)for(var o=t.map,s=0,a=n.length;s<a;s++){var l=n[s],u=o.getPixelFromCoordinate(l),h=t.pixel,c=h[0]-u[0],d=h[1]-u[1],f=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(c*c+d*d)<=f){this.finishCoordinate_=l;break}}}return e},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new Nm(new vg(e)),this.updateSketchFeatures_())},e.prototype.startDrawing_=function(t){var e=t.coordinate;this.finishCoordinate_=e,this.mode_===s_?this.sketchCoords_=e.slice():this.mode_===l_?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Nm(new Ng(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_);this.sketchFeature_=new Nm,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new f_(c_,this.sketchFeature_))},e.prototype.modifyDrawing_=function(t){var e,i,n,r=t.coordinate,o=this.sketchFeature_.getGeometry();(this.mode_===s_?i=this.sketchCoords_:this.mode_===l_?(i=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(r=this.finishCoordinate_.slice())):i=(e=this.sketchCoords_)[e.length-1],i[0]=r[0],i[1]=r[1],this.geometryFunction_(this.sketchCoords_,o),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(r);if(this.mode_===h_)if(this.sketchLine_||(this.sketchLine_=new Nm(new Ng([0,0]))),n=this.sketchLine_.getGeometry(),this.sketchCoords_.length<3)n.setCoordinates(this.sketchCoords_);else{var s=[((e=o.getCoordinates()[0])[0][0]+e[2][0])/2,(e[0][1]+e[2][1])/2];n.setCoordinates([e[0],s,e[3]])}else if(o.getType()==Uf&&this.mode_!==l_){this.sketchLine_||(this.sketchLine_=new Nm);var a=o.getLinearRing(0);(n=this.sketchLine_.getGeometry())?(n.setFlatCoordinates(a.getLayout(),a.getFlatCoordinates()),n.changed()):(n=new Ng(a.getFlatCoordinates(),a.getLayout()),this.sketchLine_.setGeometry(n))}else this.sketchLineCoords_&&(n=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},e.prototype.addToDrawing_=function(t){var e,i,n=t.coordinate,r=this.sketchFeature_.getGeometry();this.mode_===a_||this.mode_===h_?(this.finishCoordinate_=n.slice(),(i=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),this.geometryFunction_(i,r)):this.mode_===l_&&((i=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?i.pop():e=!0),i.push(n.slice()),e&&(this.finishCoordinate_=i[0]),this.geometryFunction_(this.sketchCoords_,r)),this.updateSketchFeatures_(),e&&this.finishDrawing()},e.prototype.removeLastPoint=function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry();this.mode_===a_?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e),t.length>=2&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===l_&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e)),0===t.length&&(this.finishCoordinate_=null),this.updateSketchFeatures_()}},e.prototype.finishDrawing=function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,i=t.getGeometry();this.mode_===a_?(e.pop(),this.geometryFunction_(e,i)):this.mode_===l_&&(e[0].pop(),this.geometryFunction_(e,i),e=i.getCoordinates()),this.type_===Gf?t.setGeometry(new _v([e])):this.type_===Vf?t.setGeometry(new yv([e])):this.type_===zf&&t.setGeometry(new bv([e])),this.dispatchEvent(new f_(d_,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}},e.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return t&&(this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0)),t},e.prototype.extend=function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new f_(c_,this.sketchFeature_))},e.prototype.updateSketchFeatures_=function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)},e.prototype.updateState_=function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing_(),this.overlay_.setMap(e?t:null)},e}(tm);var m_={white:[255,255,255,1],blue:[0,153,255,1],orange:"#ff5e00"},v_={},y_=new Ry({color:m_.white,width:5}),__=new Ry({color:m_.white,width:6}),b_=new Ry({color:m_.blue,width:3}),w_=new Ry({color:m_.orange,width:3}),x_=new Py({color:m_.blue}),S_=new Py({color:m_.orange}),C_=new Ry({color:m_.white,width:2}),E_=new Ry({color:m_.white,width:3}),T_=new Ry({color:m_.white,width:2,lineDash:[3]}),I_=new Ry({color:m_.blue,width:3,lineDash:[5]});const A_={colors:m_,features:function(t){var e=t.get("color");return e=e?"#"+e:m_.blue,v_.hasOwnProperty(e)||(v_[e]=[new jy({stroke:y_,image:new Ay({radius:6,fill:new Py({color:e}),stroke:C_}),fill:new Py({color:"transparent"})}),new jy({stroke:new Ry({color:e,width:3})})]),v_[e]},highlight:[new jy({stroke:__,image:new Ay({radius:6,fill:S_,stroke:E_}),zIndex:200}),new jy({stroke:w_,zIndex:200})],editing:[new jy({stroke:y_,image:new Ay({radius:6,fill:x_,stroke:T_})}),new jy({stroke:I_})],viewport:[new jy({stroke:b_}),new jy({stroke:new Ry({color:m_.white,width:1})})],cross:[new jy({image:new Iy({stroke:__,points:4,radius1:6,radius2:0,angle:Math.PI/4})}),new jy({image:new Iy({stroke:w_,points:4,radius1:6,radius2:0,angle:Math.PI/4})})]};var k_,P_=function(t){var e=t.pointerEvent;return!(!e||"pen"!==e.pointerType)||pv(t)};const L_=Ml({computed:{isDrawing:function(){return this.interactionMode.startsWith("draw")},isDrawingPoint:function(){return"drawPoint"===this.interactionMode},isDrawingRectangle:function(){return"drawRectangle"===this.interactionMode},isDrawingCircle:function(){return"drawCircle"===this.interactionMode},isDrawingLineString:function(){return"drawLineString"===this.interactionMode},isDrawingPolygon:function(){return"drawPolygon"===this.interactionMode},isDrawingEllipse:function(){return"drawEllipse"===this.interactionMode}},methods:{draw:function(t){this["isDrawing"+t]?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="draw"+t):this.requireSelectedLabel()},drawPoint:function(){this.draw("Point")},drawRectangle:function(){this.draw("Rectangle")},drawCircle:function(){this.draw("Circle")},drawLineString:function(){this.draw("LineString")},drawPolygon:function(){this.draw("Polygon")},drawEllipse:function(){this.draw("Ellipse")},maybeUpdateDrawInteractionMode:function(t){k_&&(this.map.removeInteraction(k_),k_=void 0),this.isDrawing&&((k_=new g_({source:this.annotationSource,type:t.slice(4),style:A_.editing,freehandCondition:P_})).on("drawend",this.handleNewFeature),this.map.addInteraction(k_))}},watch:{selectedLabel:function(t){this.isDrawing&&!t&&this.resetInteractionMode()}},created:function(){this.canAdd&&(xu.on("a",this.drawPoint,0,this.listenerSet),xu.on("s",this.drawRectangle,0,this.listenerSet),xu.on("d",this.drawCircle,0,this.listenerSet),xu.on("Shift+d",this.drawEllipse,0,this.listenerSet),xu.on("f",this.drawLineString,0,this.listenerSet),xu.on("g",this.drawPolygon,0,this.listenerSet),this.$watch("interactionMode",this.maybeUpdateDrawInteractionMode))}},undefined,undefined,!1,null,null,null).exports;var R_=function(t){function e(e){var i=e||{};t.call(this,i),this.type=Lv}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Xv);R_.prototype.getSource;const F_=R_;const M_=Ml({props:{label:{required:!0}}},undefined,undefined,!1,null,null,null).exports;const O_=Ml({data:function(){return{imageSection:[0,0],imageSectionCenter:[0,0]}},computed:{imageSectionSteps:function(){return[Math.ceil(this.image.width/(this.viewExtent[2]-this.viewExtent[0])),Math.ceil(this.image.height/(this.viewExtent[3]-this.viewExtent[1]))]},imageSectionStepSize:function(){var t,e=[this.viewExtent[2]-this.viewExtent[0],this.viewExtent[3]-this.viewExtent[1]];return this.imageSectionSteps[0]>1?(t=e[0]*this.imageSectionSteps[0]-this.image.width,e[0]-=t/(this.imageSectionSteps[0]-1)):e[0]=this.viewExtent[2],this.imageSectionSteps[1]>1?(t=e[1]*this.imageSectionSteps[1]-this.image.height,e[1]-=t/(this.imageSectionSteps[1]-1)):e[1]=this.viewExtent[3],e},imageSectionStartCenter:function(){var t=[(this.viewExtent[2]-this.viewExtent[0])/2,(this.viewExtent[3]-this.viewExtent[1])/2];return this.imageSectionSteps[0]<=1&&(t[0]=this.extent[2]/2),this.imageSectionSteps[1]<=1&&(t[1]=this.extent[3]/2),t},isLawnmowerAnnotationMode:function(){return"lawnmower"===this.annotationMode}},methods:{getImageSectionCenter:function(t){return[t[0]*this.imageSectionStepSize[0]+this.imageSectionStartCenter[0],t[1]*this.imageSectionStepSize[1]+this.imageSectionStartCenter[1]]},showImageSection:function(t){return t[0]<this.imageSectionSteps[0]&&t[1]<this.imageSectionSteps[1]&&t[0]>=0&&t[1]>=0&&(this.imageSection=t,this.imageSectionCenter=this.getImageSectionCenter(t),this.map.getView().setCenter(this.imageSectionCenter),!0)},showLastImageSection:function(){this.showImageSection([this.imageSectionSteps[0]-1,this.imageSectionSteps[1]-1])},showFirstImageSection:function(){this.showImageSection([0,0])},showPreviousImageSection:function(){var t=this.imageSection[0]-1;return t>=0?this.showImageSection([t,this.imageSection[1]]):this.showImageSection([this.imageSectionSteps[0]-1,this.imageSection[1]-1])},showNextImageSection:function(){var t=this.imageSection[0]+1;return t<this.imageSectionSteps[0]?this.showImageSection([t,this.imageSection[1]]):this.showImageSection([0,this.imageSection[1]+1])}},watch:{viewExtent:function(){if(this.isLawnmowerAnnotationMode&&Number.isInteger(this.imageSectionSteps[0])&&Number.isInteger(this.imageSectionSteps[1])){for(var t,e,i=1/0,n=0,r=[0,0],o=0;o<this.imageSectionSteps[1];o++)for(var s=0;s<this.imageSectionSteps[0];s++)t=this.imageSectionCenter,e=this.getImageSectionCenter([s,o]),(n=Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)))<i&&(r[0]=s,r[1]=o,i=n);this.showImageSection(r)}}}},undefined,undefined,!1,null,null,null).exports;var D_=i(6252),$_=i.n(D_);function j_(t){return(j_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N_(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function B_(t,e){return(B_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function U_(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=V_(t);if(e){var r=V_(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return G_(this,i)}}function G_(t,e){return!e||"object"!==j_(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V_(t){return(V_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const z_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B_(t,e)}(o,t);var e,i,n,r=U_(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).on("change:active",e.toggleActive),e.layer=t.layer,e.colorThreshold=void 0===t.colorThreshold?15:t.colorThreshold,e.currentThreshold=e.colorThreshold,e.blurRadius=void 0===t.blurRadius?5:t.blurRadius,e.simplifyTolerant=void 0===t.simplifyTolerant?0:t.simplifyTolerant,e.simplifyCount=void 0===t.simplifyCount?3:t.simplifyCount,e.downPoint=[0,0],e.map=t.map,e.snapshotCanvas=document.createElement("canvas"),e.snapshotContext=e.snapshotCanvas.getContext("2d"),e.snapshot=null,e.updatingSnapshot=!1,e.discardRadius=void 0===t.discardRadius?20:t.discardRadius,e.sketchFeature=null,e.sketchSource=t.source,void 0===e.sketchSource&&(e.sketchSource=new n_,e.map.addLayer(new Uy({source:e.sketchSource,zIndex:200}))),e.sketchStyle=void 0===t.style?null:t.style,e.isShowingPoint=!1,e.indicatorPoint=new Nm(new vg([20,20])),void 0!==t.indicatorPointStyle&&e.indicatorPoint.setStyle(t.indicatorPointStyle),e.isShowingCross=!1,e.indicatorCross=new Nm(new vg([100,100])),void 0!==t.indicatorCrossStyle?e.indicatorCross.setStyle(t.indicatorCrossStyle):e.indicatorCross.setStyle([new jy({image:new Iy({stroke:new Ry({color:[0,153,255,1],width:3}),points:4,radius1:6,radius2:0,angle:Math.PI/4})}),new jy({image:new Iy({stroke:new Ry({color:[255,255,255,.75],width:1.5}),points:4,radius1:6,radius2:0,angle:Math.PI/4})})]),e.indicatorSource=new n_,e.map.addLayer(new Uy({source:e.indicatorSource,zIndex:200})),e.toggleActive(),e}return e=o,(i=[{key:"getHighDpiScaling",value:function(){return this.snapshot.height/this.map.getSize()[1]}},{key:"toSnapshotCoordinates",value:function(t){var e=this.map.getView().calculateExtent(this.map.getSize()),i=this.snapshot.height,n=this.getHighDpiScaling()/this.map.getView().getResolution();return t.map((function(t){return[Math.round((t[0]-e[0])*n),i-Math.round((t[1]-e[1])*n)]}))}},{key:"fromSnapshotCoordinates",value:function(t){var e=this.map.getView().calculateExtent(this.map.getSize()),i=this.snapshot.height,n=this.map.getView().getResolution()/this.getHighDpiScaling();return t.map((function(t){return[Math.round(t[0]*n+e[0]),Math.round((i-t[1])*n+e[1])]}))}},{key:"fromMagicWandCoordinates",value:function(t){return t.map((function(t){return[t.x,t.y]}))}},{key:"handleUpEvent",value:function(){return this.currentThreshold=this.colorThreshold,this.isShowingCross?this.sketchSource.removeFeature(this.sketchFeature):this.dispatchEvent({type:"drawend",feature:this.sketchFeature}),this.sketchFeature=null,this.indicatorSource.clear(),this.isShowingPoint=!1,this.isShowingCross=!1,!1}},{key:"handleDownEvent",value:function(t){return this.downPoint[0]=Math.round(t.coordinate[0]),this.downPoint[1]=Math.round(t.coordinate[1]),this.drawSketch(),this.indicatorPoint.getGeometry().setCoordinates(this.downPoint),this.indicatorCross.getGeometry().setCoordinates(this.downPoint),this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorCross),this.isShowingCross=!0,this.isShowingPoint=!1,!0}},{key:"handleDragEvent",value:function(t){var e=this.toSnapshotCoordinates([t.coordinate]).shift(),i=Math.round(e[0]),n=Math.round(e[1]),r=this.toSnapshotCoordinates([this.downPoint]).shift(),o=r[0],s=r[1];if(i!==o||n!==s){var a=i-o,l=n-s,u=Math.sqrt(a*a+l*l);u<=this.discardRadius&&!t.originalEvent.shiftKey?this.isShowingCross||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorCross),this.isShowingCross=!0,this.isShowingPoint=!1):this.isShowingPoint||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorPoint),this.isShowingCross=!1,this.isShowingPoint=!0);var h=Math.min(Math.max(this.colorThreshold+Math.round(u/2-this.colorThreshold),1),255);h!=this.currentThreshold&&(this.currentThreshold=h,this.drawSketch())}}},{key:"handleMoveEvent",value:function(t){this.isShowingPoint||(this.indicatorSource.clear(),this.indicatorSource.addFeature(this.indicatorPoint),this.isShowingPoint=!0,this.isShowingCross=!1),this.indicatorPoint.getGeometry().setCoordinates(t.coordinate)}},{key:"toggleActive",value:function(){this.getActive()?(this.map.on(["moveend","change:size"],this.updateSnapshot.bind(this)),this.updateSnapshot()):(this.map.un(["moveend","change:size"],this.updateSnapshot.bind(this)),this.indicatorSource.clear(),this.isShowingPoint=!1,this.isShowingCross=!1,this.sketchFeature&&(this.sketchSource.removeFeature(this.sketchFeature),this.sketchFeature=null))}},{key:"updateSnapshot",value:function(){!this.updatingSnapshot&&this.layer&&(this.layer.once("postcompose",this.updateSnapshotCanvas.bind(this)),this.updatingSnapshot=!0,this.map.renderSync(),this.updatingSnapshot=!1)}},{key:"updateSnapshotCanvas",value:function(t){this.snapshotCanvas.width=t.context.canvas.width,this.snapshotCanvas.height=t.context.canvas.height,this.snapshotContext.drawImage(t.context.canvas,0,0),this.snapshot=this.snapshotContext.getImageData(0,0,this.snapshotCanvas.width,this.snapshotCanvas.height),this.snapshot.bytes=4}},{key:"setLayer",value:function(t){this.layer=t}},{key:"drawSketch",value:function(){var t=this.toSnapshotCoordinates([this.downPoint]).shift(),e=$_().floodFill(this.snapshot,t[0],t[1],this.currentThreshold);this.blurRadius>0&&(e=$_().gaussBlurOnlyBorder(e,this.blurRadius));for(var i=e.data,n=this.snapshot.data,r=i.length-1;r>=0;r--)0===n[4*r]&&(i[r]=0);var o=$_().traceContours(e).filter((function(t){return!t.innner})).shift();if(o){this.simplifyTolerant>0&&(o=$_().simplifyContours([o],this.simplifyTolerant,this.simplifyCount).shift());var s=this.fromSnapshotCoordinates(this.fromMagicWandCoordinates(o.points));this.sketchFeature?this.sketchFeature.getGeometry().setCoordinates([s]):(this.sketchFeature=new Nm(new Lg([s])),this.sketchStyle&&this.sketchFeature.setStyle(this.sketchStyle),this.sketchSource.addFeature(this.sketchFeature))}}}])&&N_(e.prototype,i),n&&N_(e,n),o}(tm);var q_;const W_=Ml({computed:{crossOrigin:function(){return this.image&&this.image.crossOrigin},isMagicWanding:function(){return"magicWand"===this.interactionMode&&!this.crossOrigin}},methods:{toggleMagicWand:function(){this.isMagicWanding?this.resetInteractionMode():q_&&(this.interactionMode="magicWand")},maybeUpdateMagicWandSnapshot:function(t){t&&!t.tiled&&this.isMagicWanding&&q_.updateSnapshot()},maybeSetMagicWandLayer:function(t,e){t&&!this.crossOrigin&&(!0===t.tiled?e&&!0===e.tiled||q_.setLayer(this.tiledImageLayer):e&&!0!==e.tiled||q_.setLayer(this.imageLayer))},toggleMagicWandInteraction:function(t){t?this.hasSelectedLabel?q_.setActive(!0):this.requireSelectedLabel():q_.setActive(!1)}},created:function(){this.canAdd&&(xu.on("Shift+g",this.toggleMagicWand,0,this.listenerSet),this.$watch("image",this.maybeUpdateMagicWandSnapshot),this.$watch("image",this.maybeSetMagicWandLayer),this.$watch("isMagicWanding",this.toggleMagicWandInteraction))},mounted:function(){this.canAdd&&((q_=new z_({map:this.map,source:this.annotationSource,style:A_.editing,indicatorPointStyle:A_.editing,indicatorCrossStyle:A_.cross,simplifyTolerant:.1})).on("drawend",this.handleNewFeature),q_.setActive(!1),this.map.addInteraction(q_))}},undefined,undefined,!1,null,null,null).exports,K_="pointermove",X_="pointerdown",Y_="pointerup",H_="pointerover",Z_="pointerout",J_="pointerenter",Q_="pointerleave",tb="pointercancel";var eb=["","unavailable","touch","pen","mouse"];function ib(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)}function nb(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)}function rb(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)}function ob(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)}function sb(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)}function ab(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)}function lb(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)}function ub(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)}const hb=function(t){function e(e){var i={MSPointerDown:ib,MSPointerMove:nb,MSPointerUp:rb,MSPointerOut:ob,MSPointerOver:sb,MSPointerCancel:ab,MSGotPointerCapture:ub,MSLostPointerCapture:lb};t.call(this,e,i),this.pointerMap=e.pointerMap}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=eb[t.pointerType]),e},e.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},e}(xv);function cb(t){this.dispatcher.fireNativeEvent(t)}function db(t){this.dispatcher.fireNativeEvent(t)}function fb(t){this.dispatcher.fireNativeEvent(t)}function pb(t){this.dispatcher.fireNativeEvent(t)}function gb(t){this.dispatcher.fireNativeEvent(t)}function mb(t){this.dispatcher.fireNativeEvent(t)}function vb(t){this.dispatcher.fireNativeEvent(t)}function yb(t){this.dispatcher.fireNativeEvent(t)}const _b=function(t){function e(e){var i={pointerdown:cb,pointermove:db,pointerup:fb,pointerout:pb,pointerover:gb,pointercancel:mb,gotpointercapture:yb,lostpointercapture:vb};t.call(this,e,i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(xv);var bb=!1,wb=function(t){function e(e,i,n){t.call(this,e),this.originalEvent=i;var r=n||{};this.buttons=function(t){var e;if(t.buttons||bb)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e}(r),this.pressure=function(t,e){var i=0;i=t.pressure?t.pressure:e?.5:0;return i}(r,this.buttons),this.bubbles="bubbles"in r&&r.bubbles,this.cancelable="cancelable"in r&&r.cancelable,this.view="view"in r?r.view:null,this.detail="detail"in r?r.detail:null,this.screenX="screenX"in r?r.screenX:0,this.screenY="screenY"in r?r.screenY:0,this.clientX="clientX"in r?r.clientX:0,this.clientY="clientY"in r?r.clientY:0,this.ctrlKey="ctrlKey"in r&&r.ctrlKey,this.altKey="altKey"in r&&r.altKey,this.shiftKey="shiftKey"in r&&r.shiftKey,this.metaKey="metaKey"in r&&r.metaKey,this.button="button"in r?r.button:0,this.relatedTarget="relatedTarget"in r?r.relatedTarget:null,this.pointerId="pointerId"in r?r.pointerId:0,this.width="width"in r?r.width:0,this.height="height"in r?r.height:0,this.tiltX="tiltX"in r?r.tiltX:0,this.tiltY="tiltY"in r?r.tiltY:0,this.pointerType="pointerType"in r?r.pointerType:"",this.hwTimestamp="hwTimestamp"in r?r.hwTimestamp:0,this.isPrimary="isPrimary"in r&&r.isPrimary,i.preventDefault&&(this.preventDefault=function(){i.preventDefault()})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);!function(){try{var t=new MouseEvent("click",{buttons:1});bb=1===t.buttons}catch(t){}}();const xb=wb;function Sb(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)}function Cb(t){this.processTouches_(t,this.moveOverOut_)}function Eb(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)}function Tb(t){this.processTouches_(t,this.cancelOut_)}const Ib=function(t){function e(e,i){var n={touchstart:Sb,touchmove:Cb,touchend:Eb,touchcancel:Tb};t.call(this,e,n),this.pointerMap=e.pointerMap,this.mouseSource=i,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_,this.dedupTimeout_=2500}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},e.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&1..toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},e.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},e.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),200)},e.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},e.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},e.prototype.touchToPointer_=function(t,e){var i=this.dispatcher.cloneEvent(t,e);return i.pointerId=e.identifier+2,i.bubbles=!0,i.cancelable=!0,i.detail=this.clickCount_,i.button=0,i.buttons=1,i.width=e.radiusX||0,i.height=e.radiusY||0,i.pressure=e.force||.5,i.isPrimary=this.isPrimaryTouch_(e),i.pointerType="touch",i.clientX=e.clientX,i.clientY=e.clientY,i.screenX=e.screenX,i.screenY=e.screenY,i},e.prototype.processTouches_=function(t,e){var i=Array.prototype.slice.call(t.changedTouches),n=i.length;function r(){t.preventDefault()}for(var o=0;o<n;++o){var s=this.touchToPointer_(t,i[o]);s.preventDefault=r,e.call(this,t,s)}},e.prototype.findTouch_=function(t,e){for(var i=t.length,n=0;n<i;n++){if(t[n].identifier===e)return!0}return!1},e.prototype.vacuumTouches_=function(t){var e=t.touches,i=Object.keys(this.pointerMap),n=i.length;if(n>=e.length){for(var r=[],o=0;o<n;++o){var s=Number(i[o]),a=this.pointerMap[s];1==s||this.findTouch_(e,s-2)||r.push(a.out)}for(var l=0;l<r.length;++l)this.cancelOut_(t,r[l])}},e.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},e.prototype.moveOverOut_=function(t,e){var i=e,n=this.pointerMap[i.pointerId];if(n){var r=n.out,o=n.outTarget;this.dispatcher.move(i,t),r&&o!==i.target&&(r.relatedTarget=i.target,i.relatedTarget=o,r.target=o,i.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(i,t)):(i.target=o,i.relatedTarget=null,this.cancelOut_(t,i))),n.out=i,n.outTarget=i.target}},e.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},e.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},e.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch_(i)){var n=[i.clientX,i.clientY];e.push(n),setTimeout((function(){var t,i,r;i=n,r=(t=e).indexOf(i),r>-1&&t.splice(r,1)}),this.dedupTimeout_)}},e}(xv);var Ab=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];const kb=function(t){function e(e){t.call(this),this.element_=e,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.registerSources=function(){if(rv)this.registerSource("native",new _b(this));else if(ov)this.registerSource("ms",new hb(this));else{var t=new Pv(this);this.registerSource("mouse",t),nv&&this.registerSource("touch",new Ib(this,t))}this.register_()},e.prototype.registerSource=function(t,e){var i=e,n=i.getEvents();n&&(n.forEach(function(t){var e=i.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(i))}.bind(this)),this.eventSourceList_.push(i))},e.prototype.register_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.addEvents_(i.getEvents())}},e.prototype.unregister_=function(){for(var t=this.eventSourceList_.length,e=0;e<t;e++){var i=this.eventSourceList_[e];this.removeEvents_(i.getEvents())}},e.prototype.eventHandler_=function(t){var e=t.type,i=this.eventMap_[e];i&&i(t)},e.prototype.addEvents_=function(t){t.forEach(function(t){Ac(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.removeEvents_=function(t){t.forEach(function(t){Pc(this.element_,t,this.eventHandler_,this)}.bind(this))},e.prototype.cloneEvent=function(t,e){for(var i={},n=0,r=Ab.length;n<r;n++){var o=Ab[n][0];i[o]=t[o]||e[o]||Ab[n][1]}return i},e.prototype.down=function(t,e){this.fireEvent(X_,t,e)},e.prototype.move=function(t,e){this.fireEvent(K_,t,e)},e.prototype.up=function(t,e){this.fireEvent(Y_,t,e)},e.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(J_,t,e)},e.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(Q_,t,e)},e.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(H_,t,e)},e.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(Z_,t,e)},e.prototype.cancel=function(t,e){this.fireEvent(tb,t,e)},e.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},e.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},e.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},e.prototype.makeEvent=function(t,e,i){return new xb(t,i,e)},e.prototype.fireEvent=function(t,e,i){var n=this.makeEvent(t,e,i);this.dispatchEvent(n)},e.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},e.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,kv(e,this),e)},e.prototype.disposeInternal=function(){this.unregister_(),t.prototype.disposeInternal.call(this)},e}(Bc);const Pb=function(t){function e(e,i){t.call(this),this.map_=e,this.clickTimeoutId_,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=i?i*ev:ev,this.down_=null;var n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new kb(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=Ac(this.pointerEventHandler_,X_,this.handlePointerDown_,this),this.relayedListenerKey_=Ac(this.pointerEventHandler_,K_,this.relayEvent_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.emulateClick_=function(t){var e=new Gm(Gg.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Gm(Gg.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Gm(Gg.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==Gg.POINTERUP||e.type==Gg.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==Gg.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Gm(Gg.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(Lc),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new Gm(Gg.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new kb(document),this.dragListenerKeys_.push(Ac(this.documentPointerEventHandler_,Gg.POINTERMOVE,this.handlePointerMove_,this),Ac(this.documentPointerEventHandler_,Gg.POINTERUP,this.handlePointerUp_,this),Ac(this.pointerEventHandler_,Gg.POINTERCANCEL,this.handlePointerUp_,this)))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Gm(Gg.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},e.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Gm(t.type,this.map_,t,e))},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Lc(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(Lc(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Lc),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),t.prototype.disposeInternal.call(this)},e}(Bc),Lb="layergroup",Rb="size",Fb="target",Mb="view",Ob=0,Db=1,$b=2,jb=3,Nb=4,Bb=5;var Ub=1/0,Gb=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};Gb.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,wc(this.queuedElements_)},Gb.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},Gb.prototype.enqueue=function(t){Ad(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=Ub&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},Gb.prototype.getCount=function(){return this.elements_.length},Gb.prototype.getLeftChildIndex_=function(t){return 2*t+1},Gb.prototype.getRightChildIndex_=function(t){return 2*t+2},Gb.prototype.getParentIndex_=function(t){return t-1>>1},Gb.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},Gb.prototype.isEmpty=function(){return 0===this.elements_.length},Gb.prototype.isKeyQueued=function(t){return t in this.queuedElements_},Gb.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},Gb.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],s=t;t<n>>1;){var a=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<n&&i[l]<i[a]?l:a;e[t]=e[u],i[t]=i[u],t=u}e[t]=r,i[t]=o,this.siftDown_(s,t)},Gb.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],o=n[e];e>t;){var s=this.getParentIndex_(e);if(!(n[s]>o))break;i[e]=i[s],n[e]=n[s],e=s}i[e]=r,n[e]=o},Gb.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,o=this.priorities_,s=0,a=r.length;for(e=0;e<a;++e)(i=n(t=r[e]))==Ub?delete this.queuedElements_[this.keyFunction_(t)]:(o[s]=i,r[s++]=t);r.length=s,o.length=s,this.heapify_()};const Vb=function(t){function e(e,i){t.call(this,(function(t){return e.apply(null,t)}),(function(t){return t[0].getKey()})),this.tileChangeCallback_=i,this.tilesLoading_=0,this.tilesLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.enqueue=function(e){var i=t.prototype.enqueue.call(this,e);i&&Ac(e[0],Uc,this.handleTileChange,this);return i},e.prototype.getTilesLoading=function(){return this.tilesLoading_},e.prototype.handleTileChange=function(t){var e=t.target,i=e.getState();if(i===$b||i===jb||i===Nb||i===Bb){Pc(e,Uc,this.handleTileChange,this);var n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},e.prototype.loadMoreTiles=function(t,e){for(var i,n,r,o=0,s=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),(i=n.getState())===Bb?s=!0:i!==Ob||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,n.load());0===o&&s&&this.tileChangeCallback_()},e}(Gb);var zb=256;function qb(t){return t}function Wb(t,e){return void 0!==t?0:void 0}function Kb(t,e){return void 0!==t?t+e:void 0}const Xb=0,Yb=1,Hb="center",Zb="resolution",Jb="rotation";function Qb(t,e){setTimeout((function(){t(e)}),0)}function tw(t){return!(t.sourceCenter&&t.targetCenter&&!qm(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}const ew=function(t){function e(e){t.call(this);var i=bc({},e);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=Mp(i.projection,"EPSG:3857"),this.applyOptions_(i)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.applyOptions_=function(t){var e={};e[Hb]=void 0!==t.center?t.center:null;var i=function(t){var e,i,n,r=28,o=2,s=void 0!==t.minZoom?t.minZoom:0,a=void 0!==t.maxZoom?t.maxZoom:r,l=void 0!==t.zoomFactor?t.zoomFactor:o;if(void 0!==t.resolutions){var u=t.resolutions;i=u[s],n=void 0!==u[a]?u[a]:u[u.length-1],e=function(t){return function(e,i,n){if(void 0!==e){var r=Pf(t,e,n);r=Hf(r+i,0,t.length-1);var o=Math.floor(r);if(r!=o&&o<t.length-1){var s=t[o]/t[o+1];return t[o]/Math.pow(s,r-o)}return t[o]}}}(u)}else{var h=Mp(t.projection,"EPSG:3857"),c=h.getExtent(),d=(c?Math.max(mf(c),df(c)):360*sp[ap.DEGREES]/h.getMetersPerUnit())/zb/Math.pow(o,0),f=d/Math.pow(o,r-0);void 0!==(i=t.maxResolution)?s=0:i=d/Math.pow(l,s),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(l,a):d/Math.pow(l,a):f),a=s+Math.floor(Math.log(i/n)/Math.log(l)),n=i/Math.pow(l,a-s),e=function(t,e,i){return function(n,r,o){if(void 0!==n){var s=-o/2+.5,a=Math.floor(Math.log(e/n)/Math.log(t)+s),l=Math.max(a+r,0);return void 0!==i&&(l=Math.min(l,i)),e/Math.pow(t,l)}}}(l,i,a-s)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:l}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=i.minZoom;var n=function(t){return void 0!==t.extent?(e=t.extent,function(t){return t?[Hf(t[0],e[0],e[2]),Hf(t[1],e[1],e[3])]:void 0}):qb;var e}(t),r=i.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(o=r||tp(5),function(t,e){return void 0!==t?Math.abs(t+e)<=o?0:t+e:void 0}):!1===e?Kb:"number"==typeof e?(i=e,n=2*Math.PI/i,function(t,e){return void 0!==t?t=Math.floor((t+e)/n+.5)*n:void 0}):Kb}return Wb;var i,n;var r,o}(t);this.constraints_={center:n,resolution:r,rotation:o},void 0!==t.resolution?e[Zb]=t.resolution:void 0!==t.zoom&&(e[Zb]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_),this.resolutions_&&(e[Zb]=Hf(Number(this.getResolution()||e[Zb]),this.minResolution_,this.maxResolution_))),e[Jb]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},e.prototype.getUpdatedOptions_=function(t){var e=bc({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),bc({},e,t)},e.prototype.animate=function(t){var e,i=arguments,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var r=arguments[n-1];return r.center&&this.setCenter(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(e&&Qb(e,!0))}for(var o=Date.now(),s=this.getCenter().slice(),a=this.getResolution(),l=this.getRotation(),u=[],h=0;h<n;++h){var c=i[h],d={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||qg};if(c.center&&(d.sourceCenter=s,d.targetCenter=c.center,s=d.targetCenter),void 0!==c.zoom?(d.sourceResolution=a,d.targetResolution=this.constrainResolution(this.maxResolution_,c.zoom-this.minZoom_,0),a=d.targetResolution):c.resolution&&(d.sourceResolution=a,d.targetResolution=c.resolution,a=d.targetResolution),void 0!==c.rotation){d.sourceRotation=l;var f=ep(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+f,l=d.targetRotation}d.callback=e,tw(d)?d.complete=!0:o+=d.duration,u.push(d)}this.animations_.push(u),this.setHint(Xb,1),this.updateAnimations_()},e.prototype.getAnimating=function(){return this.hints_[Xb]>0},e.prototype.getInteracting=function(){return this.hints_[Yb]>0},e.prototype.cancelAnimations=function(){this.setHint(Xb,-this.hints_[Xb]);for(var t=0,e=this.animations_.length;t<e;++t){var i=this.animations_[t];i[0].callback&&Qb(i[0].callback,!1)}this.animations_.length=0},e.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,i=this.animations_.length-1;i>=0;--i){for(var n=this.animations_[i],r=!0,o=0,s=n.length;o<s;++o){var a=n[o];if(!a.complete){var l=t-a.start,u=a.duration>0?l/a.duration:1;u>=1?(a.complete=!0,u=1):r=!1;var h=a.easing(u);if(a.sourceCenter){var c=a.sourceCenter[0],d=a.sourceCenter[1],f=c+h*(a.targetCenter[0]-c),p=d+h*(a.targetCenter[1]-d);this.set(Hb,[f,p])}if(a.sourceResolution&&a.targetResolution){var g=1===h?a.targetResolution:a.sourceResolution+h*(a.targetResolution-a.sourceResolution);a.anchor&&this.set(Hb,this.calculateCenterZoom(g,a.anchor)),this.set(Zb,g)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var m=1===h?ep(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+h*(a.targetRotation-a.sourceRotation);a.anchor&&this.set(Hb,this.calculateCenterRotate(m,a.anchor)),this.set(Jb,m)}if(e=!0,!a.complete)break}}if(r){this.animations_[i]=null,this.setHint(Xb,-1);var v=n[0].callback;v&&Qb(v,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},e.prototype.calculateCenterRotate=function(t,e){var i,n=this.getCenter();return void 0!==n&&(Wm(i=[n[0]-e[0],n[1]-e[1]],t-this.getRotation()),Vm(i,e)),i},e.prototype.calculateCenterZoom=function(t,e){var i,n=this.getCenter(),r=this.getResolution();void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]);return i},e.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+vc(this)+'"]',i=document.querySelector(e);if(i){var n=getComputedStyle(i);t[0]=parseInt(n.width,10),t[1]=parseInt(n.height,10)}return t},e.prototype.constrainCenter=function(t){return this.constraints_.center(t)},e.prototype.constrainResolution=function(t,e,i){var n=e||0,r=i||0;return this.constraints_.resolution(t,n,r)},e.prototype.constrainRotation=function(t,e){var i=e||0;return this.constraints_.rotation(t,i)},e.prototype.getCenter=function(){return this.get(Hb)},e.prototype.getConstraints=function(){return this.constraints_},e.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},e.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),i=this.getCenter();Ad(i,1);var n=this.getResolution();Ad(void 0!==n,2);var r=this.getRotation();return Ad(void 0!==r,3),cf(i,n,r,e)},e.prototype.getMaxResolution=function(){return this.maxResolution_},e.prototype.getMinResolution=function(){return this.minResolution_},e.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},e.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},e.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},e.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},e.prototype.getProjection=function(){return this.projection_},e.prototype.getResolution=function(){return this.get(Zb)},e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.getResolutionForExtent=function(t,e){var i=e||this.getSizeFromViewport_(),n=mf(t)/i[0],r=df(t)/i[1];return Math.max(n,r)},e.prototype.getResolutionForValueFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*r)}},e.prototype.getRotation=function(){return this.get(Jb)},e.prototype.getValueForResolutionFunction=function(t){var e=t||2,i=this.maxResolution_,n=this.minResolution_,r=Math.log(i/n)/Math.log(e);return function(t){return Math.log(i/t)/Math.log(e)/r}},e.prototype.getState=function(t){var e=this.getCenter(),i=this.getProjection(),n=this.getResolution(),r=n/t,o=this.getRotation();return{center:[Math.round(e[0]/r)*r,Math.round(e[1]/r)*r],projection:void 0!==i?i:null,resolution:n,rotation:o,zoom:this.getZoom()}},e.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},e.prototype.getZoomForResolution=function(t){var e,i,n=this.minZoom_||0;if(this.resolutions_){var r=Pf(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)},e.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},e.prototype.fit=function(t,e){var i,n=e||{},r=n.size;r||(r=this.getSizeFromViewport_()),Ad(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)?(Ad(!yf(t),25),i=Rg(t)):t.getType()===Wf?(i=Rg(t=t.getExtent())).rotate(this.getRotation(),uf(t)):i=t;var o,s=void 0!==n.padding?n.padding:[0,0,0,0],a=void 0===n.constrainResolution||n.constrainResolution,l=void 0!==n.nearest&&n.nearest;o=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.constrainResolution(this.maxResolution_,n.maxZoom-this.minZoom_,0):0;for(var u=i.getFlatCoordinates(),h=this.getRotation(),c=Math.cos(-h),d=Math.sin(-h),f=1/0,p=1/0,g=-1/0,m=-1/0,v=i.getStride(),y=0,_=u.length;y<_;y+=v){var b=u[y]*c-u[y+1]*d,w=u[y]*d+u[y+1]*c;f=Math.min(f,b),p=Math.min(p,w),g=Math.max(g,b),m=Math.max(m,w)}var x=this.getResolutionForExtent([f,p,g,m],[r[0]-s[1]-s[3],r[1]-s[0]-s[2]]);if(x=isNaN(x)?o:Math.max(x,o),a){var S=this.constrainResolution(x,0,0);!l&&S<x&&(S=this.constrainResolution(S,-1,0)),x=S}d=-d;var C=(f+g)/2,E=(p+m)/2,T=[(C+=(s[1]-s[3])/2*x)*c-(E+=(s[0]-s[2])/2*x)*d,E*c+C*d],I=n.callback?n.callback:Dc;void 0!==n.duration?this.animate({resolution:x,center:T,duration:n.duration,easing:n.easing},I):(this.setResolution(x),this.setCenter(T),Qb(I,!0))},e.prototype.centerOn=function(t,e,i){var n=this.getRotation(),r=Math.cos(-n),o=Math.sin(-n),s=t[0]*r-t[1]*o,a=t[1]*r+t[0]*o,l=this.getResolution(),u=(s+=(e[0]/2-i[0])*l)*r-(a+=(i[1]-e[1]/2)*l)*(o=-o),h=a*r+s*o;this.setCenter([u,h])},e.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},e.prototype.rotate=function(t,e){if(void 0!==e){var i=this.calculateCenterRotate(t,e);this.setCenter(i)}this.setRotation(t)},e.prototype.setCenter=function(t){this.set(Hb,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},e.prototype.setResolution=function(t){this.set(Zb,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setRotation=function(t){this.set(Jb,t),this.getAnimating()&&this.cancelAnimations()},e.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},e}(sd);var iw="layers";const nw=function(t){function e(e){var i=e||{},n=bc({},i);delete n.layers;var r=i.layers;t.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},Ac(this,od(iw),this.handleLayersChanged_,this),r?Array.isArray(r)?r=new $m(r.slice(),{unique:!0}):Ad("function"==typeof r.getArray,43):r=new $m(void 0,{unique:!0}),this.setLayers(r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleLayerChange_=function(){this.changed()},e.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(Lc),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(Ac(t,Fm,this.handleLayersAdd_,this),Ac(t,Mm,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(Lc);wc(this.listenerKeys_);for(var i=t.getArray(),n=0,r=i.length;n<r;n++){var o=i[n];this.listenerKeys_[vc(o)]=[Ac(o,_c,this.handleLayerChange_,this),Ac(o,Uc,this.handleLayerChange_,this)]}this.changed()},e.prototype.handleLayersAdd_=function(t){var e=t.element;this.listenerKeys_[vc(e)]=[Ac(e,_c,this.handleLayerChange_,this),Ac(e,Uc,this.handleLayerChange_,this)],this.changed()},e.prototype.handleLayersRemove_=function(t){var e=vc(t.element);this.listenerKeys_[e].forEach(Lc),delete this.listenerKeys_[e],this.changed()},e.prototype.getLayers=function(){return this.get(iw)},e.prototype.setLayers=function(t){this.set(iw,t)},e.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e},e.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));for(var n=this.getLayerState(),r=i,o=e.length;r<o;r++){var s=e[r];s.opacity*=n.opacity,s.visible=s.visible&&n.visible,s.maxResolution=Math.min(s.maxResolution,n.maxResolution),s.minResolution=Math.max(s.minResolution,n.minResolution),void 0!==n.extent&&(void 0!==s.extent?s.extent=ff(s.extent,n.extent):s.extent=n.extent)}return e},e.prototype.getSourceState=function(){return Sm},e}(Gv);function rw(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)}const ow=function(t){function e(e){t.call(this);var i=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,n,r,o={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new nw({layers:t.layers});o[Lb]=s,o[Fb]=t.target,o[Mb]=void 0!==t.view?t.view:new ew,void 0!==t.controls&&(Array.isArray(t.controls)?i=new $m(t.controls.slice()):(Ad("function"==typeof t.controls.getArray,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?n=new $m(t.interactions.slice()):(Ad("function"==typeof t.interactions.getArray,48),n=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?r=new $m(t.overlays.slice()):(Ad("function"==typeof t.overlays.getArray,49),r=t.overlays):r=new $m;return{controls:i,interactions:n,keyboardEventTarget:e,overlays:r,values:o}}(e);this.maxTilesLoading_=void 0!==e.maxTilesLoading?e.maxTilesLoading:16,this.loadTilesWhileAnimating_=void 0!==e.loadTilesWhileAnimating&&e.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==e.loadTilesWhileInteracting&&e.loadTilesWhileInteracting,this.pixelRatio_=void 0!==e.pixelRatio?e.pixelRatio:ev,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+(nv?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var n=[zc,qc,Hc,td,Jc,Gg.POINTERDOWN,Zc,ed],r=0,o=n.length;r<o;++r)Ac(this.overlayContainerStopEvent_,n[r],jc);for(var s in this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new Pb(this,e.moveTolerance),Gg)Ac(this.mapBrowserEventHandler_,Gg[s],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=i.keyboardEventTarget,this.keyHandlerKeys_=null,Ac(this.viewport_,Vc,this.handleBrowserEvent,this),Ac(this.viewport_,ed,this.handleBrowserEvent,this),Ac(this.viewport_,Zc,this.handleBrowserEvent,this),this.controls=i.controls||new $m,this.interactions=i.interactions||new $m,this.overlays_=i.overlays,this.overlayIdIndex_={},this.renderer_=this.createRenderer(),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new Vb(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},Ac(this,od(Lb),this.handleLayerGroupChanged_,this),Ac(this,od(Mb),this.handleViewChanged_,this),Ac(this,od(Rb),this.handleSizeChanged_,this),Ac(this,od(Fb),this.handleTargetChanged_,this),this.setProperties(i.values),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),Ac(this.controls,Fm,(function(t){t.element.setMap(this)}),this),Ac(this.controls,Mm,(function(t){t.element.setMap(null)}),this),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),Ac(this.interactions,Fm,(function(t){t.element.setMap(this)}),this),Ac(this.interactions,Mm,(function(t){t.element.setMap(null)}),this),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),Ac(this.overlays_,Fm,(function(t){this.addOverlayInternal_(t.element)}),this),Ac(this.overlays_,Mm,(function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}),this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},e.prototype.addControl=function(t){this.getControls().push(t)},e.prototype.addInteraction=function(t){this.getInteractions().push(t)},e.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},e.prototype.addOverlay=function(t){this.getOverlays().push(t)},e.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},e.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),Pc(this.viewport_,Vc,this.handleBrowserEvent,this),Pc(this.viewport_,ed,this.handleBrowserEvent,this),Pc(this.viewport_,Zc,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(removeEventListener(Qc,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),t.prototype.disposeInternal.call(this)},e.prototype.forEachFeatureAtPixel=function(t,e,i){if(this.frameState_){var n=this.getCoordinateFromPixel(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==i.layerFilter?i.layerFilter:Mc;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,e,null,o,null)}},e.prototype.getFeaturesAtPixel=function(t,e){var i=null;return this.forEachFeatureAtPixel(t,(function(t){i||(i=[]),i.push(t)}),e),i},e.prototype.forEachLayerAtPixel=function(t,e,i){if(this.frameState_){var n=i||{},r=void 0!==n.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=n.layerFilter||Mc;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,null,o,null)}},e.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var i=this.getCoordinateFromPixel(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:Mc,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,n,null)},e.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},e.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]},e.prototype.getTarget=function(){return this.get(Fb)},e.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},e.prototype.getCoordinateFromPixel=function(t){var e=this.frameState_;return e?zp(e.pixelToCoordinateTransform,t.slice()):null},e.prototype.getControls=function(){return this.controls},e.prototype.getOverlays=function(){return this.overlays_},e.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},e.prototype.getInteractions=function(){return this.interactions},e.prototype.getLayerGroup=function(){return this.get(Lb)},e.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},e.prototype.getPixelFromCoordinate=function(t){var e=this.frameState_;return e?zp(e.coordinateToPixelTransform,t.slice(0,2)):null},e.prototype.getRenderer=function(){return this.renderer_},e.prototype.getSize=function(){return this.get(Rb)},e.prototype.getView=function(){return this.get(Mb)},e.prototype.getViewport=function(){return this.viewport_},e.prototype.getOverlayContainer=function(){return this.overlayContainer_},e.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},e.prototype.getTilePriority=function(t,e,i,n){var r=this.frameState_;if(!r||!(e in r.wantedTiles))return Ub;if(!r.wantedTiles[e][t.getKey()])return Ub;var o=i[0]-r.focus[0],s=i[1]-r.focus[1];return 65536*Math.log(n)+Math.sqrt(o*o+s*s)/n},e.prototype.handleBrowserEvent=function(t,e){var i=e||t.type,n=new Um(i,this,t);this.handleMapBrowserEvent(n)},e.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){this.focus_=t.coordinate,t.frameState=this.frameState_;var e=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.getActive())if(!n.handleEvent(t))break}}},e.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var i=this.maxTilesLoading_,n=i;if(t){var r=t.viewHints;r[Xb]&&(i=this.loadTilesWhileAnimating_?8:0,n=2),r[Yb]&&(i=this.loadTilesWhileInteracting_?8:0,n=2)}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}!t||!this.hasListener(Wv)||t.animate||this.tileQueue_.getTilesLoading()||sw(this.getLayers().getArray())||this.renderer_.dispatchRenderEvent(Wv,t);for(var o=this.postRenderFunctions_,s=0,a=o.length;s<a;++s)o[s](this,t);o.length=0},e.prototype.handleSizeChanged_=function(){this.render()},e.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,i=this.keyHandlerKeys_.length;e<i;++e)Lc(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_);var n=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[Ac(n,Kc,this.handleBrowserEvent,this),Ac(n,Xc,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),addEventListener(Qc,this.handleResize_,!1))}else this.renderer_.removeLayerRenderers(),Ed(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(Qc,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},e.prototype.handleTileChange_=function(){this.render()},e.prototype.handleViewPropertyChanged_=function(){this.render()},e.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Lc(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Lc(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",vc(t)),this.viewPropertyListenerKey_=Ac(t,_c,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Ac(t,Uc,this.handleViewPropertyChanged_,this)),this.render()},e.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Lc),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[Ac(t,_c,this.render,this),Ac(t,Uc,this.render,this)]),this.render()},e.prototype.isRendered=function(){return!!this.frameState_},e.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},e.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},e.prototype.removeControl=function(t){return this.getControls().remove(t)},e.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},e.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},e.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},e.prototype.renderFrame_=function(t){var e,i=this.getSize(),n=this.getView(),r=[1/0,1/0,-1/0,-1/0],o=this.frameState_,s=null;if(void 0!==i&&function(t){return t[0]>0&&t[1]>0}(i)&&n&&n.isDef()){for(var a=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),l=this.getLayerGroup().getLayerStatesArray(),u={},h=0,c=l.length;h<c;++h)u[vc(l[h].layer)]=l[h];e=n.getState(this.pixelRatio_),s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:r,focus:this.focus_?this.focus_:e.center,index:this.frameIndex_++,layerStates:u,layerStatesArray:l,pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:e,viewHints:a,wantedTiles:{}}}if(s&&(s.extent=cf(e.center,e.resolution,e.rotation,s.size,r)),this.frameState_=s,this.renderer_.renderFrame(s),s){if(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),o)(!this.previousExtent_||!yf(this.previousExtent_)&&!Jd(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Bm(fc,this,o)),this.previousExtent_=Yd(this.previousExtent_));this.previousExtent_&&!s.viewHints[Xb]&&!s.viewHints[Yb]&&!Jd(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Bm(pc,this,s)),Ud(s.extent,this.previousExtent_))}this.dispatchEvent(new Bm(dc,this,s)),setTimeout(this.handlePostRender.bind(this),0)},e.prototype.setLayerGroup=function(t){this.set(Lb,t)},e.prototype.setSize=function(t){this.set(Rb,t)},e.prototype.setTarget=function(t){this.set(Fb,t)},e.prototype.setView=function(t){this.set(Mb,t)},e.prototype.skipFeature=function(t){this.skippedFeatureUids_[vc(t)]=!0,this.render()},e.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},e.prototype.unskipFeature=function(t){delete this.skippedFeatureUids_[vc(t)],this.render()},e}(sd);function sw(t){for(var e=0,i=t.length;e<i;++e){var n=t[e];if("function"==typeof n.getLayers)return sw(n.getLayers().getArray());var r=n.getSource();if(r&&r.loading)return!0}return!1}const aw=function(t){function e(e){t.call(this),this.element=e.element?e.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=e.render?e.render:Dc,e.target&&this.setTarget(e.target)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){Ed(this.element),t.prototype.disposeInternal.call(this)},e.prototype.getMap=function(){return this.map_},e.prototype.setMap=function(t){this.map_&&Ed(this.element);for(var e=0,i=this.listenerKeys.length;e<i;++e)Lc(this.listenerKeys[e]);(this.listenerKeys.length=0,this.map_=t,this.map_)&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Dc&&this.listenerKeys.push(Ac(t,dc,this.render,this)),t.render())},e.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t},e}(sd);function lw(t){this.updateElement_(t.frameState)}const uw=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||lw,target:i.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===i.collapsed||i.collapsed,this.overrideCollapsible_=void 0!==i.collapsible,this.collapsible_=void 0===i.collapsible||i.collapsible,this.collapsible_||(this.collapsed_=!1);var n=void 0!==i.className?i.className:"ol-attribution",r=void 0!==i.tipLabel?i.tipLabel:"Attributions",o=void 0!==i.collapseLabel?i.collapseLabel:"»";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o):this.collapseLabel_=o;var s=void 0!==i.label?i.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=r,l.appendChild(a),Ac(l,zc,this.handleClick_,this);var u=n+" "+"ol-unselectable "+yd+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=u,h.appendChild(this.ulElement_),h.appendChild(l),this.renderedAttributions_=[],this.renderedVisible_=!0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.collectSourceAttributions_=function(t){for(var e={},i=[],n=t.layerStatesArray,r=t.viewState.resolution,o=0,s=n.length;o<s;++o){var a=n[o];if(Kv(a,r)){var l=a.layer.getSource();if(l){var u=l.getAttributions();if(u){var h=u(t);if(h)if(this.overrideCollapsible_||!1!==l.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(h))for(var c=0,d=h.length;c<d;++c)h[c]in e||(i.push(h[c]),e[h[c]]=!0);else h in e||(i.push(h),e[h]=!0)}}}}return i},e.prototype.updateElement_=function(t){if(t){var e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Ff(e,this.renderedAttributions_)){Td(this.ulElement_);for(var n=0,r=e.length;n<r;++n){var o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},e.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},e.prototype.handleToggle_=function(){this.element.classList.toggle(_d),this.collapsed_?Cd(this.collapseLabel_,this.label_):Cd(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},e.prototype.getCollapsible=function(){return this.collapsible_},e.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},e.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},e.prototype.getCollapsed=function(){return this.collapsed_},e}(aw);function hw(t){var e=t.frameState;if(e){var i=e.viewState.rotation;if(i!=this.rotation_){var n="rotate("+i+"rad)";if(this.autoHide_){var r=this.element.classList.contains(md);r||0!==i?r&&0!==i&&this.element.classList.remove(md):this.element.classList.add(md)}this.label_.style.msTransform=n,this.label_.style.webkitTransform=n,this.label_.style.transform=n}this.rotation_=i}}const cw=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),render:i.render||hw,target:i.target});var n=void 0!==i.className?i.className:"ol-rotate",r=void 0!==i.label?i.label:"⇧";this.label_=null,"string"==typeof r?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=r):(this.label_=r,this.label_.classList.add("ol-compass"));var o=i.tipLabel?i.tipLabel:"Reset rotation",s=document.createElement("button");s.className=n+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),Ac(s,zc,this.handleClick_,this);var a=n+" "+"ol-unselectable "+yd,l=this.element;l.className=a,l.appendChild(s),this.callResetNorth_=i.resetNorth?i.resetNorth:void 0,this.duration_=void 0!==i.duration?i.duration:250,this.autoHide_=void 0===i.autoHide||i.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(md)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:zg}):t.setRotation(0))},e}(aw);const dw=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target});var n=void 0!==i.className?i.className:"ol-zoom",r=void 0!==i.delta?i.delta:1,o=void 0!==i.zoomInLabel?i.zoomInLabel:"+",s=void 0!==i.zoomOutLabel?i.zoomOutLabel:"−",a=void 0!==i.zoomInTipLabel?i.zoomInTipLabel:"Zoom in",l=void 0!==i.zoomOutTipLabel?i.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=n+"-in",u.setAttribute("type","button"),u.title=a,u.appendChild("string"==typeof o?document.createTextNode(o):o),Ac(u,zc,this.handleClick_.bind(this,r));var h=document.createElement("button");h.className=n+"-out",h.setAttribute("type","button"),h.title=l,h.appendChild("string"==typeof s?document.createTextNode(s):s),Ac(h,zc,this.handleClick_.bind(this,-r));var c=n+" "+"ol-unselectable "+yd,d=this.element;d.className=c,d.appendChild(u),d.appendChild(h),this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},e.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var i=e.getResolution();if(i){var n=e.constrainResolution(i,t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:n,duration:this.duration_,easing:zg})):e.setResolution(n)}}},e}(aw);var fw=function(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0};fw.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},fw.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},fw.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var i=e-3;i>0&&this.points_[i+2]>t;)i-=3;var n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;var r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_},fw.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},fw.prototype.getAngle=function(){return this.angle_};const pw=fw;function gw(t){var e=!1;if(t.type==Gg.DBLCLICK){var i=t.originalEvent,n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;Hg(n.getView(),o,r,this.duration_),t.preventDefault(),e=!0}return!e}const mw=function(t){function e(e){t.call(this,{handleEvent:gw});var i=e||{};this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Jg);const vw=function(t){function e(e){t.call(this,{stopDown:Oc});var i=e||{};this.kinetic_=i.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1,this.condition_=i.condition?i.condition:fv,this.noKinetic_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().setHint(Yb,1));var e=this.targetPointers,i=Qg(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){var n=this.lastCentroid[0]-i[0],r=i[1]-this.lastCentroid[1],o=t.map.getView(),s=[n,r];Km(s,o.getResolution()),Wm(s,o.getRotation()),Vm(s,o.getCenter()),s=o.constrainCenter(s),o.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length},e.prototype.handleUpEvent=function(t){var e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenter(),s=e.getPixelFromCoordinate(o),a=e.getCoordinateFromPixel([s[0]-n*Math.cos(r),s[1]-n*Math.sin(r)]);i.animate({center:i.constrainCenter(a),duration:500,easing:zg})}return this.panning_&&(this.panning_=!1,i.setHint(Yb,-1)),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},e}(tm);const yw=function(t){function e(e){var i=e||{};t.call(this,{stopDown:Oc}),this.condition_=i.condition?i.condition:sv,this.lastAngle_=void 0,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){if(mv(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==Wb){var n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){var s=o-this.lastAngle_,a=i.getRotation();Yg(i,a-s)}this.lastAngle_=o}}},e.prototype.handleUpEvent=function(t){if(!mv(t))return!0;var e=t.map.getView();e.setHint(Yb,-1);var i=e.getRotation();return Xg(e,i,void 0,this.duration_),!1},e.prototype.handleDownEvent=function(t){return!!mv(t)&&(!(!hv(t)||!this.condition_(t))&&(t.map.getView().setHint(Yb,1),this.lastAngle_=void 0,!0))},e}(tm);const _w=function(t){function e(e){t.call(this),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Lg([i])},e.prototype.getGeometry=function(){return this.geometry_},e}(Fc);var bw="boxstart",ww="boxdrag",xw="boxend",Sw=function(t){function e(e,i,n){t.call(this,e),this.coordinate=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);function Cw(){var t=this.getMap(),e=t.getView(),i=t.getSize(),n=this.getGeometry().getExtent();if(this.out_){var r=e.calculateExtent(i),o=function(t,e){return ef(Yd(e),t)}([t.getPixelFromCoordinate(af(n)),t.getPixelFromCoordinate(gf(n))]);!function(t,e){var i=(t[2]-t[0])/2*(e-1),n=(t[3]-t[1])/2*(e-1);t[0]-=i,t[2]+=i,t[1]-=n,t[3]+=n}(r,1/e.getResolutionForExtent(o,i)),n=r}var s=e.constrainResolution(e.getResolutionForExtent(n,i)),a=uf(n);a=e.constrainCenter(a),e.animate({resolution:s,center:a,duration:this.duration_,easing:zg})}const Ew=function(t){function e(e){var i=e||{},n=i.condition?i.condition:pv;t.call(this,{condition:n,className:i.className||"ol-dragzoom",onBoxEnd:Cw}),this.duration_=void 0!==i.duration?i.duration:200,this.out_=void 0!==i.out&&i.out}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(function(t){function e(e){t.call(this);var i=e||{};this.box_=new _w(i.className||"ol-dragbox"),this.minArea_=void 0!==i.minArea?i.minArea:64,this.onBoxEnd_=i.onBoxEnd?i.onBoxEnd:Dc,this.startPixel_=null,this.condition_=i.condition?i.condition:lv,this.boxEndCondition_=i.boxEndCondition?i.boxEndCondition:this.defaultBoxEndCondition}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.defaultBoxEndCondition=function(t,e,i){var n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_},e.prototype.getGeometry=function(){return this.box_.getGeometry()},e.prototype.handleDragEvent=function(t){mv(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Sw(ww,t.coordinate,t)))},e.prototype.handleUpEvent=function(t){return!mv(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new Sw(xw,t.coordinate,t))),!1)},e.prototype.handleDownEvent=function(t){return!!mv(t)&&(!(!hv(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Sw(bw,t.coordinate,t)),!0))},e}(tm)),Tw=37,Iw=38,Aw=39,kw=40;function Pw(t){var e=!1;if(t.type==Kc){var i=t.originalEvent.keyCode;if(this.condition_(t)&&(i==kw||i==Tw||i==Aw||i==Iw)){var n=t.map.getView(),r=n.getResolution()*this.pixelDelta_,o=0,s=0;i==kw?s=-r:i==Tw?o=-r:i==Aw?o=r:s=r;var a=[o,s];Wm(a,n.getRotation()),function(t,e,i){var n=t.getCenter();if(n){var r=t.constrainCenter([n[0]+e[0],n[1]+e[1]]);i?t.animate({duration:i,easing:Wg,center:r}):t.setCenter(r)}}(n,a,this.duration_),t.preventDefault(),e=!0}}return!e}const Lw=function(t){function e(e){t.call(this,{handleEvent:Pw});var i=e||{};this.defaultCondition_=function(t){return fv(t)&&gv(t)},this.condition_=void 0!==i.condition?i.condition:this.defaultCondition_,this.duration_=void 0!==i.duration?i.duration:100,this.pixelDelta_=void 0!==i.pixelDelta?i.pixelDelta:128}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Jg);function Rw(t){var e=!1;if(t.type==Kc||t.type==Xc){var i=t.originalEvent.charCode;if(this.condition_(t)&&(i=="+".charCodeAt(0)||i=="-".charCodeAt(0))){var n=t.map,r=i=="+".charCodeAt(0)?this.delta_:-this.delta_;Hg(n.getView(),r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}const Fw=function(t){function e(e){t.call(this,{handleEvent:Rw});var i=e||{};this.condition_=i.condition?i.condition:gv,this.delta_=i.delta?i.delta:1,this.duration_=void 0!==i.duration?i.duration:100}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Jg);var Mw="trackpad",Ow="wheel";const Dw=function(t){function e(e){var i=e||{};t.call(this,i),this.delta_=0,this.duration_=void 0!==i.duration?i.duration:250,this.timeout_=void 0!==i.timeout?i.timeout:80,this.useAnchor_=void 0===i.useAnchor||i.useAnchor,this.constrainResolution_=i.constrainResolution||!1,this.condition_=i.condition?i.condition:lv,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(Yb,-1)},e.prototype.handleEvent=function(t){if(!this.condition_(t))return!0;var e=t.type;if(e!==ed&&e!==Zc)return!0;t.preventDefault();var i,n=t.map,r=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==ed?(i=r.deltaY,Zm&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=ev),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)):t.type==Zc&&(i=-r.wheelDeltaY,Jm&&(i/=3)),0===i)return!1;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?Mw:Ow),this.mode_===Mw){var s=n.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):s.setHint(Yb,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var a=s.getResolution()*Math.pow(2,i/this.trackpadDeltaPerZoom_),l=s.getMinResolution(),u=s.getMaxResolution(),h=0;if(a<l?(a=Math.max(a,l/this.trackpadZoomBuffer_),h=1):a>u&&(a=Math.min(a,u*this.trackpadZoomBuffer_),h=-1),this.lastAnchor_){var c=s.calculateCenterZoom(a,this.lastAnchor_);s.setCenter(s.constrainCenter(c))}return s.setResolution(a),0===h&&this.constrainResolution_&&s.animate({resolution:s.constrainResolution(a,i>0?-1:1),easing:zg,anchor:this.lastAnchor_,duration:this.duration_}),h>0?s.animate({resolution:l,easing:zg,anchor:this.lastAnchor_,duration:500}):h<0&&s.animate({resolution:u,easing:zg,anchor:this.lastAnchor_,duration:500}),this.startTime_=o,!1}this.delta_+=i;var d=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),d),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();Hg(e,-Hf(this.delta_,-1,1),this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(Jg);const $w=function(t){function e(e){var i=e||{},n=i;n.stopDown||(n.stopDown=Oc),t.call(this,n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==i.threshold?i.threshold:.3,this.duration_=void 0!==i.duration?i.duration:250}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=0,i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var s=t.map,a=s.getView();if(a.getConstraints().rotation!==Wb){var l=s.getViewport().getBoundingClientRect(),u=Qg(this.targetPointers);if(u[0]-=l.left,u[1]-=l.top,this.anchor_=s.getCoordinateFromPixel(u),this.rotating_){var h=a.getRotation();s.render(),Yg(a,h+e,this.anchor_)}}},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();if(e.setHint(Yb,-1),this.rotating_){var i=e.getRotation();Xg(e,i,this.anchor_,this.duration_)}return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(Yb,1),!0}return!1},e}(tm);const jw=function(t){function e(e){var i=e||{},n=i;n.stopDown||(n.stopDown=Oc),t.call(this,n),this.constrainResolution_=i.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==i.duration?i.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDragEvent=function(t){var e=1,i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,s=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;var a=t.map,l=a.getView(),u=l.getResolution(),h=l.getMaxResolution(),c=l.getMinResolution(),d=u*e;d>h?(e=h/u,d=h):d<c&&(e=c/u,d=c),1!=e&&(this.lastScaleDelta_=e);var f=a.getViewport().getBoundingClientRect(),p=Qg(this.targetPointers);p[0]-=f.left,p[1]-=f.top,this.anchor_=a.getCoordinateFromPixel(p),a.render(),Zg(l,d,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(Yb,-1);var i=e.getResolution();if(this.constrainResolution_||i<e.getMinResolution()||i>e.getMaxResolution()){var n=this.lastScaleDelta_-1;!function(t,e,i,n,r){e=t.constrainResolution(e,0,r),Zg(t,e,i,n)}(e,i,this.anchor_,this.duration_,n)}return!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(Yb,1),!0}return!1},e}(tm);function Nw(t){var e=t||{},i=new $m,n=new pw(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new yw),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new mw({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new vw({condition:e.onFocusOnly?av:void 0,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new $w),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new jw({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new Lw),i.push(new Fw({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new Dw({condition:e.onFocusOnly?av:void 0,constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new Ew({duration:e.zoomDuration})),i}const Bw=function(t){function e(e,i,n,r,o){t.call(this,e),this.vectorContext=i,this.frameState=n,this.context=r,this.glContext=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);var Uw=function(){};Uw.prototype.drawCustom=function(t,e,i){},Uw.prototype.drawGeometry=function(t){},Uw.prototype.setStyle=function(t){},Uw.prototype.drawCircle=function(t,e){},Uw.prototype.drawEllipse=function(t,e){},Uw.prototype.drawFeature=function(t,e){},Uw.prototype.drawGeometryCollection=function(t,e){},Uw.prototype.drawLineString=function(t,e){},Uw.prototype.drawMultiLineString=function(t,e){},Uw.prototype.drawMultiPoint=function(t,e){},Uw.prototype.drawMultiPolygon=function(t,e){},Uw.prototype.drawPoint=function(t,e){},Uw.prototype.drawPolygon=function(t,e){},Uw.prototype.drawText=function(t,e){},Uw.prototype.setFillStrokeStyle=function(t,e){},Uw.prototype.setImageStyle=function(t,e){},Uw.prototype.setTextStyle=function(t,e){};const Gw=Uw;const Vw=function(t){function e(e,i,n,r,o){t.call(this),this.context_=e,this.pixelRatio_=i,this.extent_=n,this.transform_=r,this.viewRotation_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawImages_=function(t,e,i,n){if(this.image_){var r=Yf(t,e,i,2,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var u=0,h=r.length;u<h;u+=2){var c=r[u]-this.imageAnchorX_,d=r[u+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var f=c+this.imageAnchorX_,p=d+this.imageAnchorY_;Kp(s,f,p,this.imageScale_,this.imageScale_,l,-f,-p),o.setTransform.apply(o,s)}o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,d,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||o.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(o.globalAlpha=a)}},e.prototype.drawText_=function(t,e,i,n){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=Yf(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.textRotation_;for(this.textRotateWithView_&&(s+=this.viewRotation_);e<i;e+=n){var a=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;if(0!==s||1!=this.textScale_){var u=Kp(this.tmpLocalTransform_,a,l,this.textScale_,this.textScale_,s,-a,-l);o.setTransform.apply(o,u)}this.textStrokeState_&&o.strokeText(this.text_,a,l),this.textFillState_&&o.fillText(this.text_,a,l)}0===s&&1==this.textScale_||o.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,n,r){var o=this.context_,s=Yf(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);var a=s.length;r&&(a-=2);for(var l=2;l<a;l+=2)o.lineTo(s[l],s[l+1]);return r&&o.closePath(),i},e.prototype.drawRings_=function(t,e,i,n){for(var r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e},e.prototype.drawCircle=function(t){if(vf(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,i){var n=t.getFlatCoordinates();if(n){var r=t.getStride();return Yf(n,0,n.length,r,e,i)}return null}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.drawGeometry=function(t){switch(t.getType()){case jf:this.drawPoint(t);break;case Nf:this.drawLineString(t);break;case Uf:case Kf:case Xf:this.drawPolygon(t);break;case Gf:this.drawMultiPoint(t);break;case Vf:this.drawMultiLineString(t);break;case zf:this.drawMultiPolygon(t);break;case qf:this.drawGeometryCollection(t);break;case Wf:this.drawCircle(t)}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&vf(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(vf(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var n=t.getFlatMidpoint();this.drawText_(n,0,2,2)}}},e.prototype.drawMultiLineString=function(t){var e=t.getExtent();if(vf(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,n=t.getFlatCoordinates(),r=0,o=t.getEnds(),s=t.getStride();i.beginPath();for(var a=0,l=o.length;a<l;++a)r=this.moveToLineTo_(n,r,o[a],s,!1);i.stroke()}if(""!==this.text_){var u=t.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}},e.prototype.drawPolygon=function(t){if(vf(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(vf(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),n=0,r=t.getEndss(),o=t.getStride();e.beginPath();for(var s=0,a=r.length;s<a;++s){var l=r[s];n=this.drawRings_(i,n,l,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var u=t.getFlatInteriorPoints();this.drawText_(u,0,u.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=e.lineCap=t.lineCap),iv&&(Ff(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,iv&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:hy;i?(i.font!=t.font&&(i.font=e.font=t.font),i.textAlign!=n&&(i.textAlign=e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:iy(i||oy)}}else this.fillState_=null;if(e){var n=e.getColor(),r=e.getLineCap(),o=e.getLineDash(),s=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),u=e.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:sy,lineDash:o||ay,lineDashOffset:s||0,lineJoin:void 0!==a?a:ly,lineWidth:this.pixelRatio_*(void 0!==l?l:1),miterLimit:void 0!==u?u:10,strokeStyle:iy(n||uy)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),n=t.getOrigin(),r=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=r[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=n[0],this.imageOriginY_=n[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=r[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:iy(i||oy)}}else this.textFillState_=null;var n=t.getStroke();if(n){var r=n.getColor(),o=n.getLineCap(),s=n.getLineDash(),a=n.getLineDashOffset(),l=n.getLineJoin(),u=n.getWidth(),h=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:sy,lineDash:s||ay,lineDashOffset:a||0,lineJoin:void 0!==l?l:ly,lineWidth:void 0!==u?u:1,miterLimit:void 0!==h?h:10,strokeStyle:iy(r||uy)}}else this.textStrokeState_=null;var c=t.getFont(),d=t.getOffsetX(),f=t.getOffsetY(),p=t.getRotateWithView(),g=t.getRotation(),m=t.getScale(),v=t.getText(),y=t.getTextAlign(),_=t.getTextBaseline();this.textState_={font:void 0!==c?c:ry,textAlign:void 0!==y?y:hy,textBaseline:void 0!==_?_:cy},this.text_=void 0!==v?v:"",this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0,this.textOffsetY_=void 0!==f?this.pixelRatio_*f:0,this.textRotateWithView_=void 0!==p&&p,this.textRotation_=void 0!==g?g:0,this.textScale_=this.pixelRatio_*(void 0!==m?m:1)}else this.text_=""},e}(Gw);var zw=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};function qw(t,e,i){return e+":"+t+":"+(i?Qv(i):"null")}zw.prototype.clear=function(){this.cache_={},this.cacheSize_=0},zw.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t=0;for(var e in this.cache_){var i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}},zw.prototype.get=function(t,e,i){var n=qw(t,e,i);return n in this.cache_?this.cache_[n]:null},zw.prototype.set=function(t,e,i,n){var r=qw(t,e,i);this.cache_[r]=n,++this.cacheSize_},zw.prototype.setSize=function(t){this.maxCacheSize_=t,this.expire()};var Ww=new zw;function Kw(t,e){Ww.expire()}function Xw(t,e){return t.zIndex-e.zIndex}var Yw=[];const Hw=function(t){function e(e){t.call(this,e);var i=e.getViewport();this.context_=wd(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=vd,i.insertBefore(this.canvas_,i.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){var i=this.getMap(),n=this.context_;if(i.hasListener(t)){var r=e.extent,o=e.pixelRatio,s=e.viewState.rotation,a=this.getTransform(e),l=new Vw(n,o,r,a,s),u=new Bw(t,l,e,n,null);i.dispatchEvent(u)}},e.prototype.getTransform=function(t){var e=t.viewState,i=this.canvas_.width/2,n=this.canvas_.height/2,r=t.pixelRatio/e.resolution,o=-r,s=-e.rotation,a=-e.center[0],l=-e.center[1];return Kp(this.transform_,i,n,r,o,s,a,l)},e.prototype.renderFrame=function(t){if(t){var e=this.context_,i=t.pixelRatio,n=Math.round(t.size[0]*i),r=Math.round(t.size[1]*i);this.canvas_.width!=n||this.canvas_.height!=r?(this.canvas_.width=n,this.canvas_.height=r):e.clearRect(0,0,n,r);var o=t.viewState.rotation;this.calculateMatrices2D(t),this.dispatchRenderEvent(zv,t);var s=t.layerStatesArray;!function(t,e){var i,n=t.length,r=Array(t.length);for(i=0;i<n;i++)r[i]={index:i,value:t[i]};for(r.sort((function(t,i){return e(t.value,i.value)||t.index-i.index})),i=0;i<t.length;i++)t[i]=r[i].value}(s,Xw),o&&(e.save(),Sy(e,o,n/2,r/2));var a,l,u=t.viewState.resolution;for(a=0,l=s.length;a<l;++a){var h=s[a],c=h.layer,d=this.getLayerRenderer(c);Kv(h,u)&&h.sourceState==Sm&&(d.prepareFrame(t,h)&&d.composeFrame(t,h,e))}o&&e.restore(),this.dispatchRenderEvent(Vv,t),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1)},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){var a,l,u=e.viewState.resolution,h=e.layerStatesArray,c=h.length,d=zp(e.pixelToCoordinateTransform,t.slice());for(l=c-1;l>=0;--l){var f=h[l],p=f.layer;if(Kv(f,u)&&o.call(s,p))if(a=this.getLayerRenderer(p).forEachLayerAtCoordinate(d,e,i,n,r))return a}},e.prototype.registerLayerRenderers=function(e){t.prototype.registerLayerRenderers.call(this,e);for(var i=0,n=e.length;i<n;++i){var r=e[i];kf(Yw,r)||Yw.push(r)}},e}(function(t){function e(e){t.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={},this.layerRendererConstructors_=[]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.dispatchRenderEvent=function(t,e){gc()},e.prototype.registerLayerRenderers=function(t){this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_,t)},e.prototype.calculateMatrices2D=function(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;Kp(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),function(t){var e,i=(e=t)[0]*e[3]-e[1]*e[2];Ad(0!==i,32);var n=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5];t[0]=s/i,t[1]=-r/i,t[2]=-o/i,t[3]=n/i,t[4]=(o*l-s*a)/i,t[5]=-(n*l-r*a)/i}(Vp(n,i))},e.prototype.removeLayerRenderers=function(){for(var t in this.layerRenderers_)this.removeLayerRendererByKey_(t).dispose()},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a,l=e.viewState,u=l.resolution;function h(t,i){var o=e.layerStates[vc(i)].managed;if(!(vc(t)in e.skippedFeatureUids)||o)return n.call(r,t,o?i:null)}var c=l.projection,d=t;if(c.canWrapX()){var f=c.getExtent(),p=mf(f),g=t[0];if(g<f[0]||g>f[2])d=[g+p*Math.ceil((f[0]-g)/p),t[1]]}var m,v=e.layerStatesArray;for(m=v.length-1;m>=0;--m){var y=v[m],_=y.layer;if(Kv(y,u)&&o.call(s,_)){var b=this.getLayerRenderer(_),w=_.getSource();if(w&&(a=b.forEachFeatureAtCoordinate(w.getWrapX()?d:t,e,i,h)),a)return a}}},e.prototype.forEachLayerAtPixel=function(t,e,i,n,r,o,s){return gc()},e.prototype.hasFeatureAtCoordinate=function(t,e,i,n,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,Mc,this,n,r)},e.prototype.getLayerRenderer=function(t){var e=vc(t);if(e in this.layerRenderers_)return this.layerRenderers_[e];for(var i,n=0,r=this.layerRendererConstructors_.length;n<r;++n){var o=this.layerRendererConstructors_[n];if(o.handles(t)){i=o.create(this,t);break}}if(!i)throw new Error("Unable to create renderer for layer: "+t.getType());return this.layerRenderers_[e]=i,this.layerRendererListeners_[e]=Ac(i,Uc,this.handleLayerRendererChange_,this),i},e.prototype.getLayerRendererByKey=function(t){return this.layerRenderers_[t]},e.prototype.getLayerRenderers=function(){return this.layerRenderers_},e.prototype.getMap=function(){return this.map_},e.prototype.handleLayerRendererChange_=function(){this.map_.render()},e.prototype.removeLayerRendererByKey_=function(t){var e=this.layerRenderers_[t];return delete this.layerRenderers_[t],Lc(this.layerRendererListeners_[t]),delete this.layerRendererListeners_[t],e},e.prototype.removeUnusedLayerRenderers_=function(t,e){for(var i in this.layerRenderers_)e&&i in e.layerStates||this.removeLayerRendererByKey_(i).dispose()},e.prototype.renderFrame=function(t){gc()},e.prototype.scheduleExpireIconCache=function(t){t.postRenderFunctions.push(Kw)},e.prototype.scheduleRemoveUnusedLayerRenderers=function(t){for(var e in this.layerRenderers_)if(!(e in t.layerStates))return void t.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},e}(Fc));const Zw=function(t){function e(e){t.call(this,e),this.renderedResolution,this.transform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.clip=function(t,e,i){var n=e.pixelRatio,r=e.size[0]*n,o=e.size[1]*n,s=e.viewState.rotation,a=pf(i),l=gf(i),u=lf(i),h=af(i);zp(e.coordinateToPixelTransform,a),zp(e.coordinateToPixelTransform,l),zp(e.coordinateToPixelTransform,u),zp(e.coordinateToPixelTransform,h),t.save(),Sy(t,-s,r/2,o/2),t.beginPath(),t.moveTo(a[0]*n,a[1]*n),t.lineTo(l[0]*n,l[1]*n),t.lineTo(u[0]*n,u[1]*n),t.lineTo(h[0]*n,h[1]*n),t.clip(),Sy(t,s,r/2,o/2)},e.prototype.dispatchComposeEvent_=function(t,e,i,n){var r=this.getLayer();if(r.hasListener(t)){var o=i.size[0]*i.pixelRatio,s=i.size[1]*i.pixelRatio,a=i.viewState.rotation;Sy(e,-a,o/2,s/2);var l=void 0!==n?n:this.getTransform(i,0),u=new Vw(e,i.pixelRatio,i.extent,l,i.viewState.rotation),h=new Bw(t,u,i,e,null);r.dispatchEvent(h),Sy(e,a,o/2,s/2)}},e.prototype.forEachLayerAtCoordinate=function(t,e,i,n,r){return this.forEachFeatureAtCoordinate(t,e,i,Mc)?n.call(r,this.getLayer(),null):void 0},e.prototype.postCompose=function(t,e,i,n){this.dispatchComposeEvent_(Vv,t,e,n)},e.prototype.preCompose=function(t,e,i){this.dispatchComposeEvent_(zv,t,e,i)},e.prototype.dispatchRenderEvent=function(t,e,i){this.dispatchComposeEvent_(qv,t,e,i)},e.prototype.getTransform=function(t,e){var i=t.viewState,n=t.pixelRatio,r=n*t.size[0]/2,o=n*t.size[1]/2,s=n/i.resolution,a=-s,l=-i.rotation,u=-i.center[0]+e,h=-i.center[1];return Kp(this.transform_,r,o,s,a,l,u,h)},e.prototype.composeFrame=function(t,e,i){gc()},e.prototype.prepareFrame=function(t,e){return gc()},e}(function(t){function e(e){t.call(this),this.layer_=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createLoadedTileFinder=function(t,e,i){return function(n,r){return t.forEachLoadedTile(e,n,r,(function(t){i[n]||(i[n]={}),i[n][t.tileCoord.toString()]=t}))}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n){},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleImageChange_=function(t){t.target.getState()===fm&&this.renderIfReadyAndVisible()},e.prototype.hasFeatureAtCoordinate=function(t,e){return!1},e.prototype.loadImage=function(t){var e=t.getState();return e!=fm&&e!=pm&&Ac(t,Uc,this.handleImageChange_,this),e==cm&&(t.load(),e=t.getState()),e==fm},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Sm&&this.changed()},e.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var i=function(t,e,i){var n=vc(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}},e.prototype.updateUsedTiles=function(t,e,i,n){var r=vc(e),o=i.toString();r in t?o in t[r]?t[r][o].extend(n):t[r][o]=n:(t[r]={},t[r][o]=n)},e.prototype.manageTilePyramid=function(t,e,i,n,r,o,s,a,l,u){var h=vc(e);h in t.wantedTiles||(t.wantedTiles[h]={});var c,d,f,p,g,m,v=t.wantedTiles[h],y=t.tileQueue;for(m=i.getMinZoom();m<=s;++m)for(d=i.getTileRangeForExtentAndZ(o,m,d),f=i.getResolution(m),p=d.minX;p<=d.maxX;++p)for(g=d.minY;g<=d.maxY;++g)s-m<=a?((c=e.getTile(m,p,g,n,r)).getState()==Ob&&(v[c.getKey()]=!0,y.isKeyQueued(c.getKey())||y.enqueue([c,h,i.getTileCoordCenter(c.tileCoord),f])),void 0!==l&&l.call(u,c)):e.useTile(m,p,g,r)},e}(id));const Jw=function(t){function e(e){t.call(this,e),this.coordinateToCanvasPixelTransform=[1,0,0,1,0,0],this.hitCanvasContext_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.composeFrame=function(t,e,i){this.preCompose(i,t);var n=this.getImage();if(n){var r=e.extent,o=void 0!==r&&!zd(r,t.extent)&&vf(r,t.extent);o&&this.clip(i,t,r);var s=this.getImageTransform(),a=i.globalAlpha;i.globalAlpha=e.opacity;var l=s[4],u=s[5],h=n.width*s[0],c=n.height*s[3];h>=.5&&c>=.5&&i.drawImage(n,0,0,+n.width,+n.height,Math.round(l),Math.round(u),Math.round(h),Math.round(c)),i.globalAlpha=a,o&&i.restore()}this.postCompose(i,t,e)},e.prototype.getImage=function(){return gc()},e.prototype.getImageTransform=function(){return gc()},e.prototype.forEachLayerAtCoordinate=function(t,e,i,n,r){if(this.getImage()){var o=zp(this.coordinateToCanvasPixelTransform,t.slice());Km(o,e.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=wd(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),o[0],o[1],1,1,0,0,1,1);var s=this.hitCanvasContext_.getImageData(0,0,1,1).data;return s[3]>0?n.call(r,this.getLayer(),s):void 0}},e}(Zw);var Qw=function(t){function e(i){if(t.call(this,i),this.image_=null,this.imageTransform_=[1,0,0,1,0,0],this.skippedFeatures_=[],this.vectorRenderer_=null,i.getType()===Mv)for(var n=0,r=Yw.length;n<r;++n){var o=Yw[n];if(o!==e&&o.handles(i)){this.vectorRenderer_=new o(i);break}}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.vectorRenderer_&&this.vectorRenderer_.dispose(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.prepareFrame=function(t,e){var i,n=t.pixelRatio,r=t.size,o=t.viewState,s=o.center,a=o.resolution,l=this.getLayer().getSource(),u=t.viewHints,h=this.vectorRenderer_,c=t.extent;if(h||void 0===e.extent||(c=ff(c,e.extent)),!u[Xb]&&!u[Yb]&&!yf(c)){var d=o.projection,f=this.skippedFeatures_;if(h){var p=h.context,g=bc({},t,{size:[mf(c)/a,df(c)/a],viewState:bc({},t.viewState,{rotation:0})}),m=Object.keys(g.skippedFeatureUids).sort();i=new Lm(c,a,n,p.canvas,(function(t){!h.prepareFrame(g,e)||!h.replayGroupChanged&&Ff(f,m)||(p.canvas.width=g.size[0]*n,p.canvas.height=g.size[1]*n,h.compose(p,g,e),f=m,t())}))}else i=l.getImage(c,a,n,d);i&&this.loadImage(i)&&(this.image_=i,this.skippedFeatures_=f)}if(this.image_){var v=(i=this.image_).getExtent(),y=i.getResolution(),_=i.getPixelRatio(),b=n*y/(a*_),w=Kp(this.imageTransform_,n*r[0]/2,n*r[1]/2,b,b,0,_*(v[0]-s[0])/y,_*(s[1]-v[3])/y);Kp(this.coordinateToCanvasPixelTransform,n*r[0]/2-w[4],n*r[1]/2-w[5],n/a,-n/a,0,-s[0],-s[1]),this.renderedResolution=y*n/_}return!!this.image_},e.prototype.forEachFeatureAtCoordinate=function(e,i,n,r){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(e,i,n,r):t.prototype.forEachFeatureAtCoordinate.call(this,e,i,n,r)},e}(Jw);Qw.handles=function(t){return t.getType()===Lv||t.getType()===Mv&&t.getRenderMode()===Yv},Qw.create=function(t,e){return new Qw(e)};const tx=Qw;var ex=function(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n};function ix(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new ex(t,e,i,n)}ex.prototype.contains=function(t){return this.containsXY(t[1],t[2])},ex.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},ex.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},ex.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},ex.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},ex.prototype.getHeight=function(){return this.maxY-this.minY+1},ex.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},ex.prototype.getWidth=function(){return this.maxX-this.minX+1},ex.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};const nx=ex;var rx=function(t){function e(e,i){t.call(this,e),this.context=i?null:wd(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new nx(0,0,0,0),this.imageTransform_=[1,0,0,1,0,0],this.zDirection=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isDrawableTile_=function(t){var e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return i==$b||i==Nb||i==jb&&!n},e.prototype.getTile=function(t,e,i,n,r){var o=this.getLayer(),s=o.getSource().getTile(t,e,i,n,r);return s.getState()==jb&&(o.getUseInterimTilesOnError()?o.getPreload()>0&&(this.newTiles_=!0):s.setState($b)),this.isDrawableTile_(s)||(s=s.getInterimTile()),s},e.prototype.prepareFrame=function(t,e){var i=t.pixelRatio,n=t.size,r=t.viewState,o=r.projection,s=r.resolution,a=r.center,l=this.getLayer(),u=l.getSource(),h=u.getRevision(),c=u.getTileGridForProjection(o),d=c.getZForResolution(s,this.zDirection),f=c.getResolution(d),p=Math.round(s/f)||1,g=t.extent;if(void 0!==e.extent&&(g=ff(g,e.extent)),yf(g))return!1;var m=c.getTileRangeForExtentAndZ(g,d),v=c.getTileRangeExtent(d,m),y=u.getTilePixelRatio(i),_={};_[d]={};var b,w,x,S=this.createLoadedTileFinder(u,o,_),C=t.viewHints,E=C[Xb]||C[Yb],T=this.tmpExtent,I=this.tmpTileRange_;for(this.newTiles_=!1,w=m.minX;w<=m.maxX;++w)for(x=m.minY;x<=m.maxY;++x)if(!(Date.now()-t.time>16&&E)){if(b=this.getTile(d,w,x,i,o),this.isDrawableTile_(b)){var A=vc(this);if(b.getState()==$b){_[d][b.tileCoord.toString()]=b;var k=b.inTransition(A);this.newTiles_||!k&&-1!==this.renderedTiles.indexOf(b)||(this.newTiles_=!0)}if(1===b.getAlpha(A,t.time))continue}var P=c.getTileCoordChildTileRange(b.tileCoord,I,T),L=!1;P&&(L=S(d+1,P)),L||c.forEachTileCoordParentTileRange(b.tileCoord,S,null,I,T)}var R=f*i/y*p;if(!(this.renderedResolution&&Date.now()-t.time>16&&E)&&(this.newTiles_||!this.renderedExtent_||!zd(this.renderedExtent_,g)||this.renderedRevision!=h||p!=this.oversampling_||!E&&R!=this.renderedResolution)){var F=this.context;if(F){var M=u.getTilePixelSize(d,i,o),O=Math.round(m.getWidth()*M[0]/p),D=Math.round(m.getHeight()*M[1]/p),$=F.canvas;$.width!=O||$.height!=D?(this.oversampling_=p,$.width=O,$.height=D):(this.renderedExtent_&&!Jd(v,this.renderedExtent_)&&F.clearRect(0,0,O,D),p=this.oversampling_)}this.renderedTiles.length=0;var j,N,B,U,G,V,z,q,W,K,X=Object.keys(_).map(Number);for(X.sort((function(t,e){return t===d?1:e===d?-1:t>e?1:t<e?-1:0})),U=0,G=X.length;U<G;++U)for(var Y in B=X[U],N=u.getTilePixelSize(B,i,o),j=c.getResolution(B)/f,z=y*u.getGutterForProjection(o),q=_[B])b=q[Y],w=((V=c.getTileCoordExtent(b.getTileCoord(),T))[0]-v[0])/f*y/p,x=(v[3]-V[3])/f*y/p,W=N[0]*j/p,K=N[1]*j/p,this.drawTileImage(b,t,e,w,x,W,K,z,d===B),this.renderedTiles.push(b);this.renderedRevision=h,this.renderedResolution=f*i/y*p,this.renderedExtent_=v}var H=this.renderedResolution/s,Z=Kp(this.imageTransform_,i*n[0]/2,i*n[1]/2,H,H,0,(this.renderedExtent_[0]-a[0])/this.renderedResolution*i,(a[1]-this.renderedExtent_[3])/this.renderedResolution*i);return Kp(this.coordinateToCanvasPixelTransform,i*n[0]/2-Z[4],i*n[1]/2-Z[5],i/s,-i/s,0,-a[0],-a[1]),this.updateUsedTiles(t.usedTiles,u,d,m),this.manageTilePyramid(t,u,c,i,o,g,d,l.getPreload()),this.scheduleExpireCache(t,u),this.renderedTiles.length>0},e.prototype.drawTileImage=function(t,e,i,n,r,o,s,a,l){var u=this.getTileImage(t);if(u){var h=vc(this),c=l?t.getAlpha(h,e.time):1,d=this.getLayer().getSource();1!==c||d.getOpaque(e.viewState.projection)||this.context.clearRect(n,r,o,s);var f=c!==this.context.globalAlpha;f&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,r,o,s),f&&this.context.restore(),1!==c?e.animate=!0:l&&t.endTransition(h)}},e.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},e.prototype.getImageTransform=function(){return this.imageTransform_},e.prototype.getTileImage=function(t){return t.getImage()},e}(Jw);rx.handles=function(t){return t.getType()===Rv},rx.create=function(t,e){return new rx(e)},rx.prototype.getLayer;const ox=rx;var sx=function(){};sx.prototype.getReplay=function(t,e){return gc()},sx.prototype.isEmpty=function(){return gc()},sx.prototype.addDeclutter=function(t){return gc()};const ax=sx,lx="Circle",ux="Default",hx="Image",cx="LineString",dx="Polygon",fx="Text",px="Ellipse";function gx(t,e,i,n,r,o,s,a){for(var l,u,h,c=[],d=t[e]>t[i-n],f=r.length,p=t[e],g=t[e+1],m=t[e+=n],v=t[e+1],y=0,_=Math.sqrt(Math.pow(m-p,2)+Math.pow(v-g,2)),b="",w=0,x=0;x<f;++x){u=d?f-x-1:x;var S=r.charAt(u),C=o(b=d?S+b:b+S)-w;w+=C;for(var E=s+C/2;e<i-n&&y+_<E;)p=m,g=v,m=t[e+=n],v=t[e+1],y+=_,_=Math.sqrt(Math.pow(m-p,2)+Math.pow(v-g,2));var T=E-y,I=Math.atan2(v-g,m-p);if(d&&(I+=I>0?-Math.PI:Math.PI),void 0!==h){var A=I-h;if(A+=A>Math.PI?-2*Math.PI:A<-Math.PI?2*Math.PI:0,Math.abs(A)>a)return null}var k=T/_,P=ip(p,m,k),L=ip(g,v,k);h==I?(d&&(l[0]=P,l[1]=L,l[2]=C/2),l[4]=b):(w=C,l=[P,L,C/2,I,b=S],d?c.unshift(l):c.push(l),h=I),s+=C}return c}var mx={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12,ELLIPSE:13},vx=[mx.FILL],yx=[mx.STROKE],_x=[mx.BEGIN_PATH],bx=[mx.CLOSE_PATH];const wx=mx;var xx=[dx,lx,px,cx,hx,fx,ux],Sx={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Cx=[1/0,1/0,-1/0,-1/0],Ex=[1,0,0,1,0,0];const Tx=function(t){function e(e,i,n,r,o,s){t.call(this),this.declutterTree=s,this.tolerance=e,this.maxExtent=i,this.overlaps=o,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.alignFill_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.viewRotation_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.replayTextBackground_=function(t,e,i,n,r,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},e.prototype.replayImage_=function(t,e,i,n,r,o,s,a,l,u,h,c,d,f,p,g,m,v){var y=m||v;e-=r*=d,i-=o*=d;var _,b,w,x,S=p+u>n.width?n.width-u:p,C=a+h>n.height?n.height-h:a,E=g[3]+S*d+g[1],T=g[0]+C*d+g[2],I=e-g[3],A=i-g[0];(y||0!==c)&&(_=[I,A],b=[I+E,A],w=[I+E,A+T],x=[I,A+T]);var k=null;if(0!==c){var P=e+r,L=i+o;k=Kp(Ex,P,L,1,1,c,-P,-L),Yd(Cx),tf(Cx,zp(Ex,_)),tf(Cx,zp(Ex,b)),tf(Cx,zp(Ex,w)),tf(Cx,zp(Ex,x))}else Xd(I,A,I+E,A+T,Cx);var R=t.canvas,F=v?v[2]*d/2:0,M=Cx[0]-F<=R.width&&Cx[2]+F>=0&&Cx[1]-F<=R.height&&Cx[3]+F>=0;if(f&&(e=Math.round(e),i=Math.round(i)),s){if(!M&&1==s[4])return;Qd(s,Cx);var O=M?[t,k?k.slice(0):null,l,n,u,h,S,C,e,i,d]:null;O&&y&&O.push(m,v,_,b,w,x),s.push(O)}else M&&(y&&this.replayTextBackground_(t,_,b,w,x,m,v),Ey(t,k,l,n,u,h,S,C,e,i,d))},e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))},e.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=n);var l,u,h,c=[t[e],t[e+1]],d=[NaN,NaN],f=!0;for(l=e+n;l<i;l+=n)d[0]=t[l],d[1]=t[l+1],(h=Wd(a,d))!==u?(f&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],f=!1):h===Md?(this.coordinates[s++]=d[0],this.coordinates[s++]=d[1],f=!1):f=!0,c[0]=d[0],c[1]=d[1],u=h;return(r&&f||l===e+n)&&(this.coordinates[s++]=c[0],this.coordinates[s++]=c[1]),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],l=this.appendFlatCoordinates(t,e,a,n,!1,!1);r.push(l),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,r,o,s,a,l=t.getType(),u=t.getStride(),h=this.coordinates.length;if(l==zf){n=(t=t).getOrientedFlatCoordinates(),s=[];var c=t.getEndss();a=0;for(var d=0,f=c.length;d<f;++d){var p=[];a=this.drawCustomCoordinates_(n,a,c[d],u,p),s.push(p)}this.instructions.push([wx.CUSTOM,h,s,t,i,ug])}else l==Uf||l==Vf?(o=[],n=l==Uf?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),u,o),this.instructions.push([wx.CUSTOM,h,o,t,i,lg])):l==Nf||l==Gf?(n=t.getFlatCoordinates(),r=this.appendFlatCoordinates(n,0,n.length,u,!1,!1),this.instructions.push([wx.CUSTOM,h,r,t,i,ag])):l==jf&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),r=this.coordinates.length,this.instructions.push([wx.CUSTOM,h,r,t,i]));this.endGeometry(t,e)},e.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[wx.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[wx.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){},e.prototype.fill_=function(t){if(this.alignFill_){var e=zp(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.setTransform.apply(t,Cy)},e.prototype.setStrokeStyle_=function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],iv&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))},e.prototype.renderDeclutter_=function(t,e){if(t&&t.length>5){var i=t[4];if(1==i||i==t.length-5){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(!this.declutterTree.collides(n)){this.declutterTree.insert(n);for(var r=5,o=t.length;r<o;++r){var s=t[r];s&&(s.length>11&&this.replayTextBackground_(s[0],s[13],s[14],s[15],s[16],s[11],s[12]),Ey.apply(void 0,s))}}t.length=5,Yd(t)}}},e.prototype.replay_=function(t,e,i,n,r,o,s){var a;this.pixelCoordinates_&&Ff(e,this.renderedTransform_)?a=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),a=Yf(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),Vp(this.renderedTransform_,e));for(var l,u,h,c,d,f,p,g,m,v,y,_,b=!Sc(i),w=0,x=n.length,S=0,C=0,E=0,T=null,I=null,A=this.coordinateCache_,k=this.viewRotation_,P={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:k},L=this.instructions!=n||this.overlaps?0:200;w<x;){var R=n[w];switch(R[0]){case wx.BEGIN_GEOMETRY:v=R[1],b&&i[vc(v)]||!v.getGeometry()?w=R[2]:void 0===s||vf(s,v.getGeometry().getExtent())?++w:w=R[2]+1;break;case wx.BEGIN_PATH:C>L&&(this.fill_(t),C=0),E>L&&(t.stroke(),E=0),C||E||(t.beginPath(),c=d=NaN),++w;break;case wx.CIRCLE:var F=a[S=R[1]],M=a[S+1],O=a[S+2]-F,D=a[S+3]-M,$=Math.sqrt(O*O+D*D);t.moveTo(F+$,M),t.arc(F,M,$,0,2*Math.PI,!0),++w;break;case wx.ELLIPSE:S=R[1],l=R[2];var j=a[S],N=a[S+1],B=a[S+2],U=a[S+3],G=a[S+4],V=a[S+5],z=a[S+6],q=a[S+7];if(l-S==8){var W=.2761424*(G-j),K=.2761424*(V-N),X=.2761424*(z-B),Y=.2761424*(q-U);t.moveTo(j,N),t.bezierCurveTo(j-X,N-Y,B-W,U-K,B,U),t.bezierCurveTo(B+W,U+K,G-X,V-Y,G,V),t.bezierCurveTo(G+X,V+Y,z+W,q+K,z,q),t.bezierCurveTo(z-W,q-K,j+X,N+Y,j,N)}++w;break;case wx.CLOSE_PATH:t.closePath(),++w;break;case wx.CUSTOM:S=R[1],l=R[2];var H=R[3],Z=R[4],J=6==R.length?R[5]:void 0;P.geometry=H,P.feature=v,w in A||(A[w]=[]);var Q=A[w];J?J(a,S,l,2,Q):(Q[0]=a[S],Q[1]=a[S+1],Q.length=2),Z(Q,P),++w;break;case wx.DRAW_IMAGE:S=R[1],l=R[2],m=R[3],u=R[4],h=R[5],g=o?null:R[6];var tt=R[7],et=R[8],it=R[9],nt=R[10],rt=R[11],ot=R[12],st=R[13],at=R[14],lt=void 0,ut=void 0,ht=void 0;for(R.length>16?(lt=R[15],ut=R[16],ht=R[17]):(lt=dy,ut=ht=!1),rt&&(ot+=k);S<l;S+=2)this.replayImage_(t,a[S],a[S+1],m,u,h,g,tt,et,it,nt,ot,st,r,at,lt,ut?T:null,ht?I:null);this.renderDeclutter_(g,v),++w;break;case wx.DRAW_CHARS:var ct=R[1],dt=R[2],ft=R[3];g=o?null:R[4];var pt=R[5],gt=R[6],mt=R[7],vt=R[8],yt=R[9],_t=R[10],bt=R[11],wt=R[12],xt=R[13],St=R[14],Ct=jg(a,ct,dt,2),Et=vt(wt);if(pt||Et<=Ct){var Tt=this,It=Tt.textStates[xt].textAlign,At=gx(a,ct,dt,2,wt,vt,(Ct-Et)*Sx[It],mt);if(At){var kt=void 0,Pt=void 0,Lt=void 0,Rt=void 0,Ft=void 0;if(_t)for(kt=0,Pt=At.length;kt<Pt;++kt)Lt=(Ft=At[kt])[4],Rt=Tt.getImage(Lt,xt,"",_t),u=Ft[2]+bt,h=ft*Rt.height+2*(.5-ft)*bt-yt,this.replayImage_(t,Ft[0],Ft[1],Rt,u,h,g,Rt.height,1,0,0,Ft[3],St,!1,Rt.width,dy,null,null);if(gt)for(kt=0,Pt=At.length;kt<Pt;++kt)Lt=(Ft=At[kt])[4],Rt=Tt.getImage(Lt,xt,gt,""),u=Ft[2],h=ft*Rt.height-yt,this.replayImage_(t,Ft[0],Ft[1],Rt,u,h,g,Rt.height,1,0,0,Ft[3],St,!1,Rt.width,dy,null,null)}}this.renderDeclutter_(g,v),++w;break;case wx.END_GEOMETRY:if(void 0!==o){var Mt=o(v=R[1]);if(Mt)return Mt}++w;break;case wx.FILL:L?C++:this.fill_(t),++w;break;case wx.MOVE_TO_LINE_TO:for(S=R[1],l=R[2],y=a[S],p=(_=a[S+1])+.5|0,(f=y+.5|0)===c&&p===d||(t.moveTo(y,_),c=f,d=p),S+=2;S<l;S+=2)f=(y=a[S])+.5|0,p=(_=a[S+1])+.5|0,S!=l-2&&f===c&&p===d||(t.lineTo(y,_),c=f,d=p);++w;break;case wx.SET_FILL_STYLE:T=R,this.alignFill_=R[2],C&&(this.fill_(t),C=0,E&&(t.stroke(),E=0)),t.fillStyle=R[1],++w;break;case wx.SET_STROKE_STYLE:I=R,E&&(t.stroke(),E=0),this.setStrokeStyle_(t,R),++w;break;case wx.STROKE:L?E++:t.stroke(),++w;break;default:++w}}C&&this.fill_(t),E&&t.stroke()},e.prototype.replay=function(t,e,i,n,r){this.viewRotation_=i,this.replay_(t,e,n,this.instructions,r,void 0,void 0)},e.prototype.replayHitDetection=function(t,e,i,n,r,o){return this.viewRotation_=i,this.replay_(t,e,n,this.hitDetectionInstructions,!0,r,o)},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==wx.END_GEOMETRY?o=t:n==wx.BEGIN_GEOMETRY&&(i[2]=t,Lf(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=iy(n||oy)}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=iy(r||uy);var o=e.getLineCap();i.lineCap=void 0!==o?o:sy;var s=e.getLineDash();i.lineDash=s?s.slice():ay;var a=e.getLineDashOffset();i.lineDashOffset=a||0;var l=e.getLineJoin();i.lineJoin=void 0!==l?l:ly;var u=e.getWidth();i.lineWidth=void 0!==u?u:1;var h=e.getMiterLimit();i.miterLimit=void 0!==h?h:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t,e){var i=t.fillStyle,n=[wx.SET_FILL_STYLE,i];return"string"!=typeof i&&n.push(!0),n},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[wx.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e,i){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t,i)),t.currentFillStyle=n)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!Ff(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=l)},e.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var i=[wx.END_GEOMETRY,e];this.instructions.push(i),this.hitDetectionInstructions.push(i)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ud(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Bd(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(Gw);const Ix=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawCoordinates_=function(t,e,i,n){return this.appendFlatCoordinates(t,e,i,n,!1,!1)},e.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([wx.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([wx.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(i,0,i.length,n);this.instructions.push([wx.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([wx.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0},e.prototype.setImageStyle=function(t,e){var i=t.getAnchor(),n=t.getSize(),r=t.getHitDetectionImage(1),o=t.getImage(1),s=t.getOrigin();this.anchorX_=i[0],this.anchorY_=i[1],this.declutterGroup_=e,this.hitDetectionImage_=r,this.image_=o,this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=n[0]},e}(Tx);const Ax=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinates_=function(t,e,i,n){var r=this.coordinates.length,o=this.appendFlatCoordinates(t,e,i,n,!1,!1),s=[wx.MOVE_TO_LINE_TO,r,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),i},e.prototype.drawLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([wx.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],_x);var o=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(o,0,o.length,s),this.hitDetectionInstructions.push(yx),this.endGeometry(t,e)}},e.prototype.drawMultiLineString=function(t,e){var i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0!==n&&void 0!==r){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([wx.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],_x);for(var o=t.getEnds(),s=t.getFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinates_(s,l,o[u],a);this.hitDetectionInstructions.push(yx),this.endGeometry(t,e)}},e.prototype.finish=function(){var t=this.state;null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(yx),this.reverseHitDetectionInstructions(),this.state=null},e.prototype.applyStroke=function(e){null!=e.lastStroke&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(yx),e.lastStroke=this.coordinates.length),e.lastStroke=0,t.prototype.applyStroke.call(this,e),this.instructions.push(_x)},e}(Tx);const kx=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawFlatCoordinatess_=function(t,e,i,n){var r=this.state,o=void 0!==r.fillStyle,s=null!=r.strokeStyle,a=i.length;this.instructions.push(_x),this.hitDetectionInstructions.push(_x);for(var l=0;l<a;++l){var u=i[l],h=this.coordinates.length,c=this.appendFlatCoordinates(t,e,u,n,!0,!s),d=[wx.MOVE_TO_LINE_TO,h,c];this.instructions.push(d),this.hitDetectionInstructions.push(d),s&&(this.instructions.push(bx),this.hitDetectionInstructions.push(bx)),e=u}return o&&(this.instructions.push(vx),this.hitDetectionInstructions.push(vx)),s&&(this.instructions.push(yx),this.hitDetectionInstructions.push(yx)),e},e.prototype.drawCircle=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([wx.SET_FILL_STYLE,Qv(oy)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([wx.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,s,!1,!1);var l=[wx.CIRCLE,a];this.instructions.push(_x,l),this.hitDetectionInstructions.push(_x,l),this.hitDetectionInstructions.push(vx),void 0!==i.fillStyle&&this.instructions.push(vx),void 0!==i.strokeStyle&&(this.instructions.push(yx),this.hitDetectionInstructions.push(yx)),this.endGeometry(t,e)}},e.prototype.drawEllipse=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([wx.SET_FILL_STYLE,Qv(oy)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([wx.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),s=this.coordinates.length;Array.prototype.push.apply(this.coordinates,o);var a=this.coordinates.length,l=[wx.BEGIN_PATH],u=[wx.ELLIPSE,s,a];this.instructions.push(l,u),this.hitDetectionInstructions.push(l,u);var h=[wx.FILL];if(this.hitDetectionInstructions.push(h),void 0!==i.fillStyle&&this.instructions.push(h),void 0!==i.strokeStyle){var c=[wx.STROKE];this.instructions.push(c),this.hitDetectionInstructions.push(c)}this.endGeometry(t,e)}},e.prototype.drawPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([wx.SET_FILL_STYLE,Qv(oy)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([wx.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getEnds(),s=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(s,0,o,a),this.endGeometry(t,e)}},e.prototype.drawMultiPolygon=function(t,e){var i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0!==n||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([wx.SET_FILL_STYLE,Qv(oy)]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([wx.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),s=t.getOrientedFlatCoordinates(),a=t.getStride(),l=0,u=0,h=o.length;u<h;++u)l=this.drawFlatCoordinatess_(s,l,o[u],a);this.endGeometry(t,e)}},e.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,i=0,n=e.length;i<n;++i)e[i]=dg(e[i],t)},e.prototype.setFillStrokeStyles_=function(t){var e=this.state;void 0!==e.fillStyle&&this.updateFillStyle(e,this.createFill,t),void 0!==e.strokeStyle&&this.updateStrokeStyle(e,this.applyStroke)},e}(Tx);function Px(t,e,i,n,r){var o,s,a,l,u,h,c,d,f,p=i,g=i,m=0,v=0,y=i;for(o=i;o<n;o+=r){var _=e[o],b=e[o+1];void 0!==l&&(d=_-l,f=b-u,a=Math.sqrt(d*d+f*f),void 0!==h&&(v+=s,Math.acos((h*d+c*f)/(s*a))>t&&(v>m&&(m=v,p=y,g=o),v=0,y=o-r)),s=a,h=d,c=f),l=_,u=b}return(v+=a)>m?[y,o]:[p,g]}const Lx="line";var Rx={Circle:kx,Default:Tx,Image:Ix,LineString:Ax,Polygon:kx,Text:function(t){function e(e,i,n,r,o,s){t.call(this,e,i,n,r,o,s),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={},fy.prune()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.drawText=function(t,e){var i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(i||n)){var o,s,a=this.coordinates.length,l=t.getType(),u=null,h=2,c=2;if(r.placement===Lx){if(!vf(this.getBufferedMaxExtent(),t.getExtent()))return;var d;if(u=t.getFlatCoordinates(),c=t.getStride(),l==Nf)d=[u.length];else if(l==Vf)d=t.getEnds();else if(l==Uf)d=t.getEnds().slice(0,1);else if(l==zf){var f=t.getEndss();for(d=[],o=0,s=f.length;o<s;++o)d.push(f[o][0])}this.beginGeometry(t,e);for(var p,g=r.textAlign,m=0,v=0,y=d.length;v<y;++v){if(null==g){var _=Px(r.maxAngle,u,m,d[v],c);m=_[0],p=_[1]}else p=d[v];for(o=m;o<p;o+=c)this.coordinates.push(u[o],u[o+1]);h=this.coordinates.length,m=d[v],this.drawChars_(a,h,this.declutterGroup_),a=h}this.endGeometry(t,e)}else{var b=this.getImage(this.text_,this.textKey_,this.fillKey_,this.strokeKey_),w=b.width/this.pixelRatio;switch(l){case jf:case Gf:h=(u=t.getFlatCoordinates()).length;break;case Nf:u=t.getFlatMidpoint();break;case Wf:u=t.getCenter();break;case Vf:h=(u=t.getFlatMidpoints()).length;break;case Uf:if(u=t.getFlatInteriorPoint(),!r.overflow&&u[2]/this.resolution<w)return;c=3;break;case zf:var x=t.getFlatInteriorPoints();for(u=[],o=0,s=x.length;o<s;o+=3)(r.overflow||x[o+2]/this.resolution>=w)&&u.push(x[o],x[o+1]);if(0==(h=u.length))return}h=this.appendFlatCoordinates(u,0,h,c,!1,!1),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill,t),this.hitDetectionInstructions.push(this.createFill(this.state,t))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e),this.drawTextImage_(b,a,h),this.endGeometry(t,e)}}},e.prototype.getImage=function(t,e,i,n){var r,o=n+e+t+i+this.pixelRatio;if(!fy.containsKey(o)){var s=n?this.strokeStates[n]||this.textStrokeState_:null,a=i?this.fillStates[i]||this.textFillState_:null,l=this.textStates[e]||this.textState_,u=this.pixelRatio,h=l.scale*u,c=Sx[l.textAlign||hy],d=n&&s.lineWidth?s.lineWidth:0,f=t.split("\n"),p=f.length,g=[],m=function(t,e,i){for(var n=e.length,r=0,o=0;o<n;++o){var s=xy(t,e[o]);r=Math.max(r,s),i.push(s)}return r}(l.font,f,g),v=wy(l.font),y=v*p,_=m+d,b=wd(Math.ceil(_*h),Math.ceil((y+d)*h));r=b.canvas,fy.set(o,r),1!=h&&b.scale(h,h),b.font=l.font,n&&(b.strokeStyle=s.strokeStyle,b.lineWidth=d,b.lineCap=s.lineCap,b.lineJoin=s.lineJoin,b.miterLimit=s.miterLimit,iv&&s.lineDash.length&&(b.setLineDash(s.lineDash),b.lineDashOffset=s.lineDashOffset)),i&&(b.fillStyle=a.fillStyle),b.textBaseline="middle",b.textAlign="center";var w,x=.5-c,S=c*r.width/h+x*d;if(n)for(w=0;w<p;++w)b.strokeText(f[w],S+x*g[w],.5*(d+v)+w*v);if(i)for(w=0;w<p;++w)b.fillText(f[w],S+x*g[w],.5*(d+v)+w*v)}return fy.get(o)},e.prototype.drawTextImage_=function(t,e,i){var n=this.textState_,r=this.textStrokeState_,o=this.pixelRatio,s=Sx[n.textAlign||hy],a=Sx[n.textBaseline],l=r&&r.lineWidth?r.lineWidth:0,u=s*t.width/o+2*(.5-s)*l,h=a*t.height/o+2*(.5-a)*l;this.instructions.push([wx.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*o,(h-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,t.width,n.padding==dy?dy:n.padding.map((function(t){return t*o})),!!n.backgroundFill,!!n.backgroundStroke]),this.hitDetectionInstructions.push([wx.DRAW_IMAGE,e,i,t,(u-this.textOffsetX_)*o,(h-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/o,t.width,n.padding,!!n.backgroundFill,!!n.backgroundStroke])},e.prototype.drawChars_=function(t,e,i){var n=this.textStrokeState_,r=this.textState_,o=this.textFillState_,s=this.strokeKey_;n&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:n.strokeStyle,lineCap:n.lineCap,lineDashOffset:n.lineDashOffset,lineWidth:n.lineWidth,lineJoin:n.lineJoin,miterLimit:n.miterLimit,lineDash:n.lineDash}));var a=this.textKey_;this.textKey_ in this.textStates||(this.textStates[this.textKey_]={font:r.font,textAlign:r.textAlign||hy,scale:r.scale});var l=this.fillKey_;o&&(l in this.fillStates||(this.fillStates[l]={fillStyle:o.fillStyle}));var u=this.pixelRatio,h=Sx[r.textBaseline],c=this.textOffsetY_*u,d=this.text_,f=r.font,p=r.scale,g=n?n.lineWidth*p/2:0,m=this.widths_[f];m||(this.widths_[f]=m={}),this.instructions.push([wx.DRAW_CHARS,t,e,h,i,r.overflow,l,r.maxAngle,function(t){var e=m[t];return e||(e=m[t]=xy(f,t)),e*p*u},c,s,g*u,d,a,1]),this.hitDetectionInstructions.push([wx.DRAW_CHARS,t,e,h,i,r.overflow,l,r.maxAngle,function(t){var e=m[t];return e||(e=m[t]=xy(f,t)),e*p},c,s,g,d,a,1/u])},e.prototype.setTextStyle=function(t,e){var i,n,r;if(t){this.declutterGroup_=e;var o=t.getFill();o?((n=this.textFillState_)||(n=this.textFillState_={}),n.fillStyle=iy(o.getColor()||oy)):n=this.textFillState_=null;var s=t.getStroke();if(s){(r=this.textStrokeState_)||(r=this.textStrokeState_={});var a=s.getLineDash(),l=s.getLineDashOffset(),u=s.getWidth(),h=s.getMiterLimit();r.lineCap=s.getLineCap()||sy,r.lineDash=a?a.slice():ay,r.lineDashOffset=void 0===l?0:l,r.lineJoin=s.getLineJoin()||ly,r.lineWidth=void 0===u?1:u,r.miterLimit=void 0===h?10:h,r.strokeStyle=iy(s.getColor()||uy)}else r=this.textStrokeState_=null;i=this.textState_;var c=t.getFont()||ry;vy(c);var d=t.getScale();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||cy,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||dy,i.scale=void 0===d?1:d;var f=t.getOffsetX(),p=t.getOffsetY(),g=t.getRotateWithView(),m=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===p?0:p,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===m?0:m,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:vc(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+vc(n.fillStyle):""}else this.text_=""},e}(Tx),Ellipse:kx},Fx=function(t){function e(e,i,n,r,o,s,a){t.call(this),this.declutterTree_=s,this.declutterGroup_=null,this.tolerance_=e,this.maxExtent_=i,this.overlaps_=o,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=a,this.replaysByZIndex_={},this.hitDetectionContext_=wd(1,1),this.hitDetectionTransform_=[1,0,0,1,0,0]}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addDeclutter=function(t){var e=null;return this.declutterTree_&&(t?(e=this.declutterGroup_)[4]++:(e=this.declutterGroup_=[1/0,1/0,-1/0,-1/0]).push(1)),e},e.prototype.clip=function(t,e){var i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},e.prototype.hasReplays=function(t){for(var e in this.replaysByZIndex_)for(var i=this.replaysByZIndex_[e],n=0,r=t.length;n<r;++n)if(t[n]in i)return!0;return!1},e.prototype.finish=function(){for(var t in this.replaysByZIndex_){var e=this.replaysByZIndex_[t];for(var i in e)e[i].finish()}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r,o,s){var a,l=2*(n=Math.round(n))+1,u=Kp(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=this.hitDetectionContext_;h.canvas.width!==l||h.canvas.height!==l?(h.canvas.width=l,h.canvas.height=l):h.clearRect(0,0,l,l),void 0!==this.renderBuffer_&&(tf(a=[1/0,1/0,-1/0,-1/0],t),Bd(a,e*(this.renderBuffer_+n),a));var c,d,f=function(t){if(void 0!==Mx[t])return Mx[t];for(var e=2*t+1,i=new Array(e),n=0;n<e;n++)i[n]=new Array(e);var r=t,o=0,s=0;for(;r>=o;)Ox(i,t+r,t+o),Ox(i,t+o,t+r),Ox(i,t-o,t+r),Ox(i,t-r,t+o),Ox(i,t-r,t-o),Ox(i,t-o,t-r),Ox(i,t+o,t-r),Ox(i,t+r,t-o),2*((s+=1+2*++o)-r)+1>0&&(s+=1-2*(r-=1));return Mx[t]=i,i}(n);function p(t){for(var e=h.getImageData(0,0,l,l).data,i=0;i<l;i++)for(var n=0;n<l;n++)if(f[i][n]&&e[4*(n*l+i)+3]>0){var r=void 0;return(!c||d!=hx&&d!=fx||-1!==c.indexOf(t))&&(r=o(t)),r||void h.clearRect(0,0,l,l)}}this.declutterTree_&&(c=this.declutterTree_.all().map((function(t){return t.value})));var g,m,v,y,_,b=Object.keys(this.replaysByZIndex_).map(Number);for(b.sort(Af),g=b.length-1;g>=0;--g){var w=b[g].toString();for(v=this.replaysByZIndex_[w],m=xx.length-1;m>=0;--m)if(void 0!==(y=v[d=xx[m]]))if(!s||d!=hx&&d!=fx){if(_=y.replayHitDetection(h,u,i,r,p,a))return _}else{var x=s[w];x?x.push(y,u.slice(0)):s[w]=[y,u.slice(0)]}}},e.prototype.getClipCoords=function(t){var e=this.maxExtent_,i=e[0],n=e[1],r=e[2],o=e[3],s=[i,n,i,o,r,o,r,n];return Yf(s,0,8,2,t,s),s},e.prototype.getReplay=function(t,e){var i=void 0!==t?t.toString():"0",n=this.replaysByZIndex_[i];void 0===n&&(n={},this.replaysByZIndex_[i]=n);var r=n[e];void 0===r&&(r=new(0,Rx[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),n[e]=r);return r},e.prototype.getReplays=function(){return this.replaysByZIndex_},e.prototype.isEmpty=function(){return Sc(this.replaysByZIndex_)},e.prototype.replay=function(t,e,i,n,r,o,s){var a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(Af),t.save(),this.clip(t,e);var l,u,h,c,d,f,p=o||xx;for(l=0,u=a.length;l<u;++l){var g=a[l].toString();for(d=this.replaysByZIndex_[g],h=0,c=p.length;h<c;++h){var m=p[h];if(f=d[m],void 0!==f)if(!s||m!=hx&&m!=fx)f.replay(t,e,i,n,r);else{var v=s[g];v?v.push(f,e.slice(0)):s[g]=[f,e.slice(0)]}}}t.restore()},e}(ax),Mx={0:[[!0]]};function Ox(t,e,i){var n,r=Math.floor(t.length/2);if(e>=r)for(n=r;n<e;n++)t[n][i]=!0;else if(e<r)for(n=e+1;n<r;n++)t[n][i]=!0}const Dx=Fx;var $x={Point:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=fm)return;var o=t.getReplay(i.getZIndex(),hx);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),fx);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},LineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),cx);o.setFillStrokeStyle(null,r),o.drawLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),fx);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},Polygon:Vx,MultiPoint:function(t,e,i,n){var r=i.getImage();if(r){if(r.getImageState()!=fm)return;var o=t.getReplay(i.getZIndex(),hx);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),fx);a.setTextStyle(s,t.addDeclutter(!!r)),a.drawText(e,n)}},MultiLineString:function(t,e,i,n){var r=i.getStroke();if(r){var o=t.getReplay(i.getZIndex(),cx);o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,n)}var s=i.getText();if(s){var a=t.getReplay(i.getZIndex(),fx);a.setTextStyle(s,t.addDeclutter(!1)),a.drawText(e,n)}},MultiPolygon:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(o||r){var s=t.getReplay(i.getZIndex(),dx);s.setFillStrokeStyle(r,o),s.drawMultiPolygon(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),fx);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},GeometryCollection:function(t,e,i,n){var r,o,s=e.getGeometriesArray();for(r=0,o=s.length;r<o;++r){(0,$x[s[r].getType()])(t,s[r],i,n)}},Circle:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),lx);s.setFillStrokeStyle(r,o),s.drawCircle(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),fx);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}},Rectangle:Vx,Ellipse:function(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),px);s.setFillStrokeStyle(r,o),s.drawEllipse(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),fx);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}}};function jx(t,e){return parseInt(vc(t),10)-parseInt(vc(e),10)}function Nx(t,e){var i=Bx(t,e);return i*i}function Bx(t,e){return.5*t/e}function Ux(t,e,i,n,r,o){var s=!1,a=i.getImage();if(a){var l=a.getImageState();l==fm||l==pm?a.unlistenImageChange(r,o):(l==cm&&a.load(),l=a.getImageState(),a.listenImageChange(r,o),s=!0)}return function(t,e,i,n){var r=i.getGeometryFunction()(e);if(!r)return;var o=r.getSimplifiedGeometry(n);if(i.getRenderer())Gx(t,o,i,e);else{(0,$x[o.getType()])(t,o,i,e)}}(t,e,i,n),s}function Gx(t,e,i,n){if(e.getType()!=qf)t.getReplay(i.getZIndex(),ux).drawCustom(e,n,i.getRenderer());else for(var r=e.getGeometries(),o=0,s=r.length;o<s;++o)Gx(t,r[o],i,n)}function Vx(t,e,i,n){var r=i.getFill(),o=i.getStroke();if(r||o){var s=t.getReplay(i.getZIndex(),dx);s.setFillStrokeStyle(r,o),s.drawPolygon(e,n)}var a=i.getText();if(a){var l=t.getReplay(i.getZIndex(),fx);l.setTextStyle(a,t.addDeclutter(!1)),l.drawText(e,n)}}var zx=function(t){function e(e){t.call(this,e),this.declutterTree_=e.getDeclutter()?Qy()(9,void 0):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.context=wd(),Ac(fy,Gc,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){Pc(fy,Gc,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.compose=function(t,e,i){var n=e.extent,r=e.pixelRatio,o=i.managed?e.skippedFeatureUids:{},s=e.viewState,a=s.projection,l=s.rotation,u=a.getExtent(),h=this.getLayer().getSource(),c=this.getTransform(e,0),d=i.extent,f=void 0!==d;f&&this.clip(t,e,d);var p=this.replayGroup_;if(p&&!p.isEmpty()){this.declutterTree_&&this.declutterTree_.clear();var g,m=this.getLayer(),v=0,y=0,_=1!==i.opacity,b=m.hasListener(qv);if(_||b){var w=t.canvas.width,x=t.canvas.height;if(l){var S=Math.round(Math.sqrt(w*w+x*x));v=(S-w)/2,y=(S-x)/2,w=x=S}this.context.canvas.width=w,this.context.canvas.height=x,g=this.context}else g=t;var C=g.globalAlpha;_||(g.globalAlpha=i.opacity),g!=t&&g.translate(v,y);var E=e.viewHints,T=!(E[Xb]||E[Yb]),I=e.size[0]*r,A=e.size[1]*r;if(Sy(g,-l,I/2,A/2),p.replay(g,c,l,o,T),h.getWrapX()&&a.canWrapX()&&!zd(u,n)){for(var k,P=n[0],L=mf(u),R=0;P<u[0];)k=L*--R,c=this.getTransform(e,k),p.replay(g,c,l,o,T),P+=L;for(R=0,P=n[2];P>u[2];)k=L*++R,c=this.getTransform(e,k),p.replay(g,c,l,o,T),P-=L}if(Sy(g,l,I/2,A/2),b&&this.dispatchRenderEvent(g,e,c),g!=t){if(_){var F=t.globalAlpha;t.globalAlpha=i.opacity,t.drawImage(g.canvas,-v,-y),t.globalAlpha=F}else t.drawImage(g.canvas,-v,-y);g.translate(-v,-y)}_||(g.globalAlpha=C)}f&&t.restore()},e.prototype.composeFrame=function(t,e,i){var n=this.getTransform(t,0);this.preCompose(i,t,n),this.compose(i,t,e),this.postCompose(i,t,e,n)},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){if(this.replayGroup_){var o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),l={};return this.replayGroup_.forEachFeatureAtCoordinate(t,o,s,i,{},(function(t){var e=vc(t);if(!(e in l))return l[e]=!0,n.call(r,t,a)}),null)}},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.prepareFrame=function(t,e){var i=this.getLayer(),n=i.getSource(),r=t.viewHints[Xb],o=t.viewHints[Yb],s=i.getUpdateWhileAnimating(),a=i.getUpdateWhileInteracting();if(!this.dirty_&&!s&&r||!a&&o)return!0;var l=t.extent,u=t.viewState,h=u.projection,c=u.resolution,d=t.pixelRatio,f=i.getRevision(),p=i.getRenderBuffer(),g=i.getRenderOrder();void 0===g&&(g=jx);var m=Bd(l,p*c),v=u.projection.getExtent();if(n.getWrapX()&&u.projection.canWrapX()&&!zd(v,t.extent)){var y=mf(v),_=Math.max(mf(m)/2,y);m[0]=v[0]-_,m[2]=v[2]+_}if(!this.dirty_&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&zd(this.renderedExtent_,m))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var b=new Dx(Bx(c,d),m,c,d,n.getOverlaps(),this.declutterTree_,i.getRenderBuffer());n.loadFeatures(m,c,h);var w=function(t){var e,n=t.getStyleFunction()||i.getStyleFunction();if(n&&(e=n(t,c)),e){var r=this.renderFeature(t,c,d,e,b);this.dirty_=this.dirty_||r}}.bind(this);if(g){var x=[];n.forEachFeatureInExtent(m,(function(t){x.push(t)})),x.sort(g);for(var S=0,C=x.length;S<C;++S)w(x[S])}else n.forEachFeatureInExtent(m,w);return b.finish(),this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=g,this.renderedExtent_=m,this.replayGroup_=b,this.replayGroupChanged=!0,!0},e.prototype.renderFeature=function(t,e,i,n,r){if(!n)return!1;var o=!1;if(Array.isArray(n))for(var s=0,a=n.length;s<a;++s)o=Ux(r,t,n[s],Nx(e,i),this.handleStyleImageChange_,this)||o;else o=Ux(r,t,n,Nx(e,i),this.handleStyleImageChange_,this);return o},e}(Zw);zx.handles=function(t){return t.getType()===Mv},zx.create=function(t,e){return new zx(e)};const qx=zx,Wx="image",Kx="vector";var Xx={image:[dx,lx,cx,hx,fx],hybrid:[dx,cx]},Yx={image:[ux],hybrid:[hx,fx,ux],vector:xx},Hx=function(t){function e(e){t.call(this,e,!0),this.declutterTree_=e.getDeclutter()?Qy()(9,void 0):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=[1,0,0,1,0,0];var i=e.getRenderMode();this.zDirection=i===Kx?1:0,i!==Kx&&(this.context=wd()),Ac(fy,Gc,this.handleFontsChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){Pc(fy,Gc,this.handleFontsChanged_,this),t.prototype.disposeInternal.call(this)},e.prototype.getTile=function(e,i,n,r,o){var s=t.prototype.getTile.call(this,e,i,n,r,o);return s.getState()===$b&&(this.createReplayGroup_(s,r,o),this.context&&this.renderTileImage_(s,r,o)),s},e.prototype.getTileImage=function(t){var e=this.getLayer();return t.getImage(e)},e.prototype.prepareFrame=function(e,i){var n=this.getLayer().getRevision();return this.renderedLayerRevision_!=n&&(this.renderedTiles.length=0),this.renderedLayerRevision_=n,t.prototype.prepareFrame.call(this,e,i)},e.prototype.createReplayGroup_=function(t,e,i){var n=this,r=this.getLayer(),o=r.getRevision(),s=r.getRenderOrder()||null,a=t.getReplayState(r);if(a.dirty||a.renderedRevision!=o||a.renderedRenderOrder!=s){for(var l=r.getSource(),u=l.getTileGrid(),h=l.getTileGridForProjection(i).getResolution(t.tileCoord[0]),c=t.extent,d=function(o,d){var f=t.getTile(t.tileKeys[o]);if(f.getState()==$b){var p=f.tileCoord,g=u.getTileCoordExtent(p),m=ff(c,g),v=Jd(g,m)?null:Bd(m,r.getRenderBuffer()*h,n.tmpExtent),y=f.getProjection(),_=!1;Op(i,y)||(_=!0,f.setProjection(i)),a.dirty=!1;var b=new Dx(0,m,h,e,l.getOverlaps(),n.declutterTree_,r.getRenderBuffer()),w=Nx(h,e),x=function(t){var e,i=t.getStyleFunction()||r.getStyleFunction();if(i&&(e=i(t,h)),e){var n=this.renderFeature(t,w,e,b);this.dirty_=this.dirty_||n,a.dirty=a.dirty||n}},S=f.getFeatures();s&&s!==a.renderedRenderOrder&&S.sort(s);for(var C=0,E=S.length;C<E;++C){var T=S[C];_&&(y.getUnits()==ap.TILE_PIXELS&&(y.setWorldExtent(g),y.setExtent(f.getExtent())),T.getGeometry().transform(y,i)),v&&!vf(v,T.getGeometry().getExtent())||x.call(n,T)}b.finish(),f.setReplayGroup(r,t.tileCoord.toString(),b)}},f=0,p=t.tileKeys.length;f<p;++f)d(f);a.renderedRevision=o,a.renderedRenderOrder=s}},e.prototype.forEachFeatureAtCoordinate=function(t,e,i,n,r){var o=e.viewState.resolution,s=e.viewState.rotation;i=null==i?0:i;var a,l,u,h,c=this.getLayer(),d={},f=this.renderedTiles;for(u=0,h=f.length;u<h;++u){var p=f[u];if(Vd(a=Bd(p.extent,i*o,a),t))for(var g=0,m=p.tileKeys.length;g<m;++g){var v=p.getTile(p.tileKeys[g]);if(v.getState()==$b){var y=v.getReplayGroup(c,p.tileCoord.toString());l=l||y.forEachFeatureAtCoordinate(t,o,s,i,{},(function(t){var e=vc(t);if(!(e in d))return d[e]=!0,n.call(r,t,c)}),null)}}}return l},e.prototype.getReplayTransform_=function(t,e){var i=this.getLayer().getSource().getTileGrid(),n=t.tileCoord,r=i.getResolution(n[0]),o=e.viewState,s=e.pixelRatio,a=o.resolution/s,l=i.getTileCoordExtent(n,this.tmpExtent),u=o.center,h=pf(l),c=e.size,d=Math.round(s*c[0]/2),f=Math.round(s*c[1]/2);return Kp(this.tmpTransform_,d,f,r/a,r/a,o.rotation,(h[0]-u[0])/r,(u[1]-h[1])/r)},e.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},e.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},e.prototype.postCompose=function(e,i,n){var r=this.getLayer(),o=r.getRenderMode();if(o!=Wx){var s,a,l=r.getDeclutter()?{}:null,u=r.getSource(),h=Yx[o],c=i.pixelRatio,d=i.viewState.rotation,f=i.size;d&&Sy(e,-d,s=Math.round(c*f[0]/2),a=Math.round(c*f[1]/2)),l&&this.declutterTree_.clear();for(var p=i.viewHints,g=!(p[Xb]||p[Yb]),m=this.renderedTiles,v=u.getTileGridForProjection(i.viewState.projection),y=[],_=[],b=m.length-1;b>=0;--b){var w=m[b];if(w.getState()!=Bb)for(var x=w.tileCoord,S=v.getTileCoordExtent(x,this.tmpExtent)[0]-w.extent[0],C=void 0,E=0,T=w.tileKeys.length;E<T;++E){var I=w.getTile(w.tileKeys[E]);if(I.getState()==$b){var A=I.getReplayGroup(r,x.toString());if(A&&A.hasReplays(h)){C||(C=this.getTransform(i,S));var k=I.tileCoord[0],P=A.getClipCoords(C);e.save(),e.globalAlpha=n.opacity;for(var L=0,R=y.length;L<R;++L){var F=y[L];k<_[L]&&(e.beginPath(),e.moveTo(P[0],P[1]),e.lineTo(P[2],P[3]),e.lineTo(P[4],P[5]),e.lineTo(P[6],P[7]),e.moveTo(F[6],F[7]),e.lineTo(F[4],F[5]),e.lineTo(F[2],F[3]),e.lineTo(F[0],F[1]),e.clip())}A.replay(e,C,d,{},g,h,l),e.restore(),y.push(P),_.push(k)}}}}l&&function(t,e,i,n){for(var r=Object.keys(t).map(Number).sort(Af),o={},s=0,a=r.length;s<a;++s)for(var l=t[r[s].toString()],u=0,h=l.length;u<h;){var c=l[u++],d=l[u++];c.replay(e,d,i,o,n)}}(l,e,d,g),d&&Sy(e,d,s,a)}t.prototype.postCompose.call(this,e,i,n)},e.prototype.renderFeature=function(t,e,i,n){if(!i)return!1;var r=!1;if(Array.isArray(i))for(var o=0,s=i.length;o<s;++o)r=Ux(n,t,i[o],e,this.handleStyleImageChange_,this)||r;else r=Ux(n,t,i,e,this.handleStyleImageChange_,this);return r},e.prototype.renderTileImage_=function(t,e,i){var n=this.getLayer(),r=t.getReplayState(n),o=n.getRevision(),s=Xx[n.getRenderMode()];if(s&&r.renderedTileRevision!==o){r.renderedTileRevision=o;var a=t.wrappedTileCoord,l=a[0],u=n.getSource(),h=u.getTileGridForProjection(i),c=h.getResolution(l),d=t.getContext(n),f=u.getTilePixelSize(l,e,i);d.canvas.width=f[0],d.canvas.height=f[1];for(var p=h.getTileCoordExtent(a,this.tmpExtent),g=0,m=t.tileKeys.length;g<m;++g){var v=t.getTile(t.tileKeys[g]);if(v.getState()==$b){var y=e/c,_=Bp(this.tmpTransform_);qp(_,y,-y),Wp(_,-p[0],-p[3]),v.getReplayGroup(n,t.tileCoord.toString()).replay(d,_,0,{},!0,s)}}}},e}(ox);Hx.handles=function(t){return t.getType()===Fv},Hx.create=function(t,e){return new Hx(e)};const Zx=Hx;const Jx=function(t){function e(e){(e=bc({},e)).controls||(e.controls=function(t){var e=t||{},i=new $m;return(void 0===e.zoom||e.zoom)&&i.push(new dw(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&i.push(new cw(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&i.push(new uw(e.attributionOptions)),i}()),e.interactions||(e.interactions=Nw()),t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createRenderer=function(){var t=new Hw(this);return t.registerLayerRenderers([tx,ox,qx,Zx]),t},e}(ow);var Qx,tS;const eS=Ml({data:function(){return{hasMeasureFeature:!1,measureFeaturePosition:[0,0]}},computed:{isMeasuring:function(){return"measure"===this.interactionMode}},methods:{toggleMeasuring:function(){this.isMeasuring?this.resetInteractionMode():this.interactionMode="measure"},handleMeasureDrawStart:function(t){Qx.getSource().clear(),this.setMeasureFeature(t.feature)},updateMeasureFeature:function(t){this.measureFeaturePosition=t.target.getGeometry().getLastCoordinate(),this.$emit("changeMeasureFeature",[t.target])},setMeasureFeature:function(t){this.measureFeature=t,this.hasMeasureFeature=!!t,t&&(this.updateMeasureFeature({target:t}),t.on("change",this.updateMeasureFeature))}},watch:{isMeasuring:function(t){t?(this.map.addLayer(Qx),this.map.addInteraction(tS),this.$emit("measuring")):(Qx.getSource().clear(),this.setMeasureFeature(void 0),this.map.removeLayer(Qx),this.map.removeInteraction(tS))},image:function(){this.isMeasuring&&this.$nextTick((function(){this.updateMeasureFeature({target:this.measureFeature})}))}},created:function(){Qx=new Uy({source:new n_,style:A_.editing,zIndex:200,updateWhileAnimating:!0,updateWhileInteracting:!0}),(tS=new g_({source:Qx.getSource(),type:"LineString",style:Qx.getStyle()})).on("drawstart",this.handleMeasureDrawStart),xu.on("Shift+f",this.toggleMeasuring,0,this.listenerSet),this.measureFeature=void 0}},undefined,undefined,!1,null,null,null).exports;const iS=Ml({props:{extent:{type:Array,required:!0},intendedWidth:{type:Number,default:250},intendedHeight:{type:Number,default:200}},data:function(){return{}},computed:{minimap:function(){return new Jx({controls:[],interactions:[]})},viewport:function(){return new Nm}},methods:{updateViewport:function(){this.mapSize&&this.mapView.getCenter()&&this.viewport.setGeometry(Rg(this.mapView.calculateExtent(this.mapSize)))},dragViewport:function(t){this.mapView.setCenter(t.coordinate)},updateMapSize:function(t){this.mapSize=t.target.getSize()},updateMapView:function(t){this.mapView&&(this.mapView.un("change:center",this.updateViewport),this.mapView.un("change:resolution",this.updateViewport)),this.mapView=t.target.getView(),this.mapView.on("change:center",this.updateViewport),this.mapView.on("change:resolution",this.updateViewport)},updateElementSize:function(){var t=this.extent[2],e=this.extent[3],i=Math.max(t/this.intendedWidth,e/this.intendedHeight);this.minimap.setView(new ew({projection:this.mapView.getProjection(),center:uf(this.extent),resolution:i})),this.$el.style.width=Math.round(t/i)+"px",this.$el.style.height=Math.round(e/i)+"px",this.minimap.updateSize()},refreshImageLayer:function(t){var e=t.element.get("name");if(e&&e.startsWith("image")){var i=this.minimap.getLayers();i.getLength()>1?i.setAt(0,t.element):i.insertAt(0,t.element)}},initImageLayer:function(t){var e=this;t.getArray().forEach((function(t){e.refreshImageLayer({element:t})}))}},watch:{extent:function(){this.updateElementSize()}},created:function(){var t=new n_;t.addFeature(this.viewport);var e=this.$parent.map;this.mapSize=e.getSize(),this.updateMapView({target:e}),e.on("change:size",this.updateMapSize),e.on("change:view",this.updateMapView),e.once("postcompose",this.updateViewport),this.minimap.addLayer(new Uy({source:t,style:A_.viewport})),e.getLayers().on("add",this.refreshImageLayer),this.minimap.on("pointerdrag",this.dragViewport),this.minimap.on("click",this.dragViewport),this.initImageLayer(e.getLayers())},mounted:function(){this.updateElementSize(),this.minimap.setTarget(this.$el),this.updateViewport()},beforeDestroy:function(){var t=this.$parent.map;this.mapView.un("change:center",this.updateViewport),this.mapView.un("change:resolution",this.updateViewport),t.un("change:size",this.updateMapSize),t.un("change:view",this.updateMapView),t.getLayers().un("add",this.refreshImageLayer)}},(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"minimap"})}),[],!1,null,null,null).exports;var nS="modifystart",rS="modifyend",oS=function(t){function e(e,i,n){t.call(this,e),this.features=i,this.mapBrowserEvent=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);function sS(t,e){return t.index-e.index}function aS(t,e){var i,n,r=e.geometry;if(r.getType()===Wf){var o=r;if(1===e.index){var s=Xm(o.getCenter(),t),a=Math.sqrt(s)-o.getRadius();return a*a}}return i=t,n=e.segment,Xm(i,zm(i,n))}function lS(t,e){var i=e.geometry;return i.getType()===Wf&&1===e.index||i.getType()===Xf||i.getType()===Kf?i.getClosestPoint(t):zm(t,e.segment)}function uS(){var t=Dy();return function(e,i){return t[jf]}}const hS=function(t){function e(e){var i;if(t.call(this,e),this.condition_=e.condition?e.condition:vv,this.defaultDeleteCondition_=function(t){return function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}(t)&&dv(t)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:lv,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.modified_=!1,this.rBush_=new e_,this.pixelTolerance_=void 0!==e.pixelTolerance?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Uy({source:new n_({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:uS(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_,LineString:this.writeLineStringGeometry_,LinearRing:this.writeLineStringGeometry_,Polygon:this.writePolygonGeometry_,MultiPoint:this.writeMultiPointGeometry_,MultiLineString:this.writeMultiLineStringGeometry_,MultiPolygon:this.writeMultiPolygonGeometry_,Rectangle:this.writePolygonGeometry_,Ellipse:this.writePolygonGeometry_,Circle:this.writeCircleGeometry_,GeometryCollection:this.writeGeometryCollectionGeometry_},this.source_=null,e.source?(this.source_=e.source,i=new $m(this.source_.getFeatures()),Ac(this.source_,Xy,this.handleSourceAdd_,this),Ac(this.source_,Zy,this.handleSourceRemove_,this)):i=e.features,!i)throw new Error("The modify interaction requires features or a source");this.features_=i,this.features_.forEach(this.addFeature_.bind(this)),Ac(this.features_,Fm,this.handleFeatureAdd_,this),Ac(this.features_,Mm,this.handleFeatureRemove_,this),this.lastPointerEvent_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeature_=function(t){var e=t.getGeometry();e&&e.getType()in this.SEGMENT_WRITERS_&&this.SEGMENT_WRITERS_[e.getType()].call(this,t,e);var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),Ac(t,Uc,this.handleFeatureChange_,this)},e.prototype.willModifyFeatures_=function(t){this.modified_||(this.modified_=!0,this.dispatchEvent(new oS(nS,this.features_,t)))},e.prototype.removeFeature_=function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),Pc(t,Uc,this.handleFeatureChange_,this)},e.prototype.removeFeatureSegmentData_=function(t){var e=this.rBush_,i=[];e.forEach((function(e){t===e.feature&&i.push(e)}));for(var n=i.length-1;n>=0;--n)e.remove(i[n])},e.prototype.setActive=function(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.overlay_.setMap(e),t.prototype.setMap.call(this,e)},e.prototype.getOverlay=function(){return this.overlay_},e.prototype.handleSourceAdd_=function(t){t.feature&&this.features_.push(t.feature)},e.prototype.handleSourceRemove_=function(t){t.feature&&this.features_.remove(t.feature)},e.prototype.handleFeatureAdd_=function(t){this.addFeature_(t.element)},e.prototype.handleFeatureChange_=function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}},e.prototype.handleFeatureRemove_=function(t){var e=t.element;this.removeFeature_(e)},e.prototype.writePointGeometry_=function(t,e){var i=e.getCoordinates(),n={feature:t,geometry:e,segment:[i,i]};this.rBush_.insert(e.getExtent(),n)},e.prototype.writeMultiPointGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n){var o=i[n],s={feature:t,geometry:e,depth:[n],index:n,segment:[o,o]};this.rBush_.insert(e.getExtent(),s)}},e.prototype.writeLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length-1;n<r;++n){var o=i.slice(n,n+2),s={feature:t,geometry:e,index:n,segment:o};this.rBush_.insert(Nd(o),s)}},e.prototype.writeMultiLineStringGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(Nd(l),u)}},e.prototype.writePolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length-1;s<a;++s){var l=o.slice(s,s+2),u={feature:t,geometry:e,depth:[n],index:s,segment:l};this.rBush_.insert(Nd(l),u)}},e.prototype.writeMultiPolygonGeometry_=function(t,e){for(var i=e.getCoordinates(),n=0,r=i.length;n<r;++n)for(var o=i[n],s=0,a=o.length;s<a;++s)for(var l=o[s],u=0,h=l.length-1;u<h;++u){var c=l.slice(u,u+2),d={feature:t,geometry:e,depth:[s,n],index:u,segment:c};this.rBush_.insert(Nd(c),d)}},e.prototype.writeCircleGeometry_=function(t,e){var i=e.getCenter(),n={feature:t,geometry:e,index:0,segment:[i,i]},r={feature:t,geometry:e,index:1,segment:[i,i]},o=[n,r];n.featureSegments=r.featureSegments=o,this.rBush_.insert(Hd(i),n),this.rBush_.insert(e.getExtent(),r)},e.prototype.writeGeometryCollectionGeometry_=function(t,e){for(var i=e.getGeometriesArray(),n=0;n<i.length;++n)this.SEGMENT_WRITERS_[i[n].getType()].call(this,t,i[n])},e.prototype.createOrUpdateVertexFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new Nm(new vg(t)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e));return e},e.prototype.handleEvent=function(e){return!e.pointerEvent||(this.lastPointerEvent_=e,e.map.getView().getInteracting()||e.type!=Gg.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(i=!(e.type!=Gg.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),e.type==Gg.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),t.prototype.handleEvent.call(this,e)&&!i);var i},e.prototype.handleDragEvent=function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t);for(var e=t.coordinate,i=0,n=this.dragSegments_.length;i<n;++i){for(var r=this.dragSegments_[i],o=r[0],s=o.depth,a=o.geometry,l=void 0,u=o.segment,h=r[1];e.length<a.getStride();)e.push(u[h][e.length]);switch(a.getType()){case jf:l=e,u[0]=u[1]=e;break;case Gf:(l=a.getCoordinates())[o.index]=e,u[0]=u[1]=e;break;case Nf:(l=a.getCoordinates())[o.index+h]=e,u[h]=e;break;case Vf:case Uf:(l=a.getCoordinates())[s[0]][o.index+h]=e,u[h]=e;break;case zf:(l=a.getCoordinates())[s[1]][s[0]][o.index+h]=e,u[h]=e;break;case Kf:var c=(v=(l=a.getCoordinates())[s[0]])[(o.index+h+2)%4],d=[e[0]-c[0],e[1]-c[1]],f=[(y=v[(o.index+h+1)%4])[0]-c[0],y[1]-c[1]],p=Math.sqrt(f[0]*f[0]+f[1]*f[1]);f[0]=f[0]/p,f[1]=f[1]/p;var g=d[0]*f[0]+d[1]*f[1];v[(o.index+h+1)%4]=[c[0]+g*f[0],c[1]+g*f[1]];var m=[(_=v[(o.index+h+3)%4])[0]-c[0],_[1]-c[1]];p=Math.sqrt(m[0]*m[0]+m[1]*m[1]),m[0]=m[0]/p,m[1]=m[1]/p,g=d[0]*m[0]+d[1]*m[1],v[(o.index+h+3)%4]=[c[0]+g*m[0],c[1]+g*m[1]],v[o.index+h]=e;break;case Xf:var v,y=(v=(l=a.getCoordinates())[s[0]])[(o.index+h+1)%4],_=(c=v[(o.index+h+2)%4],v[(o.index+h+3)%4]),b=Math.sqrt(Math.pow(y[0]-_[0],2)+Math.pow(y[1]-_[1],2))/2,w=[e[0]-c[0],e[1]-c[1]],x=[-1*w[1],w[0]];p=Math.sqrt(x[0]*x[0]+x[1]*x[1]);x[0]=x[0]/p,x[1]=x[1]/p;var S=[c[0]+w[0]/2,c[1]+w[1]/2];v[(o.index+h+1)%4]=[S[0]+x[0]*b,S[1]+x[1]*b],v[(o.index+h+3)%4]=[S[0]-x[0]*b,S[1]-x[1]*b],v[o.index+h]=e;break;case Wf:u[0]=u[1]=e,0===o.index?(this.changingFeature_=!0,a.setCenter(e),this.changingFeature_=!1):(this.changingFeature_=!0,a.setRadius(Ym(a.getCenter(),e)),this.changingFeature_=!1)}l&&this.setGeometryCoordinates_(a,l)}this.createOrUpdateVertexFeature_(e)},e.prototype.handleDownEvent=function(t){if(!this.condition_(t))return!1;this.handlePointerAtPixel_(t.pixel,t.map);var e=t.map.getCoordinateFromPixel(t.pixel);this.dragSegments_.length=0,this.modified_=!1;var i=this.vertexFeature_;if(i){var n=[],r=i.getGeometry().getCoordinates(),o=Nd([r]),s=this.rBush_.getInExtent(o),a={};s.sort(sS);for(var l=0,u=s.length;l<u;++l){var h=s[l],c=h.segment,d=vc(h.feature),f=h.depth;if(f&&(d+="-"+f.join("-")),a[d]||(a[d]=new Array(2)),h.geometry.getType()===Wf&&1===h.index)qm(lS(e,h),r)&&!a[d][0]&&(this.dragSegments_.push([h,0]),a[d][0]=h);else if(qm(c[0],r)&&!a[d][0])this.dragSegments_.push([h,0]),a[d][0]=h;else if(qm(c[1],r)&&!a[d][1]){if((h.geometry.getType()===Nf||h.geometry.getType()===Vf)&&a[d][0]&&0===a[d][0].index)continue;this.dragSegments_.push([h,1]),a[d][1]=h}else this.insertVertexCondition_(t)&&vc(c)in this.vertexSegments_&&!a[d][0]&&!a[d][1]&&n.push([h,r])}n.length&&this.willModifyFeatures_(t);for(var p=n.length-1;p>=0;--p)this.insertVertex_.apply(this,n[p])}return!!this.vertexFeature_},e.prototype.handleUpEvent=function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var i=this.dragSegments_[e][0],n=i.geometry;if(n.getType()===Kf||n.getType()===Xf)this.features_.remove(i.feature),this.features_.push(i.feature);else if(n.getType()===Wf){var r=n.getCenter(),o=i.featureSegments[0],s=i.featureSegments[1];o.segment[0]=o.segment[1]=r,s.segment[0]=s.segment[1]=r,this.rBush_.update(Hd(r),o),this.rBush_.update(n.getExtent(),s)}else this.rBush_.update(Nd(i.segment),i)}return this.modified_&&(this.dispatchEvent(new oS(rS,this.features_,t)),this.modified_=!1),!1},e.prototype.handlePointerMove_=function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map)},e.prototype.handlePointerAtPixel_=function(t,e){var i=e.getCoordinateFromPixel(t),n=Bd(Hd(i),e.getView().getResolution()*this.pixelTolerance_),r=this.rBush_.getInExtent(n);if(r.length>0){r.sort((function(t,e){return aS(i,t)-aS(i,e)}));var o=r[0],s=o.segment,a=lS(i,o),l=e.getPixelFromCoordinate(a),u=Ym(t,l);if(u<=this.pixelTolerance_){var h={};if(o.geometry.getType()===Wf&&1===o.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(a);else{var c=e.getPixelFromCoordinate(s[0]),d=e.getPixelFromCoordinate(s[1]),f=Xm(l,c),p=Xm(l,d);u=Math.sqrt(Math.min(f,p)),this.snappedToVertex_=u<=this.pixelTolerance_,this.snappedToVertex_&&(a=f>p?s[1]:s[0]),this.createOrUpdateVertexFeature_(a);for(var g=1,m=r.length;g<m;++g){var v=r[g].segment;if(!(qm(s[0],v[0])&&qm(s[1],v[1])||qm(s[0],v[1])&&qm(s[1],v[0])))break;h[vc(v)]=!0}}return h[vc(s)]=!0,void(this.vertexSegments_=h)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},e.prototype.insertVertex_=function(t,e){for(var i,n=t.segment,r=t.feature,o=t.geometry,s=t.depth,a=t.index;e.length<o.getStride();)e.push(0);switch(o.getType()){case Vf:case Uf:(i=o.getCoordinates())[s[0]].splice(a+1,0,e);break;case zf:(i=o.getCoordinates())[s[1]][s[0]].splice(a+1,0,e);break;case Nf:(i=o.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(o,i);var l=this.rBush_;l.remove(t),this.updateSegmentIndices_(o,a,s,1);var u={segment:[n[0],e],feature:r,geometry:o,depth:s,index:a};l.insert(Nd(u.segment),u),this.dragSegments_.push([u,1]);var h={segment:[e,n[1]],feature:r,geometry:o,depth:s,index:a+1};l.insert(Nd(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0},e.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=Gg.POINTERDRAG){var t=this.lastPointerEvent_;return this.willModifyFeatures_(t),this.removeVertex_(),this.dispatchEvent(new oS(rS,this.features_,t)),this.modified_=!1,!0}return!1},e.prototype.removeVertex_=function(){var t,e,i,n,r,o,s,a,l,u,h,c=this.dragSegments_,d={},f=!1;for(r=c.length-1;r>=0;--r)h=vc((u=(i=c[r])[0]).feature),u.depth&&(h+="-"+u.depth.join("-")),h in d||(d[h]={}),0===i[1]?(d[h].right=u,d[h].index=u.index):1==i[1]&&(d[h].left=u,d[h].index=u.index+1);for(h in d){switch(l=d[h].right,s=d[h].left,(a=(o=d[h].index)-1)<0&&(a=0),t=e=(n=(u=void 0!==s?s:l).geometry).getCoordinates(),f=!1,n.getType()){case Vf:e[u.depth[0]].length>2&&(e[u.depth[0]].splice(o,1),f=!0);break;case Nf:e.length>2&&(e.splice(o,1),f=!0);break;case zf:t=t[u.depth[1]];case Uf:(t=t[u.depth[0]]).length>4&&(o==t.length-1&&(o=0),t.splice(o,1),f=!0,0===o&&(t.pop(),t.push(t[0]),a=t.length-1))}if(f){this.setGeometryCoordinates_(n,e);var p=[];if(void 0!==s&&(this.rBush_.remove(s),p.push(s.segment[0])),void 0!==l&&(this.rBush_.remove(l),p.push(l.segment[1])),void 0!==s&&void 0!==l){var g={depth:u.depth,feature:u.feature,geometry:u.geometry,index:a,segment:p};this.rBush_.insert(Nd(g.segment),g)}this.updateSegmentIndices_(n,o,u.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return f},e.prototype.setGeometryCoordinates_=function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1},e.prototype.updateSegmentIndices_=function(t,e,i,n){this.rBush_.forEachInExtent(t.getExtent(),(function(r){r.geometry===t&&(void 0===i||void 0===r.depth||Ff(r.depth,i))&&r.index>e&&(r.index+=n)}))},e}(tm);const cS=Ml({props:{position:{type:Array,required:!0}},computed:{positionText:function(){return this.position.join(" × ")}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"mouse-position-indicator",attrs:{title:"Mouse position in the image"},domProps:{textContent:t._s(t.positionText)}})}),[],!1,null,null,null).exports;const dS=Ml({components:{mousePositionIndicator:cS},props:{showMousePosition:{type:Boolean,default:!1}},data:function(){return{mousePositionIC:[0,0]}},watch:{mousePosition:function(t){var e=this;Lu((function(){e.mousePositionIC=e.invertPointsYAxis(t.slice()).map(Math.round)}),100,"annotations.canvas.mouse-position-ic")}}},undefined,undefined,!1,null,null,null).exports;var fS=6371008.8,pS={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*fS,kilometers:6371.0088,kilometres:6371.0088,meters:fS,metres:fS,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:fS/1852,radians:1,yards:5825721.287490856};function gS(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function mS(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ES(t[0])||!ES(t[1]))throw new Error("coordinates must contain numbers");return gS({type:"Point",coordinates:t},e,i)}function vS(t,e,i){void 0===i&&(i={});for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return gS({type:"Polygon",coordinates:t},e,i)}function yS(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return gS({type:"LineString",coordinates:t},e,i)}function _S(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function bS(t,e,i){return void 0===i&&(i={}),gS({type:"MultiPolygon",coordinates:t},e,i)}function wS(t,e){void 0===e&&(e="kilometers");var i=pS[e];if(!i)throw new Error(e+" units is invalid");return t*i}function xS(t,e){void 0===e&&(e="kilometers");var i=pS[e];if(!i)throw new Error(e+" units is invalid");return t/i}function SS(t){return 180*(t%(2*Math.PI))/Math.PI}function CS(t){return t%360*Math.PI/180}function ES(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function TS(t,e,i){if(null!==t)for(var n,r,o,s,a,l,u,h,c=0,d=0,f=t.type,p="FeatureCollection"===f,g="Feature"===f,m=p?t.features.length:1,v=0;v<m;v++){a=(h=!!(u=p?t.features[v].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var y=0;y<a;y++){var _=0,b=0;if(null!==(s=h?u.geometries[y]:u)){l=s.coordinates;var w=s.type;switch(c=!i||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(l,d,v,_,b))return!1;d++,_++;break;case"LineString":case"MultiPoint":for(n=0;n<l.length;n++){if(!1===e(l[n],d,v,_,b))return!1;d++,"MultiPoint"===w&&_++}"LineString"===w&&_++;break;case"Polygon":case"MultiLineString":for(n=0;n<l.length;n++){for(r=0;r<l[n].length-c;r++){if(!1===e(l[n][r],d,v,_,b))return!1;d++}"MultiLineString"===w&&_++,"Polygon"===w&&b++}"Polygon"===w&&_++;break;case"MultiPolygon":for(n=0;n<l.length;n++){for(b=0,r=0;r<l[n].length;r++){for(o=0;o<l[n][r].length-c;o++){if(!1===e(l[n][r][o],d,v,_,b))return!1;d++}b++}_++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(!1===TS(s.geometries[n],e,i))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function IS(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var i=0;i<t.features.length&&!1!==e(t.features[i],i);i++);}function AS(t,e){var i,n,r,o,s,a,l,u,h,c,d=0,f="FeatureCollection"===t.type,p="Feature"===t.type,g=f?t.features.length:1;for(i=0;i<g;i++){for(a=f?t.features[i].geometry:p?t.geometry:t,u=f?t.features[i].properties:p?t.properties:{},h=f?t.features[i].bbox:p?t.bbox:void 0,c=f?t.features[i].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,d,u,h,c))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],d,u,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,d,u,h,c))return!1;d++}}function kS(t,e){AS(t,(function(t,i,n,r,o){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(gS(t,n,{bbox:r,id:o}),i,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(gS({type:s,coordinates:u},n),i,l))return!1}}))}function PS(t,e){kS(t,(function(t,i,n){var r=0;if(t.geometry){var o=t.geometry.type;if("Point"!==o&&"MultiPoint"!==o){var s,a=0,l=0,u=0;return!1!==TS(t,(function(o,h,c,d,f){if(void 0===s||i>a||d>l||f>u)return s=o,a=i,l=d,u=f,void(r=0);var p=yS([s,o],t.properties);if(!1===e(p,i,n,f,r))return!1;r++,s=o}))&&void 0}}}))}function LS(t){var e=[1/0,1/0,-1/0,-1/0];return TS(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}LS.default=LS;const RS=LS;function FS(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function MS(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function OS(t){return"Feature"===t.type?t.geometry:t}function DS(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=FS(t),r=OS(e),o=r.type,s=e.bbox,a=r.coordinates;if(s&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(n,s))return!1;"Polygon"===o&&(a=[a]);for(var l=!1,u=0;u<a.length&&!l;u++)if($S(n,a[u][0],i.ignoreBoundary)){for(var h=!1,c=1;c<a[u].length&&!h;)$S(n,a[u][c],!i.ignoreBoundary)&&(h=!0),c++;h||(l=!0)}return l}function $S(t,e,i){var n=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!i;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(n=!n)}return n}function jS(t,e,i,n){var r=i[0],o=i[1],s=t[0],a=t[1],l=e[0],u=e[1],h=l-s,c=u-a;return 0==(i[0]-s)*c-(i[1]-a)*h&&(n?"start"===n?Math.abs(h)>=Math.abs(c)?h>0?s<r&&r<=l:l<=r&&r<s:c>0?a<o&&o<=u:u<=o&&o<a:"end"===n?Math.abs(h)>=Math.abs(c)?h>0?s<=r&&r<l:l<r&&r<=s:c>0?a<=o&&o<u:u<o&&o<=a:"both"===n&&(Math.abs(h)>=Math.abs(c)?h>0?s<r&&r<l:l<r&&r<s:c>0?a<o&&o<u:u<o&&o<a):Math.abs(h)>=Math.abs(c)?h>0?s<=r&&r<=l:l<=r&&r<=s:c>0?a<=o&&o<=u:u<=o&&o<=a)}const NS=function(t,e,i){void 0===i&&(i={});for(var n=FS(t),r=MS(e),o=0;o<r.length-1;o++){var s=!1;if(i.ignoreEndVertices&&(0===o&&(s="start"),o===r.length-2&&(s="end"),0===o&&o+1===r.length-1&&(s="both")),jS(r[o],r[o+1],n,s))return!0}return!1};function BS(t,e){var i=OS(t),n=OS(e),r=i.type,o=n.type,s=i.coordinates,a=n.coordinates;switch(r){case"Point":switch(o){case"Point":return GS(s,a);default:throw new Error("feature2 "+o+" geometry not supported")}case"MultiPoint":switch(o){case"Point":return function(t,e){var i,n=!1;for(i=0;i<t.coordinates.length;i++)if(GS(t.coordinates[i],e.coordinates)){n=!0;break}return n}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){for(var r=n[i],o=!1,s=0,a=t.coordinates;s<a.length;s++){if(GS(r,a[s])){o=!0;break}}if(!o)return!1}return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"Point":return NS(n,i,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(NS({type:"Point",coordinates:o},t,{ignoreEndVertices:!0})&&(i=!0),!NS({type:"Point",coordinates:o},t,{ignoreEndVertices:!1}))return!1}return i}(i,n);case"MultiPoint":return function(t,e){for(var i=!1,n=0,r=e.coordinates;n<r.length;n++){var o=r[n];if(NS(o,t,{ignoreEndVertices:!0})&&(i=!0),!NS(o,t))return!1}if(i)return!0;return!1}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Point":return DS(n,i,{ignoreBoundary:!0});case"LineString":return function(t,e){var i=!1,n=0,r=RS(t),o=RS(e);if(!US(r,o))return!1;for(;n<e.coordinates.length-1;n++){if(DS({type:"Point",coordinates:VS(e.coordinates[n],e.coordinates[n+1])},t,{ignoreBoundary:!0})){i=!0;break}}return i}(i,n);case"Polygon":return function(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;var i=RS(t),n=RS(e);if(!US(i,n))return!1;for(var r=OS(e).coordinates,o=0,s=r;o<s.length;o++)for(var a=0,l=s[o];a<l.length;a++){if(!DS(l[a],t))return!1}return!0}(i,n);case"MultiPoint":return function(t,e){for(var i=0,n=e.coordinates;i<n.length;i++){if(!DS(n[i],t,{ignoreBoundary:!0}))return!1}return!0}(i,n);default:throw new Error("feature2 "+o+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}}function US(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function GS(t,e){return t[0]===e[0]&&t[1]===e[1]}function VS(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}var zS=i(1787);const qS=function(t){if(!t)throw new Error("geojson is required");var e=[];return kS(t,(function(t){!function(t,e){var i=[],n=t.geometry;if(null!==n){switch(n.type){case"Polygon":i=MS(n);break;case"LineString":i=[MS(n)]}i.forEach((function(i){(function(t,e){var i=[];return t.reduce((function(t,n){var r,o,s,a,l,u,h=yS([t,n],e);return h.bbox=(o=n,s=(r=t)[0],a=r[1],l=o[0],u=o[1],[s<l?s:l,a<u?a:u,s>l?s:l,a>u?a:u]),i.push(h),n})),i})(i,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),_S(e)};function WS(t,e,i){if(void 0===i&&(i={}),!0===i.final)return function(t,e){var i=WS(e,t);return i=(i+180)%360}(t,e);var n=FS(t),r=FS(e),o=CS(n[0]),s=CS(r[0]),a=CS(n[1]),l=CS(r[1]),u=Math.sin(s-o)*Math.cos(l),h=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-o);return SS(Math.atan2(u,h))}const KS=function(t,e,i){void 0===i&&(i={});var n=FS(t),r=FS(e),o=CS(r[1]-n[1]),s=CS(r[0]-n[0]),a=CS(n[1]),l=CS(r[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return wS(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),i.units)};function XS(t,e,i,n){void 0===n&&(n={});var r=FS(t),o=CS(r[0]),s=CS(r[1]),a=CS(i),l=xS(e,n.units),u=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(a));return mS([SS(o+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(u))),SS(u)],n.properties)}function YS(t,e){var i=MS(t),n=MS(e);if(2!==i.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==n.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=i[0][0],o=i[0][1],s=i[1][0],a=i[1][1],l=n[0][0],u=n[0][1],h=n[1][0],c=n[1][1],d=(c-u)*(s-r)-(h-l)*(a-o),f=(h-l)*(o-u)-(c-u)*(r-l),p=(s-r)*(o-u)-(a-o)*(r-l);if(0===d)return null;var g=f/d,m=p/d;return g>=0&&g<=1&&m>=0&&m<=1?mS([r+g*(s-r),o+g*(a-o)]):null}const HS=function(t,e){var i={},n=[];if("LineString"===t.type&&(t=gS(t)),"LineString"===e.type&&(e=gS(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var r=YS(t,e);return r&&n.push(r),_S(n)}var o=zS();return o.load(qS(e)),IS(qS(t),(function(t){IS(o.search(t),(function(e){var r=YS(t,e);if(r){var o=MS(r).join(",");i[o]||(i[o]=!0,n.push(r))}}))})),_S(n)};const ZS=function(t,e,i){void 0===i&&(i={});var n=mS([1/0,1/0],{dist:1/0}),r=0;return kS(t,(function(t){for(var o=MS(t),s=0;s<o.length-1;s++){var a=mS(o[s]);a.properties.dist=KS(e,a,i);var l=mS(o[s+1]);l.properties.dist=KS(e,l,i);var u=KS(a,l,i),h=Math.max(a.properties.dist,l.properties.dist),c=WS(a,l),d=XS(e,h,c+90,i),f=XS(e,h,c-90,i),p=HS(yS([d.geometry.coordinates,f.geometry.coordinates]),yS([a.geometry.coordinates,l.geometry.coordinates])),g=null;p.features.length>0&&((g=p.features[0]).properties.dist=KS(e,g,i),g.properties.location=r+KS(a,g,i)),a.properties.dist<n.properties.dist&&((n=a).properties.index=s,n.properties.location=r),l.properties.dist<n.properties.dist&&((n=l).properties.index=s+1,n.properties.location=r+u),g&&g.properties.dist<n.properties.dist&&((n=g).properties.index=s),r+=u}})),n};var JS=i(251);function QS(t,e){var i=MS(e),n=MS(t),r=n[0],o=n[n.length-1],s=t.geometry.coordinates;return JS(i[0],r)?s.unshift(i[1]):JS(i[0],o)?s.push(i[1]):JS(i[1],r)?s.unshift(i[0]):JS(i[1],o)&&s.push(i[0]),t}const tC=function(t,e,i){if(void 0===i&&(i={}),!(n=i=i||{})||n.constructor!==Object)throw new Error("options is invalid");var n,r,o=i.tolerance||0,s=[],a=zS(),l=qS(t);return a.load(l),PS(e,(function(t){var e=!1;IS(a.search(t),(function(i){if(!1===e){var n=MS(t).sort(),s=MS(i).sort();JS(n,s)||(0===o?NS(n[0],i)&&NS(n[1],i):ZS(i,n[0]).properties.dist<=o&&ZS(i,n[1]).properties.dist<=o)?(e=!0,r=r?QS(r,t):t):(0===o?NS(s[0],t)&&NS(s[1],t):ZS(t,s[0]).properties.dist<=o&&ZS(t,s[1]).properties.dist<=o)&&(r=r?QS(r,i):i)}})),!1===e&&r&&(s.push(r),r=void 0)})),r&&s.push(r),_S(s)};var eC=i(9657);function iC(t,e){var i=OS(t),n=OS(e),r=i.type,o=n.type;if("MultiPoint"===r&&"MultiPoint"!==o||("LineString"===r||"MultiLineString"===r)&&"LineString"!==o&&"MultiLineString"!==o||("Polygon"===r||"MultiPolygon"===r)&&"Polygon"!==o&&"MultiPolygon"!==o)throw new Error("features must be of the same type");if("Point"===r)throw new Error("Point geometry not supported");if(new eC({precision:6}).compare(t,e))return!1;var s=0;switch(r){case"MultiPoint":for(var a=0;a<i.coordinates.length;a++)for(var l=0;l<n.coordinates.length;l++){var u=i.coordinates[a],h=n.coordinates[l];if(u[0]===h[0]&&u[1]===h[1])return!0}return!1;case"LineString":case"MultiLineString":PS(t,(function(t){PS(e,(function(e){tC(t,e).features.length&&s++}))}));break;case"Polygon":case"MultiPolygon":PS(t,(function(t){PS(e,(function(e){HS(t,e).features.length&&s++}))}))}return s>0}var nC=i(2676);const rC=function(t,e,i){void 0===i&&(i={});var n=OS(t),r=OS(e),o=nC.union(n.coordinates,r.coordinates);return 0===o.length?null:1===o.length?vS(o[0],i.properties):bS(o,i.properties)};function oC(t,e){t.geometry.coordinates=gg(t.geometry.coordinates),e.geometry.coordinates=gg(e.geometry.coordinates);var i=rC(t,e);return"MultiPolygon"===i.geometry.type?i.geometry.coordinates[0]:i.geometry.coordinates}var sC=i(9977),aC=i.n(sC);var lC=function(t){var e=t.pointerEvent;return e&&"pen"===e.pointerType};function uC(t,e){var i=t.originalEvent.deltaY;t.type==Zc?0===(i=-t.originalEvent.wheelDeltaY)&&(i=-t.originalEvent.wheelDeltaX):0===i&&(i=t.originalEvent.deltaX);var n=5;return e<=25&&(n=1),i>0?e+n:i<0?Math.max(e-n,5):e}function hC(t,e){return 0!=t.pointerEvent.pressure?(e=uC(t,e),Math.max(e*t.pointerEvent.pressure,5)*t.map.getView().getResolution()):e}function cC(){var t=Dy();return t[Uf]=t[Uf].concat(t[Nf]),function(e,i){return t[e.getGeometry().getType()]}}const dC=function(t){function e(e){e.freehandCondition=e.freehandCondition?e.freehandCondition:lC,t.call(this,e),this.overlay_=new Uy({source:this.overlay_.getSource(),style:e.style?e.style:cC(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.sketchPointRadius_=void 0!==e.brushRadius?e.brushRadius:100,this.condition_=void 0!==e.condition?e.condition:lv,this.resizeCondition_=void 0!==e.resizeCondition?e.resizeCondition:pv,this.isDrawing_=!1,this.sketchCircle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getView();i&&this.watchViewForChangedResolution(i),e.on("change:view",function(t){this.watchViewForChangedResolution(t.target.getView())}.bind(this))}},e.prototype.watchViewForChangedResolution=function(t){t.on("change:resolution",this.updateRelativeSketchPointRadius_.bind(this))},e.prototype.handleEvent=function(e){var i=e.type,n=!0;return this.resizeCondition_(e)&&(i===ed||Zc)&&(this.updateAbsoluteSketchPointRadius_(e),n=!1),e.type===Gg.POINTERDRAG&&this.handlingDownUpSequence&&(n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handleDownEvent=function(t){return!(this.handlingDownUpSequence||!this.condition_(t))&&(this.startDrawing_(t),!0)},e.prototype.handleUpEvent=function(t){return!(!this.handlingDownUpSequence||!this.isDrawing_)&&(this.finishDrawing(),!0)},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCenter(e)}else{var i=t.map.getView().getResolution()*this.sketchPointRadius_;this.sketchPoint_=new Nm(new Og(e,i)),this.updateSketchFeatures_()}},e.prototype.updateRelativeSketchPointRadius_=function(t){this.sketchPoint_&&this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.target.getResolution())},e.prototype.updateAbsoluteSketchPointRadius_=function(t){this.sketchPoint_&&(this.sketchPointRadius_=uC(t,this.sketchPointRadius_),this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.map.getView().getResolution()))},e.prototype.createOrUpdateSketchCircle_=function(t){var e=t.coordinate.slice();this.sketchCircle_?(this.sketchCircle_.setCenter(e),this.sketchCircle_.setRadius(this.sketchPoint_.getGeometry().getRadius())):this.sketchCircle_=new Og(e,this.sketchPoint_.getGeometry().getRadius()),"pen"===t.originalEvent.pointerType&&this.sketchCircle_.setRadius(hC(t,this.sketchPointRadius_))},e.prototype.startDrawing_=function(t){this.isDrawing_=!0,this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t);var e=t.coordinate;this.finishCoordinate_=e,this.sketchFeature_=new Nm(Fg(this.sketchCircle_)),this.updateSketchFeatures_(),this.dispatchEvent(new f_(c_,this.sketchFeature_))},e.prototype.handlePointerMove_=function(t){if(this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.isDrawing_&&this.sketchFeature_){var e=vS(Fg(this.sketchCircle_).getCoordinates()),i=this.sketchFeature_.getGeometry(),n=vS(i.getCoordinates());(iC(e,n)||BS(e,n))&&i.setCoordinates(oC(e,n))}},e.prototype.finishDrawing=function(){this.isDrawing_=!1;var t=this.abortDrawing_();t&&(this.dispatchEvent(new f_(d_,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t))},e.prototype.getBrushRadius=function(){return this.sketchPointRadius_},e.prototype.abortDrawing_=function(){return this.sketchCircle_=null,t.prototype.abortDrawing_.call(this)},e}(g_);var fC="modifyremove";const pC=function(t){function e(e){t.call(this,e),this.overlay_.setStyle(e.style?e.style:function(){var t=Dy();return function(e,i){return t[Wf]}}()),this.sketchPoint_=null,this.sketchPointRadius_=void 0!==e.brushRadius?e.brushRadius:100,this.addCondition_=void 0!==e.addCondition?e.addCondition:lv,this.subtractCondition_=void 0!==e.subtractCondition?e.subtractCondition:lv,this.resizeCondition_=void 0!==e.resizeCondition?e.resizeCondition:pv,this.allowRemove_=void 0===e.allowRemove||e.allowRemove,this.isAdding_=!1,this.isSubtracting_=!1,this.sketchCircle_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var i=e.getView();i&&this.watchViewForChangedResolution(i),e.on("change:view",function(t){this.watchViewForChangedResolution(t.target.getView())}.bind(this))}},e.prototype.watchViewForChangedResolution=function(t){t.on("change:resolution",this.updateRelativeSketchPointRadius_.bind(this))},e.prototype.createOrUpdateSketchPoint_=function(t){var e=t.coordinate.slice();if(this.sketchPoint_){this.sketchPoint_.getGeometry().setCenter(e)}else{var i=t.map.getView().getResolution()*this.sketchPointRadius_;this.sketchPoint_=new Nm(new Og(e,i)),this.overlay_.getSource().addFeature(this.sketchPoint_)}},e.prototype.createOrUpdateSketchCircle_=function(t){var e=t.coordinate.slice();this.sketchCircle_?(this.sketchCircle_.setCenter(e),this.sketchCircle_.setRadius(this.sketchPoint_.getGeometry().getRadius())):this.sketchCircle_=new Og(e,this.sketchPoint_.getGeometry().getRadius()),"pen"===t.originalEvent.pointerType&&this.sketchCircle_.setRadius(hC(t,this.sketchPointRadius_))},e.prototype.updateRelativeSketchPointRadius_=function(t){this.sketchPoint_&&this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.target.getResolution())},e.prototype.updateAbsoluteSketchPointRadius_=function(t){this.sketchPoint_&&(this.sketchPointRadius_=uC(t,this.sketchPointRadius_),this.sketchPoint_.getGeometry().setRadius(this.sketchPointRadius_*t.map.getView().getResolution()))},e.prototype.handleEvent=function(e){var i=e.type,n=!0;return this.resizeCondition_(e)&&(i===ed||Zc)&&(this.updateAbsoluteSketchPointRadius_(e),n=!1),t.prototype.handleEvent.call(this,e)&&n},e.prototype.handlePointerMove_=function(t){this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t)},e.prototype.handleDownEvent=function(t){if(!this.handlingDownUpSequence){if(this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.subtractCondition_(t))return this.startSubtracting_(t),!0;if(this.addCondition_(t))return this.startAdding_(t),!0}return!1},e.prototype.handleUpEvent=function(t){return!(!this.handlingDownUpSequence||!this.isSubtracting_&&!this.isAdding_)&&(this.finishModifying_(t),!0)},e.prototype.startSubtracting_=function(t){this.isSubtracting_=!0,this.willModifyFeatures_(t),this.subtractCurrentFeatures_(t)},e.prototype.startAdding_=function(t){this.isAdding_=!0,this.willModifyFeatures_(t),this.addCurrentFeatures_(t)},e.prototype.handleDragEvent=function(t){this.createOrUpdateSketchPoint_(t),this.createOrUpdateSketchCircle_(t),this.isSubtracting_?this.subtractCurrentFeatures_(t):this.isAdding_&&this.addCurrentFeatures_(t)},e.prototype.subtractCurrentFeatures_=function(t){var e=Fg(this.sketchCircle_),i=vS(e.getCoordinates()),n=e.getArea();this.features_.getArray().forEach((function(e){var r=e.getGeometry();try{var o=vS(r.getCoordinates())}catch(t){return}if(iC(i,o)){var s=function(t,e){t.geometry.coordinates=gg(t.geometry.coordinates),e.geometry.coordinates=gg(e.geometry.coordinates);var i=aC()(t,e);if("MultiPolygon"===i.geometry.type){for(var n,r=0,o=0;o<i.geometry.coordinates.length;o++){var s=new Lg(i.geometry.coordinates[o]).getArea();s>r&&(r=s,n=i.geometry.coordinates[o])}return n}return i.geometry.coordinates}(o,i);if(!this.allowRemove_&&n>new Lg(s).getArea())return;r.setCoordinates(s)}else BS(i,o)&&this.allowRemove_&&(this.features_.remove(e),this.source_&&this.source_.removeFeature(e),this.dispatchEvent(new oS(fC,new $m([e]),t)))}),this)},e.prototype.addCurrentFeatures_=function(t){var e=Fg(this.sketchCircle_),i=vS(e.getCoordinates());this.features_.getArray().forEach((function(t){var n=t.getGeometry();try{var r=vS(n.getCoordinates())}catch(t){return}iC(i,r)?n.setCoordinates(oC(i,r)):BS(i,r)&&n.setCoordinates(e.getCoordinates())}),this)},e.prototype.finishModifying_=function(t){this.isSubtracting_=!1,this.isAdding_=!1,this.dispatchEvent(new oS(rS,this.features_,t))},e.prototype.getBrushRadius=function(){return this.sketchPointRadius_},e}(hS);var gC="select",mC=function(t){function e(e,i,n,r){t.call(this,e),this.selected=i,this.deselected=n,this.mapBrowserEvent=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);function vC(t){if(!this.condition_(t))return!0;var e=this.addCondition_(t),i=this.removeCondition_(t),n=this.toggleCondition_(t),r=!e&&!i&&!n,o=t.map,s=this.getFeatures(),a=[],l=[];if(r){wc(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return l.push(t),this.addFeatureLayerAssociation_(t,e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=s.getLength()-1;u>=0;--u){var h=s.item(u),c=l.indexOf(h);c>-1?l.splice(c,1):(s.remove(h),a.push(h))}0!==l.length&&s.extend(l)}else{o.forEachFeatureAtPixel(t.pixel,function(t,r){if(this.filter_(t,r))return!e&&!n||kf(s.getArray(),t)?(i||n)&&kf(s.getArray(),t)&&(a.push(t),this.removeFeatureLayerAssociation_(t)):(l.push(t),this.addFeatureLayerAssociation_(t,r)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var d=a.length-1;d>=0;--d)s.remove(a[d]);s.extend(l)}return(l.length>0||a.length>0)&&this.dispatchEvent(new mC(gC,l,a,t)),function(t){return"pointermove"==t.type}(t)}function yC(){var t=Dy();return Rf(t[Uf],t[Nf]),Rf(t[qf],t[Nf]),function(e,i){return e.getGeometry()?t[e.getGeometry().getType()]:null}}const _C=function(t){function e(e){t.call(this,{handleEvent:vC});var i=e||{};this.condition_=i.condition?i.condition:dv,this.addCondition_=i.addCondition?i.addCondition:cv,this.removeCondition_=i.removeCondition?i.removeCondition:cv,this.toggleCondition_=i.toggleCondition?i.toggleCondition:pv,this.multi_=!!i.multi&&i.multi,this.filter_=i.filter?i.filter:Mc,this.hitTolerance_=i.hitTolerance?i.hitTolerance:0;var n,r=new Uy({source:new n_({useSpatialIndex:!1,features:i.features,wrapX:i.wrapX}),style:i.style?i.style:yC(),updateWhileAnimating:!0,updateWhileInteracting:!0});if(this.featureOverlay_=r,i.layers)if("function"==typeof i.layers)n=i.layers;else{var o=i.layers;n=function(t){return kf(o,t)}}else n=Mc;this.layerFilter_=n,this.featureLayerAssociation_={};var s=this.getFeatures();Ac(s,Fm,this.addFeature_,this),Ac(s,Mm,this.removeFeature_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addFeatureLayerAssociation_=function(t,e){this.featureLayerAssociation_[vc(t)]=e},e.prototype.getFeatures=function(){return this.featureOverlay_.getSource().getFeaturesCollection()},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.getLayer=function(t){return this.featureLayerAssociation_[vc(t)]},e.prototype.getOverlay=function(){return this.featureOverlay_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap(),n=this.getFeatures();i&&n.forEach(i.unskipFeature.bind(i)),t.prototype.setMap.call(this,e),this.featureOverlay_.setMap(e),e&&n.forEach(e.skipFeature.bind(e))},e.prototype.addFeature_=function(t){var e=this.getMap();e&&e.skipFeature(t.element)},e.prototype.removeFeature_=function(t){var e=this.getMap();e&&e.unskipFeature(t.element)},e.prototype.removeFeatureLayerAssociation_=function(t){delete this.featureLayerAssociation_[vc(t)]},e}(Jg);var bC,wC,xC=50;const SC=Ml({computed:{isUsingPolygonBrush:function(){return"polygonBrush"===this.interactionMode},isUsingPolygonEraser:function(){return"polygonEraser"===this.interactionMode},isUsingPolygonFill:function(){return"polygonFill"===this.interactionMode}},methods:{togglePolygonBrush:function(){this.isUsingPolygonBrush?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="polygonBrush"):this.requireSelectedLabel()},togglePolygonEraser:function(){this.isUsingPolygonEraser?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonEraser")},togglePolygonFill:function(){this.isUsingPolygonFill?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonFill")},toggleCurrentInteraction:function(t){wC&&(xC=wC.getBrushRadius(),this.map.removeInteraction(wC),wC=null),this.canAdd&&"polygonBrush"===t?((wC=new dC({map:this.map,source:this.annotationSource,style:A_.editing,brushRadius:xC})).on("drawend",this.handleNewFeature),this.map.addInteraction(wC)):this.canModify&&"polygonEraser"===t?((wC=new pC({map:this.map,features:this.selectInteraction.getFeatures(),style:A_.editing,brushRadius:xC,allowRemove:!1,addCondition:cv,subtractCondition:fv})).on("modifystart",this.handleFeatureModifyStart),wC.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(wC),this.map.addInteraction(bC)):this.canModify&&"polygonFill"===t&&((wC=new pC({map:this.map,features:this.selectInteraction.getFeatures(),style:A_.editing,brushRadius:xC,addCondition:fv,subtractCondition:cv})).on("modifystart",this.handleFeatureModifyStart),wC.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(wC),this.map.addInteraction(bC))}},created:function(){this.canAdd&&xu.on("e",this.togglePolygonBrush,0,this.listenerSet),this.canModify&&(xu.on("r",this.togglePolygonEraser,0,this.listenerSet),xu.on("t",this.togglePolygonFill,0,this.listenerSet)),(this.canAdd||this.canModify)&&this.$watch("interactionMode",this.toggleCurrentInteraction)},mounted:function(){this.canModify&&(bC=new _C({condition:function(t){return uv(t)&&pv(t)},style:A_.highlight,layers:[this.annotationLayer],features:this.selectInteraction.getFeatures(),multi:!0})).on("select",this.handleFeatureSelect)}},undefined,undefined,!1,null,null,null).exports;var CC,EC;const TC=Ml({data:function(){return{regularSamplingRows:null,regularSamplingColumns:null,currentSamplingIndex:null,randomSamplingCount:null,randomLocationMemory:{}}},computed:{regularSamplingLocations:function(){for(var t=[this.image.width/this.regularSamplingColumns,this.image.height/this.regularSamplingRows],e=[t[0]/2,t[1]/2],i=[],n=this.regularSamplingRows-1;n>=0;n--)for(var r=this.regularSamplingColumns-1;r>=0;r--)i.unshift([e[0]+r*t[0],e[1]+n*t[1]]);return i},randomSamplingLocations:function(){if(!this.randomLocationMemory.hasOwnProperty(this.image.id)){for(var t=[],e=this.image.width,i=this.image.height,n=this.randomSamplingCount;n>0;n--)t.push([Math.round(Math.random()*e),Math.round(Math.random()*i)]);this.randomLocationMemory[this.image.id]=t}return this.randomLocationMemory[this.image.id]},samplingLocations:function(){return this[this.annotationMode+"Locations"]},isSamplingAnnotationMode:function(){return this.annotationMode.endsWith("Sampling")}},methods:{setSamplingData:function(t,e){"regularSampling"===t?Array.isArray(e)&&e[0]>0&&e[1]>0&&(this.regularSamplingRows=e[0],this.regularSamplingColumns=e[1]):"randomSampling"===t&&e>0&&(this.randomSamplingCount=e)},updateShownSamplingLocation:function(){var t=this.currentSamplingIndex;null!==t&&t>=0&&t<this.samplingLocations.length&&(this.map.getView().setCenter(this.samplingLocations[t]),EC.getGeometry().setCoordinates(this.samplingLocations[t]))},showFirstSamplingLocation:function(){this.currentSamplingIndex=0,this.updateShownSamplingLocation()},showLastSamplingLocation:function(){this.currentSamplingIndex=this.samplingLocations.length-1,this.updateShownSamplingLocation()},showPreviousSamplingLocation:function(){var t=this.currentSamplingIndex-1;return!(t<0)&&(this.currentSamplingIndex=t,this.updateShownSamplingLocation(),!0)},showNextSamplingLocation:function(){var t=this.currentSamplingIndex+1;return!(t>=this.samplingLocations.length)&&(this.currentSamplingIndex=t,this.updateShownSamplingLocation(),!0)},createSampledAnnotation:function(){var t=this.samplingLocations[this.currentSamplingIndex];this.createPointAnnotationAt(t[0],t[1])}},watch:{isSamplingAnnotationMode:function(t){t?this.map.addLayer(CC):this.map.removeLayer(CC)},randomSamplingCount:function(){this.randomLocationMemory={}}},created:function(){CC=new Uy({source:new n_,style:[new jy({image:new Ay({radius:6,stroke:new Ry({color:"white",width:4})})}),new jy({image:new Ay({radius:6,stroke:new Ry({color:[0,153,255,1],width:2,lineDash:[3]})})})],zIndex:90,updateWhileAnimating:!0,updateWhileInteracting:!0}),EC=new Nm(new vg([0,0])),CC.getSource().addFeature(EC)}},undefined,undefined,!1,null,null,null).exports;var IC=Ml({mixins:[If],props:{resolution:{required:!0}},data:function(){return{targetWidth:100,leadingDigits:[1,2,5]}},computed:{scale:function(){return this.targetWidth*this.scaleMultiplier},scalePowerOfTen:function(){return this.powerOfTen(this.scale)},scaleMultiplier:function(){return this.hasArea?this.resolution*this.pxWidthInMeter:this.resolution||0},scaleNearest:function(){for(var t=0,e=1/0,i=this.leadingDigits.length-1;i>=0;i--){var n=this.leadingDigits[i]*this.scalePowerOfTen;Math.abs(this.scale-n)<e&&(t=i,e=Math.abs(this.scale-n))}return this.leadingDigits[t]*this.scalePowerOfTen},unitNearest:function(){for(var t=0,e=1/0,i=this.unitMultipliers.length-1;i>=0;i--)Math.abs(this.unitMultipliers[i]-this.scalePowerOfTen)<e&&(t=i,e=Math.abs(this.unitMultipliers[i]-this.scalePowerOfTen));return t},width:function(){return Math.round(this.scaleNearest/this.scaleMultiplier)},styleObject:function(){return{width:this.width+"px"}},text:function(){return this.hasArea?Math.round(this.scaleNearest/this.unitMultipliers[this.unitNearest])+" "+this.unitNames[this.unitNearest]:Math.round(this.scaleNearest)+" px"}}},undefined,undefined,!1,null,null,null);const AC=Ml({components:{scaleLineIndicator:IC.exports},props:{showScaleLine:{type:Boolean,default:!1},imagesArea:{type:Object,default:null}}},undefined,undefined,!1,null,null,null).exports,kC="preload",PC="useInterimTilesOnError";var LC=function(t){function e(e){var i=e||{},n=bc({},i);delete n.preload,delete n.useInterimTilesOnError,t.call(this,n),this.setPreload(void 0!==i.preload?i.preload:0),this.setUseInterimTilesOnError(void 0===i.useInterimTilesOnError||i.useInterimTilesOnError),this.type=Rv}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getPreload=function(){return this.get(kC)},e.prototype.setPreload=function(t){this.set(kC,t)},e.prototype.getUseInterimTilesOnError=function(){return this.get(PC)},e.prototype.setUseInterimTilesOnError=function(t){this.set(PC,t)},e}(Xv);LC.prototype.getSource;const RC=LC;var FC="translatestart",MC="translating",OC="translateend",DC=function(t){function e(e,i,n){t.call(this,e),this.features=i,this.coordinate=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);function $C(t){return($C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jC(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function NC(t,e){return(NC=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function BC(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=GC(t);if(e){var r=GC(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return UC(this,i)}}function UC(t,e){return!e||"object"!==$C(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function GC(t){return(GC=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const VC=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&NC(t,e)}(o,t);var e,i,n,r=BC(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=r.call(this,t)).features=void 0!==t.features?t.features:null,e.on("change:active",e.toggleListeners),e.translateUp=function(){return e.translate(0,1)},e.translateDown=function(){return e.translate(0,-1)},e.translateLeft=function(){return e.translate(-1,0)},e.translateRight=function(){return e.translate(1,0)},e.setMap(t.map),e.translating=!1,e}return e=o,(i=[{key:"toggleListeners",value:function(t){if(t.oldValue){xu.off("ArrowLeft",this.translateLeft),xu.off("ArrowUp",this.translateUp),xu.off("ArrowRight",this.translateRight),xu.off("ArrowDown",this.translateDown);var e=this.getMap().getTargetElement();e&&(e.style.cursor="")}else xu.on("ArrowLeft",this.translateLeft,10),xu.on("ArrowUp",this.translateUp,10),xu.on("ArrowRight",this.translateRight,10),xu.on("ArrowDown",this.translateDown,10)}},{key:"translate",value:function(t,e){var i=this;return!(null===this.lastCoordinate_&&this.features&&this.features.getLength()>0)||(this.translating||(this.dispatchEvent({type:"translatestart",features:this.features}),this.translating=!0),this.features.forEach((function(i){var n=i.getGeometry();n.translate(t,e),i.setGeometry(n)})),Iu((function(){i.translating=!1,i.dispatchEvent({type:"translateend",features:i.features})}),500,"ol.interactions.Translate.translateend"),!1)}}])&&jC(e.prototype,i),n&&jC(e,n),o}(function(t){function e(e){var i,n=e||{};if(t.call(this,n),this.lastCoordinate_=null,this.features_=void 0!==n.features?n.features:null,n.layers)if("function"==typeof n.layers)i=n.layers;else{var r=n.layers;i=function(t){return kf(r,t)}}else i=Mc;this.layerFilter_=i,this.hitTolerance_=n.hitTolerance?n.hitTolerance:0,this.lastFeature_=null,Ac(this,od(Kg),this.handleActiveChanged_,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new $m([this.lastFeature_]);return this.dispatchEvent(new DC(FC,e,t.coordinate)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new $m([this.lastFeature_]);return this.dispatchEvent(new DC(OC,e,t.coordinate)),!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,i=e[0]-this.lastCoordinate_[0],n=e[1]-this.lastCoordinate_[1],r=this.features_||new $m([this.lastFeature_]);r.forEach((function(t){var e=t.getGeometry();e.translate(i,n),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new DC(MC,r,e))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t){if(!this.features_||kf(this.features_.getArray(),t))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var i=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(i)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),i=this.getActive();e&&i||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}(tm));var zC;const qC=Ml({computed:{isTranslating:function(){return"translate"===this.interactionMode}},methods:{toggleTranslating:function(){this.isTranslating?this.resetInteractionMode():this.modifyInProgress||(this.interactionMode="translate")}},watch:{isTranslating:function(t){this.canModify&&zC.setActive(t)}},mounted:function(){this.canModify&&((zC=new VC({features:this.selectInteraction.getFeatures(),map:this.map})).setActive(!1),zC.on("translatestart",this.handleFeatureModifyStart),zC.on("translateend",this.handleFeatureModifyEnd),this.map.addInteraction(zC),xu.on("m",this.toggleTranslating,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const WC=function(t){function e(e,i,n){t.call(this);var r=n||{};this.tileCoord=e,this.state=i,this.interimTile=null,this.key="",this.transition_=void 0===r.transition?250:r.transition,this.transitionStarts_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.changed=function(){this.dispatchEvent(Uc)},e.prototype.getKey=function(){return this.key+"/"+this.tileCoord},e.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==$b)return t;t=t.interimTile}while(t);return this},e.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==$b){t.interimTile=null;break}t.getState()==Db?e=t:t.getState()==Ob?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},e.prototype.getTileCoord=function(){return this.tileCoord},e.prototype.getState=function(){return this.state},e.prototype.setState=function(t){this.state=t,this.changed()},e.prototype.load=function(){},e.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;var n=e-i+1e3/60;return n>=this.transition_?1:Vg(n/this.transition_)},e.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},e.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)},e}(Bc);function KC(){var t=wd(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}const XC=function(t){function e(e,i,n,r,o,s){t.call(this,e,i,s),this.crossOrigin_=r,this.src_=n,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.imageListenerKeys_=null,this.tileLoadFunction_=o}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==Db&&(this.unlistenImage_(),this.image_=KC()),this.interimTile&&this.interimTile.dispose(),this.state=Bb,this.changed(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.image_},e.prototype.getKey=function(){return this.src_},e.prototype.handleImageError_=function(){this.state=jb,this.unlistenImage_(),this.image_=KC(),this.changed()},e.prototype.handleImageLoad_=function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=$b:this.state=Nb,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state==jb&&(this.state=Ob,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Ob&&(this.state=Db,this.changed(),this.imageListenerKeys_=[kc(this.image_,Wc,this.handleImageError_,this),kc(this.image_,Yc,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(Lc),this.imageListenerKeys_=null},e}(WC);function YC(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function HC(t,e,i){return t+"/"+e+"/"+i}function ZC(t){return HC(t[0],t[1],t[2])}function JC(t,e){var i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,l){return s?t.replace(i,s[0].toString()).replace(n,s[1].toString()).replace(r,(function(){return(-s[2]-1).toString()})).replace(o,(function(){var t=s[0],i=e.getFullTileRange(t);return Ad(i,55),(i.getHeight()+s[2]).toString()})):void 0}}function QC(t){return 1===t.length?t[0]:function(e,i,n){if(e){var r=ep(function(t){return(t[1]<<t[0])+t[2]}(e),t.length);return t[r](e,i,n)}}}function tE(t,e,i){}function eE(t){var e=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var n,r=i[1].charCodeAt(0),o=i[2].charCodeAt(0);for(n=r;n<=o;++n)e.push(t.replace(i[0],String.fromCharCode(n)));return e}if(i=i=/\{(\d+)-(\d+)\}/.exec(t)){for(var s=parseInt(i[2],10),a=parseInt(i[1],10);a<=s;a++)e.push(t.replace(i[0],a.toString()));return e}return e.push(t),e}const iE=function(t){function e(e){t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.expireCache=function(t){for(;this.canExpireCache();){var e=this.peekLast(),i=e.tileCoord[0].toString();if(i in t&&t[i].contains(e.tileCoord))break;this.pop().dispose()}},e.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=function(t){return t.split("/").map(Number)}(this.peekFirstKey())[0];this.forEach((function(e){e.tileCoord[0]!==t&&(this.remove(ZC(e.tileCoord)),e.dispose())}),this)}},e}(ny);const nE=function(t){function e(e,i,n,r,o,s,a,l,u,h,c){t.call(this,o,Ob),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=i,this.targetTileGrid_=r,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var d=r.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent(),p=this.sourceTileGrid_.getExtent(),g=f?ff(d,f):d;if(0!==sf(g)){var m=e.getExtent();m&&(p=p?ff(p,m):m);var v=r.getResolution(this.wrappedTileCoord_[0]),y=mm(e,n,uf(g),v);if(!isFinite(y)||y<=0)this.state=Nb;else{var _=void 0!==h?h:.5;if(this.triangulation_=new bm(e,n,g,p,y*_),0!==this.triangulation_.getTriangles().length){this.sourceZ_=i.getZForResolution(y);var b=this.triangulation_.calculateSourceExtent();if(p&&(e.canWrapX()?(b[1]=Hf(b[1],p[1],p[3]),b[3]=Hf(b[3],p[1],p[3])):b=ff(b,p)),sf(b)){for(var w=i.getTileRangeForExtentAndZ(b,this.sourceZ_),x=w.minX;x<=w.maxX;x++)for(var S=w.minY;S<=w.maxY;S++){var C=u(this.sourceZ_,x,S,a);C&&this.sourceTiles_.push(C)}0===this.sourceTiles_.length&&(this.state=Nb)}else this.state=Nb}else this.state=Nb}}else this.state=Nb}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==Db&&this.unlistenSources_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,i,n){e&&e.getState()==$b&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}.bind(this)),this.sourceTiles_.length=0,0===t.length)this.state=jb;else{var e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=ym(n,r,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=$b}this.changed()},e.prototype.load=function(){if(this.state==Ob){this.state=Db,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,i,n){var r=e.getState();if(r==Ob||r==Db){t++;var o=Ac(e,Uc,(function(i){var n=e.getState();n!=$b&&n!=jb&&n!=Nb||(Lc(o),0===--t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(o)}}.bind(this)),this.sourceTiles_.forEach((function(t,e,i){t.getState()==Ob&&t.load()})),0===t&&setTimeout(this.reproject_.bind(this),0)}},e.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Lc),this.sourcesListenerKeys_=null},e}(WC);var rE=[0,0,0],oE=function(t){var e,i,n,r;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Ad((e=this.resolutions_,i=!0,n=function(t,e){return e-t}||Af,e.every((function(t,r){if(0===r)return!0;var o=n(e[r-1],t);return!(o>0||i&&0===o)}))),17),!t.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(r){if(this.resolutions_[o]/this.resolutions_[o+1]!==r){r=void 0;break}}else r=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=r,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Ad(this.origins_.length==this.resolutions_.length,20));var a=t.extent;void 0===a||this.origin_||this.origins_||(this.origin_=pf(a)),Ad(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Ad(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:zb,Ad(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){return new nx(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))}),this):a&&this.calculateTileRanges_(a)};oE.prototype.forEachTileCoord=function(t,e,i){for(var n=this.getTileRangeForExtentAndZ(t,e),r=n.minX,o=n.maxX;r<=o;++r)for(var s=n.minY,a=n.maxY;s<=a;++s)i([e,r,s])},oE.prototype.forEachTileCoordParentTileRange=function(t,e,i,n,r){var o,s,a,l=null,u=t[0]-1;for(2===this.zoomFactor_?(s=t[1],a=t[2]):l=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(o=2===this.zoomFactor_?ix(s=Math.floor(s/2),s,a=Math.floor(a/2),a,n):this.getTileRangeForExtentAndZ(l,u,n),e.call(i,u,o))return!0;--u}return!1},oE.prototype.getExtent=function(){return this.extent_},oE.prototype.getMaxZoom=function(){return this.maxZoom},oE.prototype.getMinZoom=function(){return this.minZoom},oE.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},oE.prototype.getResolution=function(t){return this.resolutions_[t]},oE.prototype.getResolutions=function(){return this.resolutions_},oE.prototype.getTileCoordChildTileRange=function(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var n=2*t[1],r=2*t[2];return ix(n,n+1,r,r+1,e)}var o=this.getTileCoordExtent(t,i);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},oE.prototype.getTileRangeExtent=function(t,e,i){var n=this.getOrigin(t),r=this.getResolution(t),o=rw(this.getTileSize(t),this.tmpSize_),s=n[0]+e.minX*o[0]*r,a=n[0]+(e.maxX+1)*o[0]*r;return Xd(s,n[1]+e.minY*o[1]*r,a,n[1]+(e.maxY+1)*o[1]*r,i)},oE.prototype.getTileRangeForExtentAndZ=function(t,e,i){var n=rE;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n);var r=n[1],o=n[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,n),ix(r,n[1],o,n[2],i)},oE.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=rw(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]+(t[2]+.5)*n[1]*i]},oE.prototype.getTileCoordExtent=function(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=rw(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,s=i[1]+t[2]*r[1]*n;return Xd(o,s,o+r[0]*n,s+r[1]*n,e)},oE.prototype.getTileCoordForCoordAndResolution=function(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)},oE.prototype.getTileCoordForXYAndResolution_=function(t,e,i,n,r){var o=this.getZForResolution(i),s=i/this.getResolution(o),a=this.getOrigin(o),l=rw(this.getTileSize(o),this.tmpSize_),u=n?.5:0,h=n?0:.5,c=Math.floor((t-a[0])/i+u),d=Math.floor((e-a[1])/i+h),f=s*c/l[0],p=s*d/l[1];return n?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),YC(o,f,p,r)},oE.prototype.getTileCoordForXYAndZ_=function(t,e,i,n,r){var o=this.getOrigin(i),s=this.getResolution(i),a=rw(this.getTileSize(i),this.tmpSize_),l=n?.5:0,u=n?0:.5,h=Math.floor((t-o[0])/s+l),c=Math.floor((e-o[1])/s+u),d=h/a[0],f=c/a[1];return n?(d=Math.ceil(d)-1,f=Math.ceil(f)-1):(d=Math.floor(d),f=Math.floor(f)),YC(i,d,f,r)},oE.prototype.getTileCoordForCoordAndZ=function(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)},oE.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},oE.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},oE.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},oE.prototype.getZForResolution=function(t,e){return Hf(Pf(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)},oE.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,i=new Array(e),n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i};const sE=oE;function aE(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){var r=void 0!==n?n:Ld,o=lE(t,e,i);return new sE({extent:t,origin:hf(t,r),resolutions:o,tileSize:i})}(uE(t),e,i,n)}(t),t.setDefaultTileGrid(e)),e}function lE(t,e,i){for(var n=void 0!==e?e:42,r=df(t),o=mf(t),s=rw(void 0!==i?i:zb),a=Math.max(o/s[0],r/s[1]),l=n+1,u=new Array(l),h=0;h<l;++h)u[h]=a/Math.pow(2,h);return u}function uE(t){var e=(t=Lp(t)).getExtent();if(!e){var i=180*sp[ap.DEGREES]/t.getMetersPerUnit();e=Xd(-i,-i,i,i)}return e}var hE=function(t){function e(e){t.call(this,{attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX}),this.opaque_=void 0!==e.opaque&&e.opaque,this.tilePixelRatio_=void 0!==e.tilePixelRatio?e.tilePixelRatio:1,this.tileGrid=void 0!==e.tileGrid?e.tileGrid:null,this.tileCache=new iE(e.cacheSize),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);i&&i.expireCache(e)},e.prototype.forEachLoadedTile=function(t,e,i,n){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,s,a,l=!0,u=i.minX;u<=i.maxX;++u)for(var h=i.minY;h<=i.maxY;++h)s=HC(e,u,h),a=!1,r.containsKey(s)&&(a=(o=r.get(s)).getState()===$b)&&(a=!1!==n(o)),a||(l=!1);return l},e.prototype.getGutterForProjection=function(t){return 0},e.prototype.getKey=function(){return this.key_},e.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},e.prototype.getOpaque=function(t){return this.opaque_},e.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},e.prototype.getTile=function(t,e,i,n,r){return gc()},e.prototype.getTileGrid=function(){return this.tileGrid},e.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:aE(t)},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!Op(e,t)?null:this.tileCache},e.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},e.prototype.getTilePixelSize=function(t,e,i){var n,r,o,s=this.getTileGridForProjection(i),a=this.getTilePixelRatio(e),l=rw(s.getTileSize(t),this.tmpSize);return 1==a?l:(n=l,r=a,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=n[0]*r+.5|0,o[1]=n[1]*r+.5|0,o)},e.prototype.getTileCoordForTileUrlFunction=function(t,e){var i=void 0!==e?e:this.getProjection(),n=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=function(t,e,i){var n=e[0],r=t.getTileCoordCenter(e),o=uE(i);if(Vd(o,r))return e;var s=mf(o),a=Math.ceil((o[0]-r[0])/s);return r[0]+=s*a,t.getTileCoordForCoordAndZ(r,n)}(n,t,i)),function(t,e){var i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;var o,s=e.getExtent();return!(o=s?e.getTileRangeForExtentAndZ(s,i):e.getFullTileRange(i))||o.containsXY(n,r)}(t,n)?t:null},e.prototype.refresh=function(){this.tileCache.clear(),this.changed()},e.prototype.useTile=function(t,e,i,n){},e}(Em),cE=function(t){function e(e,i){t.call(this,e),this.tile=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Nc);const dE="tileloadstart",fE="tileloadend",pE="tileloaderror";function gE(t,e){t.getImage().src=e}const mE=function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:gE,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:null,this.tileClass=void 0!==e.tileClass?e.tileClass:XC,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},e.prototype.expireCache=function(t,e){var i=this.getTileCacheForProjection(t);for(var n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}},e.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!Op(this.getProjection(),t)?0:this.getGutter()},e.prototype.getGutter=function(){return 0},e.prototype.getOpaque=function(e){return!(this.getProjection()&&e&&!Op(this.getProjection(),e))&&t.prototype.getOpaque.call(this,e)},e.prototype.getTileGridForProjection=function(t){var e=this.getProjection();if(!this.tileGrid||e&&!Op(e,t)){var i=vc(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=aE(t)),this.tileGridForProjection[i]}return this.tileGrid},e.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();if(!e||Op(e,t))return this.tileCache;var i=vc(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new iE(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},e.prototype.createTile_=function(t,e,i,n,r,o){var s=[t,e,i],a=this.getTileCoordForTileUrlFunction(s,r),l=a?this.tileUrlFunction(a,n,r):void 0,u=new this.tileClass(s,void 0!==l?Ob:Nb,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,Ac(u,Uc,this.handleTileChange,this),u},e.prototype.getTile=function(t,e,i,n,r){var o=this.getProjection();if(o&&r&&!Op(o,r)){var s,a=this.getTileCacheForProjection(r),l=[t,e,i],u=ZC(l);a.containsKey(u)&&(s=a.get(u));var h=this.getKey();if(s&&s.key==h)return s;var c=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(l,r),p=new nE(o,c,r,d,l,f,this.getTilePixelRatio(n),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return p.key=h,s?(p.interimTile=s,p.refreshInterimChain(),a.replace(u,p)):a.set(u,p),p}return this.getTileInternal(t,e,i,n,o||r)},e.prototype.getTileInternal=function(t,e,i,n,r){var o=null,s=HC(t,e,i),a=this.getKey();if(this.tileCache.containsKey(s)){if((o=this.tileCache.get(s)).key!=a){var l=o;o=this.createTile_(t,e,i,n,r,a),l.getState()==Ob?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(s,o)}}else o=this.createTile_(t,e,i,n,r,a),this.tileCache.set(s,o);return o},e.prototype.setRenderReprojectionEdges=function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},e.prototype.setTileGridForProjection=function(t,e){var i=Lp(t);if(i){var n=vc(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}},e}(function(t){function e(e){t.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,key:e.key,attributionsCollapsible:e.attributionsCollapsible}),this.generateTileUrlFunction_=!e.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,this.tileUrlFunction=e.tileUrlFunction?e.tileUrlFunction.bind(this):tE,this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),e.tileUrlFunction&&this.setTileUrlFunction(e.tileUrlFunction,this.key_),this.tileLoadingKeys_={}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},e.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},e.prototype.getUrls=function(){return this.urls},e.prototype.handleTileChange=function(t){var e,i=t.target,n=vc(i),r=i.getState();r==Db?(this.tileLoadingKeys_[n]=!0,e=dE):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=r==jb?pE:r==$b||r==Bb?fE:void 0),null!=e&&this.dispatchEvent(new cE(e,i))},e.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},e.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},e.prototype.setUrl=function(t){var e=this.urls=eE(t);this.setUrls(e)},e.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){for(var i=t.length,n=new Array(i),r=0;r<i;++r)n[r]=JC(t[r],e);return QC(n)}(t,this.tileGrid),e):this.setKey(e)},e.prototype.useTile=function(t,e,i){var n=HC(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)},e}(hE));var vE="default",yE="truncated",_E=function(t){function e(e,i,n,r,o,s,a){t.call(this,i,n,r,o,s,a),this.zoomifyImage_=null,this.tileSize_=rw(e.getTileSize(i[0]))}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=t.prototype.getImage.call(this);if(this.state==$b){var i=this.tileSize_;if(e.width==i[0]&&e.height==i[1])return this.zoomifyImage_=e,e;var n=wd(i[0],i[1]);return n.drawImage(e,0,0),this.zoomifyImage_=n.canvas,n.canvas}return e},e}(XC);const bE=function(t){function e(e){var i=e||{},n=i.size,r=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:vE,o=n[0],s=n[1],a=i.extent||[0,-n[1],n[0],0],l=[],u=i.tileSize||zb,h=u;switch(r){case vE:for(;o>h||s>h;)l.push([Math.ceil(o/h),Math.ceil(s/h)]),h+=h;break;case yE:for(var c=o,d=s;c>h||d>h;)l.push([Math.ceil(c/h),Math.ceil(d/h)]),c>>=1,d>>=1;break;default:Ad(!1,53)}l.push([1,1]),l.reverse();for(var f=[1],p=[0],g=1,m=l.length;g<m;g++)f.push(1<<g),p.push(l[g-1][0]*l[g-1][1]+p[g-1]);f.reverse();var v=new sE({tileSize:u,extent:a,origin:pf(a),resolutions:f}),y=i.url;y&&-1==y.indexOf("{TileGroup}")&&-1==y.indexOf("{tileIndex}")&&(y+="{TileGroup}/{z}-{x}-{y}.jpg");var _=QC(eE(y).map((function(t){return function(e,i,n){if(e){var r=e[0],o=e[1],s=-e[2]-1,a=o+s*l[r][0],u=v.getTileSize(r),h=Array.isArray(u)?u[0]:u,c={z:r,x:o,y:s,tileIndex:a,TileGroup:"TileGroup"+((a+p[r])/h|0)};return t.replace(/\{(\w+?)\}/g,(function(t,e){return c[e]}))}}}))),b=_E.bind(null,v);t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:b,tileGrid:v,tileUrlFunction:_,transition:i.transition})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(mE);var wE=Ml({props:{resolution:{required:!0}},computed:{zoomLevelText:function(){return(Math.round(100/this.resolution)/100||0)+"x"}}},undefined,undefined,!1,null,null,null);const xE=Ml({components:{zoomLevelIndicator:wE.exports},props:{showZoomLevel:{type:Boolean,default:!1}}},undefined,undefined,!1,null,null,null).exports;const SE=function(t){function e(e){var i=e||{};t.call(this,{element:document.createElement("div"),target:i.target}),this.extent=i.extent?i.extent:null;var n=void 0!==i.className?i.className:"ol-zoom-extent",r=void 0!==i.label?i.label:"E",o=void 0!==i.tipLabel?i.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=o,s.appendChild("string"==typeof r?document.createTextNode(r):r),Ac(s,zc,this.handleClick_,this);var a=n+" "+"ol-unselectable "+yd,l=this.element;l.className=a,l.appendChild(s)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fit(e)},e}(aw);function CE(t){return(CE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function EE(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function TE(t,e){return(TE=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function IE(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=PE(t);if(e){var r=PE(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return AE(this,i)}}function AE(t,e){return!e||"object"!==CE(e)&&"function"!=typeof e?kE(t):e}function kE(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PE(t){return(PE=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}const LE=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&TE(t,e)}(o,t);var e,i,n,r=IE(o);function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=t||{},n=i.label?i.label:"1",s=document.createElement("button");s.innerHTML=n,s.title="Zoom to original resolution",s.addEventListener("click",(function(){e.zoomToNative.call(kE(e))}));var a=document.createElement("div");return a.className="zoom-to-native ol-unselectable ol-control",a.appendChild(s),(e=r.call(this,{element:a,target:i.target})).duration_=void 0!==i.duration?i.duration:250,e}return e=o,(i=[{key:"zoomToNative",value:function(){var t=this.getMap().getView();t&&t.getResolution()&&(this.duration_>0?t.animate({resolution:1,duration:this.duration_}):t.setResolution(1))}}])&&EE(e.prototype,i),n&&EE(e,n),o}(aw);const RE=Ml({mixins:[Ug,hm,L_,O_,W_,eS,dS,SC,TC,AC,qC,xE],components:{minimap:iS,labelIndicator:M_,controlButton:jm},props:{canAdd:{type:Boolean,default:!1},canModify:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},image:{type:Object,default:null},annotations:{type:Array,default:function(){return[]}},selectedAnnotations:{type:Array,default:function(){return[]}},center:{type:Array,default:void 0},resolution:{type:Number,default:void 0},selectedLabel:{default:null},lastCreatedAnnotation:{default:null},annotationOpacity:{type:Number,default:1},annotationMode:{type:String,default:"default"},showMinimap:{type:Boolean,default:!0},listenerSet:{type:String,default:"default"}},data:function(){return{initialized:!1,focusOptions:{padding:50,duration:250,resolution:1},interactionMode:"default",mapSize:[0,0],mousePosition:[0,0],modifyInProgress:!1}},computed:{extent:function(){return this.image?[0,0,this.image.width,this.image.height]:[0,0,0,0]},viewExtent:function(){return this.initialized&&this.resolution&&this.map?this.map.getView().calculateExtent(this.mapSize):[0,0,0,0]},projection:function(){return new up({code:"biigle-image",units:"pixels",extent:this.extent})},selectedFeatures:function(){return this.selectInteraction?this.selectInteraction.getFeatures():[]},isDefaultInteractionMode:function(){return"default"===this.interactionMode},hasSelectedLabel:function(){return Boolean(this.selectedLabel)},hasSelectedAnnotations:function(){return this.selectedAnnotations.length>0},hasLastCreatedAnnotation:function(){return null!==this.lastCreatedAnnotation},previousButtonTitle:function(){switch(this.annotationMode){case"volare":return"Previous annotation";case"lawnmower":return"Previous image section";case"randomSampling":case"regularSampling":return"Previous sample location";default:return"Previous image"}},nextButtonTitle:function(){switch(this.annotationMode){case"volare":return"Next annotation";case"lawnmower":return"Next image section";case"randomSampling":case"regularSampling":return"Next sample location";default:return"Next image"}}},methods:{createMap:function(){var t=new SE({tipLabel:"Zoom to show whole image",label:""});xu.on("-",t.handleZoomToExtent.bind(t),0,this.listenerSet);var e=new Jx({controls:[new dw,t],interactions:Nw({altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1,mouseWheelZoom:!1})});return e.addInteraction(new Dw({condition:function(t){return!pv(t)}})),t=new LE({label:""}),xu.on("+",t.zoomToNative.bind(t),0,this.listenerSet),e.addControl(t),e},declareNonReactiveProperties:function(){this.map=this.createMap(),this.imageLayer=new F_,this.tiledImageLayer=new RC,this.annotationFeatures=new $m,this.annotationSource=new n_({features:this.annotationFeatures}),this.annotationLayer=new Uy({source:this.annotationSource,zIndex:100,updateWhileAnimating:!0,updateWhileInteracting:!0,style:A_.features}),this.selectInteraction=new _C({condition:uv,style:A_.highlight,layers:[this.annotationLayer],multi:!0}),this.canModify&&(this.featureRevisionMap={},this.modifyInteraction=new hS({features:this.selectInteraction.getFeatures(),deleteCondition:function(t){return pv(t)&&dv(t)}}))},updateMapSize:function(){this.mapSize=this.map.getSize()},updateMapView:function(t){var e=t.target.getView();this.$emit("moveend",{center:e.getCenter(),resolution:e.getResolution()})},invertPointsYAxis:function(t){for(var e=this.extent[3],i=1;i<t.length;i+=2)t[i]=e-t[i];return t},convertPointsFromOlToDb:function(t){return this.invertPointsYAxis(Array.prototype.concat.apply([],t))},convertPointsFromDbToOl:function(t){t=this.invertPointsYAxis(t.slice());for(var e=[],i=0;i<t.length;i+=2)e.push([t[i],t[i+1]||0]);return e},getGeometry:function(t){var e=this.convertPointsFromDbToOl(t.points);switch(t.shape){case"Point":return new vg(e[0]);case"Rectangle":return new r_([e]);case"Polygon":return new Lg([e]);case"LineString":return new Ng(e);case"Circle":return new Og(e[0],e[1][0]);case"Ellipse":return new o_([e]);default:return void console.error("Unknown annotation shape: "+t.shape)}},createFeature:function(t){var e=new Nm(this.getGeometry(t));return e.setId(t.id),e.set("annotation",t),t.labels&&t.labels.length>0&&e.set("color",t.labels[0].label.color),e},handleFeatureModifyStart:function(t){var e=this;this.modifyInProgress=!0,t.features.getArray().forEach((function(t){e.featureRevisionMap[t.getId()]=t.getRevision()}))},handleFeatureModifyEnd:function(t){var e=this;this.modifyInProgress=!1;var i=t.features.getArray().filter((function(t){return e.featureRevisionMap[t.getId()]!==t.getRevision()})).map((function(t){return{id:t.getId(),image_id:t.get("annotation").image_id,points:e.getPoints(t.getGeometry())}}));i.length>0&&this.$emit("update",i)},focusAnnotation:function(t,e,i){var n=this.annotationSource.getFeatureById(t.id);if(n){var r=this.map.getView(),o=e?0:this.focusOptions.duration,s=i?this.resolution:this.focusOptions.resolution,a=n.getGeometry().getExtent().slice();if(a[0]-=this.focusOptions.padding,a[1]-=this.focusOptions.padding,a[2]+=this.focusOptions.padding,a[3]+=this.focusOptions.padding,!i){var l=r.getResolutionForExtent(a);s=l>this.focusOptions.resolution?l:s}r.animate({center:uf(a),resolution:s,duration:o})}},fitImage:function(){this.map.getView().fit(this.extent,this.map.getSize())},extractAnnotationFromFeature:function(t){return t.get("annotation")},handleFeatureSelect:function(t){this.$emit("select",t.selected.map(this.extractAnnotationFromFeature),t.deselected.map(this.extractAnnotationFromFeature))},handlePrevious:function(){this.modifyInProgress||this.$emit("previous")},handleScroll:function(t){pv({originalEvent:t})&&(t.deltaY<0?this.handleNext():this.handlePrevious())},handleNext:function(){this.modifyInProgress||this.$emit("next")},resetInteractionMode:function(){this.interactionMode="default"},getPoints:function(t){var e;switch(t.getType()){case"Circle":e=[t.getCenter(),[t.getRadius()]];break;case"Polygon":case"Rectangle":case"Ellipse":e=t.getCoordinates()[0];break;case"Point":e=[t.getCoordinates()];break;default:e=t.getCoordinates()}return this.convertPointsFromOlToDb(e)},handleNewFeature:function(t){var e=this;if(this.hasSelectedLabel){var i=t.feature.getGeometry();t.feature.set("color",this.selectedLabel.color);this.$emit("new",{shape:i.getType(),points:this.getPoints(i)},(function(){try{e.annotationSource.removeFeature(t.feature)}catch(t){}}))}else this.annotationSource.removeFeature(t.feature)},deleteSelectedAnnotations:function(){!this.modifyInProgress&&this.hasSelectedAnnotations&&confirm("Are you sure you want to delete all selected annotations?")&&this.$emit("delete",this.selectedAnnotations)},deleteLastCreatedAnnotation:function(){this.hasLastCreatedAnnotation&&this.$emit("delete",[this.lastCreatedAnnotation])},createPointAnnotationAt:function(t,e){if(this.hasSelectedLabel){var i=new Nm(new vg([t,e]));this.annotationSource.addFeature(i),this.handleNewFeature({feature:i})}else this.requireSelectedLabel()},requireSelectedLabel:function(){this.$emit("requires-selected-label"),this.resetInteractionMode()},render:function(){this.map&&this.map.render()},handleRegularImage:function(t){t?this.imageLayer.setSource(new Rm({canvas:t.canvas,projection:this.projection,canvasExtent:this.extent,canvasSize:[t.width,t.height]})):this.imageLayer.setSource(null)},handleTiledImage:function(t){t?this.tiledImageLayer.setSource(new bE({url:t.url,size:[t.width,t.height],extent:[0,0,t.width,t.height],transition:100})):this.tiledImageLayer.setSource(null)},updateMousePosition:function(t){this.mousePosition=t.coordinate},refreshAnnotationSource:function(t,e){var i={};t.forEach((function(t){i[t.id]=null}));var n={},r=e.getFeatures(),o=r.filter((function(t){return n[t.getId()]=null,!i.hasOwnProperty(t.getId())}));o.length===r.length?e.clear(!0):(o.filter((function(t){return void 0!==t.getId()})).forEach((function(t){e.removeFeature(t)})),t=t.filter((function(t){return!n.hasOwnProperty(t.id)}))),e.addFeatures(t.map(this.createFeature))}},watch:{image:function(t,e){t?!0===t.tiled?(e&&!0===e.tiled||(this.map.removeLayer(this.imageLayer),this.map.addLayer(this.tiledImageLayer)),this.handleTiledImage(t,e)):(e&&!0!==e.tiled||(this.map.removeLayer(this.tiledImageLayer),this.map.addLayer(this.imageLayer)),this.handleRegularImage(t,e)):(this.map.removeLayer(this.tiledImageLayer),this.map.removeLayer(this.imageLayer))},annotations:function(t){this.refreshAnnotationSource(t,this.annotationSource),this.resetHoveredAnnotations()},selectedAnnotations:function(t){var e=this.annotationSource,i=this.selectedFeatures;i.clear(),t.forEach((function(t){i.push(e.getFeatureById(t.id))}))},extent:function(t,e){if(t[2]!==e[2]||t[3]!==e[3]){var i=uf(t);this.initialized||(i=this.center||i),this.map.setView(new ew({projection:this.projection,center:i,resolution:this.resolution,zoomFactor:2,minResolution:.01,extent:t})),void 0===this.resolution&&this.map.getView().fit(t),this.initialized||(this.updateMapView({target:this.map}),this.initialized=!0)}},annotationOpacity:function(t){this.annotationLayer.setOpacity(t)},isDefaultInteractionMode:function(t){this.selectInteraction.setActive(t||this.isTranslating),this.canModify&&this.modifyInteraction.setActive(t)}},created:function(){var t=this;this.declareNonReactiveProperties(),this.annotationLayer.set("name","annotations"),this.map.addLayer(this.annotationLayer),this.imageLayer.set("name","imageRegular"),this.tiledImageLayer.set("name","imageTile"),wu.$on("sidebar.toggle",(function(){t.$nextTick((function(){t.map.updateSize()}))})),this.map.on("change:size",this.updateMapSize),this.map.on("moveend",this.updateMapView),this.map.on("pointermove",this.updateMousePosition),this.selectInteraction.on("select",this.handleFeatureSelect),this.map.addInteraction(this.selectInteraction),xu.on(" ",this.handleNext,0,this.listenerSet),xu.on("ArrowRight",this.handleNext,0,this.listenerSet),xu.on("ArrowLeft",this.handlePrevious,0,this.listenerSet),xu.on("Escape",this.resetInteractionMode,0,this.listenerSet),this.canModify&&(this.modifyInteraction.on("modifystart",this.handleFeatureModifyStart),this.modifyInteraction.on("modifyend",this.handleFeatureModifyEnd),this.map.addInteraction(this.modifyInteraction)),this.canDelete&&(xu.on("Delete",this.deleteSelectedAnnotations,0,this.listenerSet),xu.on("Backspace",this.deleteLastCreatedAnnotation,0,this.listenerSet))},mounted:function(){this.map.setTarget(this.$el)}},undefined,undefined,!1,null,null,null).exports;const FE=Ml(new Vue({data:{cache:{}},computed:{shapeMap:function(){return biigle.$require("annotations.shapes")},inverseShapeMap:function(){var t={};for(var e in this.shapeMap)t[this.shapeMap[e]]=parseInt(e,10);return t}},methods:{parseResponse:function(t){return t.data},resolveShape:function(t){return t.shape=this.shapeMap[t.shape_id],t},resolveAllShapes:function(t){return t.forEach(this.resolveShape,this),t},setDeselected:function(t){return t.selected=!1,t},setAllDeselected:function(t){return t.forEach(this.setDeselected),t},fetchAnnotations:function(t){return this.cache.hasOwnProperty(t)||(this.cache[t]=lu.getAnnotations({id:t}).catch((function(){return Vue.Promise.reject("Failed to load annotations for image ".concat(t,"!"))})).then(this.parseResponse).then(this.resolveAllShapes)),this.cache[t].then(this.setAllDeselected)},create:function(t,e){var i=this;return e.shape_id=this.inverseShapeMap[e.shape],delete e.shape,lu.saveAnnotations({id:t},e).then(this.parseResponse).then(this.resolveShape).then(this.setDeselected).then((function(e){return i.cache[t].then((function(t){t.unshift(e)})),e}))},update:function(t){var e=this,i=au.update({id:t.id},{points:t.points});return i.then((function(){e.cache[t.image_id].then((function(e){for(var i=e.length-1;i>=0;i--)if(e[i].id===t.id)return void(e[i].points=t.points)}))})),i},attachLabel:function(t,e){var i=au.attachLabel({id:t.id},e);return i.then((function(e){t.labels.unshift(e.data)}),(function(){})),i},detachLabel:function(t,e){var i=au.detachLabel({annotation_label_id:e.id});return i.then((function(){for(var i=t.labels.length-1;i>=0;i--)if(t.labels[i].id===e.id)return void t.labels.splice(i,1)})),i},delete:function(t){var e=au.delete({id:t.id}),i=this.cache[t.image_id];return e.then((function(){i.then((function(e){for(var i=e.length-1;i>=0;i--)if(e[i].id===t.id)return void e.splice(i,1)}))})),e}}}),undefined,undefined,!1,null,null,null).exports;var ME=i(2789),OE=i.n(ME);const DE=Ml(new Vue({data:{initialized:!1,cache:{},cachedIds:[],maxCacheSize:10,supportsColorAdjustment:!1,currentlyDrawnImage:null,colorAdjustmentDefaults:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]},colorAdjustment:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]}},computed:{imageFileUri:function(){return biigle.$require("annotations.imageFileUri")},tilesUri:function(){return biigle.$require("annotations.tilesUri")},supportedTextureSize:function(){return this.fxCanvas?this.fxCanvas._.gl.getParameter(this.fxCanvas._.gl.MAX_TEXTURE_SIZE):0},hasColorAdjustment:function(){for(var t in this.colorAdjustment)if(this.colorAdjustment.hasOwnProperty(t)&&this.isAdjustmentActive(t))return!0;return!1}},methods:{initialize:function(){this.initialized=!0,this.drawCanvas=document.createElement("canvas"),this.drawCanvas.style.imageOrientation="none",this.drawCanvas.style.visibility="hidden",this.drawCanvas.style.position="fixed",document.body.appendChild(this.drawCanvas);try{this.fxCanvas=OE().canvas(),this.fxTexture=null,this.loadedImageTexture=null}catch(t){console.warn("WebGL not supported. Color adjustment disabled.")}window.addEventListener("beforeunload",(function(){this.fxTexture&&(this.fxTexture.destroy(),this.fxCanvas.width=1,this.fxCanvas.height=1)}))},isTiledImage:function(t){return!0===t.tiled},isAdjustmentActive:function(t){var e=this;return this.colorAdjustment[t].some((function(i,n){return i!==e.colorAdjustmentDefaults[t][n]}))},checkSupportsColorAdjustment:function(t){if(!this.fxCanvas||t.crossOrigin)return!1;if(this.isTiledImage(t))this.supportsColorAdjustment=!1;else{if(this.currentlyDrawnImage&&this.currentlyDrawnImage.width===t.width&&this.currentlyDrawnImage.height===t.height)return this.supportsColorAdjustment;var e=this.supportedTextureSize;if(e<t.width||e<t.height)return console.warn("Insufficient WebGL texture size. Required: ".concat(t.width,"x").concat(t.height,", available: ").concat(e,"x").concat(e,". Color adjustment disabled.")),void(this.supportsColorAdjustment=!1);var i=OE().canvas();if(i.width=t.width,i.height=t.height,t.width!==i._.gl.drawingBufferWidth||t.height!==i._.gl.drawingBufferHeight)return console.warn("Your browser does not allow a WebGL drawing buffer with the size of the original image. Color adjustment disabled."),void(this.supportsColorAdjustment=!1);this.supportsColorAdjustment=!0}},createImage:function(t){var e=this,i=document.createElement("img"),n={id:t,source:i,width:0,height:0,canvas:document.createElement("canvas"),crossOrigin:!1};i.style.imageOrientation="none",i.style.visibility="hidden",i.style.position="fixed",document.body.appendChild(i);var r=new Vue.Promise((function(e,r){i.onload=function(){n.width=i.width,n.height=i.height,e(n)},i.onerror=function(){r("Failed to load image ".concat(t,"!"))}}));return r.finally((function(){document.body.removeChild(i)})),Vue.http.get(this.imageFileUri.replace(":id",t),{responseType:"blob"}).then((function(t){if("application/json"===t.headers.get("content-type")){var n=t.body.uuid;return t.body.url=e.tilesUri.replace(":uuid",n[0]+n[1]+"/"+n[2]+n[3]+"/"+n),t.body}return t.blob().then((function(t){var e=window.URL||window.webkitURL;i.src=e.createObjectURL(t)})),r})).catch((function(e){return 0===e.status?(n.crossOrigin=!0,i.src=e.url,r):Vue.Promise.reject("Failed to load image ".concat(t,"!"))}))},drawSimpleImage:function(t){return document.body.appendChild(t.source),this.drawCanvas.width=t.width,this.drawCanvas.height=t.height,this.drawCanvas.getContext("2d").drawImage(t.source,0,0),document.body.removeChild(t.source),t.canvas.width=t.width,t.canvas.height=t.height,t.canvas.getContext("2d").drawImage(this.drawCanvas,0,0),t},drawColorAdjustedImage:function(t){for(var e in this.loadedImageTexture!==t.source.src&&(document.body.appendChild(t.source),this.drawCanvas.width=t.width,this.drawCanvas.height=t.height,this.drawCanvas.getContext("2d").drawImage(t.source,0,0),document.body.removeChild(t.source),this.fxTexture?this.fxTexture.loadContentsOf(this.drawCanvas):this.fxTexture=this.fxCanvas.texture(this.drawCanvas),this.loadedImageTexture=t.source.src),this.fxCanvas.draw(this.fxTexture),this.colorAdjustment)this.colorAdjustment.hasOwnProperty(e)&&this.isAdjustmentActive(e)&&this.fxCanvas[e].apply(this.fxCanvas,this.colorAdjustment[e]);return this.fxCanvas.update(),t.canvas.width=t.width,t.canvas.height=t.height,t.canvas.getContext("2d").drawImage(this.fxCanvas,0,0),t},drawImage:function(t){return this.initialized||this.initialize(),this.checkSupportsColorAdjustment(t),this.currentlyDrawnImage=t,this.supportsColorAdjustment&&this.hasColorAdjustment?this.drawColorAdjustedImage(t):this.isTiledImage(t)?t:this.drawSimpleImage(t)},fetchImage:function(t){return this.cache.hasOwnProperty(t)||(wu.$emit("images.fetching",t),this.cache[t]=this.createImage(t),this.cachedIds.push(t)),this.cache[t]},fetchAndDrawImage:function(t){return this.fetchImage(t).then(this.drawImage)},updateColorAdjustment:function(t){if(this.supportsColorAdjustment){var e,i,n=this.colorAdjustment,r=this.hasColorAdjustment;for(e in t)if(t.hasOwnProperty(e))for(i=t[e].length-1;i>=0;i--)n[e].splice(i,1,t[e][i]);this.hasColorAdjustment?this.drawColorAdjustedImage(this.currentlyDrawnImage):r&&this.drawSimpleImage(this.currentlyDrawnImage)}}},watch:{cachedIds:function(t){if(t.length>this.maxCacheSize){var e=t.shift();delete this.cache[e]}}}}),undefined,undefined,!1,null,null,null).exports;const $E=Ml({props:{annotationFilters:{type:Array,default:function(){return[]}},hasActiveFilter:{type:Boolean,default:!1}},data:function(){return{chosenFilterIndex:null}},computed:{hasFilters:function(){return this.annotationFilters.length>0},chosenFilter:function(){return this.annotationFilters[this.chosenFilterIndex]},clearButtonClass:function(){return{"btn-info":this.hasActiveFilter}}},methods:{emitSelectFilter:function(t){this.$emit("select",t)},emitUnselectFilter:function(){this.$emit("unselect")}},watch:{chosenFilter:function(t,e){e&&(this.$refs.filterElement.removeChild(e.$el),e.$off("select",this.emitSelectFilter),e.$off("unselect",this.emitUnselectFilter)),this.$refs.filterElement.appendChild(t.$el),t.$on("select",this.emitSelectFilter),t.$on("unselect",this.emitUnselectFilter)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("form",{staticClass:"annotations-tab__filter form-inline",on:{submit:function(t){t.preventDefault()}}},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.chosenFilterIndex,expression:"chosenFilterIndex"}],staticClass:"form-control",on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.chosenFilterIndex=e.target.multiple?i:i[0]}}},t._l(t.annotationFilters,(function(e,n){return i("option",{domProps:{value:n,textContent:t._s(e.name)}})})),0),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.chosenFilter,expression:"chosenFilter"}],ref:"filterElement"}),t._v(" "),i("input",{directives:[{name:"show",rawName:"v-show",value:!t.chosenFilter,expression:"!chosenFilter"}],staticClass:"form-control",attrs:{placeholder:"Filter annotations",type:"text",disabled:"true"}}),t._v(" "),i("button",{staticClass:"btn btn-default",class:t.clearButtonClass,attrs:{title:"Clear annotation filter",disabled:!t.hasActiveFilter},on:{click:function(e){return e.preventDefault(),t.emitUnselectFilter(e)}}},[i("i",{staticClass:"fa fa-times"})])])}),[],!1,null,null,null).exports;var jE=Ml({props:{annotation:{type:Object,required:!0},annotationLabel:{type:Object,required:!0},canDetach:{type:Boolean,default:!1}},computed:{classObject:function(){return{selected:!1!==this.annotation.selected}},shapeClass:function(){return"icon-"+this.annotation.shape.toLowerCase()},username:function(){return this.annotationLabel.user?this.annotationLabel.user.firstname+" "+this.annotationLabel.user.lastname:"(user deleted)"}},methods:{emitSelect:function(t){this.$emit("select",this.annotation,t.shiftKey)},emitDetach:function(){this.$emit("detach",this.annotation,this.annotationLabel)},emitFocus:function(){this.$emit("focus",this.annotation)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"annotations-tab-item__sub-item",class:t.classObject,attrs:{"data-annotation-id":t.annotation.id},on:{click:t.emitSelect,dblclick:t.emitFocus}},[t.canDetach?i("button",{staticClass:"close",attrs:{type:"button",title:"Detach this label from the annotation"},on:{click:function(e){return e.stopPropagation(),t.emitDetach(e)}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]):t._e(),t._v(" "),i("span",{staticClass:"icon",class:t.shapeClass}),t._v(" "),i("span",{domProps:{textContent:t._s(t.username)}})])}),[],!1,null,null,null);var NE=Ml({components:{annotationItem:jE.exports},props:{label:{type:Object,default:function(){return{}}},annotations:{type:Array,default:function(){return[]}},canDetachOthers:{type:Boolean,default:!1},ownUserId:{type:Number,default:null}},data:function(){return{open:!1}},computed:{title:function(){return"Annotations with label ".concat(this.label.name)},classObject:function(){return{selected:this.isSelected}},count:function(){return this.annotationItems.length},countTitle:function(){return"There are ".concat(this.count," annotations with label ").concat(this.label.name)},colorStyle:function(){return"background-color: #"+this.label.color},isSelected:function(){return this.open||this.annotations.reduce((function(t,e){return t||!1!==e.selected}),!1)},annotationItems:function(){var t=this,e=[];return this.annotations.forEach((function(i){i.labels.forEach((function(n){n.label_id===t.label.id&&e.push({annotation:i,annotationLabel:n,canDetach:t.canDetachAnnotationLabel(n)})}))})),e}},methods:{toggleOpen:function(){this.open=!this.open},emitSelect:function(t,e){this.$emit("select",t,e)},emitDetach:function(t,e){this.$emit("detach",t,e)},emitFocus:function(t){this.$emit("focus",t)},canDetachAnnotationLabel:function(t){return this.canDetachOthers||this.ownUserId===t.user_id}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"annotations-tab-item",class:t.classObject,attrs:{title:t.title}},[i("div",{staticClass:"annotations-tab-item__title",on:{click:t.toggleOpen}},[i("span",{staticClass:"pull-right badge",attrs:{title:t.countTitle},domProps:{textContent:t._s(t.count)}}),t._v(" "),i("span",{staticClass:"annotations-tab-item__color",style:t.colorStyle}),t._v(" "),i("span",{domProps:{textContent:t._s(t.label.name)}})]),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.isSelected,expression:"isSelected"}],staticClass:"annotations-tab-item__list list-unstyled"},t._l(t.annotationItems,(function(e){return i("annotation-item",{key:e.annotationLabel.id,attrs:{annotation:e.annotation,"annotation-label":e.annotationLabel,"can-detach":e.canDetach},on:{select:t.emitSelect,detach:t.emitDetach,focus:t.emitFocus}})})),1)])}),[],!1,null,null,null);const BE=Ml({components:{filters:$E,labelItem:NE.exports},props:{hasActiveFilter:{type:Boolean,default:!1},annotations:{type:Array,default:function(){return[]}},annotationFilters:{type:Array,default:function(){return[]}},canDetachOthers:{type:Boolean,default:!1},ownUserId:{type:Number,default:null},selectedAnnotations:{type:Array,default:function(){return[]}}},computed:{labelItems:function(){var t={},e={},i={};return this.annotations.forEach((function(n){n.labels.forEach((function(r){t.hasOwnProperty(r.label.id)||(t[r.label_id]=r.label,e[r.label_id]=[]);var o=n.id+"-"+r.label_id;i.hasOwnProperty(o)||(i[o]=null,e[r.label_id].push(n))}))})),Object.values(t).sort((function(t,e){return t.name.toLowerCase()>e.name.toLowerCase()?1:-1})).map((function(t){return{id:t.id,label:t,annotations:e[t.id]}}))}},methods:{handleSelect:function(t,e){!1!==t.selected&&e?this.$emit("deselect",t):this.$emit("select",t,e)},emitDetach:function(t,e){this.$emit("detach",t,e)},emitSelectFilter:function(t){this.$emit("select-filter",t)},emitUnselectFilter:function(){this.$emit("unselect-filter")},emitFocus:function(t){this.$emit("focus",t)},scrollIntoView:function(t){var e,i=this.$refs.scrollList,n=i.scrollTop,r=i.offsetHeight,o=1/0,s=0;t.forEach((function(t){for(var n=i.querySelectorAll('[data-annotation-id="'.concat(t.id,'"]')),r=n.length-1;r>=0;r--)e=n[r],o=Math.min(e.offsetTop,o),s=Math.max(e.offsetTop+e.offsetHeight,s)})),n>o?i.scrollTop=o:n+r<s&&(i.scrollTop=r>=s-o?s-i.offsetHeight:o)}},watch:{selectedAnnotations:function(t){t.length>0&&this.$nextTick((function(){this.scrollIntoView(t)}))}}},undefined,undefined,!1,null,null,null).exports;var UE={};const GE=Ml({mixins:[BE],computed:{plugins:function(){return UE}}},undefined,undefined,!1,null,null,null).exports;var VE={};const zE=Ml({components:{labelTrees:Xu},data:function(){return{labelTrees:[],selectedLabel:null}},computed:{plugins:function(){return VE}},methods:{handleSelectedLabel:function(t){this.selectedLabel=t,this.$emit("select",t)},handleDeselectedLabel:function(){this.selectedLabel=null,this.$emit("select",null)}},created:function(){this.labelTrees=biigle.$require("annotations.labelTrees")}},undefined,undefined,!1,null,null,null).exports;const qE=Ml({data:function(){return{filenames:{},currentId:null}},computed:{filename:function(){if(this.currentId){var t=this.filenames[this.currentId].split(".");return t.length>1&&(t[t.length-1]="png"),"biigle_screenshot_"+(t=t.join(".").toLowerCase())}return"biigle_screenshot.png"}},methods:{trimCanvas:function(t){var e,i,n,r=t.getContext("2d"),o=document.createElement("canvas").getContext("2d"),s=r.getImageData(0,0,t.width,t.height),a=s.data.length,l={top:null,left:null,right:null,bottom:null};for(e=0;e<a;e+=4)0!==s.data[e+3]&&(i=e/4%t.width,n=~~(e/4/t.width),null===l.top&&(l.top=n),(null===l.left||i<l.left)&&(l.left=i),(null===l.right||l.right<i)&&(l.right=i),(null===l.bottom||l.bottom<n)&&(l.bottom=n));var u=l.bottom-l.top,h=l.right-l.left,c=r.getImageData(l.left,l.top,h,u);return o.canvas.width=h,o.canvas.height=u,o.putImageData(c,0,0),o.canvas},makeBlob:function(t){try{t=this.trimCanvas(t)}catch(t){return Vue.Promise.reject("Could not create screenshot. Maybe the image is not loaded yet?")}var e="image/png";if(HTMLCanvasElement.prototype.toBlob)return new Vue.Promise((function(i){t.toBlob(i,e)}));for(var i=atob(t.toDataURL(e).split(",")[1]),n=i.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=i.charCodeAt(o);return new Vue.Promise((function(t){t(new Blob([r],{type:e}))}))},download:function(t){var e=document.createElement("a");e.style="display: none",e.download=this.filename,e.href=URL.createObjectURL(t),document.body.appendChild(e),e.click(),window.setTimeout((function(){document.body.removeChild(e),URL.revokeObjectURL(e.href)}),100)},capture:function(){var t=this;this.map&&(this.map.once("postcompose",(function(e){t.makeBlob(e.context.canvas).then(t.download).catch(t.handleError)})),this.map.renderSync())},handleError:function(t){Ou.danger(t)},setMap:function(t){this.map=t},updateCurrentId:function(t){this.currentId=t}},created:function(){var t=biigle.$require("annotations.imagesIds"),e={};biigle.$require("annotations.imagesFilenames").forEach((function(i,n){e[t[n]]=i})),this.filenames=e,this.currentId=biigle.$require("annotations.imageId"),wu.$on("images.change",this.updateCurrentId),wu.$on("annotations.map.init",this.setMap)}},undefined,undefined,!1,null,null,null).exports;var WE={annotationOpacity:1,mousePosition:!1,zoomLevel:!1,scaleLine:!1,labelTooltip:!1,measureTooltip:!1,minimap:!0,progressIndicator:!0,randomSamplingNumber:9,regularSamplingRows:3,regularSamplingColumns:3};const KE=new ju({data:{urlParams:Object.keys(WE),storageKey:"biigle.annotations.settings",defaults:WE}});var XE={};const YE=Ml({components:{screenshotButton:qE,powerToggle:_u},props:{image:{type:Object,default:null}},data:function(){return{restoreKeys:["annotationOpacity","mousePosition","zoomLevel","scaleLine","labelTooltip","measureTooltip","minimap","progressIndicator"],annotationOpacity:1,mousePosition:!1,zoomLevel:!1,scaleLine:!1,labelTooltip:!1,measureTooltip:!1,minimap:!0,progressIndicator:!0}},computed:{plugins:function(){return XE},crossOrigin:function(){return this.image&&this.image.crossOrigin},settings:function(){return KE}},methods:{showMousePosition:function(){this.mousePosition=!0},hideMousePosition:function(){this.mousePosition=!1},showZoomLevel:function(){this.zoomLevel=!0},hideZoomLevel:function(){this.zoomLevel=!1},showScaleLine:function(){this.scaleLine=!0},hideScaleLine:function(){this.scaleLine=!1},showLabelTooltip:function(){this.labelTooltip=!0,this.measureTooltip=!1},hideLabelTooltip:function(){this.labelTooltip=!1},showMeasureTooltip:function(){this.measureTooltip=!0,this.labelTooltip=!1},hideMeasureTooltip:function(){this.measureTooltip=!1},showMinimap:function(){this.minimap=!0},hideMinimap:function(){this.minimap=!1},showProgressIndicator:function(){this.progressIndicator=!0},hideProgressIndicator:function(){this.progressIndicator=!1},toggleAnnotationOpacity:function(){this.annotationOpacity>0?this.annotationOpacity=0:this.annotationOpacity=1}},watch:{annotationOpacity:function(t){t=parseFloat(t),this.$emit("change","annotationOpacity",t),this.settings.set("annotationOpacity",t)},mousePosition:function(t){this.$emit("change","mousePosition",t),this.settings.set("mousePosition",t)},zoomLevel:function(t){this.$emit("change","zoomLevel",t),this.settings.set("zoomLevel",t)},scaleLine:function(t){this.$emit("change","scaleLine",t),this.settings.set("scaleLine",t)},labelTooltip:function(t){this.$emit("change","labelTooltip",t),this.settings.set("labelTooltip",t)},measureTooltip:function(t){this.$emit("change","measureTooltip",t),this.settings.set("measureTooltip",t)},minimap:function(t){this.$emit("change","minimap",t),this.settings.set("minimap",t)},progressIndicator:function(t){this.$emit("change","progressIndicator",t),this.settings.set("progressIndicator",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){t[e]=t.settings.get(e)})),xu.on("o",this.toggleAnnotationOpacity)}},undefined,undefined,!1,null,null,null).exports;biigle.$declare("annotations.components.annotationCanvas",RE),biigle.$declare("annotations.components.annotationsTabPlugins",UE),biigle.$declare("annotations.components.labelsTabPlugins",VE),biigle.$declare("annotations.components.settingsTabPlugins",XE),biigle.$declare("annotations.ol.AttachLabelInteraction",am),biigle.$declare("annotations.stores.annotations",FE),biigle.$declare("annotations.stores.images",DE),biigle.$declare("annotations.stores.styles",A_);var HE=i(6442),ZE={insert:"head",singleton:!1};Ll()(HE.Z,ZE);HE.Z.locals;const JE=Ml({components:{powerToggle:_u},data:function(){return{mode:"default",modes:["default","volare","lawnmower","randomSampling","regularSampling"],restoreKeys:["randomSamplingNumber","regularSamplingRows","regularSamplingColumns"],randomSamplingNumber:9,regularSamplingRows:3,regularSamplingColumns:3}},computed:{isVolareActive:function(){return"volare"===this.mode},isLawnmowerActive:function(){return"lawnmower"===this.mode},isRandomSamplingActive:function(){return"randomSampling"===this.mode},isRegularSamplingActive:function(){return"regularSampling"===this.mode}},methods:{startVolare:function(){this.setMode("volare")},startLawnmower:function(){this.setMode("lawnmower")},startRandomSampling:function(){this.setMode("randomSampling")},startRegularSampling:function(){this.setMode("regularSampling")},setMode:function(t){-1!==this.modes.indexOf(t)&&(this.mode=t)},resetMode:function(){this.mode="default"},emitAttachLabel:function(){this.$emit("attach-label")},emitCreateSample:function(){this.$emit("create-sample")}},watch:{mode:function(t,e){switch(e){case"volare":xu.off("Enter",this.emitAttachLabel);break;case"randomSampling":case"regularSampling":xu.off("Enter",this.emitCreateSample)}switch(t){case"volare":xu.on("Enter",this.emitAttachLabel);break;case"randomSampling":case"regularSampling":xu.on("Enter",this.emitCreateSample)}switch(t){case"randomSampling":this.$emit("change",t,this.randomSamplingNumber);break;case"regularSampling":this.$emit("change",t,[this.regularSamplingRows,this.regularSamplingColumns]);break;default:this.$emit("change",t)}},randomSamplingNumber:function(t){KE.set("randomSamplingNumber",t)},regularSamplingRows:function(t){KE.set("regularSamplingRows",t)},regularSamplingColumns:function(t){KE.set("regularSamplingColumns",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){return t[e]=KE.get(e)}));var e=Au.get("annotationMode");e&&wu.$once("images.change",(function(){return t.setMode(e)}))}},undefined,undefined,!1,null,null,null).exports;const QE=Ml({data:function(){return{isBrightnessRgbActive:!1,colorAdjustmentDefaults:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]},colorAdjustment:{brightnessContrast:[0,0],brightnessRGB:[0,0,0],hueSaturation:[0,0],vibrance:[0],gamma:[1]}}},methods:{resetType:function(t,e){void 0!==e?this.colorAdjustment[t].splice(e,1,this.colorAdjustmentDefaults[t][e]):this.colorAdjustment[t]=this.colorAdjustmentDefaults[t].slice()},reset:function(){for(var t in this.colorAdjustment)this.colorAdjustment.hasOwnProperty(t)&&this.resetType(t)},toggleBrightnessRgb:function(){this.isBrightnessRgbActive?this.resetType("brightnessRGB"):this.resetType("brightnessContrast",0),this.isBrightnessRgbActive=!this.isBrightnessRgbActive}},watch:{colorAdjustment:{handler:function(){this.$emit("change",this.colorAdjustment)},deep:!0}}},undefined,undefined,!1,null,null,null).exports;const tT=Ml({mixins:[$u],components:{fileLabelList:oc},props:{fileId:{required:!0,type:Number},selectedLabel:{type:Object,default:null},type:{type:String,default:"image"}},data:function(){return{cache:{},open:!1,currentLabels:[],saving:!1,userId:null,isAdmin:!1}},computed:{hasLabels:function(){return this.currentLabels.length>0},hasSelectedLabel:function(){return null!==this.selectedLabel},canAttachSelectedLabel:function(){if(this.hasSelectedLabel){for(var t=this.currentLabels.length-1;t>=0;t--)if(this.currentLabels[t].label.id===this.selectedLabel.id)return!1;return!this.saving}return!1},proposedLabelTitle:function(){return this.hasSelectedLabel?this.canAttachSelectedLabel?"Attach '".concat(this.selectedLabel.name,"' as new ").concat(this.type," label"):"The selected label is already attached.":"Please select a label first."}},methods:{startSaving:function(){this.saving=!0},finishSaving:function(){this.saving=!1},showFileLabels:function(t){this.cache.hasOwnProperty(t)||(this.startLoading(),this.currentLabels=[],"image"===this.type?this.cache[t]=ic.query({image_id:t}):this.cache[t]=nc.query({video_id:t}),this.cache[t].finally(this.finishLoading)),this.cache[t].then(this.updateCurrentLabels,Mu)},updateCurrentLabels:function(t){this.currentLabels=t.body},handleDeletedLabel:function(t){for(var e=this.currentLabels.length-1;e>=0;e--)if(this.currentLabels[e].id===t.id){this.currentLabels.splice(e,1);break}},attachSelectedLabel:function(){var t=this;this.startSaving(),("image"===this.type?ic.save({image_id:this.fileId},{label_id:this.selectedLabel.id}):nc.save({video_id:this.fileId},{label_id:this.selectedLabel.id})).then((function(e){return t.currentLabels.push(e.data)}),Mu).finally(this.finishSaving)},attachSelectedLabelIfPossible:function(){if(this.canAttachSelectedLabel)return this.attachSelectedLabel(),!1}},watch:{fileId:function(t){this.open&&this.showFileLabels(t)},open:function(t){t?(this.showFileLabels(this.fileId),xu.on("Enter",this.attachSelectedLabelIfPossible)):xu.off("Enter",this.attachSelectedLabelIfPossible)}},created:function(){var t=this;this.$parent.$watch("open",(function(e){return t.open=e}))}},undefined,undefined,!1,null,null,null).exports;const eT=Ml({mixins:[tT],created:function(){this.userId=biigle.$require("annotations.userId"),this.isAdmin=biigle.$require("annotations.isAdmin")}},undefined,undefined,!1,null,null,null).exports;const iT=Ml({components:{typeahead:Eu},data:function(){return{name:"",placeholder:"",selectedItem:null}},computed:{items:function(){return[]},selectedItemName:function(){return this.selectedItem?this.selectedItem.name:""}},methods:{select:function(t){this.selectedItem=t},filter:function(t){return t},reset:function(){this.selectedItem=null}},watch:{selectedItem:function(t){t?this.$emit("select",this):this.$emit("unselect")}},created:function(){this.$mount()}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("typeahead",{attrs:{items:t.items,placeholder:t.placeholder,value:t.selectedItemName},on:{select:t.select}})}),[],!1,null,null,null).exports;const nT=Ml(Vue.extend({mixins:[iT],components:{typeahead:Ku},data:function(){return{name:"label",annotations:[],placeholder:"label name"}},computed:{items:function(){var t={};return this.annotations.forEach((function(e){e.labels.forEach((function(e){t[e.label.id]=e.label}))})),Object.values(t)}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem.id;return t.filter((function(t){return t.labels.reduce((function(t,i){return t||i.label.id===e}),!1)}))}}}),undefined,undefined,!1,null,null,null).exports;const rT=Ml(Vue.extend({mixins:[iT],data:function(){return{name:"session",sessions:[],placeholder:"session name"}},computed:{items:function(){return this.sessions.map((function(t){return t.starts_at=new Date(t.starts_at),t.ends_at=new Date(t.ends_at),t}))}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem,i={};return e.users.forEach((function(t){i[t.id]=null})),t.filter((function(t){for(var n=t.labels.length-1;n>=0;n--)if(i.hasOwnProperty(t.labels[n].user_id)){var r=new Date(t.created_at);return r>=e.starts_at&&r<e.ends_at}return!1}))}}}),undefined,undefined,!1,null,null,null).exports;const oT=Ml(Vue.extend({mixins:[iT],data:function(){return{name:"shape",shapes:[],placeholder:"shape name"}},computed:{items:function(){var t=this;return Object.keys(this.shapes).map((function(e){return{id:parseInt(e),name:t.shapes[e]}}))}},methods:{filter:function(t){var e=this;return this.selectedItem?t.filter((function(t){return t.shape_id===e.selectedItem.id})):t}}}),undefined,undefined,!1,null,null,null).exports;const sT=Ml(Vue.extend({mixins:[iT],data:function(){return{name:"user",annotations:[],placeholder:"user name"}},computed:{items:function(){var t={};return this.annotations.forEach((function(e){e.labels.forEach((function(e){t[e.user_id]=e.user}))})),Object.values(t).map((function(t){return t.name=t.firstname+" "+t.lastname,t}))}},methods:{filter:function(t){if(!this.selectedItem)return t;var e=this.selectedItem.id;return t.filter((function(t){return t.labels.reduce((function(t,i){return t||i.user_id===e}),!1)}))}}}),undefined,undefined,!1,null,null,null).exports,aT=Vue.resource("api/v1/volumes{/id}/images/area");function lT(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return uT(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return uT(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw o}}}}function uT(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function hT(t){return(hT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}const cT=Ml({mixins:[$u],components:{sidebar:Su,sidebarTab:Cu,annotationsTab:GE,labelsTab:zE,annotationModesTab:JE,colorAdjustmentTab:QE,imageLabelTab:eT,settingsTab:YE,annotationCanvas:RE},data:function(){return{allImagesIds:[],volumeId:null,isEditor:!1,imageIndex:null,image:null,annotations:[],annotationFilter:null,annotationFilters:[],lastCreatedAnnotation:null,lastCreatedAnnotationTimeout:null,annotationOpacity:1,mapCenter:void 0,mapResolution:void 0,selectedLabel:null,annotationMode:"default",focussedAnnotationIndex:null,annotationModeCarry:null,showMousePosition:!1,showZoomLevel:!1,showLabelTooltip:!1,showMeasureTooltip:!1,showMinimap:!0,showScaleLine:!1,imagesArea:null,openTab:null,userUpdatedVolareResolution:!1,userId:null}},computed:{imageId:function(){return this.imagesIds[this.imageIndex]},hasAnnotationFilter:function(){return null!==this.annotationFilter},filteredAnnotations:function(){var t=this.annotations.filter((function(t){return!t.markedForDeletion}));return this.annotationFilter?this.annotationFilter.filter(t):t},selectedAnnotations:function(){return this.filteredAnnotations.filter((function(t){return t.selected}))},supportsColorAdjustment:function(){return DE.supportsColorAdjustment},focussedAnnotation:function(){return this.filteredAnnotations[this.focussedAnnotationIndex]},isDefaultAnnotationMode:function(){return"default"===this.annotationMode},isVolareAnnotationMode:function(){return"volare"===this.annotationMode},isLawnmowerAnnotationMode:function(){return"lawnmower"===this.annotationMode},isSamplingAnnotationMode:function(){return this.annotationMode.endsWith("Sampling")},imagesIds:function(){var t=this.allImagesIds.slice(),e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t}},methods:{getImageAndAnnotationsPromises:function(t){return[DE.fetchAndDrawImage(t),FE.fetchAnnotations(t)]},setCurrentImageAndAnnotations:function(t){t?(this.image=t[0],this.annotations=t[1]):(this.image=null,this.annotations=[])},updateUrlSlug:function(){Au.setSlug(this.imageId,-2)},getNextIndex:function(t){return(t+1)%this.imagesIds.length},getPreviousIndex:function(t){return(t+this.imagesIds.length-1)%this.imagesIds.length},handleNext:function(){if(!this.loading){if(this.isVolareAnnotationMode){if(this.focussedAnnotationIndex<this.filteredAnnotations.length-1)return void this.focussedAnnotationIndex++;this.focussedAnnotationIndex===1/0?this.focussedAnnotationIndex=Math.min(1,this.filteredAnnotations.length-1):this.focussedAnnotationIndex=-1/0}else if(this.isLawnmowerAnnotationMode){if(this.$refs.canvas.showNextImageSection())return;this.annotationModeCarry=0}else if(this.isSamplingAnnotationMode){if(this.$refs.canvas.showNextSamplingLocation())return;this.annotationModeCarry=0}this.imageIndex=this.getNextIndex(this.imageIndex)}},handlePrevious:function(){if(!this.loading){if(this.isVolareAnnotationMode){if(this.focussedAnnotationIndex>0)return void this.focussedAnnotationIndex--;this.focussedAnnotationIndex===-1/0?this.focussedAnnotationIndex=Math.max(this.filteredAnnotations.length-2,0):this.focussedAnnotationIndex=1/0}else if(this.isLawnmowerAnnotationMode){if(this.$refs.canvas.showPreviousImageSection())return;this.annotationModeCarry=1/0}else if(this.isSamplingAnnotationMode){if(this.$refs.canvas.showPreviousSamplingLocation())return;this.annotationModeCarry=1/0}this.imageIndex=this.getPreviousIndex(this.imageIndex)}},maybeUpdateFocussedAnnotation:function(){this.isVolareAnnotationMode?this.filteredAnnotations.length>0?this.focussedAnnotationIndex===1/0?this.focussedAnnotationIndex=this.filteredAnnotations.length-1:this.focussedAnnotationIndex=0:(this.focussedAnnotationIndex=null,this.$refs.canvas.fitImage()):this.focussedAnnotationIndex=null},maybeUpdateShownImageSection:function(){this.isLawnmowerAnnotationMode&&(this.annotationModeCarry===1/0?this.$refs.canvas.showLastImageSection():this.$refs.canvas.showFirstImageSection())},maybeUpdateShownSampling:function(t){this.isSamplingAnnotationMode&&(this.$refs.canvas.setSamplingData(this.annotationMode,t),this.annotationModeCarry===1/0?this.$nextTick(this.$refs.canvas.showLastSamplingLocation):this.$nextTick(this.$refs.canvas.showFirstSamplingLocation))},maybeUpdateAnnotationMode:function(t){this.maybeUpdateFocussedAnnotation(),this.maybeUpdateShownImageSection(),this.maybeUpdateShownSampling(t)},handleMapMoveend:function(t){this.mapCenter=t.center,this.mapResolution=t.resolution,Au.set({r:Math.round(100*t.resolution),x:Math.round(t.center[0]),y:Math.round(t.center[1])})},handleSelectAnnotation:function(t,e){!0===e||"object"===hT(e)&&e.shiftKey?t.selected=!0:this.annotations.forEach((function(e){e.selected=t.id===e.id}))},handleSelectAnnotations:function(t,e){t.forEach((function(t){t.selected=!0})),e.forEach((function(t){t.selected=!1}))},handleDeselectAnnotation:function(t){t?t.selected=!1:this.annotations.forEach((function(t){t.selected=!1}))},focusAnnotation:function(t,e,i){this.$refs.canvas.focusAnnotation(t,e,i)},handleDetachAnnotationLabel:function(t,e){this.isEditor&&(t.labels.length>1?FE.detachLabel(t,e).catch(Mu):confirm("Detaching the last label of an annotation deletes the whole annotation. Do you want to delete the annotation?")&&this.handleDeleteAnnotation(t))},handleDeleteAnnotation:function(t){this.isEditor&&(this.lastCreatedAnnotation&&this.lastCreatedAnnotation.id===t.id&&(this.lastCreatedAnnotation=null),Vue.set(t,"markedForDeletion",!0),FE.delete(t).catch((function(e){t.markedForDeletion=!1,Mu(e)})))},handleDeleteAnnotations:function(t){t.forEach(this.handleDeleteAnnotation)},handleUpdateAnnotations:function(t){this.isEditor&&Vue.Promise.all(t.map(FE.update)).catch(Mu)},selectAndFocusAnnotation:function(t,e){this.selectedAnnotations.forEach((function(t){t.selected=!1})),t.selected=!0,this.focusAnnotation(t,!0,e)},handleFilter:function(t){this.annotationFilter=t},resetFilter:function(){this.annotationFilter&&this.annotationFilter.reset(),this.annotationFilter=null},handleSelectedLabel:function(t){this.selectedLabel=t},handleNewAnnotation:function(t,e){this.isEditor&&(t.label_id=this.selectedLabel.id,t.confidence=1,FE.create(this.imageId,t).then(this.setLastCreatedAnnotation).catch(Mu).finally(e))},handleAttachLabel:function(t,e){if(e=e||this.selectedLabel,this.isEditor&&e){var i={label_id:e.id,confidence:1},n=FE.attachLabel(t,i);return n.catch(Mu),n}return Vue.Promise.reject()},handleSwapLabel:function(t,e){var i=this;if(e=e||this.selectedLabel,this.isEditor&&e){var n=t.labels.filter((function(t){return t.user_id===i.userId})).sort((function(t,e){return t.id-e.id})).pop();this.handleAttachLabel(t,e).then((function(){n&&i.handleDetachAnnotationLabel(t,n)})).catch(Mu)}},handleAttachAllSelected:function(){this.selectedAnnotations.forEach(this.handleAttachLabel)},emitImageChanged:function(){wu.$emit("images.change",this.imageId,this.image)},cachePreviousAndNext:function(){var t,e=[],i=this.imagesIds[this.getPreviousIndex(this.imageIndex)],n=lT(Array(10).keys());try{for(n.s();!(t=n.n()).done;){var r=t.value,o=this.imagesIds[this.getNextIndex(this.imageIndex+r)];e.push(FE.fetchAnnotations(o)),e.push(DE.fetchImage(o))}}catch(t){n.e(t)}finally{n.f()}e.push(FE.fetchAnnotations(i)),e.push(DE.fetchImage(i)),i!==this.imageId&&Vue.Promise.all(e).catch((function(){}))},setLastCreatedAnnotation:function(t){var e=this;this.lastCreatedAnnotationTimeout&&window.clearTimeout(this.lastCreatedAnnotationTimeout),this.lastCreatedAnnotation=t,this.lastCreatedAnnotationTimeout=window.setTimeout((function(){e.lastCreatedAnnotation=null}),1e4)},updateColorAdjustment:function(t){var e=this.$refs.canvas;Iu((function(){DE.updateColorAdjustment(t),e.render()}),100,"annotations.color-adjustment.update")},handleSettingsChange:function(t,e){switch(t){case"annotationOpacity":this.annotationOpacity=e;break;case"mousePosition":this.showMousePosition=e;break;case"zoomLevel":this.showZoomLevel=e;break;case"scaleLine":this.showScaleLine=e;break;case"labelTooltip":this.showLabelTooltip=e;break;case"measureTooltip":this.showMeasureTooltip=e;break;case"minimap":this.showMinimap=e}},handleAnnotationModeChange:function(t,e){this.annotationMode=t,this.annotationModeCarry=null,this.maybeUpdateAnnotationMode(e)},handleOpenedTab:function(t){KE.set("openTab",t)},handleClosedTab:function(){KE.delete("openTab")},handleLoadingError:function(t){Ou.danger(t)},createSampledAnnotation:function(){this.$refs.canvas.createSampledAnnotation()},fetchImagesArea:function(){this.imagesArea||(this.imagesArea={},aT.get({id:this.volumeId}).then(this.setImagesArea,Mu))},setImagesArea:function(t){this.imagesArea=t.body},handleRequiresSelectedLabel:function(){Ou.info("Please select a label first."),this.$refs.sidebar.$emit("open","labels")},maybeShowTilingInProgressMessage:function(){this.image.tilingInProgress&&Ou.warning("This image is currently being processed. Please retry later.")}},watch:{imageId:function(t){t&&(this.startLoading(),Vue.Promise.all(this.getImageAndAnnotationsPromises(t)).then(this.setCurrentImageAndAnnotations).then(this.updateUrlSlug).then(this.maybeUpdateAnnotationMode).then(this.emitImageChanged).then(this.maybeShowTilingInProgressMessage).then(this.cachePreviousAndNext).catch(this.handleLoadingError).finally(this.finishLoading))},focussedAnnotation:function(t){t&&this.selectAndFocusAnnotation(t,this.userUpdatedVolareResolution)},annotationFilter:function(){this.maybeUpdateFocussedAnnotation()},showScaleLine:function(t){t&&this.fetchImagesArea()},showMeasureTooltip:function(t){t&&this.fetchImagesArea()},isVolareAnnotationMode:function(t){t||(this.userUpdatedVolareResolution=!1)},mapResolution:function(){this.isVolareAnnotationMode&&(this.userUpdatedVolareResolution=!0)},annotations:function(t){this.annotationFilters[0].annotations=t,this.annotationFilters[1].annotations=t}},created:function(){var t=this;if(this.allImagesIds=biigle.$require("annotations.imagesIds"),this.volumeId=biigle.$require("annotations.volumeId"),this.isEditor=biigle.$require("annotations.isEditor"),this.userId=biigle.$require("annotations.userId"),this.annotationFilters=[new nT,new sT,new oT({data:{shapes:biigle.$require("annotations.shapes")}}),new rT({data:{sessions:biigle.$require("annotations.sessions")}})],0!==this.imagesIds.length){var e=this.imagesIds.indexOf(biigle.$require("annotations.imageId"));if(-1===e&&(e=0,Ou.info("The requested image does not exist in your current volume filtering. Switching to the first image.")),this.imageIndex=e,void 0!==Au.get("r")&&(this.mapResolution=parseInt(Au.get("r"),10)/100),void 0!==Au.get("x")&&void 0!==Au.get("y")&&(this.mapCenter=[parseInt(Au.get("x"),10),parseInt(Au.get("y"),10)]),wu.$on("annotations.select",this.handleSelectAnnotation),wu.$on("annotations.deselect",this.handleDeselectAnnotation),wu.$on("annotations.detachLabel",this.handleDetachAnnotationLabel),wu.$on("annotations.delete",this.handleDeleteAnnotation),wu.$on("annotations.focus",this.focusAnnotation),Au.get("annotation")){var i=parseInt(Au.get("annotation"));wu.$once("images.change",(function(){for(var e=t.annotations,n=e.length-1;n>=0;n--)if(e[n].id===i)return void t.selectAndFocusAnnotation(e[n])}))}if(KE.has("openTab")){var n=KE.get("openTab");"color-adjustment"===n?wu.$once("images.change",(function(){t.supportsColorAdjustment&&(t.openTab=n)})):this.openTab=n}}else Ou.info("Your current volume filtering contains no images.")},mounted:function(){wu.$emit("annotations.map.init",this.$refs.canvas.map)}},undefined,undefined,!1,null,null,null).exports;var dT=function(t){return[Math.cos(2*Math.PI*t)+1,Math.sin(2*Math.PI*t)+1]};const fT=Ml({props:{fileIds:{type:Array,default:function(){return[]}},filenames:{type:Object,default:function(){return{}}},showIndicator:{type:Boolean,default:!0},currentFileId:{type:Number,required:!0},type:{type:String,required:!0}},data:function(){return{fileIdsLeft:[]}},computed:{progressPath:function(){return"M 2 1 A 1 1 0 "+(this.progress>=.5?1:0)+" 1 "+dT(this.progress).join(" ")+"L 1 1"},initialProgressPath:function(){return"M 1 1 L "+dT(this.initialProgress).join(" ")},progressTitle:function(){var t=["started at ".concat(this.initialFileNumber)];return this.hasSeenAllFiles&&t.push("seen all"),"".concat(Ru(this.type)," ").concat(this.currentFileNumber," of ").concat(this.fileIds.length," (").concat(t.join(", "),")")},currentFileNumber:function(){return this.currentFileId?this.fileIds.indexOf(this.currentFileId)+1:0},progress:function(){return this.currentFileNumber/this.fileIds.length},initialProgress:function(){return this.initialFileNumber/this.fileIds.length},hasSeenAllFiles:function(){return 0===this.fileIdsLeft.length},showInitialProgressMarker:function(){return 1!==this.initialFileNumber},indicatorClass:function(){return this.hasSeenAllFiles?"progress-indicator--all":""},filenameClass:function(){return this.hasSeenAllFiles?"text-success":""},filenameTitle:function(){return this.hasSeenAllFiles?"You have seen all ".concat(this.type,"s"):""},currentFilename:function(){return this.filenames[this.currentFileId]}},watch:{currentFileId:function(t){this.fileIdsLeft=this.fileIdsLeft.filter((function(e){return e!==t}))}},created:function(){var t=this;this.initialFileNumber=this.fileIds.indexOf(this.currentFileId)+1,this.fileIdsLeft=this.fileIds.filter((function(e){return e!==t.currentFileId}))}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",[t.showIndicator?i("span",{staticClass:"progress-indicator-container",attrs:{title:t.progressTitle}},[i("svg",{staticClass:"progress-indicator",class:t.indicatorClass,attrs:{viewBox:"-0.2 -0.2 2.4 2.4"}},[i("circle",{staticClass:"progress-indicator__background",attrs:{cx:"1",cy:"1",r:"1"}}),t._v(" "),i("g",{staticClass:"progress-indicator__progress"},[1==t.progress?i("circle",{attrs:{cx:"1",cy:"1",r:"1"}}):i("path",{attrs:{d:t.progressPath}})]),t._v(" "),t.showInitialProgressMarker?i("path",{staticClass:"progress-indicator__marker",attrs:{d:t.initialProgressPath}}):t._e()])]):t._e(),t._v(" "),i("strong",{class:t.filenameClass,attrs:{title:t.filenameTitle},domProps:{textContent:t._s(t.currentFilename)}})])}),[],!1,null,null,null).exports;const pT=Ml({components:{breadcrumb:fT},data:function(){return{volumeId:null,allIds:[],filenames:{},showIndicator:!0,currentId:null}},computed:{currentFilename:function(){return this.filenames[this.currentId]},ids:function(){var t=this.allIds.slice(),e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t}},methods:{updateShowIndicator:function(t){this.showIndicator=!1!==t},updateCurrentId:function(t){this.currentId=t}},watch:{currentFilename:function(t){document.title="Annotate ".concat(t," - BIIGLE")}},created:function(){var t=this;this.allIds=biigle.$require("annotations.imagesIds"),this.volumeId=biigle.$require("annotations.volumeId");var e={};biigle.$require("annotations.imagesFilenames").forEach((function(i,n){e[t.allIds[n]]=i})),this.filenames=e,this.currentId=biigle.$require("annotations.imageId"),wu.$on("images.change",this.updateCurrentId),this.updateShowIndicator(KE.get("progressIndicator")),KE.watch("progressIndicator",this.updateShowIndicator)}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("annotator-container",cT),biigle.$mount("annotations-navbar",pT);i(9276);var gT={annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,showProgressIndicator:!0};const mT=new ju({data:{urlParams:Object.keys(gT),storageKey:"biigle.videos.settings",defaults:gT}});const vT=Ml({components:{breadcrumb:fT},data:function(){return{ids:[],volumeId:null,filenames:{},showIndicator:!0,currentId:null}},computed:{currentFilename:function(){return this.filenames[this.currentId]}},methods:{updateShowIndicator:function(t){this.showIndicator=!1!==t},updateCurrentId:function(t){this.currentId=t},initVideoIds:function(t){var e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t}},watch:{currentFilename:function(t){document.title="Annotate ".concat(t," - BIIGLE")}},created:function(){this.volumeId=biigle.$require("videos.volumeId");var t=biigle.$require("videos.videoIds");this.ids=this.initVideoIds(t);var e={};biigle.$require("videos.videoFilenames").forEach((function(i,n){e[t[n]]=i})),this.filenames=e,this.currentId=biigle.$require("videos.id"),this.updateShowIndicator(mT.get("showProgressIndicator")),mT.watch("showProgressIndicator",this.updateShowIndicator),wu.$on("video.id",this.updateCurrentId)}},undefined,undefined,!1,null,null,null).exports;const yT=Ml({components:{previewThumbnail:_h}},undefined,undefined,!1,null,null,null).exports,_T=Vue.resource("api/v1/video-annotations{/id}",{},{query:{method:"GET",url:"api/v1/videos{/id}/annotations"},save:{method:"POST",url:"api/v1/videos{/id}/annotations"},split:{method:"POST",url:"api/v1/video-annotations{/id}/split"},link:{method:"POST",url:"api/v1/video-annotations{/id}/link"},attachLabel:{method:"POST",url:"api/v1/video-annotations{/id}/labels"},detachLabel:{method:"DELETE",url:"api/v1/video-annotation-labels{/id}"}}),bT=void 0,wT=" ",xT="fill";function ST(t){return"string"==typeof t}const CT=Math,ET=CT.abs,TT=CT.min,IT=CT.max,AT=CT.floor,kT=CT.round,PT=CT.sqrt,LT=CT.pow,RT=CT.cos,FT=CT.asin,MT=CT.sin,OT=CT.tan,DT=CT.PI,$T=2/3,jT=LT(2,-52);function NT(){throw new Error(Array.prototype.join.call(arguments,wT))}function BT(t,e){for(let i in e)t.hasOwnProperty(i)||(t[i]=e[i]);return t}var UT="undefined"!=typeof window&&window.navigator.userAgent;const GT=/(MSIE |Trident\/|Edge\/)/i.test(UT)?Array:Float32Array;function VT(t){return new GT(t)}function zT(t,e,i){const n=t.length,r=e.length;if(n<r)return zT(e,t,i);e.length=n;for(let o=r;o<n;o++){const n=t[o],r=VT(n.d.length);for(let t=0;t<n.d.length;t+=2)r[t]=i.absolute?i.x:n.x+n.w*i.x,r[t+1]=i.absolute?i.y:n.y+n.y*i.y;e[o]=BT({d:r},n)}}function qT(t,e,i,n){return PT((t-i)*(t-i)+(e-n)*(e-n))}function WT(t,e,i){let n=i.length;if(i[n-2]!==i[0]||i[n-1]!==i[1])return;const r=i.slice(2);let o,s;n=r.length;for(let i=0;i<n;i+=6){const n=qT(t,e,r[i],r[i+1]);(s===bT||n<s)&&(s=n,o=i)}!function(t,e){const i=t.length,n=i-e,r=VT(e);let o;for(o=0;o<e;o++)r[o]=t[o];for(o=e;o<i;o++)t[o-e]=t[o];for(o=0;o<e;o++)t[n+o]=r[o]}(r,o),i[0]=r[n-2],i[1]=r[n-1];for(let t=0;t<r.length;t++)i[t+2]=r[t]}function KT(t,e){let i=e-t.length;const n=Math.ceil(i/t.length),r=VT(e);r[0]=t[0],r[1]=t[1];let o=1,s=1;for(;s<e-1;){r[++s]=t[++o],r[++s]=t[++o],r[++s]=t[++o],r[++s]=t[++o];const e=r[++s]=t[++o],a=r[++s]=t[++o];if(i)for(let t=0;t<n&&i;t++)r[s+5]=r[s+3]=r[s+1]=e,r[s+6]=r[s+4]=r[s+2]=a,s+=6,i-=6}return r}function XT(t,e){return e.p-t.p}function YT(t,e,i){const n=HT(t),r=HT(e),o=i.origin,s=o.x,a=o.y,l=o.absolute;n.length!==r.length&&(i.optimize===xT?zT(n,r,i.origin):NT("optimize:none requires equal lengths"));const u=Array(2);if(u[0]=n.map(ZT),u[1]=r.map(ZT),"none"!==i.optimize)for(let t=0;t<n.length;t++){const e=n[t],i=r[t];WT(l?s:e.x+e.w*s,l?a:e.y+e.h*a,u[0][t]),WT(l?s:i.x+i.w*s,l?a:i.y+i.h*a,u[1][t])}return i.optimize===xT&&function(t,e){const i=t[0].length;for(let n=0;n<i;n++){const i=t[0][n],r=t[1][n],o=IT(i.length+e,r.length+e);t[0][n]=KT(i,o),t[1][n]=KT(r,o)}}(u,6*i.addPoints),u}function HT(t){return t.data.slice().sort(XT)}function ZT(t){return t.d}const JT={addPoints:0,optimize:xT,origin:{x:0,y:0},precision:0};function QT(t,e){e=BT(e,JT),(!t||t.length<2)&&NT("invalid arguments");const i=t.length-1,n=Array(i);for(let r=0;r<i;r++)n[r]=tI(t[r],t[r+1],e);const r=e.precision?t=>t.toFixed(e.precision):kT;return t=>{const e=i*t,o=TT(AT(e),i-1);return function(t,e){if(ST(t))return t;let i=[];for(let n=0;n<t.length;n++){const r=t[n];let o;i.push("M",e(r[0]),e(r[1]),"C");for(let t=2;t<r.length;t+=6){const n=e(r[t]),s=e(r[t+1]),a=e(r[t+2]),l=e(r[t+3]),u=e(r[t+4]),h=e(r[t+5]);n==u&&a==u&&s==h&&l==h&&o==(o=""+n+s+a+l+u+h)||i.push(n,s,a,l,u,h)}}return i.join(wT)}(n[o]((e-o)/(o+1)),r)}}function tI(t,e,i){const n=YT(t,e,i),r=n[0].length;return i=>{if(ET(i-0)<jT)return t.path;if(ET(i-1)<jT)return e.path;const o=Array(r);for(let t=0;t<r;t++)o[t]=eI(n[0][t],n[1][t],i);return o}}function eI(t,e,i){const n=t.length,r=VT(n);for(let o=0;o<n;o++)r[o]=t[o]+(e[o]-t[o])*i;return r}function iI(t,e){return t===bT?e:t}const nI=120*DT/180,rI=2*DT;function oI(t,e,i,n,r,o,s,a,l,u,h,c,d){if(i<=0||n<=0)return[t,e,a,l,a,l];const f=DT/180*(+r||0),p=RT(f),g=MT(f),m=!!u;if(!m){const r=t,f=a,m=((t=r*p-e*-g)-(a=f*p-l*-g))/2,v=((e=r*-g+e*p)-(l=f*-g+l*p))/2;let y=m*m/(i*i)+v*v/(n*n);y>1&&(y=PT(y),i*=y,n*=y);const _=(o===s?-1:1)*PT(ET((i*i*n*n-i*i*v*v-n*n*m*m)/(i*i*v*v+n*n*m*m)));c=_*i*v/n+(t+a)/2,u=FT((e-(d=_*-n*m/i+(e+l)/2))/n),h=FT((l-d)/n),t<c&&(u=DT-u),a<c&&(h=DT-h),u<0&&(u+=rI),h<0&&(h+=rI),s&&u>h&&(u-=rI),!s&&h>u&&(h-=rI)}let v;if(ET(h-u)>nI){const t=h,e=a,o=l;v=oI(a=c+i*RT(h=u+nI*(s&&h>u?1:-1)),l=d+n*MT(h),i,n,r,0,s,e,o,h,t,c,d)}else v=[];const y=4/3*OT((h-u)/4);if(v.splice(0,0,2*t-(t+y*i*MT(u)),2*e-(e-y*n*RT(u)),a+y*i*MT(h),l-y*n*RT(h),a,l),!m)for(let t=0,e=v.length;t<e;t+=2){const e=v[t],i=v[t+1];v[t]=e*p-i*g,v[t+1]=e*g+i*p}return v}const sI={M:2,H:1,V:1,L:2,Z:0,C:6,S:4,Q:4,T:2,A:7};function aI(t,e,i,n,r,o,s){const a=t.x,l=t.y;t.x=iI(o,a),t.y=iI(s,l),t.p.push(iI(e,a),i=iI(i,l),n=iI(n,a),r=iI(r,l),t.x,t.y),t.lc=t.c}function lI(t){const e=t.c,i=t.t,n=t.x,r=t.y;if("V"===e)i[0]+=r;else if("H"===e)i[0]+=n;else if("A"===e)i[5]+=n,i[6]+=r;else for(let t=0;t<i.length;t+=2)i[t]+=n,i[t+1]+=r}function uI(t){return t.split(wT).map(hI)}function hI(t,e){return 0===e?t:+t}function cI(t){const e={x:0,y:0,s:[]},i=function(t){return t.replace(/[\^\s]*([mhvlzcsqta]|\-?\d*\.?\d+)[,\$\s]*/gi," $1").replace(/([mhvlzcsqta])/gi," $1").trim().split("  ").map(uI)}(t);for(let t=0;t<i.length;t++){const n=i[t],r=n[0],o=r.toUpperCase(),s="Z"!==o&&o!==r;e.c=o;const a=sI[o],l=n;let u=1;do{e.t=1===l.length?l:l.slice(u,u+a),s&&lI(e);const t=e.t,i=e.x,n=e.y;let r,h,c,d,f,p;if("M"===o)e.s.push(e.p=[e.x=t[0],e.y=t[1]]);else if("H"===o)aI(e,bT,bT,bT,bT,t[0],bT);else if("V"===o)aI(e,bT,bT,bT,bT,bT,t[0]);else if("L"===o)aI(e,bT,bT,bT,bT,t[0],t[1]);else if("Z"===o)aI(e,bT,bT,bT,bT,e.p[0],e.p[1]);else if("C"===o)aI(e,t[0],t[1],t[2],t[3],t[4],t[5]),e.cx=t[2],e.cy=t[3];else if("S"===o){const o="S"!==e.lc&&"C"!==e.lc;r=o?bT:2*i-e.cx,h=o?bT:2*n-e.cy,aI(e,r,h,t[0],t[1],t[2],t[3]),e.cx=t[0],e.cy=t[1]}else if("Q"===o){const r=t[0],o=t[1];c=t[2],d=t[3],aI(e,i+(r-i)*$T,n+(o-n)*$T,c+(r-c)*$T,d+(o-d)*$T,c,d),e.cx=r,e.cy=o}else if("T"===o)c=t[0],d=t[1],"Q"===e.lc||"T"===e.lc?(r=i+(2*i-e.cx-i)*$T,h=n+(2*n-e.cy-n)*$T,f=c+(2*i-e.cx-c)*$T,p=d+(2*n-e.cy-d)*$T):(r=f=i,h=p=n),aI(e,r,h,f,p,c,d),e.cx=f,e.cy=p;else if("A"===o){const r=oI(i,n,t[0],t[1],t[2],t[3],t[4],t[5],t[6]);for(let t=0;t<r.length;t+=6)aI(e,r[t],r[t+1],r[t+2],r[t+3],r[t+4],r[t+5])}else NT(e.c," is not supported");u+=a}while(u<l.length)}return e.s}function dI(t){const e=t.length;let i=t[e-2],n=t[e-1],r=0;for(let o=0;o<e;o+=6)r+=qT(t[o],t[o+1],i,n),i=t[o],n=t[o+1];return AT(r)}function fI(t){let e=t[0],i=t[1],n=i,r=e;for(let o=2;o<t.length;o+=6){let s=t[o+4],a=t[o+5];e=TT(e,s),r=IT(r,s),i=TT(i,a),n=IT(n,a)}return{d:t,x:e,y:i,w:r-e,h:n-i,p:dI(t)}}const pI=/^([#|\.]|path)/i;function gI(t){return function(t){return{path:t,data:cI(t).map(fI)}}(function(t){if(ST(t)){if(!pI.test(t))return t;t=document.querySelector(t)}return t.getAttribute("d")}(t))}const mI=Ml(Vue.extend({data:function(){return{id:0,frames:[],points:[],video_id:0,shape_id:0,created_at:"",updated_at:"",labels:[],selected:!1,revision:1,tracking:!1,pending:!1}},computed:{startFrame:function(){return this.frames[0]},endFrame:function(){return this.frames[this.frames.length-1]},interpolationPoints:function(){switch(this.shape){case"Rectangle":case"Ellipse":return this.points.map(this.rectangleToInterpolationPoints);case"LineString":case"Polygon":return this.points.map(this.polygonToSvgPath);default:return this.points}},gapRanges:function(){var t=[];return this.frames.map((function(e,i,n){null===e&&t.push([n[i-1],n[i+1]])})),t},isSelected:function(){return!1!==this.selected},isClip:function(){return this.frames.length>1},wholeFrame:function(){return"WholeFrame"===this.shape}},methods:{startPollTracking:function(){this.tracking=!0,this.continuePollTracking()},pollTracking:function(){_T.get({id:this.id}).then(this.maybeFinishPollTracking,this.cancelPollTracking)},maybeFinishPollTracking:function(t){var e=t.body;e.frames.length>1?(this.tracking=!1,this.frames=e.frames,this.points=e.points):this.continuePollTracking()},continuePollTracking:function(){this.pollTimeout=window.setTimeout(this.pollTracking,5e3)},cancelPollTracking:function(){Ou.danger("Tracking of annotation ".concat(this.id," failed.")),this.tracking=!1,this.$emit("tracking-failed",this)},interpolatePoints:function(t){if(t<this.startFrame||t>this.endFrame)return[];if(this.hasGapAt(t))return[];for(var e=this.frames,i=e.length-1;i>=0&&!(e[i]<=t&&null!==e[i]);i--);if(e[i]===t)return this.points[i];var n=(t-e[i])/(e[i+1]-e[i]);return this.interpolateBetweenFrames(i,i+1,n)},interpolateBetweenFrames:function(t,e,i){var n=this.interpolationPoints[t],r=this.interpolationPoints[e];switch(this.shape){case"Rectangle":case"Ellipse":return this.interpolationPointsToRectangle(this.interpolateNaive(n,r,i));case"LineString":case"Polygon":return this.interpolatePolymorph(n,r,i);default:return this.interpolateNaive(n,r,i)}},interpolateNaive:function(t,e,i){return t.map((function(t,n){return t+(e[n]-t)*i}))},interpolatePolymorph:function(t,e,i){return function(t,e){return QT(t.map(gI),e||{})}([t,e])(i).replace(/[MCL\s]+/g," ").trim().split(" ").map((function(t){return parseInt(t,10)}))},rectangleToInterpolationPoints:function(t){var e=[t[2]-t[0],t[3]-t[1]],i=[t[6]-t[0],t[7]-t[1]],n=Math.sqrt(i[0]*i[0]+i[1]*i[1]),r=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=[e[0]/r,e[1]/r],s=[(t[0]+t[2]+t[4]+t[6])/4,(t[1]+t[3]+t[5]+t[7])/4];return[s[0],s[1],o[0],o[1],n,r]},interpolationPointsToRectangle:function(t){var e=[t[2],t[3]],i=[-e[1],e[0]],n=t[4]/2*i[0],r=t[4]/2*i[1],o=t[5]/2*e[0],s=t[5]/2*e[1];return[t[0]-o-n,t[1]-s-r,t[0]+o-n,t[1]+s-r,t[0]+o+n,t[1]+s+r,t[0]-o+n,t[1]-s+r]},polygonToSvgPath:function(t){return(t=t.slice()).unshift("M"),t.splice(3,0,"L"),t.join(" ")},hasGapAt:function(t){if(t<this.startFrame||t>this.endFrame)return!1;for(var e=this.gapRanges.length-1;e>=0;e--)if(this.gapRanges[e][0]<t&&this.gapRanges[e][1]>t)return!0;return!1},detachAnnotationLabel:function(t){var e=this.labels.indexOf(t);return-1!==e&&this.labels.splice(e,1),_T.detachLabel({id:t.id})},attachAnnotationLabel:function(t){return _T.attachLabel({id:this.id},{label_id:t.id}).then(this.handleAttachedLabel)},handleAttachedLabel:function(t){return this.labels.push(t.body),t},hasKeyframe:function(t){return-1!==this.frames.indexOf(t)},modify:function(t,e){var i=this.frames.indexOf(t);if(-1!==i)this.points.splice(i,1,e);else{for(var n=this.frames.length-1;n>=0&&!(this.frames[n]<=t);n--);this.frames.splice(n+1,0,t),this.points.splice(n+1,0,e)}return _T.update({id:this.id},{frames:this.frames,points:this.points})},split:function(t){return _T.split({id:this.id},{time:t}).then(this.handleFinishedSplit)},handleFinishedSplit:function(t){return this.frames=t.body[0].frames,this.points=t.body[0].points,t.body=t.body[1],t},link:function(t){return _T.link({id:this.id},{annotation_id:t.id}).then(this.handleFinishedLink)},handleFinishedLink:function(t){return this.frames=t.body.frames,this.points=t.body.points,this.labels=t.body.labels,t},deleteKeyframe:function(t){var e=this.frames.indexOf(t);return-1!==e?(this.frames.splice(e,1),this.points.splice(e,1),_T.update({id:this.id},{frames:this.frames,points:this.points})):Vue.Promise.reject("Unknown keyframe ".concat(t," of annotation ").concat(this.id))},delete:function(){return _T.delete({id:this.id})}},watch:{points:function(){this.revision+=1}},created:function(){this.shape=biigle.$require("videos.shapes")[this.shape_id]}}),undefined,undefined,!1,null,null,null).exports;const vI=Ml({mixins:[BE],methods:{handleSelect:function(t,e){t.isSelected&&e?this.$emit("deselect",t):this.$emit("select",t,t.startFrame,e)}}},undefined,undefined,!1,null,null,null).exports;const yI=Ml({components:{powerToggle:_u},data:function(){return{restoreKeys:["annotationOpacity","showMinimap","autoplayDraw","showLabelTooltip","showMousePosition","showProgressIndicator"],annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,playbackRate:1,showProgressIndicator:!0}},methods:{handleShowMinimap:function(){this.showMinimap=!0},handleHideMinimap:function(){this.showMinimap=!1},handleShowLabelTooltip:function(){this.showLabelTooltip=!0},handleHideLabelTooltip:function(){this.showLabelTooltip=!1},handleShowMousePosition:function(){this.showMousePosition=!0},handleHideMousePosition:function(){this.showMousePosition=!1},handleShowProgressIndicator:function(){this.showProgressIndicator=!0},handleHideProgressIndicator:function(){this.showProgressIndicator=!1}},watch:{annotationOpacity:function(t){t=parseFloat(t),isNaN(t)||(this.$emit("update","annotationOpacity",t),mT.set("annotationOpacity",t))},showMinimap:function(t){this.$emit("update","showMinimap",t),mT.set("showMinimap",t)},autoplayDraw:function(t){t=parseFloat(t),this.$emit("update","autoplayDraw",t),mT.set("autoplayDraw",t)},showLabelTooltip:function(t){this.$emit("update","showLabelTooltip",t),mT.set("showLabelTooltip",t)},showMousePosition:function(t){this.$emit("update","showMousePosition",t),mT.set("showMousePosition",t)},playbackRate:function(t){t=parseFloat(t),isNaN(t)||this.$emit("update","playbackRate",t)},showProgressIndicator:function(t){this.$emit("update","showProgressIndicator",t),mT.set("showProgressIndicator",t)}},created:function(){var t=this;this.restoreKeys.forEach((function(e){t[e]=mT.get(e)}))}},undefined,undefined,!1,null,null,null).exports;const _I=Ml({mixins:[tT],created:function(){var t=biigle.$require("videos.user");this.userId=t?t.id:null,this.isAdmin=biigle.$require("videos.isAdmin")}},undefined,undefined,!1,null,null,null).exports;const bI=Ml({data:function(){return{renderedAnnotationMap:{},viewFitOptions:{padding:[50,50,50,50],minResolution:1}}},computed:{annotationsRevision:function(){return this.annotations.reduce((function(t,e){return t+e.revision}),0)},annotationsPreparedToRender:function(){return this.annotations.filter((function(t){return"WholeFrame"!==t.shape})).map((function(t){return{id:t.id,start:t.startFrame,end:t.endFrame,self:t}})).sort((function(t,e){return t.start-e.start}))}},methods:{refreshAnnotations:function(t){var e=this,i=this.annotationSource,n=this.selectedFeatures,r=this.annotationsPreparedToRender,o=this.renderedAnnotationMap,s={};this.renderedAnnotationMap=s;for(var a,l=[],u=!1,h=0,c=r.length;h<c;h++)if(!(r[h].end<t&&r[h].start!==t||r[h].self.hasGapAt(t))){if(r[h].start>t)break;a=r[h],u=!0,o.hasOwnProperty(a.id)?(s[a.id]=o[a.id],delete o[a.id]):l.push(a.self)}u?Object.values(o).forEach((function(t){i.removeFeature(t),n.remove(t)})):(i.clear(),n.clear());var d=l.map(this.createFeature);d.forEach((function(t){s[t.getId()]=t,t.get("annotation").isSelected&&n.push(t)})),d.length>0&&i.addFeatures(d),Object.values(s).forEach((function(i){e.updateGeometry(i,t)}))},createFeature:function(t){var e=new Nm(this.getGeometryFromPoints(t.shape,t.points[0]));return e.setId(t.id),e.set("annotation",t),t.labels&&t.labels.length>0&&e.set("color",t.labels[0].label.color),e},updateGeometry:function(t,e){var i=t.get("annotation"),n=i.interpolatePoints(e);t.setGeometry(this.getGeometryFromPoints(i.shape,n))},getGeometryFromPoints:function(t,e){switch(e=this.convertPointsFromDbToOl(e),t){case"Point":return new vg(e[0]);case"Rectangle":return new r_([e]);case"Polygon":return new Lg([e]);case"LineString":return new Ng(e);case"Circle":return new Og(e[0],e[1][0]);case"Ellipse":return new o_([e]);default:return void console.error("Unknown annotation shape: "+t)}},getPointsFromGeometry:function(t){var e;switch(t.getType()){case"Circle":e=[t.getCenter(),[t.getRadius()]];break;case"Polygon":case"Rectangle":case"Ellipse":e=t.getCoordinates()[0];break;case"Point":e=[t.getCoordinates()];break;default:e=t.getCoordinates()}return this.convertPointsFromOlToDb(e)},invertPointsYAxis:function(t){for(var e=this.videoCanvas.height,i=1;i<t.length;i+=2)t[i]=e-t[i];return t},convertPointsFromOlToDb:function(t){return this.invertPointsYAxis(Array.prototype.concat.apply([],t))},convertPointsFromDbToOl:function(t){t=this.invertPointsYAxis(t.slice());for(var e=[],i=0;i<t.length;i+=2)e.push([t[i],t[i+1]||0]);return e},focusAnnotation:function(t){var e=this.annotationSource.getFeatureById(t.id);e&&this.map.getView().fit(e.getGeometry(),this.viewFitOptions)}},created:function(){var t=this;this.$on("refresh",this.refreshAnnotations),this.$once("map-ready",(function(){t.$watch("annotationsRevision",(function(){t.refreshAnnotations(t.video.currentTime)}))}))}},undefined,undefined,!1,null,null,null).exports;const wI=Ml({data:function(){return{pendingAnnotation:{},autoplayDrawTimeout:null}},computed:{hasSelectedLabel:function(){return!!this.selectedLabel},hasNoSelectedLabel:function(){return!this.selectedLabel},isDrawing:function(){return this.interactionMode.startsWith("draw")},isDrawingPoint:function(){return"drawPoint"===this.interactionMode},isDrawingRectangle:function(){return"drawRectangle"===this.interactionMode},isDrawingCircle:function(){return"drawCircle"===this.interactionMode},isDrawingLineString:function(){return"drawLineString"===this.interactionMode},isDrawingPolygon:function(){return"drawPolygon"===this.interactionMode},isDrawingWholeFrame:function(){return"drawWholeFrame"===this.interactionMode},hasPendingAnnotation:function(){return this.isDrawingWholeFrame?this.pendingAnnotation.shape&&this.pendingAnnotation.frames.length>0&&0===this.pendingAnnotation.points.length:this.pendingAnnotation.shape&&this.pendingAnnotation.frames.length>0&&this.pendingAnnotation.points.length>0},cantFinishDrawAnnotation:function(){return!this.hasPendingAnnotation},cantFinishTrackAnnotation:function(){return!this.pendingAnnotation.frames||1!==this.pendingAnnotation.frames.length}},methods:{requireSelectedLabel:function(){this.$emit("requires-selected-label"),this.resetInteractionMode()},initPendingAnnotationLayer:function(t){this.pendingAnnotationSource=new n_,this.pendingAnnotationLayer=new Uy({opacity:.5,source:this.pendingAnnotationSource,updateWhileAnimating:!0,updateWhileInteracting:!0,style:A_.editing}),t.addLayer(this.pendingAnnotationLayer)},draw:function(t){this["isDrawing"+t]?this.resetInteractionMode():this.hasNoSelectedLabel?this.requireSelectedLabel():this.canAdd&&(this.interactionMode="draw"+t)},drawPoint:function(){this.draw("Point")},drawRectangle:function(){this.draw("Rectangle")},drawCircle:function(){this.draw("Circle")},drawLineString:function(){this.draw("LineString")},drawPolygon:function(){this.draw("Polygon")},drawWholeFrame:function(){this.draw("WholeFrame")},maybeUpdateDrawInteractionMode:function(t){var e=t.slice(4);this.resetPendingAnnotation(e),this.drawInteraction&&(this.map.removeInteraction(this.drawInteraction),this.drawInteraction=void 0),this.isDrawing&&this.hasSelectedLabel&&(this.pause(),this.isDrawingWholeFrame?(this.pendingAnnotation.frames.push(this.video.currentTime),this.$emit("pending-annotation",this.pendingAnnotation)):(this.drawInteraction=new g_({source:this.pendingAnnotationSource,type:e,style:A_.editing}),this.drawInteraction.on("drawend",this.extendPendingAnnotation),this.map.addInteraction(this.drawInteraction)))},finishDrawAnnotation:function(){(this.isDrawing||this.isUsingPolygonBrush)&&this.hasPendingAnnotation&&(this.isDrawingWholeFrame&&!this.pendingAnnotation.frames.includes(this.video.currentTime)&&this.pendingAnnotation.frames.push(this.video.currentTime),this.$emit("create-annotation",this.pendingAnnotation),this.isDrawingWholeFrame?this.resetInteractionMode():this.resetPendingAnnotation(this.pendingAnnotation.shape))},finishTrackAnnotation:function(){this.isDrawing&&this.hasPendingAnnotation&&(this.$emit("track-annotation",this.pendingAnnotation),this.resetPendingAnnotation(this.pendingAnnotation.shape))},resetPendingAnnotation:function(t){this.pendingAnnotationSource.clear(),this.pendingAnnotation={shape:t,frames:[],points:[]},this.$emit("pending-annotation",null)},extendPendingAnnotation:function(t){var e=this.pendingAnnotation.frames[this.pendingAnnotation.frames.length-1];void 0===e||e<this.video.currentTime?(this.pendingAnnotation.frames.push(this.video.currentTime),this.pendingAnnotation.points.push(this.getPointsFromGeometry(t.feature.getGeometry())),!this.video.ended&&this.autoplayDraw>0&&(this.play(),window.clearTimeout(this.autoplayDrawTimeout),this.autoplayDrawTimeout=window.setTimeout(this.pause,1e3*this.autoplayDraw))):this.pendingAnnotationSource.once("addfeature",(function(t){this.removeFeature(t.feature)})),this.$emit("pending-annotation",this.pendingAnnotation)}},created:function(){this.$once("map-ready",this.initPendingAnnotationLayer),this.canAdd&&(this.$watch("interactionMode",this.maybeUpdateDrawInteractionMode),xu.on("a",this.drawPoint,0,this.listenerSet),xu.on("s",this.drawRectangle,0,this.listenerSet),xu.on("d",this.drawCircle,0,this.listenerSet),xu.on("f",this.drawLineString,0,this.listenerSet),xu.on("g",this.drawPolygon,0,this.listenerSet),xu.on("h",this.drawWholeFrame,0,this.listenerSet),xu.on("Enter",this.finishDrawAnnotation,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const xI=Ml({components:{mousePositionIndicator:cS},data:function(){return{mousePositionImageCoordinates:[0,0]}},methods:{updateMousePositionImageCoordinates:function(){this.mousePositionImageCoordinates=this.invertPointsYAxis(this.mousePosition.slice()).map(Math.round)}},watch:{mousePosition:function(){Lu(this.updateMousePositionImageCoordinates,100,"videos.update-mouse-position-ic")}}},undefined,undefined,!1,null,null,null).exports;var SI=["Point","Circle","Rectangle","WholeFrame"];const CI=Ml({data:function(){return{isTranslating:!1}},computed:{cannotSplitAnnotation:function(){return 1!==this.selectedAnnotations.length||this.selectedAnnotations[0].frames.length<=1||-1===SI.indexOf(this.selectedAnnotations[0].shape)},cannotLinkAnnotations:function(){return 2!==this.selectedAnnotations.length||this.selectedAnnotations[0].shape_id!==this.selectedAnnotations[1].shape_id},isAttaching:function(){return"attachLabel"===this.interactionMode},isSwapping:function(){return"swapLabel"===this.interactionMode}},methods:{initModifyInteraction:function(t){this.featureRevisionMap={},this.modifyInteraction=new hS({features:this.selectInteraction.getFeatures(),deleteCondition:function(t){return pv(t)&&dv(t)}}),this.modifyInteraction.on("modifystart",this.handleModifyStart),this.modifyInteraction.on("modifyend",this.handleModifyEnd),t.addInteraction(this.modifyInteraction)},handleModifyStart:function(t){var e=this;t.features.getArray().forEach((function(t){e.featureRevisionMap[t.getId()]=t.getRevision()}))},handleModifyEnd:function(t){var e=this,i=t.features.getArray().filter((function(t){return e.featureRevisionMap[t.getId()]!==t.getRevision()})).map((function(t){return{annotation:t.get("annotation"),points:e.getPointsFromGeometry(t.getGeometry()),time:e.video.currentTime}}));i.length>0&&this.$emit("modify",i)},maybeUpdateModifyInteractionMode:function(t){this.modifyInteraction&&this.modifyInteraction.setActive(t)},emitDelete:function(){var t=this;this.canDelete&&this.hasSelectedAnnotations&&this.$emit("delete",this.selectedAnnotations.map((function(e){return{annotation:e,time:t.video.currentTime}})))},toggleTranslating:function(){this.resetInteractionMode(),this.isTranslating=!this.isTranslating},initTranslateInteraction:function(t){this.translateInteraction=new VC({features:this.selectedFeatures,map:t}),this.translateInteraction.setActive(!1),this.translateInteraction.on("translatestart",this.handleModifyStart),this.translateInteraction.on("translateend",this.handleModifyEnd),this.map.addInteraction(this.translateInteraction)},maybeUpdateIsTranslating:function(t){this.translateInteraction&&!t&&(this.isTranslating=!1)},resetTranslating:function(){this.isTranslating=!1},emitSplitAnnotation:function(){this.$emit("split-annotation",this.selectedAnnotations[0],this.video.currentTime)},emitLinkAnnotations:function(){this.$emit("link-annotations",this.selectedAnnotations)},toggleAttaching:function(){this.isAttaching?this.resetInteractionMode():this.interactionMode="attachLabel"},toggleSwapping:function(){this.isSwapping?this.resetInteractionMode():this.interactionMode="swapLabel"},initAttachInteraction:function(t){this.attachInteraction=new am({features:this.annotationFeatures,map:t}),this.attachInteraction.setActive(!1),this.attachInteraction.on("attach",this.handleAttachLabel),this.map.addInteraction(this.attachInteraction)},initSwapInteraction:function(t){this.swapInteraction=new am({features:this.annotationFeatures,map:t}),this.swapInteraction.setActive(!1),this.swapInteraction.on("attach",this.handleSwapLabel),this.map.addInteraction(this.swapInteraction)},handleAttachLabel:function(t){this.$emit("attach-label",t.feature.get("annotation"))},handleSwapLabel:function(t){this.$emit("swap-label",t.feature.get("annotation"))},maybeResetAttaching:function(t){this.isAttaching&&t&&this.resetInteractionMode()},maybeResetSwapping:function(t){this.isSwapping&&t&&this.resetInteractionMode()}},watch:{isTranslating:function(t){this.translateInteraction&&(this.translateInteraction.setActive(t),t?this.modifyInteraction.setActive(!1):this.isDefaultInteractionMode&&this.modifyInteraction.setActive(!0))},isAttaching:function(t){this.attachInteraction&&this.attachInteraction.setActive(t),this.$emit("attaching-active",t)},isSwapping:function(t){this.swapInteraction&&this.swapInteraction.setActive(t),this.$emit("swapping-active",t)}},created:function(){var t=this;this.canModify&&(this.$once("map-created",(function(){t.$once("map-ready",t.initModifyInteraction),t.$once("map-ready",t.initTranslateInteraction),t.$once("map-ready",t.initAttachInteraction),t.$once("map-ready",t.initSwapInteraction)})),this.$watch("isDefaultInteractionMode",this.maybeUpdateModifyInteractionMode),this.$watch("isDefaultInteractionMode",this.maybeUpdateIsTranslating),this.$watch("hasNoSelectedLabel",this.maybeResetAttaching),this.$watch("hasNoSelectedLabel",this.maybeResetSwapping),xu.on("m",this.toggleTranslating,0,this.listenerSet),xu.on("Escape",this.resetTranslating,0,this.listenerSet),xu.on("l",this.toggleAttaching,0,this.listenerSet),xu.on("Shift+l",this.toggleSwapping,0,this.listenerSet)),this.canDelete&&xu.on("Delete",this.emitDelete)}},undefined,undefined,!1,null,null,null).exports;const EI=Ml({data:function(){return{polygonBrushRadius:50}},computed:{isUsingPolygonBrush:function(){return"polygonBrush"===this.interactionMode},isUsingPolygonEraser:function(){return"polygonEraser"===this.interactionMode},isUsingPolygonFill:function(){return"polygonFill"===this.interactionMode}},methods:{togglePolygonBrush:function(){this.isUsingPolygonBrush?this.resetInteractionMode():this.hasSelectedLabel?this.canAdd&&(this.interactionMode="polygonBrush"):this.requireSelectedLabel()},togglePolygonEraser:function(){this.isUsingPolygonEraser?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonEraser")},togglePolygonFill:function(){this.isUsingPolygonFill?this.resetInteractionMode():this.canModify&&(this.interactionMode="polygonFill")},togglePolygonBrushInteraction:function(t){t?this.hasSelectedLabel&&(this.polygonBrushInteraction=new dC({source:this.pendingAnnotationSource,style:A_.editing,brushRadius:this.polygonBrushRadius}),this.polygonBrushInteraction.on("drawend",this.extendPendingAnnotation),this.pendingAnnotation.shape="Polygon",this.map.addInteraction(this.polygonBrushInteraction)):(this.polygonBrushRadius=this.polygonBrushInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonBrushInteraction))},togglePolygonEraserInteraction:function(t){t?(this.polygonEraserInteraction=new pC({features:this.selectInteraction.getFeatures(),style:A_.editing,brushRadius:this.polygonBrushRadius,allowRemove:!1,addCondition:cv,subtractCondition:fv}),this.polygonEraserInteraction.on("modifystart",this.handleModifyStart),this.polygonEraserInteraction.on("modifyend",this.handleModifyEnd),this.map.addInteraction(this.polygonEraserInteraction),this.map.addInteraction(this.shiftClickSelectInteraction)):(this.polygonBrushRadius=this.polygonEraserInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonEraserInteraction),this.polygonEraserInteraction=null,this.map.removeInteraction(this.shiftClickSelectInteraction))},togglePolygonFillInteraction:function(t){t?(this.polygonFillInteraction=new pC({features:this.selectInteraction.getFeatures(),style:A_.editing,brushRadius:this.polygonBrushRadius,allowRemove:!1,addCondition:fv,subtractCondition:cv}),this.polygonFillInteraction.on("modifystart",this.handleModifyStart),this.polygonFillInteraction.on("modifyend",this.handleModifyEnd),this.map.addInteraction(this.polygonFillInteraction),this.map.addInteraction(this.shiftClickSelectInteraction)):(this.polygonBrushRadius=this.polygonFillInteraction.getBrushRadius(),this.map.removeInteraction(this.polygonFillInteraction),this.polygonFillInteraction=null,this.map.removeInteraction(this.shiftClickSelectInteraction))},initShiftSelectInteraction:function(){this.shiftClickSelectInteraction=new _C({condition:function(t){return uv(t)&&pv(t)},style:A_.highlight,layers:[this.annotationLayer],features:this.selectInteraction.getFeatures(),multi:!0}),this.shiftClickSelectInteraction.on("select",this.handleFeatureSelect)}},created:function(){var t=this;this.canAdd&&(this.$watch("isUsingPolygonBrush",this.togglePolygonBrushInteraction),xu.on("e",this.togglePolygonBrush,0,this.listenerSet)),this.canModify&&(this.$once("map-created",(function(){t.$once("map-ready",t.initShiftSelectInteraction)})),this.$watch("isUsingPolygonEraser",this.togglePolygonEraserInteraction),xu.on("r",this.togglePolygonEraser,0,this.listenerSet),this.$watch("isUsingPolygonFill",this.togglePolygonFillInteraction),xu.on("t",this.togglePolygonFill,0,this.listenerSet))}},undefined,undefined,!1,null,null,null).exports;const TI=Ml({components:{labelTooltip:Tf},data:function(){return{hoveredFeaturesHash:""}},computed:{showTooltip:function(){return this.isDefaultInteractionMode&&this.showLabelTooltip}},methods:{annotationLayerFilter:function(t){return"annotations"===t.get("name")},updateHoveredAnnotations:function(t){var e=this.map.getFeaturesAtPixel(t.pixel,{layerFilter:this.annotationLayerFilter})||[],i=e.map((function(t){return t.getId()})).join("-");this.hoveredFeaturesHash!==i&&(this.hoveredFeaturesHash=i,this.$emit("hoverFeatures",e))},resetHoveredAnnotations:function(){this.hoveredFeaturesHash="",this.$emit("hoverFeatures",[])},updateTooltipEventListeners:function(){this.showTooltip?this.map.on("pointermove",this.updateHoveredAnnotations):(this.map.un("pointermove",this.updateHoveredAnnotations),this.resetHoveredAnnotations())}},watch:{showTooltip:function(){this.updateTooltipEventListeners()}},created:function(){this.$once("map-created",this.updateTooltipEventListeners)}},undefined,undefined,!1,null,null,null).exports;var II=Ml({data:function(){return{playing:!1,animationFrameId:null,refreshRate:30,renderCurrentTime:-1,refreshLastTime:Date.now(),extent:[0,0,0,0],minResolution:.01}},methods:{initVideoLayer:function(t){var e=t[0];this.videoCanvas.width=this.video.videoWidth,this.videoCanvas.height=this.video.videoHeight,this.extent=[0,0,this.videoCanvas.width,this.videoCanvas.height];var i=new up({code:"biigle-image",units:"pixels",extent:this.extent});this.videoLayer=new F_({name:"image",source:new Rm({canvas:this.videoCanvas,projection:i,canvasExtent:this.extent,canvasSize:[this.extent[0],this.extent[1]]})}),e.addLayer(this.videoLayer),e.setView(new ew({center:[0,0],projection:i,minResolution:this.minResolution,extent:this.extent})),e.getView().fit(this.extent)},renderVideo:function(t){if(t||this.renderCurrentTime!==this.video.currentTime){this.renderCurrentTime=this.video.currentTime,this.videoCanvasCtx.drawImage(this.video,0,0,this.video.videoWidth,this.video.videoHeight),this.videoLayer.changed();var e=Date.now();(t||e-this.refreshLastTime>=this.refreshRate)&&(this.$emit("refresh",this.video.currentTime),this.refreshLastTime=e)}},startRenderLoop:function(){this.renderVideo(),this.animationFrameId=window.requestAnimationFrame(this.startRenderLoop)},stopRenderLoop:function(){window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null,this.renderVideo(!0)},setPlaying:function(){this.playing=!0},setPaused:function(){this.playing=!1},togglePlaying:function(){this.playing?this.pause():this.play()},play:function(){this.video.play()},pause:function(){this.video.pause(),this.renderVideo(!0)},emitMapReady:function(){this.$emit("map-ready",this.map)}},watch:{playing:function(t){t&&!this.animationFrameId?this.startRenderLoop():t||this.stopRenderLoop()}},created:function(){var t=this;this.videoCanvas=document.createElement("canvas"),this.videoCanvasCtx=this.videoCanvas.getContext("2d"),this.video.addEventListener("play",this.setPlaying),this.video.addEventListener("pause",this.setPaused),this.video.addEventListener("seeked",this.renderVideo),this.video.addEventListener("loadeddata",this.renderVideo);var e=new Vue.Promise((function(e){t.$once("map-created",e)})),i=new Vue.Promise((function(e){t.video.addEventListener("loadedmetadata",e)}));Vue.Promise.all([e,i]).then(this.initVideoLayer).then(this.emitMapReady),xu.on(" ",this.togglePlaying),this.$watch("hasError",(function(e){t.videoLayer&&t.videoLayer.setVisible(!e)}))}},undefined,undefined,!1,null,null,null);const AI=Ml({mixins:[II.exports,bI,wI,CI,TI,xI,EI],components:{controlButton:jm,minimap:iS},props:{annotations:{type:Array,default:function(){return[]}},annotationOpacity:{type:Number,default:1},autoplayDraw:{type:Number,default:0},canAdd:{type:Boolean,default:!1},canModify:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},initialCenter:{type:Array,default:function(){return[0,0]}},initialResolution:{type:Number,default:0},listenerSet:{type:String,default:"default"},selectedAnnotations:{type:Array,default:function(){return[]}},selectedLabel:{type:Object},showLabelTooltip:{type:Boolean,default:!1},showMinimap:{type:Boolean,default:!0},showMousePosition:{type:Boolean,default:!0},video:{type:HTMLVideoElement,required:!0},heightOffset:{type:Number,default:0},showPrevNext:{type:Boolean,default:!0},hasError:{type:Boolean,default:!1}},data:function(){return{interactionMode:"default",mousePosition:[0,0]}},computed:{showModifyBar:function(){return this.canModify||this.canDelete},hasSelectedAnnotations:function(){return this.selectedAnnotations.length>0},hasNoSelectedAnnotations:function(){return!this.hasSelectedAnnotations},isDefaultInteractionMode:function(){return"default"===this.interactionMode},styleObject:function(){return 0!==this.heightOffset?"height: calc(65% + ".concat(this.heightOffset,"px);"):""}},methods:{createMap:function(){var t=new SE({tipLabel:"Zoom to show whole video",label:""});xu.on("-",t.handleZoomToExtent.bind(t),0,this.listenerSet);var e=new Jx({controls:[new dw,t],interactions:Nw({altShiftDragRotate:!1,doubleClickZoom:!1,keyboard:!1,shiftDragZoom:!1,pinchRotate:!1,pinchZoom:!1})});return t=new LE({label:""}),xu.on("+",t.zoomToNative.bind(t),0,this.listenerSet),e.addControl(t),e},initLayersAndInteractions:function(t){this.annotationFeatures=new $m,this.annotationSource=new n_({features:this.annotationFeatures}),this.annotationLayer=new Uy({source:this.annotationSource,updateWhileAnimating:!0,updateWhileInteracting:!0,style:A_.features,opacity:this.annotationOpacity,name:"annotations"}),this.selectInteraction=new _C({condition:uv,style:A_.highlight,layers:[this.annotationLayer],multi:!0}),this.selectedFeatures=this.selectInteraction.getFeatures(),this.selectInteraction.on("select",this.handleFeatureSelect),t.addLayer(this.annotationLayer),t.addInteraction(this.selectInteraction)},resetInteractionMode:function(){this.interactionMode="default"},extractAnnotationFromFeature:function(t){return t.get("annotation")},handleFeatureSelect:function(t){this.$emit("select",t.selected.map(this.extractAnnotationFromFeature),t.deselected.map(this.extractAnnotationFromFeature),this.video.currentTime)},updateMousePosition:function(t){this.mousePosition=t.coordinate},emitTrack:function(){this.$emit("track")},emitMoveend:function(t){var e=t.target.getView();this.$emit("moveend",e.getCenter(),e.getResolution())},initInitialCenterAndResolution:function(t){var e=t.getView();0!==this.initialResolution&&e.setResolution(Math.min(e.getMaxResolution(),Math.max(e.getMinResolution(),this.initialResolution))),0===this.initialCenter[0]&&0===this.initialCenter[1]||!Vd(this.extent,this.initialCenter)||e.setCenter(this.initialCenter)},updateSize:function(){var t=this;this.$nextTick((function(){return t.map.updateSize()}))},emitPrevious:function(){this.$emit("previous")},emitNext:function(){this.$emit("next")},reset:function(){this.setPaused(),this.resetInteractionMode()}},watch:{selectedAnnotations:function(t){var e,i=this.annotationSource,n=this.selectedFeatures;i&&n&&(n.clear(),t.forEach((function(t){(e=i.getFeatureById(t.id))&&n.push(e)})))},isDefaultInteractionMode:function(t){this.selectInteraction.setActive(t)},annotationOpacity:function(t){this.annotationLayer&&this.annotationLayer.setOpacity(t)},heightOffset:function(){this.updateSize()}},created:function(){this.$once("map-ready",this.initLayersAndInteractions),this.$once("map-ready",this.initInitialCenterAndResolution),this.map=this.createMap(),this.$emit("map-created",this.map),this.map.on("pointermove",this.updateMousePosition),this.map.on("moveend",this.emitMoveend),xu.on("Escape",this.resetInteractionMode,0,this.listenerSet),xu.on("ArrowRight",this.emitNext,0,this.listenerSet),xu.on("ArrowLeft",this.emitPrevious,0,this.listenerSet)},mounted:function(){this.map.setTarget(this.$el)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-screen",style:t.styleObject},[t.showMinimap&&!t.hasError?i("minimap",{attrs:{extent:t.extent}}):t._e(),t._v(" "),i("label-tooltip",{attrs:{watch:"hoverFeatures",show:t.showLabelTooltip,position:t.mousePosition}}),t._v(" "),i("div",{staticClass:"controls"},[i("div",{staticClass:"btn-group"},[t.showPrevNext?i("control-button",{attrs:{icon:"fa-step-backward",title:"Previous video 𝗟𝗲𝗳𝘁 𝗮𝗿𝗿𝗼𝘄"},on:{click:t.emitPrevious}}):t._e(),t._v(" "),t.playing?i("control-button",{attrs:{icon:"fa-pause",title:"Pause 𝗦𝗽𝗮𝗰𝗲𝗯𝗮𝗿",disabled:t.hasError},on:{click:t.pause}}):i("control-button",{attrs:{icon:"fa-play",title:"Play 𝗦𝗽𝗮𝗰𝗲𝗯𝗮𝗿",disabled:t.hasError},on:{click:t.play}}),t._v(" "),t.showPrevNext?i("control-button",{attrs:{icon:"fa-step-forward",title:"Next video 𝗥𝗶𝗴𝗵𝘁 𝗮𝗿𝗿𝗼𝘄"},on:{click:t.emitNext}}):t._e()],1),t._v(" "),t.canAdd?i("div",{staticClass:"btn-group"},[i("control-button",{attrs:{icon:"icon-point",title:"Start a point annotation 𝗔",hover:!1,open:t.isDrawingPoint,active:t.isDrawingPoint,disabled:t.hasError},on:{click:t.drawPoint}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the point annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}),t._v(" "),i("control-button",{attrs:{icon:"fa-project-diagram",title:"Finish and track the point annotation",disabled:t.cantFinishTrackAnnotation},on:{click:t.finishTrackAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-rectangle",title:"Start a rectangle annotation 𝗦",hover:!1,open:t.isDrawingRectangle,active:t.isDrawingRectangle,disabled:t.hasError},on:{click:t.drawRectangle}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the rectangle annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-circle",title:"Start a circle annotation 𝗗",hover:!1,open:t.isDrawingCircle,active:t.isDrawingCircle,disabled:t.hasError},on:{click:t.drawCircle}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the circle annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}),t._v(" "),i("control-button",{attrs:{icon:"fa-project-diagram",title:"Finish and track the circle annotation",disabled:t.cantFinishTrackAnnotation},on:{click:t.finishTrackAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-linestring",title:"Start a line annotation 𝗙",hover:!1,open:t.isDrawingLineString,active:t.isDrawingLineString,disabled:t.hasError},on:{click:t.drawLineString}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the line annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-polygon",title:"Start a polygon annotation 𝗚",open:t.isDrawingPolygon,active:t.isDrawingPolygon,disabled:t.hasError},on:{click:t.drawPolygon}},[t.isDrawingPolygon||t.isUsingPolygonBrush?i("control-button",{attrs:{icon:"fa-check",title:"Finish the polygon annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}}):t._e(),t._v(" "),i("control-button",{attrs:{icon:"fa-paint-brush",title:"Draw a polygon using the brush tool 𝗘",active:t.isUsingPolygonBrush},on:{click:t.togglePolygonBrush}}),t._v(" "),i("control-button",{attrs:{icon:"fa-eraser",title:"Modify selected polygons using the eraser tool 𝗥",active:t.isUsingPolygonEraser},on:{click:t.togglePolygonEraser}}),t._v(" "),i("control-button",{attrs:{icon:"fa-fill-drip",title:"Modify selected polygons using the fill tool 𝗧",active:t.isUsingPolygonFill},on:{click:t.togglePolygonFill}})],1),t._v(" "),i("control-button",{attrs:{icon:"icon-wholeframe",title:"Start a whole frame annotation 𝗛",hover:!1,open:t.isDrawingWholeFrame,active:t.isDrawingWholeFrame,disabled:t.hasError},on:{click:t.drawWholeFrame}},[i("control-button",{attrs:{icon:"fa-check",title:"Finish the whole frame annotation 𝗘𝗻𝘁𝗲𝗿",disabled:t.cantFinishDrawAnnotation},on:{click:t.finishDrawAnnotation}})],1)],1):t._e(),t._v(" "),t.showModifyBar?i("div",{staticClass:"btn-group"},[t.canModify?i("control-button",{attrs:{icon:"fa-tag",title:"Attach the currently selected label to existing annotations 𝗟",active:t.isAttaching,disabled:t.hasNoSelectedLabel||t.hasError},on:{click:t.toggleAttaching}},[i("control-button",{attrs:{icon:"fa-sync-alt",title:"Swap the most recent label of an existing annotation with the currently selected one 𝗦𝗵𝗶𝗳𝘁+𝗟",active:t.isSwapping,disabled:t.hasNoSelectedLabel||t.hasError},on:{click:t.toggleSwapping}})],1):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-arrows-alt",title:"Move selected annotations 𝗠",active:t.isTranslating,disabled:t.hasError},on:{click:t.toggleTranslating}}):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-link",title:"Link selected annotations",disabled:t.cannotLinkAnnotations||t.hasError},on:{click:t.emitLinkAnnotations}}):t._e(),t._v(" "),t.canModify?i("control-button",{attrs:{icon:"fa-unlink",title:"Split selected annotation",disabled:t.cannotSplitAnnotation||t.hasError},on:{click:t.emitSplitAnnotation}}):t._e(),t._v(" "),t.canDelete?i("control-button",{attrs:{icon:"fa-trash",title:"Delete selected annotations/keyframes 𝗗𝗲𝗹𝗲𝘁𝗲",disabled:t.hasNoSelectedAnnotations||t.hasError},on:{click:t.emitDelete}}):t._e()],1):t._e()]),t._v(" "),i("div",{staticClass:"indicators indicators--left"},[t.showMousePosition?i("mouse-position-indicator",{attrs:{position:t.mousePositionImageCoordinates}}):t._e()],1),t._v(" "),i("div",{staticClass:"indicators indicators--right"},[t.selectedLabel?i("div",{staticClass:"indicator",domProps:{textContent:t._s(t.selectedLabel.name)}}):t._e()])],1)}),[],!1,null,null,null).exports;const kI=Ml({props:{currentTime:{type:Number,required:!0},hoverTime:{type:Number,default:0},seeking:{type:Boolean,default:!1}},components:{loader:vu},computed:{currentTimeText:function(){return Vue.filter("videoTime")(this.currentTime)},hoverTimeText:function(){return Vue.filter("videoTime")(this.hoverTime)},classObject:function(){return{"current-time--seeking":this.seeking,"current-time--hover":this.showHoverTime}},showHoverTime:function(){return 0!==this.hoverTime}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"current-time",class:t.classObject},[t.seeking?i("loader",{attrs:{active:!0}}):i("span",[i("span",{domProps:{textContent:t._s(t.currentTimeText)}}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showHoverTime,expression:"showHoverTime"}],staticClass:"hover-time",domProps:{textContent:t._s(t.hoverTimeText)}})])],1)}),[],!1,null,null,null).exports;var PI=Ml({props:{frame:{type:Object,required:!0},startFrame:{type:Number,required:!0},segmentDuration:{type:Number,required:!0},color:{type:String,required:!0}},computed:{offset:function(){return(this.frame.time-this.startFrame)/this.segmentDuration},style:function(){return{left:100*this.offset+"%","background-color":this.color}},classObj:function(){return{"annotation-keyframe--selected":this.frame.selected}}},methods:{emitSelect:function(t){this.$emit("select",this.frame,t.shiftKey)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"annotation-keyframe",class:t.classObj,style:t.style,on:{click:function(e){return e.stopPropagation(),t.emitSelect(e)}}})}),[],!1,null,null,null);var LI=Ml({components:{keyframe:PI.exports},props:{annotation:{type:Object,required:!0},label:{type:Object,required:!0},frames:{type:Array,required:!0},gap:{type:Boolean,default:!1},clipDuration:{type:Number,required:!0}},computed:{startFrame:function(){return this.frames[0]},endFrame:function(){return this.frames[this.frames.length-1]},segmentDuration:function(){return this.endFrame-this.startFrame},classObject:function(){return{"annotation-segment--gap":this.gap}},width:function(){return 100*this.segmentDuration/this.clipDuration},color:function(){return"#"+(this.label.color||"000000")},style:function(){var t={width:this.width+"%"};return this.gap?t["border-top-color"]=this.color:t["background-color"]=this.color+"66",t},keyframes:function(){if(this.gap)return[];var t=this.annotation.selected;return this.frames.map((function(e){return{time:e,selected:t===e}}))}},methods:{selectFrame:function(t,e){this.$emit("select",t.time,e)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-segment",class:t.classObject,style:t.style},t._l(t.keyframes,(function(e){return i("keyframe",{key:e.time,attrs:{frame:e,"start-frame":t.startFrame,"segment-duration":t.segmentDuration,color:t.color},on:{select:t.selectFrame}})})),1)}),[],!1,null,null,null);var RI=Ml({components:{segment:LI.exports},props:{annotation:{type:Object,required:!0},label:{type:Object,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},computed:{startFrame:function(){return this.annotation.startFrame},endFrame:function(){return this.annotation.endFrame},offset:function(){var t=this.startFrame/this.duration*this.elementWidth;return this.annotation.isClip||(t=Math.min(t,this.elementWidth-9)),t},clipDuration:function(){return this.endFrame-this.startFrame},width:function(){return this.clipDuration/this.duration*this.elementWidth},style:function(){return{left:this.offset+"px",width:this.width+"px"}},segments:function(){for(var t,e=[this.annotation.frames.slice()],i=[!1],n=0;-1!==(t=e[n].indexOf(null));){var r=e[n];e[n]=r.slice(0,t),e.push([r[t-1],r[t+1]]),i.push(!0),e.push(r.slice(t+1)),i.push(!1),n+=2}return e.map((function(t,e){return{frames:t,gap:i[e]}}))},selected:function(){return this.annotation.isSelected},classObj:function(){return{"annotation-clip--selected":this.selected,"annotation-clip--compact":this.shouldBeCompact,"annotation-clip--more-compact":this.shouldBeMoreCompact,"annotation-clip--tracking":this.annotation.tracking,"annotation-clip--whole-frame":this.annotation.wholeFrame,"annotation-clip--dark":this.hasDarkColor,"annotation-clip--pending":this.annotation.pending}},minTimeBetweenFrames:function(){for(var t=1/0,e=this.annotation.frames.filter((function(t){return null!==t})),i=e.length-1;i>0;i--)t=Math.min(t,e[i]-e[i-1]);return t},minDistanceBetweenFrames:function(){return this.minTimeBetweenFrames/this.duration*this.elementWidth},shouldBeCompact:function(){return this.minDistanceBetweenFrames<=18},shouldBeMoreCompact:function(){return this.minDistanceBetweenFrames<=6},title:function(){return this.annotation.pending?"Pending annotation":this.annotation.tracking?"Tracking in progress":""},hasDarkColor:function(){var t=this.label.color||"000000",e=parseInt(t,16);return.2126*(e>>16&255)+.7152*(e>>8&255)+.0722*(e>>0&255)<128}},methods:{emitSelect:function(t,e){this.selected&&e?this.$emit("deselect",this.annotation):this.$emit("select",this.annotation,t,e)},select:function(t){var e=this.startFrame+(t.clientX-this.$el.getBoundingClientRect().left)/this.$el.clientWidth*this.clipDuration;this.emitSelect(e,t.shiftKey)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.duration>0,expression:"duration > 0"}],staticClass:"annotation-clip",class:t.classObj,style:t.style,attrs:{title:t.title},on:{click:function(e){return e.stopPropagation(),t.select(e)}}},t._l(t.segments,(function(e,n){return i("segment",{key:n,attrs:{annotation:t.annotation,label:t.label,frames:e.frames,gap:e.gap,"clip-duration":t.clipDuration},on:{select:t.emitSelect}})})),1)}),[],!1,null,null,null);var FI=Ml({components:{annotationClip:RI.exports},props:{label:{type:Object,required:!0},lanes:{type:Array,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},methods:{emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-track"},t._l(t.lanes,(function(e){return i("div",{staticClass:"annotation-lane"},t._l(e,(function(e){return i("annotation-clip",{key:e.id,attrs:{annotation:e,"element-width":t.elementWidth,label:t.label,duration:t.duration},on:{select:t.emitSelect,deselect:t.emitDeselect}})})),1)})),0)}),[],!1,null,null,null);const MI=Ml({components:{annotationTrack:FI.exports},props:{tracks:{type:Array,required:!0},duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},data:function(){return{dragging:!1,scrollTop:0,scrollHeight:0,clientHeight:0}},computed:{hasOverflowTop:function(){return this.scrollTop>0},hasOverflowBottom:function(){var t=this.scrollHeight-this.clientHeight-1;return t>0&&this.scrollTop<t}},methods:{emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(){this.$emit("deselect")},emitDeselectAnnotation:function(t){this.$emit("deselect",t)},emitDragX:function(t){this.$emit("drag-x",t)},startDragging:function(t){this.dragging=1===t.buttons},stopDragging:function(){this.dragging=!1},continueDragging:function(t){this.dragging&&(1!==t.buttons?this.stopDragging():(this.$el.scrollTop-=t.movementY,0!==t.movementX&&this.emitDragX(t.movementX)))},updateScrollTop:function(){this.scrollTop=this.$el.scrollTop},updateScrollHeight:function(){this.scrollHeight=this.$el.scrollHeight},updateClientHeight:function(){this.clientHeight=this.$el.clientHeight}},watch:{tracks:function(){this.$nextTick(this.updateScrollHeight)},hasOverflowTop:function(t){this.$emit("overflow-top",t)},hasOverflowBottom:function(t){this.$emit("overflow-bottom",t)},scrollTop:function(t){this.$emit("scroll-y",t)}},created:function(){window.addEventListener("resize",this.updateClientHeight)},mounted:function(){this.$nextTick(this.updateClientHeight)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"annotation-tracks",on:{click:t.emitDeselect,mousedown:t.startDragging,mouseup:t.stopDragging,mousemove:t.continueDragging,scroll:function(e){return e.stopPropagation(),t.updateScrollTop(e)}}},t._l(t.tracks,(function(e){return i("annotation-track",{key:e.id,attrs:{label:e.label,lanes:e.lanes,duration:t.duration,"element-width":t.elementWidth},on:{select:t.emitSelect,deselect:t.emitDeselectAnnotation}})})),1)}),[],!1,null,null,null).exports;const OI=Ml({props:{time:{type:Number,required:!0}},computed:{style:function(){var t=this.time/this.$parent.duration*this.$parent.elementWidth;return"left: ".concat(t,"px")},text:function(){return Vue.filter("videoTime")(this.time)}}},(function(){var t=this,e=t.$createElement;return(t._self._c||e)("span",{staticClass:"tick",style:t.style,domProps:{textContent:t._s(t.text)}})}),[],!1,null,null,null).exports;var DI=Ml({props:{duration:{type:Number,required:!0},elementWidth:{type:Number,required:!0}},components:{tick:OI},data:function(){return{tickSpacing:100}},computed:{tickCount:function(){return Math.floor(this.elementWidth/this.tickSpacing)},ticks:function(){if(!this.hasTicks)return[];var t=this.duration/this.tickCount;return Array.apply(null,{length:this.tickCount}).map((function(e,i){return t*i}))},hasTicks:function(){return this.tickCount>0&&this.duration>0}},methods:{emitSeek:function(t){this.$emit("seek",(t.clientX-t.target.getBoundingClientRect().left)/t.target.clientWidth*this.duration)}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-progress",on:{click:t.emitSeek}},t._l(t.ticks,(function(t){return i("tick",{key:t,attrs:{time:t}})})),1)}),[],!1,null,null,null);const $I=Ml({components:{videoProgress:DI.exports,annotationTracks:MI},props:{tracks:{type:Array,required:function(){return[]}},duration:{type:Number,required:!0},currentTime:{type:Number,required:!0},seeking:{type:Boolean,default:!1}},data:function(){return{zoom:1,zoomFactor:.3,scrollFactor:10,initialElementWidth:0,scrollLeft:0,hoverTime:0,hasOverflowTop:!1,hasOverflowBottom:!1}},computed:{currentTimePosition:function(){return this.duration>0?this.elementWidth*this.currentTime/this.duration:0},timeIndicatorClass:function(){return{"time-indicator--seeking":this.seeking}},timeIndicatorStyle:function(){return"transform: translateX(".concat(this.currentTimePosition,"px);")},hoverTimeIndicatorStyle:function(){return"transform: translateX(".concat(this.hoverPosition,"px);")},scrollerStyle:function(){return{width:100*this.zoom+"%",left:this.scrollLeft+"px"}},elementWidth:function(){return this.initialElementWidth*this.zoom},hoverPosition:function(){return this.duration>0?this.elementWidth*this.hoverTime/this.duration:0},showHoverTime:function(){return 0!==this.hoverTime},hasOverflowLeft:function(){return this.scrollLeft<0},hasOverflowRight:function(){return this.elementWidth+this.scrollLeft>this.initialElementWidth}},methods:{updateInitialElementWidth:function(){this.initialElementWidth=this.$el.clientWidth},emitSeek:function(t){this.$emit("seek",t)},emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)},emitScrollY:function(t){this.$emit("scroll-y",t)},handleWheel:function(t){t.shiftKey?0!==t.deltaY&&this.updateZoom(t):t.deltaX<0?this.updateScrollLeft(this.scrollLeft+this.scrollFactor):t.deltaX>0&&this.updateScrollLeft(this.scrollLeft-this.scrollFactor)},updateZoom:function(t){var e=this,i=t.clientX-this.$el.getBoundingClientRect().left,n=(t.clientX-this.$refs.scroller.getBoundingClientRect().left)/this.elementWidth,r=t.deltaY<0?this.zoomFactor:-1*this.zoomFactor;this.zoom=Math.max(1,this.zoom+r),this.$nextTick((function(){var t=n*e.elementWidth;e.updateScrollLeft(i-t)}))},handleHideHoverTime:function(){this.hoverTime=0},handleUpdateHoverTime:function(t){this.hoverTime=(t.clientX-this.$refs.scroller.getBoundingClientRect().left)/this.elementWidth*this.duration},updateScrollLeft:function(t){this.scrollLeft=Math.max(Math.min(0,t),this.initialElementWidth-this.elementWidth)},updateOverflowTop:function(t){this.hasOverflowTop=t},updateOverflowBottom:function(t){this.hasOverflowBottom=t},handleDragX:function(t){this.updateScrollLeft(this.scrollLeft+t)},updateHeight:function(){this.$refs.annotationTracks.updateClientHeight()},reset:function(){this.zoom=1,this.scrollLeft=0,this.hoverTime=0,this.hasOverflowTop=!1,this.hasOverflowBottom=!1}},watch:{hoverTime:function(t){this.$emit("hover-time",t)},initialElementWidth:function(t,e){this.updateScrollLeft(this.scrollLeft*t/e)}},created:function(){var t=this;window.addEventListener("resize",this.updateInitialElementWidth),wu.$on("sidebar.toggle",(function(){t.$nextTick(t.updateInitialElementWidth)})),xu.on(" ",(function(t){t.preventDefault()}))},mounted:function(){this.$nextTick(this.updateInitialElementWidth)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scroll-strip",on:{wheel:function(e){return e.stopPropagation(),t.handleWheel(e)},mouseleave:t.handleHideHoverTime}},[i("div",{ref:"scroller",staticClass:"scroll-strip__scroller",style:t.scrollerStyle,on:{mousemove:t.handleUpdateHoverTime}},[i("video-progress",{attrs:{duration:t.duration,"element-width":t.elementWidth},on:{seek:t.emitSeek}}),t._v(" "),i("div",{staticClass:"annotation-tracks-wrapper"},[i("annotation-tracks",{ref:"annotationTracks",attrs:{tracks:t.tracks,duration:t.duration,"element-width":t.elementWidth},on:{select:t.emitSelect,deselect:t.emitDeselect,"scroll-y":t.emitScrollY,"drag-x":t.handleDragX,"overflow-top":t.updateOverflowTop,"overflow-bottom":t.updateOverflowBottom}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowTop,expression:"hasOverflowTop"}],staticClass:"overflow-shadow overflow-shadow--top"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowBottom,expression:"hasOverflowBottom"}],staticClass:"overflow-shadow overflow-shadow--bottom"})],1),t._v(" "),i("span",{staticClass:"time-indicator",class:t.timeIndicatorClass,style:t.timeIndicatorStyle}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:t.showHoverTime,expression:"showHoverTime"}],staticClass:"hover-time-indicator",style:t.hoverTimeIndicatorStyle})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowLeft,expression:"hasOverflowLeft"}],staticClass:"overflow-shadow overflow-shadow--left"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasOverflowRight,expression:"hasOverflowRight"}],staticClass:"overflow-shadow overflow-shadow--right"})])}),[],!1,null,null,null).exports;var jI=Ml({props:{tracks:{type:Array,required:!0},scrollTop:{type:Number,default:0}},watch:{scrollTop:function(t){this.$el.scrollTop=t}}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"track-headers"},t._l(t.tracks,(function(e){return i("div",{staticClass:"track-header"},[i("div",{staticClass:"label-name",attrs:{title:e.label.name},domProps:{textContent:t._s(e.label.name)}}),t._v(" "),t._l(e.lanes,(function(t){return i("div",{staticClass:"lane-dummy"})}))],2)})),0)}),[],!1,null,null,null);const NI=Ml({components:{currentTime:kI,trackHeaders:jI.exports,scrollStrip:$I},props:{annotations:{type:Array,default:function(){return[]}},video:{type:HTMLVideoElement,required:!0},seeking:{type:Boolean,default:!1},heightOffset:{type:Number,default:0},pendingAnnotation:{type:Object,default:function(){return null}}},data:function(){return{animationFrameId:null,refreshRate:30,refreshLastTime:Date.now(),currentTime:0,duration:0,scrollTop:0,hoverTime:0}},computed:{labelMap:function(){var t={},e=this.annotations;return this.pendingAnnotation&&(e=e.slice()).push(this.pendingAnnotation),e.forEach((function(e){e.labels.forEach((function(e){t.hasOwnProperty(e.label_id)||(t[e.label_id]=e.label)}))})),t},annotationTracks:function(){var t=this,e={},i=this.annotations;return this.pendingAnnotation&&(i=i.slice()).push(this.pendingAnnotation),i.forEach((function(t){t.labels.forEach((function(i){e.hasOwnProperty(i.label_id)||(e[i.label_id]=[]),e[i.label_id].push(t)}))})),Object.keys(e).map((function(i){return{id:i,label:t.labelMap[i],lanes:t.getAnnotationTrackLanes(e[i])}}))},styleObject:function(){return 0!==this.heightOffset?"height: calc(35% + ".concat(this.heightOffset,"px);"):""}},methods:{startUpdateLoop:function(){var t=Date.now();t-this.refreshLastTime>=this.refreshRate&&(this.updateCurrentTime(),this.refreshLastTime=t),this.animationFrameId=window.requestAnimationFrame(this.startUpdateLoop)},stopUpdateLoop:function(){this.updateCurrentTime(),window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null},updateCurrentTime:function(){this.currentTime=this.video.currentTime},setDuration:function(){this.duration=this.video.duration},emitSeek:function(t){this.$emit("seek",t)},emitSelect:function(t,e,i){this.$emit("select",t,e,i)},emitDeselect:function(t){this.$emit("deselect",t)},handleScrollY:function(t){this.scrollTop=t},getAnnotationTrackLanes:function(t){var e=this,i=[[]],n=[[]];return t.forEach((function(t){var r=[t.startFrame,t.endFrame],o=0,s=!1;t:for(;!s;){if(n[o]){for(var a=i[o].length-1;a>=0;a--)if(e.rangesCollide(i[o][a],r)){o+=1;continue t}}else i[o]=[],n[o]=[];i[o].push(r),n[o].push(t),s=!0}})),n},rangesCollide:function(t,e){return t[0]>=e[0]&&t[0]<e[1]||t[1]>e[0]&&t[1]<=e[1]||e[0]>=t[0]&&e[0]<t[1]||e[1]>t[0]&&e[1]<=t[1]||t[0]===e[0]&&t[1]===e[1]},updateHoverTime:function(t){this.hoverTime=t},emitStartResize:function(t){this.$emit("start-resize",t)},reset:function(){this.currentTime=0,this.duration=0,this.scrollTop=0,this.hoverTime=0,this.$refs.scrollStrip.reset()}},watch:{heightOffset:function(){this.$refs.scrollStrip.updateHeight()}},created:function(){this.video.addEventListener("play",this.startUpdateLoop),this.video.addEventListener("pause",this.stopUpdateLoop),this.video.addEventListener("loadedmetadata",this.setDuration),this.video.addEventListener("seeked",this.updateCurrentTime)}},(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-timeline",style:t.styleObject},[i("div",{staticClass:"grab-border",on:{mousedown:t.emitStartResize}}),t._v(" "),i("div",{staticClass:"static-strip"},[i("current-time",{attrs:{"current-time":t.currentTime,"hover-time":t.hoverTime,seeking:t.seeking}}),t._v(" "),i("track-headers",{ref:"trackheaders",attrs:{tracks:t.annotationTracks,"scroll-top":t.scrollTop}})],1),t._v(" "),i("scroll-strip",{ref:"scrollStrip",attrs:{tracks:t.annotationTracks,duration:t.duration,"current-time":t.currentTime,seeking:t.seeking},on:{seek:t.emitSeek,select:t.emitSelect,deselect:t.emitDeselect,"scroll-y":t.handleScrollY,"hover-time":t.updateHoverTime}})],1)}),[],!1,null,null,null).exports;function BI(t){return(BI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function UI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GI(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&XI(t,e)}function VI(t){var e=KI();return function(){var i,n=YI(t);if(e){var r=YI(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return zI(this,i)}}function zI(t,e){return!e||"object"!==BI(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qI(t){var e="function"==typeof Map?new Map:void 0;return(qI=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return WI(t,arguments,YI(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),XI(n,t)})(t)}function WI(t,e,i){return(WI=KI()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var r=new(Function.bind.apply(t,n));return i&&XI(r,i.prototype),r}).apply(null,arguments)}function KI(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function XI(t,e){return(XI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function YI(t){return(YI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HI=function(t){GI(i,t);var e=VI(i);function i(){return UI(this,i),e.apply(this,arguments)}return i}(qI(Error)),ZI=function(t){GI(i,t);var e=VI(i);function i(){return UI(this,i),e.apply(this,arguments)}return i}(HI),JI=function(t){GI(i,t);var e=VI(i);function i(){return UI(this,i),e.apply(this,arguments)}return i}(HI),QI=function(t){GI(i,t);var e=VI(i);function i(){return UI(this,i),e.apply(this,arguments)}return i}(HI),tA=function(t){GI(i,t);var e=VI(i);function i(){return UI(this,i),e.apply(this,arguments)}return i}(HI),eA=function(t){GI(i,t);var e=VI(i);function i(){return UI(this,i),e.apply(this,arguments)}return i}(HI),iA=function(t){GI(i,t);var e=VI(i);function i(){return UI(this,i),e.apply(this,arguments)}return i}(HI);const nA=Ml({mixins:[$u],components:{videoScreen:AI,videoTimeline:NI,sidebar:Su,sidebarTab:Cu,labelTrees:Xu,settingsTab:yI,annotationsTab:vI,videoLabelsTab:_I},data:function(){return{volumeId:null,videoId:null,videoDuration:0,videoIds:[],videoFileUri:"",shapes:[],canEdit:!1,video:null,labelTrees:[],selectedLabel:null,pendingAnnotation:null,annotations:[],seeking:!1,settings:{annotationOpacity:1,showMinimap:!0,autoplayDraw:0,showLabelTooltip:!1,showMousePosition:!1,playbackRate:1,showProgressIndicator:!0},openTab:"",urlParams:{x:0,y:0,r:0,t:0},initialCurrentTime:0,initialMapCenter:[0,0],initialMapResolution:0,initialFocussedAnnotation:0,annotationFilters:[],activeAnnotationFilter:null,resizingTimeline:!1,timelineOffsetReference:0,timelineHeightReference:0,fixedTimelineOffset:0,currentTimelineOffset:0,errors:{},error:null,user:null,attachingLabel:!1,swappingLabel:!1}},computed:{selectedAnnotations:function(){return this.filteredAnnotations.filter((function(t){return t.isSelected}))},filteredAnnotations:function(){return this.hasActiveAnnotationFilter?this.activeAnnotationFilter.filter(this.annotations):this.annotations},hasActiveAnnotationFilter:function(){return null!==this.activeAnnotationFilter},timelineHeightOffset:function(){return this.fixedTimelineOffset+this.currentTimelineOffset},screenHeightOffset:function(){return-1*this.timelineHeightOffset},classObject:function(){return this.resizingTimeline?"resizing-timeline":""},hasSiblingVideos:function(){return this.videoIds.length>1},hasError:function(){return null!==this.error},hasVideoError:function(){return this.error instanceof HI},errorMessage:function(){if(this.hasVideoError){if(this.error instanceof ZI)return"The video has not been processed yet. Please try again later.";if(this.error instanceof JI)return"The video file has not been found. Please check the source.";if(this.error instanceof QI)return"The video MIME type is invalid.";if(this.error instanceof tA)return"The video codec is invalid.";if(this.error instanceof eA)return"The video file is malformed.";if(this.error instanceof iA)return"The video file is too large."}return""},errorClass:function(){return this.hasVideoError?this.error instanceof ZI?"panel-warning text-warning":"panel-danger text-danger":""}},methods:{prepareAnnotation:function(t){return new mI({data:t})},setAnnotations:function(t){this.annotations=t[0].body.map(this.prepareAnnotation)},addCreatedAnnotation:function(t){var e=this.prepareAnnotation(t.body);return e.$on("tracking-failed",this.removeAnnotation),this.annotations.push(e),e},seek:function(t){var e=this;if(!this.seeking&&this.video.currentTime!==t){var i=new Vue.Promise((function(t,i){e.video.addEventListener("seeked",t),e.video.addEventListener("error",i)}));return this.seeking=!0,this.video.currentTime=t,i}return Vue.Promise.resolve()},selectAnnotation:function(t,e,i){return this.attachingLabel?(this.attachAnnotationLabel(t),Vue.Promise.resolve()):this.swappingLabel?(this.swapAnnotationLabel(t),Vue.Promise.resolve()):i?this.selectAnnotations([t],[],e):this.selectAnnotations([t],this.selectedAnnotations,e)},selectAnnotations:function(t,e,i){e.forEach((function(t){t.selected=!1}));var n=this.selectedAnnotations.length>0;return t.forEach((function(t){t.selected=i})),void 0!==i&&!1===n?this.seek(i):Vue.Promise.resolve()},deselectAnnotation:function(t){t?t.selected=!1:this.selectedAnnotations.forEach((function(t){t.selected=!1}))},updatePendingAnnotation:function(t){if(t){var e=Object.assign({},t,{shape_id:this.shapes[t.shape],labels:[{label_id:this.selectedLabel.id,label:this.selectedLabel,user:this.user}],pending:!0});this.pendingAnnotation=new mI({data:e})}else this.pendingAnnotation=null},createAnnotation:function(t){var e=this;this.updatePendingAnnotation(t);var i=this.pendingAnnotation;this.annotations.push(i);var n=i.frames.length;this.videoDuration>0&&n>0&&i.frames[n-1]>this.videoDuration&&(i.frames[n-1]=this.videoDuration);var r=Object.assign({},t,{shape_id:this.shapes[t.shape],label_id:this.selectedLabel?this.selectedLabel.id:0});return delete r.shape,_T.save({id:this.videoId},r).then(this.addCreatedAnnotation,Mu).finally((function(){var t=e.annotations.indexOf(i);-1!==t&&e.annotations.splice(t,1)}))},trackAnnotation:function(t){t.track=!0,this.createAnnotation(t).then(this.startPollTrackingAnnotation)},startPollTrackingAnnotation:function(t){t&&t.startPollTracking()},handleSelectedLabel:function(t){this.selectedLabel=t},handleDeselectedLabel:function(){this.selectedLabel=null},deleteAnnotationsOrKeyframes:function(t){confirm("Are you sure that you want to delete all selected annotations/keyframes?")&&t.forEach(this.deleteAnnotationOrKeyframe)},deleteAnnotationOrKeyframe:function(t){var e=this,i=t.annotation;i.isClip&&i.hasKeyframe(t.time)?i.deleteKeyframe(t.time).catch(Mu):i.delete().then((function(){return e.removeAnnotation(i)})).catch(Mu)},handleVideoSeeked:function(){this.seeking=!1},modifyAnnotations:function(t){t.forEach(this.modifyAnnotation)},modifyAnnotation:function(t){t.annotation.modify(t.time,t.points).catch(Mu)},handleUpdatedSettings:function(t,e){this.settings[t]=e},handleOpenedTab:function(t){mT.set("openTab",t)},handleClosedTab:function(){mT.delete("openTab")},handleToggledTab:function(){this.$refs.videoScreen.updateSize()},removeAnnotation:function(t){var e=this.annotations.indexOf(t);-1!==e&&this.annotations.splice(e,1)},splitAnnotation:function(t,e){t.split(e).then(this.addCreatedAnnotation,Mu)},linkAnnotations:function(t){var e=this;t[0].link(t[1]).then((function(){return e.removeAnnotation(t[1])})).catch(Mu)},updateMapUrlParams:function(t,e){this.urlParams.x=Math.round(t[0]),this.urlParams.y=Math.round(t[1]),this.urlParams.r=Math.round(100*e)},updateVideoUrlParams:function(){this.urlParams.t=Math.round(100*this.video.currentTime)},restoreUrlParams:function(){void 0!==Au.get("r")&&(this.initialMapResolution=parseInt(Au.get("r"),10)/100),void 0!==Au.get("x")&&void 0!==Au.get("y")&&(this.initialMapCenter=[parseInt(Au.get("x"),10),parseInt(Au.get("y"),10)]),void 0!==Au.get("t")&&(this.initialCurrentTime=parseInt(Au.get("t"),10)/100),void 0!==Au.get("annotation")&&(this.initialFocussedAnnotation=parseInt(Au.get("annotation"),10))},maybeInitCurrentTime:function(){return 0===this.initialCurrentTime||this.selectedAnnotations.length>0?Vue.Promise.resolve():this.seek(this.initialCurrentTime)},maybeFocusInitialAnnotation:function(){var t=this;if(this.initialFocussedAnnotation){var e=this.annotations.find((function(e){return e.id===t.initialFocussedAnnotation}));if(e)return this.selectAnnotation(e,e.startFrame).then((function(){return t.$refs.videoScreen.focusAnnotation(e)}))}return Vue.Promise.resolve()},detachAnnotationLabel:function(t,e){var i=this;t.labels.length>1?t.detachAnnotationLabel(e).catch(Mu):confirm("Detaching the last label of an annotation deletes the whole annotation. Do you want to delete the annotation?")&&t.delete().then((function(){return i.removeAnnotation(t)})).catch(Mu)},attachAnnotationLabel:function(t){var e=t.attachAnnotationLabel(this.selectedLabel);return e.catch(Mu),e},swapAnnotationLabel:function(t){var e=this,i=t.labels.filter((function(t){return t.user_id===e.user.id})).sort((function(t,e){return t.id-e.id})).pop();this.attachAnnotationLabel(t).then((function(){i&&e.detachAnnotationLabel(t,i)})).catch(Mu)},initAnnotationFilters:function(){var t={};for(var e in this.shapes)t[this.shapes[e]]=e;this.annotationFilters=[new nT({data:{annotations:this.annotations}}),new sT({data:{annotations:this.annotations}}),new oT({data:{shapes:t}})]},updateAnnotationFilters:function(){this.annotationFilters[0].annotations=this.annotations,this.annotationFilters[1].annotations=this.annotations},setActiveAnnotationFilter:function(t){this.activeAnnotationFilter=t},resetAnnotationFilter:function(){this.activeAnnotationFilter&&this.activeAnnotationFilter.reset(),this.activeAnnotationFilter=null},handleRequiresSelectedLabel:function(){Ou.info("Please select a label first."),this.$refs.sidebar.$emit("open","labels")},startUpdateTimelineHeight:function(t){t.preventDefault(),this.resizingTimeline=!0,this.timelineOffsetReference=t.clientY,this.timelineHeightReference=this.$refs.videoTimeline.$el.offsetHeight},updateTimelineHeight:function(t){this.resizingTimeline&&(t.preventDefault(),this.currentTimelineOffset=this.timelineOffsetReference-t.clientY)},finishUpdateTimelineHeight:function(){this.resizingTimeline&&(this.resizingTimeline=!1,this.fixedTimelineOffset=this.fixedTimelineOffset+this.$refs.videoTimeline.$el.offsetHeight-this.timelineHeightReference,this.currentTimelineOffset=0)},handleVideoInformationResponse:function(t){var e=t.body;if(e.error===this.errors["not-found"])throw new JI;if(e.error===this.errors.mimetype)throw new QI;if(e.error===this.errors.codec)throw new tA;if(e.error===this.errors.malformed)throw new eA;if(e.error===this.errors["too-large"])throw new iA;if(null===e.size)throw new ZI;return this.error=null,this.videoDuration=e.duration,e},handleVideoError:function(t){t instanceof HI?this.error=t:(this.error=!0,Mu(t))},fetchVideoContent:function(t){var e=this,i=new Vue.Promise((function(t){e.video.addEventListener("canplay",t)})),n=_T.query({id:t.id}),r=Vue.Promise.all([n,i]).then(this.setAnnotations).then(this.updateAnnotationFilters).then(this.maybeFocusInitialAnnotation).then(this.maybeInitCurrentTime);return this.video.src=this.videoFileUri.replace(":id",t.id),r},loadVideo:function(t){return this.videoId=t,wu.$emit("video.id",t),Au.setSlug(t,-2),this.startLoading(),Yh.get({id:t}).then(this.handleVideoInformationResponse).then(this.fetchVideoContent).catch(this.handleVideoError).finally(this.finishLoading)},showPreviousVideo:function(){this.reset();var t=this.videoIds.length,e=(this.videoIds.indexOf(this.videoId)+t-1)%t;this.loadVideo(this.videoIds[e]).then(this.updateVideoUrlParams)},showNextVideo:function(){this.reset();var t=this.videoIds.length,e=(this.videoIds.indexOf(this.videoId)+t+1)%t;this.loadVideo(this.videoIds[e]).then(this.updateVideoUrlParams)},reset:function(){this.annotations=[],this.seeking=!1,this.initialCurrentTime=0,this.initialFocussedAnnotation=0,this.$refs.videoTimeline.reset(),this.$refs.videoScreen.reset()},initVideoIds:function(t){var e=window.localStorage.getItem("biigle.volumes.".concat(this.volumeId,".files"));if(e){var i={};return t.forEach((function(t){i[t]=null})),JSON.parse(e).filter((function(t){return i.hasOwnProperty(t)}))}return t},handleAttachingLabelActive:function(t){this.swappingLabel=!1,this.attachingLabel=t},handleSwappingLabelActive:function(t){this.attachingLabel=!1,this.swappingLabel=t}},watch:{"settings.playbackRate":function(t){this.video.playbackRate=t},urlParams:{deep:!0,handler:function(t){Au.set(t)}}},created:function(){var t=biigle.$require("videos.shapes"),e={};Object.keys(t).forEach((function(i){e[t[i]]=parseInt(i)})),this.shapes=e,this.video=document.createElement("video"),this.videoId=biigle.$require("videos.id"),this.volumeId=biigle.$require("videos.volumeId"),this.videoIds=this.initVideoIds(biigle.$require("videos.videoIds")),this.videoFileUri=biigle.$require("videos.videoFileUri"),this.canEdit=biigle.$require("videos.isEditor"),this.labelTrees=biigle.$require("videos.labelTrees"),this.errors=biigle.$require("videos.errors"),this.user=biigle.$require("videos.user"),this.initAnnotationFilters(),this.restoreUrlParams(),this.video.muted=!0,this.video.addEventListener("error",(function(t){t.target.error.code===MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED?t.target.error.message.startsWith("404")||t.target.error.message.startsWith("403")?Ou.danger("Unable to access the video file."):Ou.danger("The video codec is not supported by your browser."):t.target.error.code!==MediaError.MEDIA_ERR_ABORTED&&Ou.danger("Error while loading video file.")})),this.video.addEventListener("seeked",this.handleVideoSeeked),this.video.addEventListener("pause",this.updateVideoUrlParams),this.video.addEventListener("seeked",this.updateVideoUrlParams),mT.has("openTab")&&(this.openTab=mT.get("openTab"))},mounted:function(){this.loadVideo(this.videoId)}},undefined,undefined,!1,null,null,null).exports;biigle.$mount("search-results",yT),biigle.$mount("video-annotations-navbar",vT),biigle.$mount("video-container",nA)},9276:()=>{var t=new Date(0);Vue.filter("videoTime",(function(e){return t.setTime(1e3*e),t.toISOString().split("T")[1].slice(0,-2)}))},1924:(t,e,i)=>{"use strict";var n=i(210),r=i(5559),o=r(n("String.prototype.indexOf"));t.exports=function(t,e){var i=n(t,!!e);return"function"==typeof i&&o(t,".prototype.")>-1?r(i):i}},5559:(t,e,i)=>{"use strict";var n=i(8612),r=i(210),o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),a=r("%Reflect.apply%",!0)||n.call(s,o),l=r("%Object.getOwnPropertyDescriptor%",!0),u=r("%Object.defineProperty%",!0),h=r("%Math.max%");if(u)try{u({},"a",{value:1})}catch(t){u=null}t.exports=function(t){var e=a(n,s,arguments);if(l&&u){var i=l(e,"length");i.configurable&&u(e,"length",{value:1+h(0,t.length-(arguments.length-1))})}return e};var c=function(){return a(n,o,arguments)};u?u(t.exports,"apply",{value:c}):t.exports.apply=c},6442:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,'.ol-box{box-sizing:border-box;border-radius:2px;border:2px solid #00f}.ol-mouse-position{top:8px;right:8px;position:absolute}.ol-scale-line{background:rgba(0,60,136,.3);border-radius:4px;bottom:8px;left:8px;padding:2px;position:absolute}.ol-scale-line-inner{border:1px solid #eee;border-top:none;color:#eee;font-size:10px;text-align:center;margin:1px;will-change:contents,width}.ol-overlay-container{will-change:left,right,top,bottom}.ol-unsupported{display:none}.ol-unselectable,.ol-viewport{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.ol-selectable{-webkit-touch-callout:default;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ol-grabbing{cursor:-webkit-grabbing;cursor:grabbing}.ol-grab{cursor:move;cursor:-webkit-grab;cursor:grab}.ol-control{position:absolute;background-color:hsla(0,0%,100%,.4);border-radius:4px;padding:2px}.ol-control:hover{background-color:hsla(0,0%,100%,.6)}.ol-zoom{top:.5em;left:.5em}.ol-rotate{top:.5em;right:.5em;transition:opacity .25s linear,visibility 0s linear}.ol-rotate.ol-hidden{opacity:0;visibility:hidden;transition:opacity .25s linear,visibility 0s linear .25s}.ol-zoom-extent{top:4.643em;left:.5em}.ol-full-screen{right:.5em;top:.5em}@media print{.ol-control{display:none}}.ol-control button{display:block;margin:1px;padding:0;color:#fff;font-size:1.14em;font-weight:700;text-decoration:none;text-align:center;height:1.375em;width:1.375em;line-height:.4em;background-color:rgba(0,60,136,.5);border:none;border-radius:2px}.ol-control button::-moz-focus-inner{border:none;padding:0}.ol-zoom-extent button{line-height:1.4em}.ol-compass{display:block;font-weight:400;font-size:1.2em;will-change:transform}.ol-touch .ol-control button{font-size:1.5em}.ol-touch .ol-zoom-extent{top:5.5em}.ol-control button:focus,.ol-control button:hover{text-decoration:none;background-color:rgba(0,60,136,.7)}.ol-zoom .ol-zoom-in{border-radius:2px 2px 0 0}.ol-zoom .ol-zoom-out{border-radius:0 0 2px 2px}.ol-attribution{text-align:right;bottom:.5em;right:.5em;max-width:calc(100% - 1.3em)}.ol-attribution ul{margin:0;padding:0 .5em;font-size:.7rem;line-height:1.375em;color:#000;text-shadow:0 0 2px #fff}.ol-attribution li{display:inline;list-style:none;line-height:inherit}.ol-attribution li:not(:last-child):after{content:" "}.ol-attribution img{max-height:2em;max-width:inherit;vertical-align:middle}.ol-attribution button,.ol-attribution ul{display:inline-block}.ol-attribution.ol-collapsed ul{display:none}.ol-attribution:not(.ol-collapsed){background:hsla(0,0%,100%,.8)}.ol-attribution.ol-uncollapsible{bottom:0;right:0;border-radius:4px 0 0;height:1.1em;line-height:1em}.ol-attribution.ol-uncollapsible img{margin-top:-.2em;max-height:1.6em}.ol-attribution.ol-uncollapsible button{display:none}.ol-zoomslider{top:4.5em;left:.5em;height:200px}.ol-zoomslider button{position:relative;height:10px}.ol-touch .ol-zoomslider{top:5.5em}.ol-overviewmap{left:.5em;bottom:.5em}.ol-overviewmap.ol-uncollapsible{bottom:0;left:0;border-radius:0 4px 0 0}.ol-overviewmap .ol-overviewmap-map,.ol-overviewmap button{display:inline-block}.ol-overviewmap .ol-overviewmap-map{border:1px solid #7b98bc;height:150px;margin:2px;width:150px}.ol-overviewmap:not(.ol-collapsed) button{bottom:1px;left:2px;position:absolute}.ol-overviewmap.ol-collapsed .ol-overviewmap-map,.ol-overviewmap.ol-uncollapsible button{display:none}.ol-overviewmap:not(.ol-collapsed){background:hsla(0,0%,100%,.8)}.ol-overviewmap-box{border:2px dotted rgba(0,60,136,.7)}.ol-overviewmap .ol-overviewmap-box:hover{cursor:move}',""]);const o=r},6187:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".fade-enter-active,.fade-leave-active{transition:opacity .3s ease}.fade-enter,.fade-leave-active{height:0;opacity:0}.alert.top{margin:0 auto;left:0;right:0}.alert.top,.alert.top-right{position:fixed;top:30px;z-index:1050}.alert.top-right{right:50px}",""]);const o=r},5608:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".datepicker{position:relative;display:inline-block}.datepicker-block{display:block}input.datepicker-input.with-reset-button{padding-right:25px}.datepicker>button.close{position:absolute;top:0;right:0;outline:none;z-index:2;display:block;width:34px;height:34px;line-height:34px;text-align:center}.datepicker>button.close:focus{opacity:.2}.datepicker-popup{position:absolute;border:1px solid #555;border-radius:5px;background-color:#222;margin-top:2px;z-index:1000;box-shadow:0 6px 12px rgba(0,0,0,.5)}.datepicker-inner{width:218px}.datepicker-body{padding:10px}.datepicker-body span,.datepicker-ctrl p,.datepicker-ctrl span{display:inline-block;width:28px;line-height:28px;height:28px;border-radius:4px}.datepicker-ctrl p{width:65%}.datepicker-ctrl span{position:absolute}.datepicker-body span{text-align:center}.datepicker-monthRange span{width:48px;height:50px;line-height:45px}.datepicker-item-disable{cursor:not-allowed!important}.datepicker-item-disable,.datepicker-item-gray,.decadeRange span:first-child,.decadeRange span:last-child{opacity:.65}.datepicker-dateRange-item-active,.datepicker-dateRange-item-active:hover{background:#3276b1!important;color:#fff!important}.datepicker-monthRange{margin-top:10px}.datepicker-ctrl p,.datepicker-ctrl span,.datepicker-dateRange span,.datepicker-monthRange span{cursor:pointer}.datepicker-ctrl i:hover,.datepicker-ctrl p:hover,.datepicker-dateRange-item-hover,.datepicker-dateRange span:hover,.datepicker-monthRange span:hover{background-color:#090909}.datepicker-weekRange span{font-weight:700}.datepicker-label{background-color:#f8f8f8;font-weight:700;padding:7px 0;text-align:center}.datepicker-ctrl{position:relative;height:30px;line-height:30px;font-weight:700;text-align:center}.month-btn{font-weight:700;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.datepicker-preBtn{left:2px}.datepicker-nextBtn{right:2px}",""]);const o=r},8518:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".popover.bottom,.popover.left,.popover.right,.popover.top{display:block}.scale-enter{-webkit-animation:scale-in .15s ease-in;animation:scale-in .15s ease-in}.scale-leave-active{-webkit-animation:scale-out .15s ease-out;animation:scale-out .15s ease-out}@-webkit-keyframes scale-in{0%{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}@keyframes scale-in{0%{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}@-webkit-keyframes scale-out{0%{transform:scale(1);opacity:1}to{transform:scale(0);opacity:0}}@keyframes scale-out{0%{transform:scale(1);opacity:1}to{transform:scale(0);opacity:0}}",""]);const o=r},3698:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".tab-content .tab-pane{display:none}.tab-content .tab-pane.active{display:block}",""]);const o=r},5306:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,"[tabs]>.tab-content{margin:15px 0}",""]);const o=r},9118:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var n=i(3645),r=i.n(n)()((function(t){return t[1]}));r.push([t.id,".dropdown-menu>li>a{cursor:pointer}",""]);const o=r},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=t(e);return e[2]?"@media ".concat(e[2]," {").concat(i,"}"):i})).join("")},e.i=function(t,i,n){"string"==typeof t&&(t=[[null,t,""]]);var r={};if(n)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(r[s]=!0)}for(var a=0;a<t.length;a++){var l=[].concat(t[a]);n&&r[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),e.push(l))}},e}},251:(t,e,i)=>{var n=i(2215),r=i(2584),o=i(609),s=i(8420),a=i(2847),l=i(8923),u=Date.prototype.getTime;function h(t,e,i){var f=i||{};return!!(f.strict?o(t,e):t===e)||(!t||!e||"object"!=typeof t&&"object"!=typeof e?f.strict?o(t,e):t==e:function(t,e,i){var o,f;if(typeof t!=typeof e)return!1;if(c(t)||c(e))return!1;if(t.prototype!==e.prototype)return!1;if(r(t)!==r(e))return!1;var p=s(t),g=s(e);if(p!==g)return!1;if(p||g)return t.source===e.source&&a(t)===a(e);if(l(t)&&l(e))return u.call(t)===u.call(e);var m=d(t),v=d(e);if(m!==v)return!1;if(m||v){if(t.length!==e.length)return!1;for(o=0;o<t.length;o++)if(t[o]!==e[o])return!1;return!0}if(typeof t!=typeof e)return!1;try{var y=n(t),_=n(e)}catch(t){return!1}if(y.length!==_.length)return!1;for(y.sort(),_.sort(),o=y.length-1;o>=0;o--)if(y[o]!=_[o])return!1;for(o=y.length-1;o>=0;o--)if(!h(t[f=y[o]],e[f],i))return!1;return!0}(t,e,f))}function c(t){return null==t}function d(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}t.exports=h},4289:(t,e,i)=>{"use strict";var n=i(2215),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,l=a&&function(){var t={};try{for(var e in a(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),u=function(t,e,i,n){var r;(!(e in t)||"function"==typeof(r=n)&&"[object Function]"===o.call(r)&&n())&&(l?a(t,e,{configurable:!0,enumerable:!1,value:i,writable:!0}):t[e]=i)},h=function(t,e){var i=arguments.length>2?arguments[2]:{},o=n(e);r&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)u(t,o[a],e[o[a]],i[o[a]])};h.supportsDescriptors=!!l,t.exports=h},7648:t=>{"use strict";var e="Function.prototype.bind called on incompatible ",i=Array.prototype.slice,n=Object.prototype.toString,r="[object Function]";t.exports=function(t){var o=this;if("function"!=typeof o||n.call(o)!==r)throw new TypeError(e+o);for(var s,a=i.call(arguments,1),l=function(){if(this instanceof s){var e=o.apply(this,a.concat(i.call(arguments)));return Object(e)===e?e:this}return o.apply(t,a.concat(i.call(arguments)))},u=Math.max(0,o.length-a.length),h=[],c=0;c<u;c++)h.push("$"+c);if(s=Function("binder","return function ("+h.join(",")+"){ return binder.apply(this,arguments); }")(l),o.prototype){var d=function(){};d.prototype=o.prototype,s.prototype=new d,d.prototype=null}return s}},8612:(t,e,i)=>{"use strict";var n=i(7648);t.exports=Function.prototype.bind||n},9657:(t,e,i)=>{var n=i(251),r=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:a};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function s(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function a(t,e){return n(t,e,{strict:!0})}r.prototype.compare=function(t,e){if(t.type!==e.type||!s(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var i=this,n=o(t),r=o(e);return n.every((function(t){return this.some((function(e){return i.compare(t,e)}))}),r)}}return!1},r.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i].toFixed(this.precision)!==e[i].toFixed(this.precision))return!1;return!0},r.prototype.compareLine=function(t,e,i,n){if(!s(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!n||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var a=this.compareCoord(r[i],o[i]);return this.direction||a?this.comparePath(r,o):!!this.compareCoord(r[i],o[o.length-(1+i)])&&this.comparePath(r.slice().reverse(),o)}},r.prototype.fixStartIndex=function(t,e){for(var i,n=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){n=r;break}return n>=0&&(i=[].concat(t.slice(n,t.length),t.slice(1,n+1))),i},r.prototype.comparePath=function(t,e){var i=this;return t.every((function(t,e){return i.compareCoord(t,this[e])}),e)},r.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var i=t.coordinates.slice(1,t.coordinates.length),n=e.coordinates.slice(1,e.coordinates.length),r=this;return i.every((function(t){return this.some((function(e){return r.compareLine(t,e,1,!0)}))}),n)}return!1},r.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},r.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},r.prototype.removePseudo=function(t){return t},t.exports=r},1787:(t,e,i)=>{var n=i(5510),r=i(4102),o=i(1540),s=i(9705).Z,a=o.featureEach,l=(o.coordEach,r.polygon,r.featureCollection);function u(t){var e=n(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),n.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),n.prototype.remove.call(this,t,e)},e.clear=function(){return n.prototype.clear.call(this)},e.search=function(t){var e=n.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=n.prototype.all.call(this);return l(t)},e.toJSON=function(){return n.prototype.toJSON.call(this)},e.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},210:(t,e,i)=>{"use strict";var n,r=SyntaxError,o=Function,s=TypeError,a=function(t){try{return o('"use strict"; return ('+t+").constructor;")()}catch(t){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(t){l=null}var u=function(){throw new s},h=l?function(){try{return u}catch(t){try{return l(arguments,"callee").get}catch(t){return u}}}():u,c=i(1405)(),d=Object.getPrototypeOf||function(t){return t.__proto__},f={},p="undefined"==typeof Uint8Array?n:d(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":c?d([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c?d(d([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&c?d((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&c?d((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c?d(""[Symbol.iterator]()):n,"%Symbol%":c?Symbol:n,"%SyntaxError%":r,"%ThrowTypeError%":h,"%TypedArray%":p,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},m=function t(e){var i;if("%AsyncFunction%"===e)i=a("async function () {}");else if("%GeneratorFunction%"===e)i=a("function* () {}");else if("%AsyncGeneratorFunction%"===e)i=a("async function* () {}");else if("%AsyncGenerator%"===e){var n=t("%AsyncGeneratorFunction%");n&&(i=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&(i=d(r.prototype))}return g[e]=i,i},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=i(8612),_=i(7642),b=y.call(Function.call,Array.prototype.concat),w=y.call(Function.apply,Array.prototype.splice),x=y.call(Function.call,String.prototype.replace),S=y.call(Function.call,String.prototype.slice),C=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,E=/\\(\\)?/g,T=function(t){var e=S(t,0,1),i=S(t,-1);if("%"===e&&"%"!==i)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==e)throw new r("invalid intrinsic syntax, expected opening `%`");var n=[];return x(t,C,(function(t,e,i,r){n[n.length]=i?x(r,E,"$1"):e||t})),n},I=function(t,e){var i,n=t;if(_(v,n)&&(n="%"+(i=v[n])[0]+"%"),_(g,n)){var o=g[n];if(o===f&&(o=m(n)),void 0===o&&!e)throw new s("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:o}}throw new r("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new s('"allowMissing" argument must be a boolean');var i=T(t),n=i.length>0?i[0]:"",o=I("%"+n+"%",e),a=o.name,u=o.value,h=!1,c=o.alias;c&&(n=c[0],w(i,b([0,1],c)));for(var d=1,f=!0;d<i.length;d+=1){var p=i[d],m=S(p,0,1),v=S(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===v||"'"===v||"`"===v)&&m!==v)throw new r("property names with quotes must have matching quotes");if("constructor"!==p&&f||(h=!0),_(g,a="%"+(n+="."+p)+"%"))u=g[a];else if(null!=u){if(!(p in u)){if(!e)throw new s("base intrinsic for "+t+" exists, but the property is not available.");return}if(l&&d+1>=i.length){var y=l(u,p);u=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[p]}else f=_(u,p),u=u[p];f&&!h&&(g[a]=u)}}return u}},1405:(t,e,i)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,r=i(5419);t.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&r())))}},5419:t=>{"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),i=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},7642:(t,e,i)=>{"use strict";var n=i(8612);t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},2584:(t,e,i)=>{"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,r=i(1924)("Object.prototype.toString"),o=function(t){return!(n&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===r(t)},s=function(t){return!!o(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==r(t)&&"[object Function]"===r(t.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,t.exports=a?o:s},8923:t=>{"use strict";var e=Date.prototype.getDay,i=Object.prototype.toString,n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){return"object"==typeof t&&null!==t&&(n?function(t){try{return e.call(t),!0}catch(t){return!1}}(t):"[object Date]"===i.call(t))}},8420:(t,e,i)=>{"use strict";var n,r,o,s,a=i(1924),l=i(1405)()&&"symbol"==typeof Symbol.toStringTag;if(l){n=a("Object.prototype.hasOwnProperty"),r=a("RegExp.prototype.exec"),o={};var u=function(){throw o};s={toString:u,valueOf:u},"symbol"==typeof Symbol.toPrimitive&&(s[Symbol.toPrimitive]=u)}var h=a("Object.prototype.toString"),c=Object.getOwnPropertyDescriptor;t.exports=l?function(t){if(!t||"object"!=typeof t)return!1;var e=c(t,"lastIndex");if(!(e&&n(e,"value")))return!1;try{r(t,s)}catch(t){return t===o}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===h(t)}},6252:(t,e,i)=>{t=i.nmd(t);var n,r=((n={}).floodFill=function(t,e,i,n,r,o){return o?function(t,e,i,n,r){var o,s,a,l,u,h,c,d,f,p,g=t.data,m=t.width,v=t.height,y=t.bytes,_=-1,b=m+1,w=-1,x=v+1,S=i*m+e,C=new Uint8Array(m*v),E=new Uint8Array(r||m*v);if(1===E[S])return null;var T=[g[S*=y],g[S+1],g[S+2],g[S+3]],I=[{y:i,left:e-1,right:e+1,dir:1}];do{for(p=!1,s=(l=I.shift()).left+1;s<l.right;s++)if(S=((c=l.y*m)+s)*y,1!==E[c+s]&&(p=!0,C[c+s]=1,E[c+s]=1,!((o=g[S]-T[0])>n||o<-n||(o=g[S+1]-T[1])>n||o<-n||(o=g[S+2]-T[2])>n||o<-n))){for(h=s-1;h>-1&&(S=(d=c+h)*y,1!==E[d])&&(C[d]=1,E[d]=1,h--,!((o=g[S]-T[0])>n||o<-n))&&!((o=g[S+1]-T[1])>n||o<-n)&&!((o=g[S+2]-T[2])>n||o<-n););for(u=s+1;u<m&&(S=(f=c+u)*y,1!==E[f])&&(C[f]=1,E[f]=1,u++,!((o=g[S]-T[0])>n||o<-n))&&!((o=g[S+1]-T[1])>n||o<-n)&&!((o=g[S+2]-T[2])>n||o<-n););h<b&&(b=h+1),u>_&&(_=u-1),(a=l.y-l.dir)>=0&&a<v&&(h<l.left&&I.push({y:a,left:h,right:l.left,dir:-l.dir}),l.right<u&&I.push({y:a,left:l.right,right:u,dir:-l.dir})),(a=l.y+l.dir)>=0&&a<v&&h<u&&I.push({y:a,left:h,right:u,dir:l.dir})}p&&(l.y<x&&(x=l.y),l.y>w&&(w=l.y))}while(I.length>0);return{data:C,width:t.width,height:t.height,bounds:{minX:b,minY:x,maxX:_,maxY:w}}}(t,e,i,n,r):function(t,e,i,n,r){var o,s,a,l,u,h,c,d,f,p,g=t.data,m=t.width,v=t.height,y=t.bytes,_=-1,b=m+1,w=-1,x=v+1,S=i*m+e,C=new Uint8Array(m*v),E=new Uint8Array(r||m*v);if(1===E[S])return null;var T=[g[S*=y],g[S+1],g[S+2],g[S+3]],I=[{y:i,left:e-1,right:e+1,dir:1}];do{for(p=!1,s=(l=I.shift()).left+1;s<l.right;s++)if(S=((c=l.y*m)+s)*y,1!==E[c+s]&&!((o=g[S]-T[0])>n||o<-n||(o=g[S+1]-T[1])>n||o<-n||(o=g[S+2]-T[2])>n||o<-n)){for(p=!0,C[c+s]=1,E[c+s]=1,h=s-1;h>-1&&(S=(d=c+h)*y,1!==E[d])&&!((o=g[S]-T[0])>n||o<-n)&&!((o=g[S+1]-T[1])>n||o<-n)&&!((o=g[S+2]-T[2])>n||o<-n);)C[d]=1,E[d]=1,h--;for(u=s+1;u<m&&(S=(f=c+u)*y,1!==E[f])&&!((o=g[S]-T[0])>n||o<-n)&&!((o=g[S+1]-T[1])>n||o<-n)&&!((o=g[S+2]-T[2])>n||o<-n);)C[f]=1,E[f]=1,u++;h<b&&(b=h+1),u>_&&(_=u-1),(a=l.y-l.dir)>=0&&a<v&&(h<l.left&&I.push({y:a,left:h,right:l.left,dir:-l.dir}),l.right<u&&I.push({y:a,left:l.right,right:u,dir:-l.dir})),(a=l.y+l.dir)>=0&&a<v&&h<u&&I.push({y:a,left:h,right:u,dir:l.dir})}p&&(l.y<x&&(x=l.y),l.y>w&&(w=l.y))}while(I.length>0);return{data:C,width:t.width,height:t.height,bounds:{minX:b,minY:x,maxX:_,maxY:w}}}(t,e,i,n,r)},n.gaussBlur=function(t,e){var i,n,r,o,s,a,l,u=2*e+1,h=e*e,c=new Float32Array(u),d=0,f=t.width,p=t.height,g=t.data,m=t.bounds.minX,v=t.bounds.maxX,y=t.bounds.minY,_=t.bounds.maxY;for(i=0;i<e;i++){var b=(e-i)*(e-i),w=Math.exp(-b/(2*h))/(2*Math.PI*h);c[e+i]=c[e-i]=w,d+=2*w}for(i=0;i<u;i++)c[i]/=d;var x=new Uint8Array(f*p),S=e+f,C=e+p;for(s=y;s<_+1;s++)for(o=m;o<v+1;o++){for(a=0,l=S-o<u?S-o:u,r=(n=s*f+o)-e,i=e-o>0?e-o:0;i<l;i++)a+=g[r+i]*c[i];for(l=C-s<u?C-s:u,r=n-e*f,i=e-s>0?e-s:0;i<l;i++)a+=g[r+i*f]*c[i];x[n]=a>.5?1:0}return{data:x,width:f,height:p,bounds:{minX:m,minY:y,maxX:v,maxY:_}}},n.gaussBlurOnlyBorder=function(t,e,i){var n,r,o,s,a,l,u,h,c,d,f=function(t,e,i){var n,r,o,s,a,l,u,h=t.width,c=t.height,d=t.data,f=new Uint8Array(d),p=t.bounds.minX,g=t.bounds.maxX,m=t.bounds.minY,v=t.bounds.maxY,y=h*c,_=new Uint8Array(y),b=[],w=Math.max(p,1),x=Math.min(g,h-2),S=Math.max(m,1),C=Math.min(v,c-2);if(i&&i.length>0)for(a=0;a<y;a++)1===i[a]&&(f[a]=1);for(s=S;s<C+1;s++)for(n=w;n<x+1;n++)0!==d[a=s*h+n]&&(l=a+h,u=a-h,0!==f[a+1]&&0!==f[a-1]&&0!==f[l]&&0!==f[l+1]&&0!==f[l-1]&&0!==f[u]&&0!==f[u+1]&&0!==f[u-1]||b.push(a));if(0==p)for(s=m;s<v+1;s++)1===d[s*h]&&b.push(s*h);if(g==h-1)for(s=m;s<v+1;s++)1===d[s*h+g]&&b.push(s*h+g);if(0==m)for(n=p;n<g+1;n++)1===d[n]&&b.push(n);if(v==c-1)for(n=p;n<g+1;n++)1===d[v*h+n]&&b.push(v*h+n);var E,T=[],I=e+h,A=e+c,k=2*e+1;for(y=b.length,o=0;o<y;o++){for(_[a=b[o]]=1,T.push(a),s=(a-(n=a%h))/h,E=I-n<k?I-n:k,l=a-e,r=e-n>0?e-n:0;r<E;r++)0===_[u=l+r]&&(_[u]=1,T.push(u));for(E=A-s<k?A-s:k,l=a-e*h,r=e-s>0?e-s:0;r<E;r++)0===_[u=l+r*h]&&(_[u]=1,T.push(u))}return T}(t,e,i),p=2*e+1,g=2*e*e,m=new Float32Array(p),v=0,y=t.width,_=t.height,b=t.data,w=t.bounds.minX,x=t.bounds.maxX,S=t.bounds.minY,C=t.bounds.maxY,E=f.length;for(o=0;o<e;o++)r=(e-o)*(e-o),n=Math.exp(-r/g)/Math.PI,m[e+o]=m[e-o]=n,v+=2*n;for(o=0;o<p;o++)m[o]/=v;var T=new Uint8Array(b),I=e+y,A=e+_;for(o=0;o<E;o++){for(c=0,h=((a=f[o])-(u=a%y))/y,d=I-u<p?I-u:p,l=a-e,s=e-u>0?e-u:0;s<d;s++)c+=b[l+s]*m[s];if(c>.5)T[a]=1,u<w&&(w=u),u>x&&(x=u),h<S&&(S=h),h>C&&(C=h);else{for(d=A-h<p?A-h:p,l=a-e*y,s=e-h>0?e-h:0;s<d;s++)c+=b[l+s*y]*m[s];c>.5?(T[a]=1,u<w&&(w=u),u>x&&(x=u),h<S&&(S=h),h>C&&(C=h)):T[a]=0}}return{data:T,width:y,height:_,bounds:{minX:w,minY:S,maxX:x,maxY:C}}},n.createBorderMask=function(t){var e,i,n,r,o,s=t.width,a=t.height,l=t.data,u=t.bounds.minX,h=t.bounds.maxX,c=t.bounds.minY,d=t.bounds.maxY,f=h-u+1,p=d-c+1,g=new Uint8Array(f*p),m=Math.max(u,1),v=Math.min(h,s-2),y=Math.max(c,1),_=Math.min(d,a-2);for(i=y;i<_+1;i++)for(e=m;e<v+1;e++)0!==l[n=i*s+e]&&(r=n+s,o=n-s,0!==l[n+1]&&0!==l[n-1]&&0!==l[r]&&0!==l[r+1]&&0!==l[r-1]&&0!==l[o]&&0!==l[o+1]&&0!==l[o-1]||(g[(i-c)*f+(e-u)]=1));if(0==u)for(i=c;i<d+1;i++)1===l[i*s]&&(g[(i-c)*f]=1);if(h==s-1)for(i=c;i<d+1;i++)1===l[i*s+h]&&(g[(i-c)*f+(h-u)]=1);if(0==c)for(e=u;e<h+1;e++)1===l[e]&&(g[e-u]=1);if(d==a-1)for(e=u;e<h+1;e++)1===l[d*s+e]&&(g[(d-c)*f+(e-u)]=1);return{data:g,width:f,height:p,offset:{x:u,y:c}}},n.getBorderIndices=function(t){var e,i,n,r,o,s=t.width,a=t.height,l=t.data,u=[],h=s-1,c=a-1;for(i=1;i<c;i++)for(e=1;e<h;e++)0!==l[n=i*s+e]&&(r=n+s,o=n-s,0!==l[n+1]&&0!==l[n-1]&&0!==l[r]&&0!==l[r+1]&&0!==l[r-1]&&0!==l[o]&&0!==l[o+1]&&0!==l[o-1]||u.push(n));for(i=0;i<a;i++)1===l[i*s]&&u.push(i*s);for(e=0;e<s;e++)1===l[e]&&u.push(e);for(n=s-1,i=0;i<a;i++)1===l[i*s+n]&&u.push(i*s+n);for(n=(a-1)*s,e=0;e<s;e++)1===l[n+e]&&u.push(n+e);return u},n.traceContours=function(t){var e,i,n,r,o,s,a,l,u,h,c,d,f,p,g,m=function(t){var e,i,n=t.width,r=t.data,o=t.bounds.minX,s=t.bounds.maxX,a=t.bounds.minY,l=t.bounds.maxY,u=s-o+3,h=l-a+3,c=new Uint8Array(u*h);for(i=a;i<l+1;i++)for(e=o;e<s+1;e++)1===r[i*n+e]&&(c[(i-a+1)*u+(e-o+1)]=1);return{data:c,width:u,height:h,offset:{x:o-1,y:a-1}}}(t),v=[],y=0,_=m.width,b=2*_,w=m.height,x=m.data,S=m.offset.x,C=m.offset.y,E=new Uint8Array(x),T=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];for(r=1;r<w-1;r++)for(n=1;n<_-1;n++)if(1===x[o=r*_+n])for(e=-_;e<b;e+=b)if(0===x[o+e]&&0===E[o+e]){for(y++,a=[],u=(l=e===_)?2:6,d=f=h={x:n,y:r},c=null;;){for(E[d.y*_+d.x]=y,i=0;i<8;i++){if(g=T[u=(u+1)%8],1===x[s=(p={x:d.x+g[0],y:d.y+g[1]}).y*_+p.x]){E[s]=y;break}E[s]=-1,p=null}if(null===p)break;if(d=p,c){if(f.x===h.x&&f.y===h.y&&d.x===c.x&&d.y===c.y)break}else c=p;a.push({x:f.x+S,y:f.y+C}),f=d,u=(u+4)%8}null!=p&&(a.push({x:h.x+S,y:h.y+C}),v.push({inner:l,label:y,points:a}))}return v},n.simplifyContours=function(t,e,i){var n,r,o,s,a,l,u,h,c,d,f,p,g,m,v,y,_,b,w,x,S,C=t.length,E=[];for(r=0;r<C;r++)if(a=(s=t[r]).points,(l=s.points.length)<i){for(u=[],o=0;o<l;o++)u.push({x:a[o].x,y:a[o].y});E.push({inner:s.inner,label:s.label,points:u,initialCount:l})}else{h=[0,l-1],c=[{first:0,last:l-1}];do{if(!((d=c.shift()).last<=d.first+1)){for(f=-1,p=d.first,n=d.first+1;n<d.last;n++)w=a[n],x=a[d.first],S=a[d.last],_=w.x-x.x,b=w.y-x.y,m=Math.sqrt(_*_+b*b),_=w.x-S.x,b=w.y-S.y,v=Math.sqrt(_*_+b*b),_=x.x-S.x,b=x.y-S.y,y=Math.sqrt(_*_+b*b),(g=m>=Math.sqrt(v*v+y*y)?v:v>=Math.sqrt(m*m+y*y)?m:Math.abs((b*w.x-_*w.y+x.x*S.y-S.x*x.y)/y))>f&&(p=n,f=g);f>e&&(h.push(p),c.push({first:d.first,last:p}),c.push({first:p,last:d.last}))}}while(c.length>0);for(u=[],l=h.length,h.sort((function(t,e){return t-e})),o=0;o<l;o++)u.push({x:a[h[o]].x,y:a[h[o]].y});E.push({inner:s.inner,label:s.label,points:u,initialCount:s.points.length})}return E},n);null!==t&&(t.exports=r),"undefined"!=typeof window&&null!==window&&(window.MagicWand=r)},9209:function(t,e){!function(t){"use strict";function e(t,e){return t>e?1:t<e?-1:0}var i=function(t,i){void 0===t&&(t=e),void 0===i&&(i=!1),this._compare=t,this._root=null,this._size=0,this._noDuplicates=!!i},n={size:{configurable:!0}};function r(t,e,i,n,o){var s=o-n;if(s>0){var a=n+Math.floor(s/2),l={key:e[a],data:i[a],parent:t};return l.left=r(l,e,i,n,a),l.right=r(l,e,i,a+1,o),l}return null}function o(t,e,i,n,r){if(!(i>=n)){for(var s=t[i+n>>1],a=i-1,l=n+1;;){do{a++}while(r(t[a],s)<0);do{l--}while(r(t[l],s)>0);if(a>=l)break;var u=t[a];t[a]=t[l],t[l]=u,u=e[a],e[a]=e[l],e[l]=u}o(t,e,i,l,r),o(t,e,l+1,n,r)}}i.prototype.rotateLeft=function(t){var e=t.right;e&&(t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.left=t),t.parent=e},i.prototype.rotateRight=function(t){var e=t.left;e&&(t.left=e.right,e.right&&(e.right.parent=t),e.parent=t.parent),t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.right=t),t.parent=e},i.prototype._splay=function(t){for(;t.parent;){var e=t.parent;e.parent?e.left===t&&e.parent.left===e?(this.rotateRight(e.parent),this.rotateRight(e)):e.right===t&&e.parent.right===e?(this.rotateLeft(e.parent),this.rotateLeft(e)):e.left===t&&e.parent.right===e?(this.rotateRight(e),this.rotateLeft(e)):(this.rotateLeft(e),this.rotateRight(e)):e.left===t?this.rotateRight(e):this.rotateLeft(e)}},i.prototype.splay=function(t){for(var e,i,n,r,o;t.parent;)(i=(e=t.parent).parent)&&i.parent?((n=i.parent).left===i?n.left=t:n.right=t,t.parent=n):(t.parent=null,this._root=t),r=t.left,o=t.right,t===e.left?(i&&(i.left===e?(e.right?(i.left=e.right,i.left.parent=i):i.left=null,e.right=i,i.parent=e):(r?(i.right=r,r.parent=i):i.right=null,t.left=i,i.parent=t)),o?(e.left=o,o.parent=e):e.left=null,t.right=e,e.parent=t):(i&&(i.right===e?(e.left?(i.right=e.left,i.right.parent=i):i.right=null,e.left=i,i.parent=e):(o?(i.left=o,o.parent=i):i.left=null,t.right=i,i.parent=t)),r?(e.right=r,r.parent=e):e.right=null,t.left=e,e.parent=t)},i.prototype.replace=function(t,e){t.parent?t===t.parent.left?t.parent.left=e:t.parent.right=e:this._root=e,e&&(e.parent=t.parent)},i.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},i.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},i.prototype.insert=function(t,e){var i=this._root,n=null,r=this._compare;if(this._noDuplicates)for(;i;){if(n=i,0===r(i.key,t))return;i=r(i.key,t)<0?i.right:i.left}else for(;i;)n=i,i=r(i.key,t)<0?i.right:i.left;return i={key:t,data:e,left:null,right:null,parent:n},n?r(n.key,i.key)<0?n.right=i:n.left=i:this._root=i,this.splay(i),this._size++,i},i.prototype.find=function(t){for(var e=this._root,i=this._compare;e;){var n=i(e.key,t);if(n<0)e=e.right;else{if(!(n>0))return e;e=e.left}}return null},i.prototype.contains=function(t){for(var e=this._root,i=this._compare;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},i.prototype.remove=function(t){var e=this.find(t);if(!e)return!1;if(this.splay(e),e.left)if(e.right){var i=this.minNode(e.right);i.parent!==e&&(this.replace(i,i.right),i.right=e.right,i.right.parent=i),this.replace(e,i),i.left=e.left,i.left.parent=i}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0},i.prototype.removeNode=function(t){if(!t)return!1;if(this.splay(t),t.left)if(t.right){var e=this.minNode(t.right);e.parent!==t&&(this.replace(e,e.right),e.right=t.right,e.right.parent=e),this.replace(t,e),e.left=t.left,e.left.parent=e}else this.replace(t,t.left);else this.replace(t,t.right);return this._size--,!0},i.prototype.erase=function(t){var e=this.find(t);if(e){this.splay(e);var i=e.left,n=e.right,r=null;i&&(i.parent=null,r=this.maxNode(i),this.splay(r),this._root=r),n&&(i?r.right=n:this._root=n,n.parent=r),this._size--}},i.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},i.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)t=e,e=e.parent;return e},i.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)t=e,e=e.parent;return e},i.prototype.forEach=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)e?(i.push(e),e=e.left):i.length>0?(t(e=i.pop(),r++),e=e.right):n=!0;return this},i.prototype.range=function(t,e,i,n){for(var r=[],o=this._compare,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},i.prototype.keys=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.key),t=t.right):n=!0;return i},i.prototype.values=function(){for(var t=this._root,e=[],i=[],n=!1;!n;)t?(e.push(t),t=t.left):e.length>0?(t=e.pop(),i.push(t.data),t=t.right):n=!0;return i},i.prototype.at=function(t){for(var e=this._root,i=[],n=!1,r=0;!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},i.prototype.load=function(t,e,i){if(void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=!1),0!==this._size)throw new Error("bulk-load: tree is not empty");var n=t.length;return i&&o(t,e,0,n-1,this._compare),this._root=r(null,t,e,0,n),this._size=n,this},i.prototype.min=function(){var t=this.minNode(this._root);return t?t.key:null},i.prototype.max=function(){var t=this.maxNode(this._root);return t?t.key:null},i.prototype.isEmpty=function(){return null===this._root},n.size.get=function(){return this._size},i.createTree=function(t,e,n,r,o){return new i(n,o).load(t,e,r)},Object.defineProperties(i.prototype,n);var s=0,a=1,l=2,u=3,h=0,c=1,d=2,f=3;function p(t,e,i){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!g(e,i)||e.isVertical()?e.prevInResult:e));var n=g(t,i);t.resultTransition=n?m(t,i):0}function g(t,e){switch(t.type){case s:switch(e){case h:return!t.otherInOut;case c:return t.otherInOut;case d:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case f:return!0}break;case l:return e===h||e===c;case u:return e===d;case a:return!1}return!1}function m(t,e){var i,n=!t.inOut,r=!t.otherInOut;switch(e){case h:i=n&&r;break;case c:i=n||r;break;case f:i=n^r;break;case d:i=t.isSubject?n&&!r:r&&!n}return i?1:-1}var v=function(t,e,i,n,r){this.left=e,this.point=t,this.otherEvent=i,this.isSubject=n,this.type=r||s,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},y={inResult:{configurable:!0}};function _(t,e){return t[0]===e[0]&&t[1]===e[1]}v.prototype.isBelow=function(t){var e=this.point,i=this.otherEvent.point;return this.left?(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])>0:(i[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(i[1]-t[1])>0},v.prototype.isAbove=function(t){return!this.isBelow(t)},v.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},y.inResult.get=function(){return 0!==this.resultTransition},v.prototype.clone=function(){var t=new v(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.contourId=this.contourId,t.resultTransition=this.resultTransition,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t},Object.defineProperties(v.prototype,y);var b=11102230246251565e-32,w=134217729,x=(3+8*b)*b;function S(t,e,i,n,r){var o,s,a,l,u=e[0],h=n[0],c=0,d=0;h>u==h>-u?(o=u,u=e[++c]):(o=h,h=n[++d]);var f=0;if(c<t&&d<i)for(h>u==h>-u?(a=o-((s=u+o)-u),u=e[++c]):(a=o-((s=h+o)-h),h=n[++d]),o=s,0!==a&&(r[f++]=a);c<t&&d<i;)h>u==h>-u?(a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c]):(a=o-((s=o+h)-(l=s-o))+(h-l),h=n[++d]),o=s,0!==a&&(r[f++]=a);for(;c<t;)a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++c],o=s,0!==a&&(r[f++]=a);for(;d<i;)a=o-((s=o+h)-(l=s-o))+(h-l),h=n[++d],o=s,0!==a&&(r[f++]=a);return 0===o&&0!==f||(r[f++]=o),f}function C(t,e){for(var i=e[0],n=1;n<t;n++)i+=e[n];return i}function E(t){return new Float64Array(t)}var T=(3+16*b)*b,I=(2+12*b)*b,A=(9+64*b)*b*b,k=E(4),P=E(8),L=E(12),R=E(16),F=E(4);function M(t,e,i,n,r,o,s){var a,l,u,h,c,d,f,p,g,m,v,y,_,b,E,T,M,O,D=t-r,$=i-r,j=e-o,N=n-o;c=(E=(p=D-(f=(d=w*D)-(d-D)))*(m=N-(g=(d=w*N)-(d-N)))-((b=D*N)-f*g-p*g-f*m))-(v=E-(M=(p=j-(f=(d=w*j)-(d-j)))*(m=$-(g=(d=w*$)-(d-$)))-((T=j*$)-f*g-p*g-f*m))),k[0]=E-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-T),k[1]=_-(v+c)+(c-T),c=(O=y+v)-y,k[2]=y-(O-c)+(v-c),k[3]=O;var B=C(4,k),U=I*s;if(B>=U||-B>=U)return B;if(a=t-(D+(c=t-D))+(c-r),u=i-($+(c=i-$))+(c-r),l=e-(j+(c=e-j))+(c-o),h=n-(N+(c=n-N))+(c-o),0===a&&0===l&&0===u&&0===h)return B;if(U=A*s+x*Math.abs(B),(B+=D*h+N*a-(j*u+$*l))>=U||-B>=U)return B;c=(E=(p=a-(f=(d=w*a)-(d-a)))*(m=N-(g=(d=w*N)-(d-N)))-((b=a*N)-f*g-p*g-f*m))-(v=E-(M=(p=l-(f=(d=w*l)-(d-l)))*(m=$-(g=(d=w*$)-(d-$)))-((T=l*$)-f*g-p*g-f*m))),F[0]=E-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-T),F[1]=_-(v+c)+(c-T),c=(O=y+v)-y,F[2]=y-(O-c)+(v-c),F[3]=O;var G=S(4,k,4,F,P);c=(E=(p=D-(f=(d=w*D)-(d-D)))*(m=h-(g=(d=w*h)-(d-h)))-((b=D*h)-f*g-p*g-f*m))-(v=E-(M=(p=j-(f=(d=w*j)-(d-j)))*(m=u-(g=(d=w*u)-(d-u)))-((T=j*u)-f*g-p*g-f*m))),F[0]=E-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-T),F[1]=_-(v+c)+(c-T),c=(O=y+v)-y,F[2]=y-(O-c)+(v-c),F[3]=O;var V=S(G,P,4,F,L);c=(E=(p=a-(f=(d=w*a)-(d-a)))*(m=h-(g=(d=w*h)-(d-h)))-((b=a*h)-f*g-p*g-f*m))-(v=E-(M=(p=l-(f=(d=w*l)-(d-l)))*(m=u-(g=(d=w*u)-(d-u)))-((T=l*u)-f*g-p*g-f*m))),F[0]=E-(v+c)+(c-M),c=(_=b-((y=b+v)-(c=y-b))+(v-c))-(v=_-T),F[1]=_-(v+c)+(c-T),c=(O=y+v)-y,F[2]=y-(O-c)+(v-c),F[3]=O;var z=S(V,L,4,F,R);return R[z-1]}function O(t,e,i,n,r,o){var s=(e-o)*(i-r),a=(t-r)*(n-o),l=s-a;if(0===s||0===a||s>0!=a>0)return l;var u=Math.abs(s+a);return Math.abs(l)>=T*u?l:-M(t,e,i,n,r,o,u)}function D(t,e,i){var n=O(t[0],t[1],e[0],e[1],i[0],i[1]);return n>0?-1:n<0?1:0}function $(t,e){var i=t.point,n=e.point;return i[0]>n[0]?1:i[0]<n[0]?-1:i[1]!==n[1]?i[1]>n[1]?1:-1:j(t,e,i)}function j(t,e,i,n){return t.left!==e.left?t.left?1:-1:0!==D(i,t.otherEvent.point,e.otherEvent.point)?t.isBelow(e.otherEvent.point)?-1:1:!t.isSubject&&e.isSubject?1:-1}function N(t,e,i){var n=new v(e,!1,t,t.isSubject),r=new v(e,!0,t.otherEvent,t.isSubject);return _(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),n.contourId=r.contourId=t.contourId,$(r,t.otherEvent)>0&&(t.otherEvent.left=!0,r.left=!1),t.otherEvent.otherEvent=r,t.otherEvent=n,i.push(r),i.push(n),i}function B(t,e){return t[0]*e[1]-t[1]*e[0]}function U(t,e){return t[0]*e[0]+t[1]*e[1]}function G(t,e,i,n,r){var o=[e[0]-t[0],e[1]-t[1]],s=[n[0]-i[0],n[1]-i[1]];function a(t,e,i){return[t[0]+e*i[0],t[1]+e*i[1]]}var l=[i[0]-t[0],i[1]-t[1]],u=B(o,s),h=u*u,c=U(o,o);if(h>0){var d=B(l,s)/u;if(d<0||d>1)return null;var f=B(l,o)/u;return f<0||f>1?null:0===d||1===d?r?null:[a(t,d,o)]:0===f||1===f?r?null:[a(i,f,s)]:[a(t,d,o)]}if((h=(u=B(l,o))*u)>0)return null;var p=U(o,l)/c,g=p+U(o,s)/c,m=Math.min(p,g),v=Math.max(p,g);return m<=1&&v>=0?1===m?r?null:[a(t,m>0?m:0,o)]:0===v?r?null:[a(t,v<1?v:1,o)]:r&&0===m&&1===v?null:[a(t,m>0?m:0,o),a(t,v<1?v:1,o)]:null}function V(t,e,i){var n=G(t.point,t.otherEvent.point,e.point,e.otherEvent.point),r=n?n.length:0;if(0===r)return 0;if(1===r&&(_(t.point,e.point)||_(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===r&&t.isSubject===e.isSubject)return 0;if(1===r)return _(t.point,n[0])||_(t.otherEvent.point,n[0])||N(t,n[0],i),_(e.point,n[0])||_(e.otherEvent.point,n[0])||N(e,n[0],i),1;var o=[],s=!1,h=!1;return _(t.point,e.point)?s=!0:1===$(t,e)?o.push(e,t):o.push(t,e),_(t.otherEvent.point,e.otherEvent.point)?h=!0:1===$(t.otherEvent,e.otherEvent)?o.push(e.otherEvent,t.otherEvent):o.push(t.otherEvent,e.otherEvent),s&&h||s?(e.type=a,t.type=e.inOut===t.inOut?l:u,s&&!h&&N(o[1].otherEvent,o[0].point,i),2):h?(N(o[0],o[1].point,i),3):o[0]!==o[3].otherEvent?(N(o[0],o[1].point,i),N(o[1],o[2].point,i),3):(N(o[0],o[1].point,i),N(o[3].otherEvent,o[2].point,i),3)}function z(t,e){if(t===e)return 0;if(0!==D(t.point,t.otherEvent.point,e.point)||0!==D(t.point,t.otherEvent.point,e.otherEvent.point))return _(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===$(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;var i=t.point,n=e.point;return i[0]===n[0]&&i[1]===n[1]?(i=t.otherEvent.point,n=e.otherEvent.point,i[0]===n[0]&&i[1]===n[1]?0:t.contourId>e.contourId?1:-1):1===$(t,e)?1:-1}function q(t,e,n,r,o,s){for(var a,l,u,c=new i(z),f=[],g=Math.min(r[2],o[2]);0!==t.length;){var m=t.pop();if(f.push(m),s===h&&m.point[0]>g||s===d&&m.point[0]>r[2])break;if(m.left){l=a=c.insert(m),a=a!==(u=c.minNode())?c.prev(a):null,l=c.next(l);var v=a?a.key:null;if(p(m,v,s),l&&2===V(m,l.key,t)&&(p(m,v,s),p(m,l.key,s)),a&&2===V(a.key,m,t)){var y=a;p(v,(y=y!==u?c.prev(y):null)?y.key:null,s),p(m,v,s)}}else m=m.otherEvent,l=a=c.find(m),a&&l&&(a=a!==u?c.prev(a):null,l=c.next(l),c.remove(m),l&&a&&V(a.key,l.key,t))}return f}var W=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function K(t){var e,i,n,r,o=[];for(i=0,n=t.length;i<n;i++)((e=t[i]).left&&e.inResult||!e.left&&e.otherEvent.inResult)&&o.push(e);for(var s=!1;!s;)for(s=!0,i=0,n=o.length;i<n;i++)i+1<n&&1===$(o[i],o[i+1])&&(r=o[i],o[i]=o[i+1],o[i+1]=r,s=!1);for(i=0,n=o.length;i<n;i++)(e=o[i]).otherPos=i;for(i=0,n=o.length;i<n;i++)(e=o[i]).left||(r=e.otherPos,e.otherPos=e.otherEvent.otherPos,e.otherEvent.otherPos=r);return o}function X(t,e,i,n){var r,o=t+1,s=e[t].point,a=e.length;for(o<a&&(r=e[o].point);o<a&&r[0]===s[0]&&r[1]===s[1];){if(!i[o])return o;r=e[++o].point}for(o=t-1;i[o]&&o>n;)o--;return o}function Y(t,e,i){var n=new W;if(null!=t.prevInResult){var r=t.prevInResult,o=r.outputContourId;if(r.resultTransition>0){var s=e[o];if(null!=s.holeOf){var a=s.holeOf;e[a].holeIds.push(i),n.holeOf=a,n.depth=e[o].depth}else e[o].holeIds.push(i),n.holeOf=o,n.depth=e[o].depth+1}else n.holeOf=null,n.depth=e[o].depth}else n.holeOf=null,n.depth=0;return n}function H(t){var e,i,n=K(t),r={},o=[],s=function(){if(!r[e]){var t=o.length,i=Y(n[e],o,t),s=function(e){r[e]=!0,n[e].outputContourId=t},a=e,l=e,u=n[e].point;for(i.points.push(u);s(a),s(a=n[a].otherPos),i.points.push(n[a].point),(a=X(a,n,r,l))!=l;);o.push(i)}};for(e=0,i=n.length;e<i;e++)s();return o}W.prototype.isExterior=function(){return null==this.holeOf};var Z=Q,J=Q;function Q(t,e){if(!(this instanceof Q))return new Q(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||tt,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}function tt(t,e){return t<e?-1:t>e?1:0}Q.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,i=this.compare,n=e[t];t>0;){var r=t-1>>1,o=e[r];if(i(n,o)>=0)break;e[t]=o,t=r}e[t]=n},_down:function(t){for(var e=this.data,i=this.compare,n=this.length>>1,r=e[t];t<n;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&i(e[s],a)<0&&(o=s,a=e[s]),i(a,r)>=0)break;e[t]=a,t=o}e[t]=r}},Z.default=J;var et=Math.max,it=Math.min,nt=0;function rt(t,e,i,n,r,o){var s,a,l,u,h,c;for(s=0,a=t.length-1;s<a;s++)if(l=t[s],u=t[s+1],h=new v(l,!1,void 0,e),c=new v(u,!1,h,e),h.otherEvent=c,l[0]!==u[0]||l[1]!==u[1]){h.contourId=c.contourId=i,o||(h.isExteriorRing=!1,c.isExteriorRing=!1),$(h,c)>0?c.left=!0:h.left=!0;var d=l[0],f=l[1];r[0]=it(r[0],d),r[1]=it(r[1],f),r[2]=et(r[2],d),r[3]=et(r[3],f),n.push(h),n.push(c)}}function ot(t,e,i,n,r){var o,s,a,l,u,h,c=new Z(null,$);for(a=0,l=t.length;a<l;a++)for(u=0,h=(o=t[a]).length;u<h;u++)(s=0===u)&&nt++,rt(o[u],!0,nt,c,i,s);for(a=0,l=e.length;a<l;a++)for(u=0,h=(o=e[a]).length;u<h;u++)s=0===u,r===d&&(s=!1),s&&nt++,rt(o[u],!1,nt,c,n,s);return c}var st=[];function at(t,e,i){var n=null;return t.length*e.length==0&&(i===h?n=st:i===d?n=t:i!==c&&i!==f||(n=0===t.length?e:t)),n}function lt(t,e,i,n,r){var o=null;return(i[0]>n[2]||n[0]>i[2]||i[1]>n[3]||n[1]>i[3])&&(r===h?o=st:r===d?o=t:r!==c&&r!==f||(o=t.concat(e))),o}function ut(t,e,i){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);var n=at(t,e,i);if(n)return n===st?null:n;var r=[1/0,1/0,-1/0,-1/0],o=[1/0,1/0,-1/0,-1/0],s=ot(t,e,r,o,i);if(n=lt(t,e,r,o,i))return n===st?null:n;for(var a=H(q(s,t,e,r,o,i)),l=[],u=0;u<a.length;u++){var h=a[u];if(h.isExterior()){for(var c=[h.points],d=0;d<h.holeIds.length;d++){var f=h.holeIds[d];c.push(a[f].points)}l.push(c)}}return l}function ht(t,e){return ut(t,e,c)}function ct(t,e){return ut(t,e,d)}function dt(t,e){return ut(t,e,f)}function ft(t,e){return ut(t,e,h)}var pt={UNION:c,DIFFERENCE:d,INTERSECTION:h,XOR:f};t.diff=ct,t.intersection=ft,t.operations=pt,t.union=ht,t.xor=dt,Object.defineProperty(t,"__esModule",{value:!0})}(e)},5798:()=>{},4244:t=>{"use strict";var e=function(t){return t!=t};t.exports=function(t,i){return 0===t&&0===i?1/t==1/i:t===i||!(!e(t)||!e(i))}},609:(t,e,i)=>{"use strict";var n=i(4289),r=i(5559),o=i(4244),s=i(5624),a=i(2281),l=r(s(),Object);n(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},5624:(t,e,i)=>{"use strict";var n=i(4244);t.exports=function(){return"function"==typeof Object.is?Object.is:n}},2281:(t,e,i)=>{"use strict";var n=i(5624),r=i(4289);t.exports=function(){var t=n();return r(Object,{is:t},{is:function(){return Object.is!==t}}),t}},8987:(t,e,i)=>{"use strict";var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=i(1414),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(t){var e=t.constructor;return e&&e.prototype===t},d={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!d["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{c(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();n=function(t){var e=null!==t&&"object"==typeof t,i="[object Function]"===o.call(t),n=s(t),a=e&&"[object String]"===o.call(t),d=[];if(!e&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var p=u&&i;if(a&&t.length>0&&!r.call(t,0))for(var g=0;g<t.length;++g)d.push(String(g));if(n&&t.length>0)for(var m=0;m<t.length;++m)d.push(String(m));else for(var v in t)p&&"prototype"===v||!r.call(t,v)||d.push(String(v));if(l)for(var y=function(t){if("undefined"==typeof window||!f)return c(t);try{return c(t)}catch(t){return!1}}(t),_=0;_<h.length;++_)y&&"constructor"===h[_]||!r.call(t,h[_])||d.push(h[_]);return d}}t.exports=n},2215:(t,e,i)=>{"use strict";var n=Array.prototype.slice,r=i(1414),o=Object.keys,s=o?function(t){return o(t)}:i(8987),a=Object.keys;s.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return r(t)?a(n.call(t)):a(t)}):Object.keys=s;return Object.keys||s},t.exports=s},1414:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){var i=e.call(t),n="[object Arguments]"===i;return n||(n="[object Array]"!==i&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),n}},2676:function(t,e,i){var n=i(4155);t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}var r=function(){function t(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return t}();function o(t,e){return t>e?1:t<e?-1:0}function s(t,e,i){for(var n=new r(null,null),o=n,s=n;;){var a=i(t,e.key);if(a<0){if(null===e.left)break;if(i(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(i(t,e.right.key)>0&&(l=e.right,e.right=l.left,l.left=e,null===(e=l).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,s.left=e.right,e.left=n.right,e.right=n.left,e}function a(t,e,i,n){var o=new r(t,e);if(null===i)return o.left=o.right=null,o;var a=n(t,(i=s(t,i,n)).key);return a<0?(o.left=i.left,o.right=i,i.left=null):a>=0&&(o.right=i.right,o.left=i,i.right=null),o}function l(t,e,i){var n=null,r=null;if(e){var o=i((e=s(t,e,i)).key,t);0===o?(n=e.left,r=e.right):o<0?(r=e.right,e.right=null,n=e):(n=e.left,e.left=null,r=e)}return{left:n,right:r}}function u(t,e,i){return null===e?t:(null===t||((e=s(t.key,e,i)).left=t),e)}function h(t,e,i,n,r){if(t){n(e+(i?"└── ":"├── ")+r(t)+"\n");var o=e+(i?"    ":"│   ");t.left&&h(t.left,o,!1,n,r),t.right&&h(t.right,o,!0,n,r)}}var c=function(){function t(t){void 0===t&&(t=o),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=a(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var i=new r(t,e);null===this._root&&(i.left=i.right=null,this._size++,this._root=i);var n=this._comparator,o=s(t,this._root,n),a=n(t,o.key);return 0===a?this._root=o:(a<0?(i.left=o.left,i.right=o,o.left=null):a>0&&(i.right=o.right,i.left=o,o.right=null),this._size++,this._root=i),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,i){var n;return null===e?null:0===i(t,(e=s(t,e,i)).key)?(null===e.left?n=e.right:(n=s(t,e.left,i)).right=e.right,this._size--,n):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=s(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=s(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),t.call(e,i),i=i.right):r=!0;return this},t.prototype.range=function(t,e,i,n){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var i=e.key;return t.push(i)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var i=e.data;return t.push(i)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,i=!1,n=0,r=[];!i;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),n===t)return e;n++,e=e.right}else i=!0;return null},t.prototype.next=function(t){var e=this._root,i=null;if(t.right){for(i=t.right;i.left;)i=i.left;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?(i=e,e=e.left):e=e.right}return i},t.prototype.prev=function(t){var e=this._root,i=null;if(null!==t.left){for(i=t.left;i.right;)i=i.right;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?e=e.left:(i=e,e=e.right)}return i},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return p(this._root)},t.prototype.load=function(t,e,i){void 0===e&&(e=[]),void 0===i&&(i=!1);var n=t.length,r=this._comparator;if(i&&v(t,e,0,n-1,r),null===this._root)this._root=d(t,e,0,n),this._size=n;else{var o=m(this.toList(),f(t,e),r);n=this._size+n,this._root=g({head:o},0,n)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return h(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,i){var n=this._comparator,r=l(t,this._root,n),o=r.left,s=r.right;n(t,e)<0?s=a(e,i,s,n):o=a(e,i,o,n),this._root=u(o,s,n)},t.prototype.split=function(t){return l(t,this._root,this._comparator)},t}();function d(t,e,i,n){var o=n-i;if(o>0){var s=i+Math.floor(o/2),a=t[s],l=e[s],u=new r(a,l);return u.left=d(t,e,i,s),u.right=d(t,e,s+1,n),u}return null}function f(t,e){for(var i=new r(null,null),n=i,o=0;o<t.length;o++)n=n.next=new r(t[o],e[o]);return n.next=null,i.next}function p(t){for(var e=t,i=[],n=!1,o=new r(null,null),s=o;!n;)e?(i.push(e),e=e.left):i.length>0?e=(e=s=s.next=i.pop()).right:n=!0;return s.next=null,o.next}function g(t,e,i){var n=i-e;if(n>0){var r=e+Math.floor(n/2),o=g(t,e,r),s=t.head;return s.left=o,t.head=t.head.next,s.right=g(t,r+1,i),s}return null}function m(t,e,i){for(var n=new r(null,null),o=n,s=t,a=e;null!==s&&null!==a;)i(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),n.next}function v(t,e,i,n,r){if(!(i>=n)){for(var o=t[i+n>>1],s=i-1,a=n+1;;){do{s++}while(r(t[s],o)<0);do{a--}while(r(t[a],o)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}v(t,e,i,a,r),v(t,e,a+1,n,r)}}var y=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},_=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var i=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},b=Number.EPSILON;void 0===b&&(b=Math.pow(2,-52));var w=b*b,x=function(t,e){if(-b<t&&t<b&&-b<e&&e<b)return 0;var i=t-e;return i*i<w*t*e?0:t<e?-1:1},S=function(){function e(){t(this,e),this.reset()}return i(e,[{key:"reset",value:function(){this.xRounder=new C,this.yRounder=new C}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),C=function(){function e(){t(this,e),this.tree=new c,this.round(0)}return i(e,[{key:"round",value:function(t){var e=this.tree.add(t),i=this.tree.prev(e);if(null!==i&&0===x(e.key,i.key))return this.tree.remove(t),i.key;var n=this.tree.next(e);return null!==n&&0===x(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),e}(),E=new S,T=function(t,e){return t.x*e.y-t.y*e.x},I=function(t,e){return t.x*e.x+t.y*e.y},A=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y},o=T(n,r);return x(o,0)},k=function(t){return Math.sqrt(I(t,t))},P=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return T(r,n)/k(r)/k(n)},L=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return I(r,n)/k(r)/k(n)},R=function(t,e,i){return 0===e.y?null:{x:t.x+e.x/e.y*(i-t.y),y:i}},F=function(t,e,i){return 0===e.x?null:{x:i,y:t.y+e.y/e.x*(i-t.x)}},M=function(t,e,i,n){if(0===e.x)return F(i,n,t.x);if(0===n.x)return F(t,e,i.x);if(0===e.y)return R(i,n,t.y);if(0===n.y)return R(t,e,i.y);var r=T(e,n);if(0==r)return null;var o={x:i.x-t.x,y:i.y-t.y},s=T(o,e)/r,a=T(o,n)/r;return{x:(t.x+a*e.x+(i.x+s*n.x))/2,y:(t.y+a*e.y+(i.y+s*n.y))/2}},O=function(){function e(i,n){t(this,e),void 0===i.events?i.events=[this]:i.events.push(this),this.point=i,this.isLeft=n}return i(e,null,[{key:"compare",value:function(t,i){var n=e.comparePoints(t.point,i.point);return 0!==n?n:(t.point!==i.point&&t.link(i),t.isLeft!==i.isLeft?t.isLeft?1:-1:$.compare(t.segment,i.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),i(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,i=0,n=e.length;i<n;i++){var r=e[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var i=this.point.events[e];if(void 0===i.segment.consumedBy)for(var n=e+1;n<t;n++){var r=this.point.events[n];void 0===r.consumedBy&&i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,i=this.point.events.length;e<i;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,i=new Map,n=function(n){var r=n.otherSE;i.set(n,{sine:P(e.point,t.point,r.point),cosine:L(e.point,t.point,r.point)})};return function(t,e){i.has(t)||n(t),i.has(e)||n(e);var r=i.get(t),o=r.sine,s=r.cosine,a=i.get(e),l=a.sine,u=a.cosine;return o>=0&&l>=0?s<u?1:s>u?-1:0:o<0&&l<0?s<u?-1:s>u?1:0:l<o?-1:l>o?1:0}}}]),e}(),D=0,$=function(){function e(i,n,r,o){t(this,e),this.id=++D,this.leftSE=i,i.segment=this,i.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=i,this.rings=r,this.windings=o}return i(e,null,[{key:"compare",value:function(t,e){var i=t.leftSE.point.x,n=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o<i)return 1;if(r<n)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(i<n){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var h=t.comparePoint(e.leftSE.point);if(h<0)return 1;if(h>0)return-1;var c=e.comparePoint(t.rightSE.point);return 0!==c?c:-1}if(i>n){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var d=e.comparePoint(t.leftSE.point);if(0!==d)return d;var f=t.comparePoint(e.rightSE.point);return f<0?1:f>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<o){var p=e.comparePoint(t.rightSE.point);if(0!==p)return p}if(r>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(r!==o){var m=l-s,v=r-i,y=u-a,_=o-n;if(m>v&&y<_)return 1;if(m<v&&y>_)return-1}return r>o?1:r<o||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),i(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(e.x===i.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/n.y,o=e.x+r*n.x;if(t.x===o)return 0;var s=(t.x-e.x)/n.x,a=e.y+s*n.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),i=t.bbox(),n=_(e,i);if(null===n)return null;var r=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=y(e,s)&&0===this.comparePoint(s),u=y(i,r)&&0===t.comparePoint(r),h=y(e,a)&&0===this.comparePoint(a),c=y(i,o)&&0===t.comparePoint(o);if(u&&l)return c&&!h?o:!c&&h?a:null;if(u)return h&&r.x===a.x&&r.y===a.y?null:r;if(l)return c&&o.x===s.x&&o.y===s.y?null:s;if(c&&h)return null;if(c)return o;if(h)return a;var d=M(r,this.vector(),s,t.vector());return null===d?null:y(n,d)?E.round(d.x,d.y):null}},{key:"split",value:function(t){var i=[],n=void 0!==t.events,r=new O(t,!0),o=new O(t,!1),s=this.rightSE;this.replaceRightSE(o),i.push(o),i.push(r);var a=new e(r,s,this.rings.slice(),this.windings.slice());return O.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),O.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),o.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,i=this.windings.length;e<i;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var i=this,n=t;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var r=e.compare(i,n);if(0!==r){if(r>0){var o=i;i=n,n=o}if(i.prev===n){var s=i;i=n,n=s}for(var a=0,l=n.rings.length;a<l;a++){var u=n.rings[a],h=n.windings[a],c=i.rings.indexOf(u);-1===c?(i.rings.push(u),i.windings.push(h)):i.windings[c]+=h}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys,r=0,o=this.rings.length;r<o;r++){var s=this.rings[r],a=this.windings[r],l=e.indexOf(s);-1===l?(e.push(s),i.push(a)):i[l]+=a}for(var u=[],h=[],c=0,d=e.length;c<d;c++)if(0!==i[c]){var f=e[c],p=f.poly;if(-1===h.indexOf(p))if(f.isExterior)u.push(p);else{-1===h.indexOf(p)&&h.push(p);var g=u.indexOf(f.poly);-1!==g&&u.splice(g,1)}}for(var m=0,v=u.length;m<v;m++){var y=u[m].multiPoly;-1===n.indexOf(y)&&n.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(K.type){case"union":var i=0===t.length,n=0===e.length;this._isInResult=i!==n;break;case"intersection":var r,o;t.length<e.length?(r=t.length,o=e.length):(r=e.length,o=t.length),this._isInResult=o===K.numMultiPolys&&r<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(K.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,i,n){var r,o,s,a=O.comparePoints(t,i);if(a<0)r=t,o=i,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));r=i,o=t,s=-1}return new e(new O(r,!0),new O(o,!1),[n],[s])}}]),e}(),j=function(){function e(i,n,r){if(t(this,e),!Array.isArray(i)||0===i.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],"number"!=typeof i[0][0]||"number"!=typeof i[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=E.round(i[0][0],i[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,l=i.length;a<l;a++){if("number"!=typeof i[a][0]||"number"!=typeof i[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=E.round(i[a][0],i[a][1]);u.x===s.x&&u.y===s.y||(this.segments.push($.fromRing(s,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),s=u)}o.x===s.x&&o.y===s.y||this.segments.push($.fromRing(s,o,this))}return i(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.segments.length;e<i;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),e}(),N=function(){function e(i,n){if(t(this,e),!Array.isArray(i))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new j(i[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,o=i.length;r<o;r++){var s=new j(i[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=n}return i(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,i=this.interiorRings.length;e<i;e++)for(var n=this.interiorRings[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),e}(),B=function(){function e(i,n){if(t(this,e),!Array.isArray(i))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof i[0][0][0]&&(i=[i])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,o=i.length;r<o;r++){var s=new N(i[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=n}return i(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++)for(var n=this.polys[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),e}(),U=function(){function e(i){t(this,e),this.events=i;for(var n=0,r=i.length;n<r;n++)i[n].segment.ringOut=this;this.poly=null}return i(e,null,[{key:"factory",value:function(t){for(var i=[],n=0,r=t.length;n<r;n++){var o=t[n];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,u=[a],h=a.point,c=[];s=a,a=l,u.push(a),a.point!==h;)for(;;){var d=a.getAvailableLinkedEvents();if(0===d.length){var f=u[0].point,p=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(p.x,", ").concat(p.y,"]."))}if(1===d.length){l=d[0].otherSE;break}for(var g=null,m=0,v=c.length;m<v;m++)if(c[m].point===a.point){g=m;break}if(null===g){c.push({index:u.length,point:a.point});var y=a.getLeftmostComparator(s);l=d.sort(y)[0].otherSE;break}var _=c.splice(g)[0],b=u.splice(_.index);b.unshift(b[0].otherSE),i.push(new e(b.reverse()))}i.push(new e(u))}}return i}}]),i(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],i=1,n=this.events.length-1;i<n;i++){var r=this.events[i].point,o=this.events[i+1].point;0!==A(r,t,o)&&(e.push(r),t=r)}if(1===e.length)return null;var s=e[0],a=e[1];0===A(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,c=[],d=u;d!=h;d+=l)c.push([e[d].x,e[d].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,i=this.events.length;e<i;e++){var n=this.events[e];O.compare(t,n)>0&&(t=n)}for(var r=t.segment.prevInResult(),o=r?r.prevInResult():null;;){if(!r)return null;if(!o)return r.ringOut;if(o.ringOut!==r.ringOut)return o.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=o.prevInResult(),o=r?r.prevInResult():null}}}]),e}(),G=function(){function e(i){t(this,e),this.exteriorRing=i,i.poly=this,this.interiorRings=[]}return i(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,i=this.interiorRings.length;e<i;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),e}(),V=function(){function e(i){t(this,e),this.rings=i,this.polys=this._composePolys(i)}return i(e,[{key:"getGeom",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];if(!r.poly)if(r.isExteriorRing())e.push(new G(r));else{var o=r.enclosingRing();o.poly||e.push(new G(o)),o.poly.addInterior(r)}}return e}}]),e}(),z=function(){function e(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$.compare;t(this,e),this.queue=i,this.tree=new c(n),this.segments=[]}return i(e,[{key:"process",value:function(t){var e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),i;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=n,o=n,s=void 0,a=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var h=this._splitSafely(s,u),c=0,d=h.length;c<d;c++)i.push(h[c])}var f=null;if(a){var p=a.getIntersection(e);if(null!==p&&(e.isAnEndpoint(p)||(f=p),!a.isAnEndpoint(p)))for(var g=this._splitSafely(a,p),m=0,v=g.length;m<v;m++)i.push(g[m])}if(null!==l||null!==f){var y=null;y=null===l?f:null===f||O.comparePoints(l,f)<=0?l:f,this.queue.remove(e.rightSE),i.push(e.rightSE);for(var _=e.split(y),b=0,w=_.length;b<w;b++)i.push(_[b])}i.length>0?(this.tree.remove(e),i.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var x=s.getIntersection(a);if(null!==x){if(!s.isAnEndpoint(x))for(var S=this._splitSafely(s,x),C=0,E=S.length;C<E;C++)i.push(S[C]);if(!a.isAnEndpoint(x))for(var T=this._splitSafely(a,x),I=0,A=T.length;I<A;I++)i.push(T[I])}}this.tree.remove(e)}return i}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var i=t.rightSE;this.queue.remove(i);var n=t.split(e);return n.push(i),void 0===t.consumedBy&&this.tree.insert(t),n}}]),e}(),q=void 0!==n&&n.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,W=void 0!==n&&n.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,K=new(function(){function e(){t(this,e)}return i(e,[{key:"run",value:function(t,e,i){K.type=t,E.reset();for(var n=[new B(e,!0)],r=0,o=i.length;r<o;r++)n.push(new B(i[r],!1));if(K.numMultiPolys=n.length,"difference"===K.type)for(var s=n[0],a=1;a<n.length;)null!==_(n[a].bbox,s.bbox)?a++:n.splice(a,1);if("intersection"===K.type)for(var l=0,u=n.length;l<u;l++)for(var h=n[l],d=l+1,f=n.length;d<f;d++)if(null===_(h.bbox,n[d].bbox))return[];for(var p=new c(O.compare),g=0,m=n.length;g<m;g++)for(var v=n[g].getSweepEvents(),y=0,b=v.length;y<b;y++)if(p.insert(v[y]),p.size>q)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new z(p),x=p.size,S=p.pop();S;){var C=S.key;if(p.size===x){var T=C.segment;throw new Error("Unable to pop() ".concat(C.isLeft?"left":"right"," SweepEvent ")+"[".concat(C.point.x,", ").concat(C.point.y,"] from segment #").concat(T.id," ")+"[".concat(T.leftSE.point.x,", ").concat(T.leftSE.point.y,"] -> ")+"[".concat(T.rightSE.point.x,", ").concat(T.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(p.size>q)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>W)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var I=w.process(C),A=0,k=I.length;A<k;A++){var P=I[A];void 0===P.consumedBy&&p.insert(P)}x=p.size,S=p.pop()}E.reset();var L=U.factory(w.segments);return new V(L).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("union",t,i)},intersection:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("intersection",t,i)},xor:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("xor",t,i)},difference:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return K.run("difference",t,i)}}}()},4155:t=>{var e,i,n=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(i){try{return e.call(null,t,0)}catch(i){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:r}catch(t){e=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var a,l=[],u=!1,h=-1;function c(){u&&a&&(u=!1,a.length?l=a.concat(l):h=-1,l.length&&d())}function d(){if(!u){var t=s(c);u=!0;for(var e=l.length;e;){for(a=l,l=[];++h<e;)a&&a[h].run();h=-1,e=l.length}a=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new f(t,e)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},8166:function(t){t.exports=function(){"use strict";function t(t,i,r,o,s){e(t,i,r||0,o||t.length-1,s||n)}function e(t,n,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=n-r+1,u=Math.log(a),h=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*h*(a-h)/a)*(l-a/2<0?-1:1);e(t,n,Math.max(r,Math.floor(n-l*h/a+c)),Math.min(o,Math.floor(n+(a-l)*h/a+c)),s)}var d=t[n],f=r,p=o;for(i(t,r,n),s(t[o],d)>0&&i(t,r,o);f<p;){for(i(t,f,p),f++,p--;s(t[f],d)<0;)f++;for(;s(t[p],d)>0;)p--}0===s(t[r],d)?i(t,r,p):i(t,++p,o),p<=n&&(r=p+1),n<=p&&(o=p-1)}}function i(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function n(t,e){return t<e?-1:t>e?1:0}return t}()},5510:(t,e,i)=>{"use strict";t.exports=r,t.exports.default=r;var n=i(8166);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,i,n,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<i;s++)o=t.children[s],l(r,t.leaf?n(o):o);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,i,r,o){for(var s,a=[e,i];a.length;)(i=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((i-e)/r/2)*r,n(t,s,e,i,o),a.push(e,s,s,i))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!p(t,e))return i;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],p(t,a=e.leaf?n(s):s)&&(e.leaf?i.push(s):f(t,a)?this._all(s,i):l.push(s));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!p(t,e))return!1;for(var n,r,o,s,a=[];e;){for(n=0,r=e.children.length;n<r;n++)if(o=e.children[n],p(t,s=e.leaf?i(o):o)){if(e.leaf||f(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var i,n,r,s,a=this.data,l=this.toBBox(t),u=[],h=[];a||u.length;){if(a||(a=u.pop(),n=u[u.length-1],i=h.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!f(a,l)?n?(i++,a=n.children[i],s=!1):a=null:(u.push(a),h.push(i),i=0,n=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=g([])).leaf=!1,r.height=n;var l,u,h,c,d=Math.ceil(o/a),f=d*Math.ceil(Math.sqrt(a));for(m(t,e,i,f,this.compareMinX),l=e;l<=i;l+=f)for(m(t,l,h=Math.min(l+f-1,i),d,this.compareMinY),u=l;u<=h;u+=d)c=Math.min(u+d-1,h),r.children.push(this._build(t,u,c,n-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,i,n){for(var r,o,s,a,l,u,h,d,f,p;n.push(e),!e.leaf&&n.length-1!==i;){for(h=d=1/0,r=0,o=e.children.length;r<o;r++)l=c(s=e.children[r]),f=t,p=s,(u=(Math.max(p.maxX,f.maxX)-Math.min(p.minX,f.minX))*(Math.max(p.maxY,f.maxY)-Math.min(p.minY,f.minY))-l)<d?(d=u,h=l<h?l:h,a=s):u===d&&l<h&&(h=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,r=i?t:n(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),l(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=g(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,r,o,s,l,u,h,d,f,p,g,m,v,y;for(u=h=1/0,n=e;n<=i-e;n++)r=a(t,0,n,this.toBBox),o=a(t,n,i,this.toBBox),f=r,p=o,g=void 0,m=void 0,v=void 0,y=void 0,g=Math.max(f.minX,p.minX),m=Math.max(f.minY,p.minY),v=Math.min(f.maxX,p.maxX),y=Math.min(f.maxY,p.maxY),s=Math.max(0,v-g)*Math.max(0,y-m),l=c(r)+c(o),s<u?(u=s,d=n,h=l<h?l:h):s===u&&l<h&&(h=l,d=n);return d},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var r,o,s=this.toBBox,u=a(t,0,e,s),h=a(t,i-e,i,s),c=d(u)+d(h);for(r=e;r<i-e;r++)o=t.children[r],l(u,t.leaf?s(o):o),c+=d(u);for(r=i-e-1;r>=e;r--)o=t.children[r],l(h,t.leaf?s(o):o),c+=d(h);return c},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)l(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():s(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},3697:t=>{"use strict";var e=Object,i=TypeError;t.exports=function(){if(null!=this&&this!==e(this))throw new i("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},2847:(t,e,i)=>{"use strict";var n=i(4289),r=i(5559),o=i(3697),s=i(1721),a=i(2753),l=r(o);n(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},1721:(t,e,i)=>{"use strict";var n=i(3697),r=i(4289).supportsDescriptors,o=Object.getOwnPropertyDescriptor,s=TypeError;t.exports=function(){if(!r)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return n}},2753:(t,e,i)=>{"use strict";var n=i(4289).supportsDescriptors,r=i(1721),o=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,l=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!n||!l)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=r(),e=l(u),i=o(e,"flags");return i&&i.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},3379:(t,e,i)=>{"use strict";var n,r=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},o=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),s=[];function a(t){for(var e=-1,i=0;i<s.length;i++)if(s[i].identifier===t){e=i;break}return e}function l(t,e){for(var i={},n=[],r=0;r<t.length;r++){var o=t[r],l=e.base?o[0]+e.base:o[0],u=i[l]||0,h="".concat(l," ").concat(u);i[l]=u+1;var c=a(h),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==c?(s[c].references++,s[c].updater(d)):s.push({identifier:h,updater:m(d,e),references:1}),n.push(h)}return n}function u(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var h,c=(h=[],function(t,e){return h[t]=e,h.filter(Boolean).join("\n")});function d(t,e,i,n){var r=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=c(e,r);else{var o=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function f(t,e,i){var n=i.css,r=i.media,o=i.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var p=null,g=0;function m(t,e){var i,n,r;if(e.singleton){var o=g++;i=p||(p=u(e)),n=d.bind(null,i,o,!1),r=d.bind(null,i,o,!0)}else i=u(e),n=f.bind(null,i,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=r());var i=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var r=a(i[n]);s[r].references--}for(var o=l(t,e),u=0;u<i.length;u++){var h=a(i[u]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}i=o}}}},8227:()=>{Array.prototype.find||(Array.prototype.find=function(t){"use strict";if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,i=Object(this),n=i.length>>>0,r=arguments[1],o=0;o<n;o++)if(e=i[o],t.call(r,e,o,i))return e}),"undefined"!=typeof window&&(!("classList"in document.createElement("_"))||document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?function(t){"use strict";if("Element"in t){var e="classList",i=t.Element.prototype,n=Object,r=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},o=Array.prototype.indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},s=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},a=function(t,e){if(""===e)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return o.call(t,e)},l=function(t){for(var e=r.call(t.getAttribute("class")||""),i=e?e.split(/\s+/):[],n=0,o=i.length;n<o;n++)this.push(i[n]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},u=l.prototype=[],h=function(){return new l(this)};if(s.prototype=Error.prototype,u.item=function(t){return this[t]||null},u.contains=function(t){return-1!==a(this,t+="")},u.add=function(){var t,e=arguments,i=0,n=e.length,r=!1;do{t=e[i]+"",-1===a(this,t)&&(this.push(t),r=!0)}while(++i<n);r&&this._updateClassName()},u.remove=function(){var t,e,i=arguments,n=0,r=i.length,o=!1;do{for(t=i[n]+"",e=a(this,t);-1!==e;)this.splice(e,1),o=!0,e=a(this,t)}while(++n<r);o&&this._updateClassName()},u.toggle=function(t,e){t+="";var i=this.contains(t),n=i?!0!==e&&"remove":!1!==e&&"add";return n&&this[n](t),!0===e||!1===e?e:!i},u.toString=function(){return this.join(" ")},n.defineProperty){var c={get:h,enumerable:!0,configurable:!0};try{n.defineProperty(i,e,c)}catch(t){-2146823252===t.number&&(c.enumerable=!1,n.defineProperty(i,e,c))}}else n.prototype.__defineGetter__&&i.__defineGetter__(e,h)}}(self):function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var i,n=arguments.length;for(i=0;i<n;i++)t=arguments[i],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var i=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:i.call(this,t)}}t=null}())},6608:()=>{}},i={};function n(t){var r=i[t];if(void 0!==r)return r.exports;var o=i[t]={id:t,loaded:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,t=[],n.O=(e,i,r,o)=>{if(!i){var s=1/0;for(u=0;u<t.length;u++){for(var[i,r,o]=t[u],a=!0,l=0;l<i.length;l++)(!1&o||s>=o)&&Object.keys(n.O).every((t=>n.O[t](i[l])))?i.splice(l--,1):(a=!1,o<s&&(s=o));a&&(t.splice(u--,1),e=r())}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[i,r,o]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={355:0,392:0};n.O.j=e=>0===t[e];var e=(e,i)=>{var r,o,[s,a,l]=i,u=0;for(r in a)n.o(a,r)&&(n.m[r]=a[r]);for(l&&l(n),e&&e(i);u<s.length;u++)o=s[u],n.o(t,o)&&t[o]&&t[o][0](),t[s[u]]=0;n.O()},i=self.webpackChunk=self.webpackChunk||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})(),n.O(void 0,[392],(()=>n(5471)));var r=n.O(void 0,[392],(()=>n(5798)));r=n.O(r)})();