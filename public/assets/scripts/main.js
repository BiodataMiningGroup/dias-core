angular.module("dias.api",["ngResource"]),angular.module("dias.api").config(["$httpProvider","$compileProvider",function(e,t){"use strict";e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",t.debugInfoEnabled(!1)}]),angular.module("dias.ui.messages",["ui.bootstrap"]),angular.module("dias.ui.messages").config(["$compileProvider",function(e){e.debugInfoEnabled(!1)}]),angular.element(document).ready(function(){"use strict";angular.bootstrap(document.querySelector('[data-ng-controller="MessagesController"]'),["dias.ui.messages"])}),angular.module("dias.ui.users",["ui.bootstrap","dias.api"]),angular.module("dias.ui.users").config(["$compileProvider",function(e){"use strict";e.debugInfoEnabled(!1)}]),angular.module("dias.ui.utils",[]),angular.module("dias.ui.utils").config(["$compileProvider","$locationProvider",function(e,t){"use strict";e.debugInfoEnabled(!1),t.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}]),angular.module("dias.ui",["ui.bootstrap","dias.ui.messages","dias.ui.users","dias.ui.utils","ngAnimate"]),angular.module("dias.ui").config(["$compileProvider","$animateProvider",function(e,t){"use strict";e.debugInfoEnabled(!1),t.classNameFilter(/\banimated\b/)}]),angular.module("dias.api").service("roles",["Role",function(e){"use strict";var t={},a={};e.query(function(e){e.forEach(function(e){t[e.id]=e.name,a[e.name]=e.id})}),this.getName=function(e){return t[e]},this.getId=function(e){return a[e]}}]),angular.module("dias.api").service("shapes",["Shape",function(e){"use strict";var t={},a={},i=e.query(function(e){e.forEach(function(e){t[e.id]=e.name,a[e.name]=e.id})});this.getName=function(e){return t[e]},this.getId=function(e){return a[e]},this.getAll=function(){return i}}]),angular.module("dias.api").factory("Annotation",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/annotations/:id",{id:"@id"},{save:{method:"PUT"},query:{method:"GET",url:t+"/api/v1/images/:id/annotations",isArray:!0},add:{method:"POST",url:t+"/api/v1/images/:id/annotations"}})}]),angular.module("dias.api").factory("AnnotationLabel",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/annotation-labels/:id",{id:"@id",annotation_id:"@annotation_id"},{query:{method:"GET",url:t+"/api/v1/annotations/:annotation_id/labels",isArray:!0},attach:{method:"POST",url:t+"/api/v1/annotations/:annotation_id/labels"},save:{method:"PUT",params:{annotation_id:null}},delete:{method:"DELETE",params:{annotation_id:null}}})}]),angular.module("dias.api").factory("Image",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/images/:id",{id:"@id"})}]),angular.module("dias.api").factory("ImageLabel",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/image-labels/:id",{id:"@id",image_id:"@image_id"},{query:{method:"GET",url:t+"/api/v1/images/:image_id/labels",isArray:!0},attach:{method:"POST",url:t+"/api/v1/images/:image_id/labels"},delete:{method:"DELETE",params:{image_id:null}}})}]),angular.module("dias.api").factory("Label",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/labels/:id",{id:"@id"},{create:{method:"POST",url:t+"/api/v1/label-trees/:label_tree_id/labels",params:{label_tree_id:"@label_tree_id"},isArray:!0}})}]),angular.module("dias.api").factory("LabelSource",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/label-sources/:id/find")}]),angular.module("dias.api").factory("LabelTree",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/label-trees/:id",{id:"@id"},{query:{method:"GET",isArray:!0},create:{method:"POST"},update:{method:"PUT"}})}]),angular.module("dias.api").factory("LabelTreeAuthorizedProject",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/label-trees/:id/authorized-projects",{},{addAuthorized:{method:"POST"},removeAuthorized:{method:"DELETE",url:t+"/api/v1/label-trees/:id/authorized-projects/:pid",params:{pid:"@id"}}})}]),angular.module("dias.api").factory("LabelTreeUser",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/label-trees/:label_tree_id/users/:id",{id:"@id"},{update:{method:"PUT"},attach:{method:"POST",url:t+"/api/v1/label-trees/:label_tree_id/users",params:{id:null}},detach:{method:"DELETE"}})}]),angular.module("dias.api").factory("MediaType",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/media-types/:id",{id:"@id"})}]),angular.module("dias.api").factory("OwnUser",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/users/my",{},{save:{method:"PUT"}})}]),angular.module("dias.api").factory("Project",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/projects/:id",{id:"@id"},{query:{method:"GET",params:{id:"my"},isArray:!0},add:{method:"POST"},save:{method:"PUT"}})}]),angular.module("dias.api").factory("ProjectLabelTree",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/projects/:project_id/label-trees",{project_id:"@project_id"},{available:{method:"GET",isArray:!0,url:t+"/api/v1/projects/:project_id/label-trees/available"},attach:{method:"POST",url:t+"/api/v1/projects/:project_id/label-trees"},detach:{method:"DELETE",url:t+"/api/v1/projects/:project_id/label-trees/:id",params:{id:"@id"}}})}]),angular.module("dias.api").factory("ProjectTransect",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/projects/:project_id/transects/:id",{id:"@id"},{add:{method:"POST"},attach:{method:"POST"},detach:{method:"DELETE"}})}]),angular.module("dias.api").factory("ProjectUser",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/projects/:project_id/users/:id",{id:"@id"},{save:{method:"PUT"},attach:{method:"POST"},detach:{method:"DELETE"}})}]),angular.module("dias.api").factory("Role",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/roles/:id",{id:"@id"})}]),angular.module("dias.api").factory("Shape",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/shapes/:id",{id:"@id"})}]),angular.module("dias.api").factory("Transect",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/transects/:id",{id:"@id"},{save:{method:"PUT"}})}]),angular.module("dias.api").factory("TransectImage",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/transects/:transect_id/images",{},{save:{method:"POST",isArray:!0}})}]),angular.module("dias.api").factory("User",["$resource","URL",function(e,t){"use strict";return e(t+"/api/v1/users/:id/:query",{id:"@id"},{save:{method:"PUT"},add:{method:"POST"},find:{method:"GET",params:{id:"find"},isArray:!0}})}]),angular.module("dias.ui.messages").constant("MAX_MSG",1),angular.module("dias.ui.messages").controller("MessagesController",["$scope","MAX_MSG",function(e,t){"use strict";e.alerts=[];var a=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()};window.$diasPostMessage=function(i,r){a(),e.$apply(function(){e.alerts.unshift({message:r,type:i||"info"}),e.alerts.length>t&&e.alerts.pop()})},e.close=function(t){e.alerts.splice(t,1)}}]),angular.module("dias.ui.messages").service("msg",function(){"use strict";var e=this;this.post=function(e,t){t=t||e,window.$diasPostMessage(e,t)},this.danger=function(t){e.post("danger",t)},this.warning=function(t){e.post("warning",t)},this.success=function(t){e.post("success",t)},this.info=function(t){e.post("info",t)},this.responseError=function(t){var a=t.data;if(a)if(a.message)e.danger(a.message);else if("string"==typeof a)e.danger(a);else for(var i in a)e.danger(a[i][0]);else 403===t.status?e.danger("You have no permission to do that."):401===t.status?e.danger("Please log in (again)."):e.danger("The server didn't respond, sorry.")}}),angular.module("dias.ui.users").directive("userChooser",function(){"use strict";return{restrict:"A",scope:{select:"=userChooser"},replace:!0,template:'<input type="text" data-ng-model="selected" data-uib-typeahead="name(user) for user in find($viewValue)" data-typeahead-wait-ms="250" data-typeahead-on-select="select($item)"/>',controller:["$scope","User",function(e,t){e.name=function(e){return e&&e.firstname&&e.lastname?e.firstname+" "+e.lastname:""},e.find=function(e){return t.find({query:encodeURIComponent(e)}).$promise}}]}}),angular.module("dias.ui.utils").factory("debounce",["$timeout","$q",function(e,t){"use strict";var a={};return function(i,r,s){var n=t.defer();return function(){var o=this,u=arguments,d=function(){a[s]=void 0,n.resolve(i.apply(o,u)),n=t.defer()};return a[s]&&e.cancel(a[s]),a[s]=e(d,r),n.promise}()}}]),angular.module("dias.ui.utils").factory("filterExclude",function(){"use strict";var e=function(e,t){return e-t},t=function(t,a,i){i||(a=a.slice(0).sort(e));for(var r=t.slice(0).sort(e),s=0,n=0;s<a.length&&n<r.length;)a[s]<r[n]?s++:a[s]===r[n]?(t.splice(t.indexOf(r[n]),1),s++,n++):n++};return t}),angular.module("dias.ui.utils").factory("filterSubset",function(){"use strict";var e=function(e,t){return e-t},t=function(t,a,i){i||(a=a.slice(0).sort(e));for(var r=t.slice(0).sort(e),s=[],n=0,o=0;n<a.length&&o<r.length;)a[n]<r[o]?n++:a[n]===r[o]?(n++,o++):s.push(r[o++]);for(;o<r.length;)s.push(r[o++]);for(n=0;n<s.length;n++)t.splice(t.indexOf(s[n]),1)};return t}),angular.module("dias.ui.utils").service("keyboard",["$document",function(e){"use strict";var t={},a=e[0].body,i=function(e,t){for(var a=e.length-1;a>=0;a--)if(e[a].callback(t)===!1)return},r=function(e){if(e.target===a){var r=e.keyCode,s=String.fromCharCode(e.which||r).toLowerCase();t[r]&&i(t[r],e),t[s]&&i(t[s],e)}};e.bind("keydown",r),this.on=function(e,a,i){("string"==typeof e||e instanceof String)&&(e=e.toLowerCase()),i=i||0;var r={callback:a,priority:i};if(t[e]){var s,n=t[e];for(s=0;s<n.length&&!(n[s].priority>=i);s++);s===n.length-1?n.push(r):n.splice(s,0,r)}else t[e]=[r]},this.off=function(e,a){if(("string"==typeof e||e instanceof String)&&(e=e.toLowerCase()),t[e])for(var i=t[e],r=0;r<i.length;r++)if(i[r].callback===a){i.splice(r,1);break}}}]),angular.module("dias.ui.utils").service("urlParams",["$location",function(e){"use strict";this.setSlug=function(t){var a=e.path();a=a.substring(0,a.lastIndexOf("/")),e.path(a+"/"+t),e.replace()},this.set=function(t){e.search(t),e.replace()},this.unset=function(t){e.search(t,null),e.replace()},this.get=function(t){return e.search()[t]}}]);